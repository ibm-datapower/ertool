<!-- This supports Cast Iron / API Management (v5) / API Connect (v5) post mortems -->
<Analytics version="APIConnect_1.0.0.8" date="Feb 22 2020 11:00PM EST">
	<!-- keeping this at the top as it serves as a wildcard to cache all files in the archive, makes tool output more efficient, does not display this result formula to user -->
	<Formula Categories="general">
		<Expression LogLevel="Info">
			<Section Name="int.version.txt" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="VersionInfo" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<!-- removed formula from active review since it is redundant to usr/ironhide/etc/version/version.txt -->
	<!--
	<Formula Categories="general" TopPositionResult="true">
		<Name>API Firmware Info: {Condition:VersionInfo}</Name>
		<DisplayMessage>.</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="api.version.txt" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="VersionInfo" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>-->

	<!-- 5.0.x/2018 end of service data is at http://www-01.ibm.com/support/docview.wss?uid=swg22006450 -->
	<!-- 4.0.x end of service data is at https://www-01.ibm.com/software/support/lifecycleapp/PLCDetail.wss?from=spf&synkey=Y996196B48803Q73 -->
	<Formula CollapseResult="true" OmitPrintingMetConditions="true" TopPositionResult="true" Categories="general">
		<Name>API Connect Firmware Version: &lt;font color='{Condition:DefaultColor}'&gt;{Condition:FirmwareVersion}&lt;/font&gt;.  End of Fix Support: {Condition:EndFixSupport}.  End of Service: {Condition:EndOfService}. See &lt;a href="{Condition:URL}"&gt;End of Fix and End of Service Support Details&lt;/a&gt;.</Name>
		<!-- 5.0.8 is current long term support -->
		<Expression LogLevel="Info">
			<Section Name="usr/ironhide/etc/version/version.txt" XPath="/Root/text()"/>
			<RegExp>API Connect (([0-9]\.[0-9]\.[0-9])\.([0-9]))(iFix)?_([0-9]{8})-([0-9]{4,}_[a-f0-9]+) \(([a-zA-Z]{3}\s[0-9]{2}\s[0-9]{4}, SOURCE ID: [0-9a-f]+)\)</RegExp>
			<Condition FieldPosition="2" Operation="StartsWith" Value="5.0.8" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="DefaultColor" Value="#009900" NextOperation="And"/>
			<Condition FieldPosition="0" ConditionName="FirmwareVersion" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="URL" Value="http://www-01.ibm.com/support/docview.wss?uid=swg22006450" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="EndFixSupport" Value="*TBD*" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="EndOfService" Value="*TBD*"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="usr/ironhide/etc/version/version.txt" XPath="/Root/text()"/>
			<RegExp>API Connect (([0-9]\.[0-9]\.[0-9])\.([0-9]))(iFix)?_([0-9]{8})-([0-9]{4,}_[a-f0-9]+) \(([a-zA-Z]{3}\s[0-9]{2}\s[0-9]{4}, SOURCE ID: [0-9a-f]+)\)</RegExp>
			<Condition FieldPosition="2" Operation="StartsWith" Value="5.0.7" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="DefaultColor" Value="#009900" NextOperation="And"/>
			<Condition FieldPosition="0" ConditionName="FirmwareVersion" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="URL" Value="http://www-01.ibm.com/support/docview.wss?uid=swg22006450" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="EndFixSupport" Value="October 20, 2017" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="EndOfService" Value="*TBD*"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="usr/ironhide/etc/version/version.txt" XPath="/Root/text()"/>
			<RegExp>API Connect (([0-9]\.[0-9]\.[0-9])\.([0-9]))(iFix)?_([0-9]{8})-([0-9]{4,}_[a-f0-9]+) \(([a-zA-Z]{3}\s[0-9]{2}\s[0-9]{4}, SOURCE ID: [0-9a-f]+)\)</RegExp>
			<Condition FieldPosition="2" Operation="StartsWith" Value="5.0.6" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="DefaultColor" Value="#009900" NextOperation="And"/>
			<Condition FieldPosition="0" ConditionName="FirmwareVersion" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="URL" Value="http://www-01.ibm.com/support/docview.wss?uid=swg22006450" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="EndFixSupport" Value="March 30, 2018" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="EndOfService" Value="*TBD*"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="usr/ironhide/etc/version/version.txt" XPath="/Root/text()"/>
			<RegExp>API Connect (([0-9]\.[0-9]\.[0-9])\.([0-9]))(iFix)?_([0-9]{8})-([0-9]{4,}_[a-f0-9]+) \(([a-zA-Z]{3}\s[0-9]{2}\s[0-9]{4}, SOURCE ID: [0-9a-f]+)\)</RegExp>
			<Condition FieldPosition="2" Operation="StartsWith" Value="5.0.5" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="DefaultColor" Value="#009900" NextOperation="And"/>
			<Condition FieldPosition="0" ConditionName="FirmwareVersion" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="URL" Value="http://www-01.ibm.com/support/docview.wss?uid=swg22006450" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="EndFixSupport" Value="April 02, 2017" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="EndOfService" Value="*TBD*"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="usr/ironhide/etc/version/version.txt" XPath="/Root/text()"/>
			<RegExp>API Connect (([0-9]\.[0-9]\.[0-9])\.([0-9]))(iFix)?_([0-9]{8})-([0-9]{4,}_[a-f0-9]+) \(([a-zA-Z]{3}\s[0-9]{2}\s[0-9]{4}, SOURCE ID: [0-9a-f]+)\)</RegExp>
			<Condition FieldPosition="2" Operation="StartsWith" Value="5.0.4" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="DefaultColor" Value="#009900" NextOperation="And"/>
			<Condition FieldPosition="0" ConditionName="FirmwareVersion" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="URL" Value="http://www-01.ibm.com/support/docview.wss?uid=swg22006450" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="EndFixSupport" Value="November 23, 2016" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="EndOfService" Value="*TBD*"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="usr/ironhide/etc/version/version.txt" XPath="/Root/text()"/>
			<RegExp>API Connect (([0-9]\.[0-9]\.[0-9])\.([0-9]))(iFix)?_([0-9]{8})-([0-9]{4,}_[a-f0-9]+) \(([a-zA-Z]{3}\s[0-9]{2}\s[0-9]{4}, SOURCE ID: [0-9a-f]+)\)</RegExp>
			<Condition FieldPosition="2" Operation="StartsWith" Value="5.0.3" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="DefaultColor" Value="#009900" NextOperation="And"/>
			<Condition FieldPosition="0" ConditionName="FirmwareVersion" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="URL" Value="http://www-01.ibm.com/support/docview.wss?uid=swg22006450" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="EndFixSupport" Value="September 22, 2016" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="EndOfService" Value="*TBD*"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="usr/ironhide/etc/version/version.txt" XPath="/Root/text()"/>
			<RegExp>API Connect (([0-9]\.[0-9]\.[0-9])\.([0-9]))(iFix)?_([0-9]{8})-([0-9]{4,}_[a-f0-9]+) \(([a-zA-Z]{3}\s[0-9]{2}\s[0-9]{4}, SOURCE ID: [0-9a-f]+)\)</RegExp>
			<Condition FieldPosition="2" Operation="StartsWith" Value="5.0.2" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="DefaultColor" Value="#009900" NextOperation="And"/>
			<Condition FieldPosition="0" ConditionName="FirmwareVersion" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="URL" Value="http://www-01.ibm.com/support/docview.wss?uid=swg22006450" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="EndFixSupport" Value="August 10, 2016" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="EndOfService" Value="*TBD*"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="usr/ironhide/etc/version/version.txt" XPath="/Root/text()"/>
			<RegExp>API Connect (([0-9]\.[0-9]\.[0-9])\.([0-9]))(iFix)?_([0-9]{8})-([0-9]{4,}_[a-f0-9]+) \(([a-zA-Z]{3}\s[0-9]{2}\s[0-9]{4}, SOURCE ID: [0-9a-f]+)\)</RegExp>
			<Condition FieldPosition="2" Operation="StartsWith" Value="5.0.1" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="DefaultColor" Value="#009900" NextOperation="And"/>
			<Condition FieldPosition="0" ConditionName="FirmwareVersion" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="URL" Value="http://www-01.ibm.com/support/docview.wss?uid=swg22006450" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="EndFixSupport" Value="July 01, 2016" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="EndOfService" Value="*TBD*"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="usr/ironhide/etc/version/version.txt" XPath="/Root/text()"/>
			<RegExp>API Connect (([0-9]\.[0-9]\.[0-9])\.([0-9]))(iFix)?_([0-9]{8})-([0-9]{4,}_[a-f0-9]+) \(([a-zA-Z]{3}\s[0-9]{2}\s[0-9]{4}, SOURCE ID: [0-9a-f]+)\)</RegExp>
			<Condition FieldPosition="2" Operation="StartsWith" Value="5.0.0" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="DefaultColor" Value="#009900" NextOperation="And"/>
			<Condition FieldPosition="0" ConditionName="FirmwareVersion" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="URL" Value="http://www-01.ibm.com/support/docview.wss?uid=swg22006450" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="EndFixSupport" Value="March 30, 2018" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="EndOfService" Value="*TBD*"/>
		</Expression>
		<!-- 4.0 is nearing end of service Sep, 30 2018 -->
		<Expression LogLevel="Info">
			<Section Name="usr/ironhide/etc/version/version.txt" XPath="/Root/text()"/>
			<RegExp>API Connect (([0-9]\.[0-9]\.[0-9])\.([0-9]))(iFix)?_([0-9]{8})-([0-9]{4,}_[a-f0-9]+) \(([a-zA-Z]{3}\s[0-9]{2}\s[0-9]{4}, SOURCE ID: [0-9a-f]+)\)</RegExp>
			<Condition FieldPosition="2" Operation="StartsWith" Value="4.0." NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="DefaultColor" Value="red" NextOperation="And"/>
			<Condition FieldPosition="0" ConditionName="FirmwareVersion" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="URL" Value="https://www-01.ibm.com/software/support/lifecycleapp/PLCDetail.wss?from=spf&amp;synkey=Y996196B48803Q73" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="EndFixSupport" Value="September 15, 2017" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="EndOfService" Value="September 30, 2018"/>
		</Expression>
		<!-- 3.0.x is nearing end of service Sep, 30 2018 -->
		<Expression LogLevel="Info">
			<Section Name="usr/ironhide/etc/version/version.txt" XPath="/Root/text()"/>
			<RegExp>API Connect (([0-9]\.[0-9]\.[0-9])\.([0-9]))(iFix)?_([0-9]{8})-([0-9]{4,}_[a-f0-9]+) \(([a-zA-Z]{3}\s[0-9]{2}\s[0-9]{4}, SOURCE ID: [0-9a-f]+)\)</RegExp>
			<Condition FieldPosition="2" Operation="StartsWith" Value="3.0." NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="DefaultColor" Value="red" NextOperation="And"/>
			<Condition FieldPosition="0" ConditionName="FirmwareVersion" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="URL" Value="https://www-01.ibm.com/software/support/lifecycleapp/PLCDetail.wss?from=spf&amp;synkey=Y996196B48803Q73" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="EndFixSupport" Value="September 15, 2017" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="EndOfService" Value="September 30, 2018"/>
		</Expression>
		<!-- 2.0.x is nearing end of service Sep, 30 2015 -->
		<Expression LogLevel="Info">
			<Section Name="usr/ironhide/etc/version/version.txt" XPath="/Root/text()"/>
			<RegExp>API Connect (([0-9]\.[0-9]\.[0-9])\.([0-9]))(iFix)?_([0-9]{8})-([0-9]{4,}_[a-f0-9]+) \(([a-zA-Z]{3}\s[0-9]{2}\s[0-9]{4}, SOURCE ID: [0-9a-f]+)\)</RegExp>
			<Condition FieldPosition="2" Operation="StartsWith" Value="2.0." NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="DefaultColor" Value="red" NextOperation="And"/>
			<Condition FieldPosition="0" ConditionName="FirmwareVersion" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="URL" Value="https://www-01.ibm.com/software/support/lifecycleapp/PLCDetail.wss?from=spf&amp;synkey=Y996196B48803Q73" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="EndFixSupport" Value="November 04, 2014" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="EndOfService" Value="September 30, 2015"/>
		</Expression>
	</Formula>
	
	<!--
	<Formula Categories="general" TopPositionResult="true">
		<Name>[Bedrock Info] App Version: {Condition:AppVersion} Build {Condition:BuildNum} on {Condition:BuildDate}</Name>
		<DisplayMessage>.</DisplayMessage>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="bedrock-version.xml" XPath="/version/application//versionnum"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="AppVersion" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="bedrock-version.xml" XPath="/version/application//buildnum"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="BuildNum" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="bedrock-version.xml" XPath="/version/application//builddate"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="BuildDate" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	-->
	
	<Formula CollapseResult="true" OmitPrintingMetConditions="true" TopPositionResult="true" Categories="general;memory" FormulaID="MemoryUsage">
		<Name>{Condition:SectionName} MemoryStatus at {Condition:DateTime}: Active/Total Memory {Condition:ActiveMemory}/{Condition:TotalMemory} kB - Free Memory: {Condition:FreeMemory} kB.</Name>
		<Expression LogLevel="Info">
			<Section Name="var/log/router.stat" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="MemoryUsageStructure" Operation="NotEqualTo" Value="" NextOperation="And">ENTER MEMINFO((?![\s\S]*ENTER MEMINFO+)\W+(\w+\W+)*)\#EXIT MEMINFO</Condition>
			<Condition FieldPosition="1" InValue="{Condition:MemoryUsageStructure}" RegGroup="All" ConditionName="DateTime" Operation="NotEqualTo" Value="" NextOperation="And">\s+([0-9]{4}\-[0-9]{1,2}\-[0-9]{1,2}\s[0-9]{1,2}\:[0-9]{2}\:[0-9]{2})</Condition>
			<Condition FieldPosition="2" InValue="{Condition:MemoryUsageStructure}" RegGroup="All" ConditionName="ActiveMemory" Operation="NotEqualTo" Value="" NextOperation="And">Active\:((?![\s\S]*Active\:+)\s+([0-9]+))</Condition>
			<Condition FieldPosition="2" InValue="{Condition:MemoryUsageStructure}" RegGroup="All" ConditionName="TotalMemory" Operation="NotEqualTo" Value="" NextOperation="And">MemTotal\:((?![\s\S]*MemTotal\:+)\s+([0-9]+))</Condition>
			<Condition FieldPosition="2" InValue="{Condition:MemoryUsageStructure}" RegGroup="All" ConditionName="FreeMemory" Operation="NotEqualTo" Value="">MemFree\:((?![\s\S]*MemFree\:+)\s+([0-9]+))</Condition>
		</Expression>
	</Formula>
	
	<Formula OmitPrintingMetConditions="true" TopPositionResult="true" Categories="general;memory" FormulaID="FileSystemUsage">
		<Name>{Condition:SectionName} DiskUsage at {Condition:DateTime}: DiskDirectory: {Condition:DiskDirectory} - DiskUsed: {Condition:DiskUsed}</Name>
		<Expression LogLevel="Info">
			<Section Name="var/log/router.stat" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="DiskUsageStructure" Operation="NotEqualTo" Value="" NextOperation="And">ENTER DISKUSAGE((?![\s\S]*ENTER DISKUSAGE+)\W+(\w+\W+)*)\#EXIT DISKUSAGE</Condition>
			<Condition FieldPosition="1" InValue="{Condition:DiskUsageStructure}" RegGroup="All" ConditionName="DateTime" Operation="NotEqualTo" Value="" NextOperation="And">\s+([0-9]{4}\-[0-9]{1,2}\-[0-9]{1,2}\s[0-9]{1,2}\:[0-9]{2}\:[0-9]{2})</Condition>
			<Condition FieldPosition="1" InValue="{Condition:DiskUsageStructure}" RegGroup="All" ConditionName="DiskUsed" Operation="NotEqualTo" Value="" NextOperation="And">\/[a-zA-Z0-9_\/]+\s+[0-9]+\s+[0-9]+\s+[0-9]+\s+([0-9]+\%)\s+([a-zA-Z0-9_\/]+)</Condition>
			<Condition FieldPosition="2" InValue="{Condition:DiskUsageStructure}" RegGroup="All" ConditionName="DiskDirectory" Operation="NotEqualTo" Value="">\/[a-zA-Z0-9_\/]+\s+[0-9]+\s+[0-9]+\s+[0-9]+\s+([0-9]+\%)\s+([a-zA-Z0-9_\/]+)</Condition>
		</Expression>
	</Formula>
	
		
	<!-- APIC Portal Version Information List -->
	<Formula Categories="general" TopPositionResult="true">
		<Name>{Condition:SectionName} {Condition:VersionData}</Name>
		<Expression LogLevel="Info">
			<Section Name="home/admin/bin/.distribution_version" XPath="/Root/text()"/>
			<!-- example input: 7.x-5.0.7.2-iFix-20180328-2109 and 7.x-4.0.4.6-20170707-1023 -->
			<RegExp>\b([0-9.a-zA-Z]+)\-([0-9.]+)(\-iFix[0-9]{0,})?\-([0-9]{8})\-([0-9]{4})\b</RegExp>
			<Condition FieldPosition="0" RegGroup="All" ConditionName="VersionData" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="general" TopPositionResult="true">
		<Name>{Condition:SectionName} {Condition:VersionData}</Name>
		<Expression LogLevel="Info">
			<Section Name="home/admin/bin/.system_version" XPath="/Root/text()"/>
			<!-- example input: 7.x-5.0.7.2-iFix-20180328-2109 -->
			<RegExp>\b([0-9.a-zA-Z]+)\-([0-9.]+)(\-iFix[0-9]{0,})?\-([0-9]{8})\-([0-9]{4})\b</RegExp>
			<Condition FieldPosition="0" RegGroup="All" ConditionName="VersionData" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="general" TopPositionResult="true">
		<Name>{Condition:SectionName} {Condition:VersionData}</Name>
		<Expression LogLevel="Info">
			<Section Name="home/admin/bin/.system_version_history" XPath="/Root/text()"/>
			<!-- example input: Sat Jan 27 22:40:13 UTC 2018 Updated from 7.x-4.0.4.6-20170707-1023 to 7.x-5.0.7.2-iFix5-20170911-1114 -->
			<RegExp>\b[a-zA-Z]{3}\s[a-zA-Z]{3}\s[0-9]{2}\s[0-9]{2}\:[0-9]{2}\:[0-9]{2}\s[a-zA-Z]{3}\s[0-9]{4}\sUpdated\sfrom\s([0-9.a-zA-Z]+)\-([0-9.]+)(\-iFix[0-9]{0,})?\-([0-9]{8})\-([0-9]{4})\sto\s([0-9.a-zA-Z]+)\-([0-9.]+)(\-iFix[0-9]{0,})?\-([0-9]{8})\-([0-9]{4})\b</RegExp>
			<Condition FieldPosition="0" RegGroup="All" ConditionName="VersionData" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- End of APIC Portal Version Information List -->
	
	<!-- APIC Portal IP/Hostname Info -->
	<Formula Categories="general" TopPositionResult="true">
		<Name>{Condition:SectionName} {Condition:IPHostname}</Name>
		<Expression LogLevel="Info">
			<Section Name="home/admin/bin/.apim_hostname" XPath="/Root/text()"/>
			<RegExp>\b([0-9a-zA-Z_\.-]+)\b</RegExp>
			<Condition FieldPosition="0" RegGroup="All" ConditionName="IPHostname" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="general" TopPositionResult="true">
		<Name>{Condition:SectionName} {Condition:IPHostname}</Name>
		<Expression LogLevel="Info">
			<Section Name="home/admin/bin/.apim_hostip" XPath="/Root/text()"/>
			<RegExp>\b([0-9]+\.[0-9]+\.[0-9]+\.[0-9]+)\b</RegExp>
			<Condition FieldPosition="0" RegGroup="All" ConditionName="IPHostname" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="general" TopPositionResult="true">
		<Name>{Condition:SectionName} {Condition:FQDN}</Name>
		<Expression LogLevel="Info">
			<Section Name="home/admin/bin/.devportal_fqdn" XPath="/Root/text()"/>
			<RegExp>\b([0-9a-zA-Z_\.-]+)\b</RegExp>
			<Condition FieldPosition="0" RegGroup="All" ConditionName="FQDN" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	
	<Formula CollapseResult="true" FormulaID="NO_CIRCUITBREAKER">
			<Expression LogLevel="Info">
			<Section Name="bedrock-version.xml" XPath="/version/application//buildnum"/>
				<RegExp>WCI-(\d+\.\d+)\.(\d+)\.(\d+)</RegExp>
				<Condition FieldPosition="1" Operation="EqualsTo" Value="5.0" NextOperation="And"/>
				<Condition FieldPosition="2" Operation="LessThan" Value="7"/> <!-- less than 5.0.7.x -->
			</Expression>
	</Formula>
	
	<Formula Categories="general" CollapseResult="true" TopPositionResult="true">
		<Name>[Device Info] Device Serial: {Condition:SerialNumber}</Name>
		<Expression LogLevel="Info">
			<Section Name="var/log/platinfo" XPath="/Root/text()"/>
			<RegExp>\bSerial Number: ([a-zA-Z0-9]+)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="SerialNumber" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="SerialNumber" Operation="NotEqualTo" Value="None"/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" OmitPrintingMetConditions="true" TopPositionResult="true" Categories="general">
		<Name>{Condition:SectionName} Hostname: {Condition:HostName}, Emgmt IP: {Condition:EmgmtIP}, Domain: {Condition:Domain}</Name>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="var/log/platinfo" XPath="/Root/text()"/>
			<RegExp>\bHostname: ([a-zA-Z0-9._-]+)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="HostName" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="var/log/platinfo" XPath="/Root/text()"/>
			<RegExp>\bEmgmt: ([a-zA-Z0-9._-]+)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="EmgmtIP" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="var/log/platinfo" XPath="/Root/text()"/>
			<RegExp>\bDomain: ([a-zA-Z0-9._-]+)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Domain" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula OmitPrintingMetConditions="true" TopPositionResult="true" Categories="configuration;network">
		<Name>{Condition:SectionName} {Condition:Date} GatewayCluster: {Condition:ClusterName} ({Condition:ClusterID}), Domain: {Condition:DomainName}, HostName: {Condition:HostName}.</Name>
		<DisplayMessage>{Condition:StatusMsg}</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="var/log/topology-config.json" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<!-- gets latest date result of the topology config -->
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Structure" Operation="NotEqualTo" Value="" NextOperation="And">\"date\"((?![\s\S]*\"date\"+)[0-9a-zA-Z\s\:_\"\-\+\[\],.\(\){\/\\\-\=}\@!#$%^&amp;*]+)</Condition>
			<Condition FieldPosition="1" InValue="{Condition:Structure}" RegGroup="AllResult" ConditionName="Date" Operation="NotEqualTo" Value="" NextOperation="And">\:\s\"([a-zA-Z]{3}\s[a-zA-Z]{3}\s[0-9]{1,2}\s[0-9]{4}\s[0-9]{1,2}\:[0-9]{1,2}\:[0-9]{1,2}.*\s[A-Za-z0-9]+\))\"</Condition>
			<Condition FieldPosition="1" InValue="{Condition:Structure}" RegGroup="AllResult" ConditionName="GatewayClusters" Operation="NotEqualTo" Value="" NextOperation="And">(\"gatewayClusters\"\: \[\s+\{[0-9a-zA-Z\s\:_\"\-\+\[\],.\\\/\={\}\(\)]+)\"managementClusters\"</Condition>
			<Condition FieldPosition="1" InValue="{Condition:GatewayClusters}" RegGroup="AllResult" ConditionName="ClusterID" Operation="NotEqualTo" Value="" NextOperation="And">\"_id\":\s\"([a-zA-Z0-9.\-_ ]+)\"</Condition>
			<Condition FieldPosition="1" InValue="{Condition:GatewayClusters}" RegGroup="AllResult" ConditionName="ClusterName" Operation="NotEqualTo" Value="" NextOperation="And">\"name\":\s\"([a-zA-Z0-9.\-_ ]+)\"</Condition>
			<Condition FieldPosition="1" InValue="{Condition:GatewayClusters}" RegGroup="AllResult" ConditionName="HostName" Operation="NotEqualTo" Value="" NextOperation="And">\"hostname\":\s\"([a-zA-Z0-9.\-_]+)\"</Condition>
			<Condition FieldPosition="1" InValue="{Condition:GatewayClusters}" RegGroup="AllResult" ConditionName="DomainName" Operation="NotEqualTo" Value="" NextOperation="And">\"gatewayDomainName\":\s\"([a-zA-Z0-9.\-_]+)\"</Condition>
			<Condition FieldPosition="1" InValue="{Condition:GatewayClusters}" RegGroup="AllResult" ConditionName="StatusMsg" Operation="NotEqualTo" Value="">\"statusMsg\":\s\"([a-zA-Z0-9.\-_ ]+)\"</Condition>
		</Expression>
	</Formula>
	
	<Formula OmitPrintingMetConditions="true" TopPositionResult="true" Categories="configuration;network">
		<Name>{Condition:SectionName} {Condition:Date} ManagementCluster: {Condition:ClusterName} ({Condition:ClusterID}), HostName: {Condition:HostName}.</Name>
		<DisplayMessage>{Condition:StatusMsg}</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="var/log/topology-config.json" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<!-- gets latest date result of the topology config -->
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Structure" Operation="NotEqualTo" Value="" NextOperation="And">\"date\"((?![\s\S]*\"date\"+)[0-9a-zA-Z\s\:_\"\-\+\[\],.\(\){\/\\\-\=}\@!#$%^&amp;*]+)</Condition>
			<Condition FieldPosition="1" InValue="{Condition:Structure}" RegGroup="AllResult" ConditionName="Date" Operation="NotEqualTo" Value="" NextOperation="And">\:\s\"([a-zA-Z]{3}\s[a-zA-Z]{3}\s[0-9]{1,2}\s[0-9]{4}\s[0-9]{1,2}\:[0-9]{1,2}\:[0-9]{1,2}.*\s[A-Za-z0-9]+\))\"</Condition>
			<Condition FieldPosition="1" InValue="{Condition:Structure}" RegGroup="AllResult" ConditionName="ManagementClusters" Operation="NotEqualTo" Value="" NextOperation="And">(\"managementClusters\"\: \[\s+\{[0-9a-zA-Z\s\:_\"\-\+\[\],.\\\/\={\}\(\)]+)\"servers\"</Condition>
			<Condition FieldPosition="1" InValue="{Condition:ManagementClusters}" RegGroup="AllResult" ConditionName="ClusterID" Operation="NotEqualTo" Value="" NextOperation="And">\"_id\":\s\"([a-zA-Z0-9.\-_ ]+)\"</Condition>
			<Condition FieldPosition="1" InValue="{Condition:ManagementClusters}" RegGroup="AllResult" ConditionName="ClusterName" Operation="NotEqualTo" Value="" NextOperation="And">\"name\":\s\"([a-zA-Z0-9.\-_ ]+)\"</Condition>
			<Condition FieldPosition="1" InValue="{Condition:ManagementClusters}" RegGroup="AllResult" ConditionName="HostName" Operation="NotEqualTo" Value="" NextOperation="And">\"hostname\":\s\"([a-zA-Z0-9.\-_]+)\"</Condition>
			<Condition FieldPosition="1" InValue="{Condition:ManagementClusters}" RegGroup="AllResult" ConditionName="StatusMsg" Operation="NotEqualTo" Value="">\"statusMsg\":\s\"([a-zA-Z0-9.\-_ ]+)\"</Condition>
		</Expression>
	</Formula>
	
	<Formula OmitPrintingMetConditions="true" TopPositionResult="true" Categories="configuration;network">
		<Name>{Condition:SectionName} {Condition:Date} ServerName {Condition:ServerName} in Cluster: {Condition:ClusterID}, ServerType: {Condition:ServerType}, HostName/IP: {Condition:HostName} / {Condition:IPAddress}.  Device Version: {Condition:Version}.  Dissociated State: {Condition:Dissociated}</Name>
		<DisplayMessage>{Condition:Status} - {Condition:StatusMsg}</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="var/log/topology-config.json" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<!-- gets latest date result of the topology config -->
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Structure" Operation="NotEqualTo" Value="" NextOperation="And">\"date\"((?![\s\S]*\"date\"+)[0-9a-zA-Z\s\:_\"\-\+\[\],.\(\){\/\\\-\=}\@!#$%^&amp;*]+)</Condition>
			<Condition FieldPosition="1" InValue="{Condition:Structure}" RegGroup="AllResult" ConditionName="Date" Operation="NotEqualTo" Value="" NextOperation="And">\:\s\"([a-zA-Z]{3}\s[a-zA-Z]{3}\s[0-9]{1,2}\s[0-9]{4}\s[0-9]{1,2}\:[0-9]{1,2}\:[0-9]{1,2}.*\s[A-Za-z0-9]+\))\"</Condition>
			<Condition FieldPosition="1" InValue="{Condition:Structure}" RegGroup="AllResult" ConditionName="ServersStructure" Operation="NotEqualTo" Value="" NextOperation="And">(\"servers\"\: \[\s+\{[0-9a-zA-Z\s\:_\"\-\+\[\],.\\\/\={\}\(\)]+)\"dbhosts\"</Condition>
			<Condition FieldPosition="1" InValue="{Condition:ServersStructure}" RegGroup="AllResult" ConditionName="ServerName" Operation="NotEqualTo" Value="" NextOperation="And">\"name\":\s\"([a-zA-Z0-9.\-_ ]+)\"\,\W+\"type\":\s\"([a-zA-Z0-9.\-_]+)\"</Condition>
			<Condition FieldPosition="2" InValue="{Condition:ServersStructure}" RegGroup="AllResult" ConditionName="ServerType" Operation="NotEqualTo" Value="" NextOperation="And">\"name\":\s\"([a-zA-Z0-9.\-_ ]+)\"\,\W+\"type\":\s\"([a-zA-Z0-9.\-_]+)\"</Condition>
			<Condition FieldPosition="1" InValue="{Condition:ServersStructure}" RegGroup="AllResult" ConditionName="IPAddress" Operation="NotEqualTo" Value="" NextOperation="And">\"ipAddress\":\s\"([a-zA-Z0-9.\-_]+)\"</Condition>
			<Condition FieldPosition="1" InValue="{Condition:ServersStructure}" RegGroup="AllResult" ConditionName="HostName" Operation="NotEqualTo" Value="" NextOperation="And">\"hostname\":\s\"([a-zA-Z0-9.\-_]+)\"</Condition>
			<Condition FieldPosition="1" InValue="{Condition:ServersStructure}" RegGroup="AllResult" ConditionName="ClusterID" Operation="NotEqualTo" Value="" NextOperation="And">\"clusters\":\s\[\W+\"([a-zA-Z0-9.\-_ \:\/]+)\"</Condition>
			<Condition FieldPosition="1" InValue="{Condition:ServersStructure}" RegGroup="AllResult" ConditionName="Version" Operation="NotEqualTo" Value="" NextOperation="And">\"version\":\s\"([a-zA-Z0-9.\-_ \:\/]+)\"</Condition>
			<Condition FieldPosition="1" InValue="{Condition:ServersStructure}" RegGroup="AllResult" ConditionName="Status" Operation="NotEqualTo" Value="" NextOperation="And">\"status\":\s\"([a-zA-Z0-9.\-_]+)\"</Condition>
			<Condition FieldPosition="1" InValue="{Condition:ServersStructure}" RegGroup="AllResult" ConditionName="Dissociated" Operation="NotEqualTo" Value="" NextOperation="And">\"dissociated\":\s(false|true)</Condition>
			<Condition FieldPosition="1" InValue="{Condition:ServersStructure}" RegGroup="AllResult" ConditionName="StatusMsg" Operation="NotEqualTo" Value="">\"statusMsg\":\s\"([a-zA-Z0-9.\-_ ]+)\"</Condition>
		</Expression>
	</Formula>
	
	<Formula Categories="failure" SortCondition="Timestamp" SortMethod="Descending" SortOption="yyyy-MM-dd HH:mm:ss.SSS">
		<Name>SEVERE Notification in {Condition:SectionName} on {Condition:ObjectInfo} at {Condition:Timestamp}</Name>
		<DisplayMessage>{Condition:ErrorMessage}</DisplayMessage>
		<Expression LogLevel="Warning">
			<Section Name="cmc.out" Wildcard="True" XPath="/Root/text()"/>
			<!-- increased T-xxxx limit since there were values going over 6 character limits -->
			<RegExp>\b([0-9]{4}-[0-9]{2}-[0-9]{2} [0-9:.]+) SEVERE \[[TP]-[0-9]{1,20}\] \[([a-zA-Z0-9._$-]+)\] (.*)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ObjectInfo" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ErrorMessage" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
		<Formula Categories="failure" SortCondition="Timestamp" SortMethod="Descending" SortOption="yyyy-MM-dd HH:mm:ss,SSS">
		<Name>{Condition:SectionName}</Name>
		<DisplayMessage>{Condition:LineData}</DisplayMessage>
		<Expression LogLevel="Warning">
			<Section Name="elasticsearch.log" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\[([0-9]{4}-[0-9]{2}-[0-9]{2}[T ][0-9Z:.,]+)\]\[WARN ]\[.*\] \[.*\] timed out .*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" RegGroup="All" ConditionName="LineData" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
		<Formula Categories="network" SortCondition="Timestamp" SortMethod="Descending" SortOption="yyyy-MM-dd HH:mm:ss.SSS">
		<Name>Interface Issue {Condition:Interface} at {Condition:Timestamp}</Name>
		<DisplayMessage>Interface error: {Condition:ErrorMessage}.</DisplayMessage>
		<Expression LogLevel="Warning">
			<Section Name="router.log" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\b([0-9-]+ [0-9:.]+) \(none\): \[[a-fxA-FX0-9]+\] ERROR hostnet Could not set L3 information for ([a-zA-Z0-9_-]+): (.*)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="Interface" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ErrorMessage" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
		<Formula Categories="failure" SortCondition="Timestamp" SortMethod="Descending" SortOption="yyyy-MM-dd HH:mm:ss">
		<Name>ERROR Notification in {Condition:SectionName} on {Condition:ObjectInfo} at {Condition:Timestamp}</Name>
		<DisplayMessage>{Condition:ErrorMessage}</DisplayMessage>
		<Expression LogLevel="Warning">
			<Section Name="jsonListener.log" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\b([0-9]{4}-[0-9]{2}-[0-9]{2} [0-9:.]+) \[([a-zA-Z0-9._$-]+)\] ERROR (.*)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ObjectInfo" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ErrorMessage" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="failure;configuration;network" SortCondition="Timestamp" SortMethod="Descending" SortOption="yyyy-MM-dd HH:mm:ss">
		<Name>{Condition:SectionName} {Condition:Timestamp} No DP Appliance to update peers, gateway is not in sync.</Name>
		<DisplayMessage>API Management and DataPower Gateway is not in sync.</DisplayMessage>
		<Expression LogLevel="Error">
			<Section Name="cmc.out" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\b([0-9-]+ [0-9:.]+) INFO \[T-[0-9]+\] \[com.ibm.apimgmt.gateway.DatapowerConfigurationHelper.updatePeersForAllAppliances\] No DP appliance to update peers for\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="failure;configuration" SortCondition="Timestamp" SortMethod="Descending" SortOption="MM/dd/yy HH:mm:ss">
		<Name>{Condition:SectionName} Fatal Error in Informix Database.</Name>
		<DisplayMessage>{Condition:Timestamp} - {Condition:Message}</DisplayMessage>
		<Expression LogLevel="Critical">
			<Section Name="var/log/informix/online.log" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>([0-9-]{1,2}/[0-9-]{1,2}/[0-9-]{1,2} [0-9-]{1,2}:[0-9-]{1,2}:[0-9-]{1,2})\s+(Fatal error.*)</RegExp>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="Message" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="failure" SortCondition="Timestamp" SortMethod="Descending" SortOption="MM/dd/yy HH:mm:ss">
		<Name>{Condition:SectionName} Informix DB Stopped.</Name>
		<DisplayMessage>{Condition:Timestamp} - {Condition:Message}</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="var/log/informix/online.log" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>([0-9-]{1,2}/[0-9-]{1,2}/[0-9-]{1,2} [0-9-]{1,2}:[0-9-]{1,2}:[0-9-]{1,2})\s+(IBM Informix Dynamic Server Stopped.)</RegExp>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="Message" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!--<Formula Categories="memory" SortCondition="Timestamp" SortMethod="descending" SortOption="EEE MMM dd HH:mm:ss yyyy">
		<Name>{Condition:Timestamp} there is {Condition:MemFree} kB memory free.</Name>
		<DisplayMessage>{Condition:SectionName}</DisplayMessage>
		<Expression LogLevel="Warning">
			<Section Name="router.stat" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\bENTER MEMINFO ([a-zA-Z-_0-9: ]+).*\W+(\w+\W+)*?(MemFree:\s+([0-9]+) kB)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="MemFree" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>-->
	
	
	<!-- new formulas -->
	
	<Formula Categories="failure" SortCondition="Timestamp" SortMethod="Descending" SortOption="yyyy-MM-dd HH:mm:ss.SSS">
		<Name>{Condition:SectionName} {Condition:Timestamp} Portal EnvironmentDocument Changes in catalogue {Condition:CatalogueID}.  This may push requests to webapi-internal on DataPower side, review cmc logs further (eg flushDocuments as example).</Name>
		<!-- toggling self-service option in dev portal triggers a publish -->
		<Expression LogLevel="Warning">
			<Section Name="cmc.out" Wildcard="True" XPath="/Root/text()"/>
			<!-- EnironmentDocument  is not a typo, that is how its defined in the logs -->
			<RegExp>\b([0-9]{4}-[0-9]{2}-[0-9]{2} [0-9:.]+) INFO \[[TP]-[0-9]{1,6}\] \[([a-zA-Z0-9._$-]+)\] \[PORTAL\] EnironmentDocument changes: ([0-9a-zA-Z]+)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="CatalogueID" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="failure" SortCondition="Timestamp" SortMethod="Descending" SortOption="yyyy-MM-dd HH:mm:ss.SSS">
		<Name>{Condition:SectionName} {Condition:Timestamp} {Condition:LogLevel} Flush document cache call to DataPower with string: {Condition:URL}.</Name>
		<URL description="IT20387 (Fixed in 7.5.2.4, upgrade past fix if timing of flushes coincides with slow transactions on DataPower): FREQUENT DOCUMENT CACHE FLUSHING VIA WEBGUI OR SOMA CAN CAUSE A RESTART UNDER HEAVY LOAD: ">http://www.ibm.com/support/docview.wss?uid=swg1IT20387</URL>
		<Expression LogLevel="Critical">
			<Section Name="cmc.out" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\b([0-9]{4}-[0-9]{2}-[0-9]{2} [0-9:.]+) (SEVERE) \[[TP]-[0-9]{1,6}\] \[([a-zA-Z0-9._$-]+)\] flush: \[flushDocuments\] (.*)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="LogLevel" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="URL" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="cmc.out" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\b([0-9]{4}-[0-9]{2}-[0-9]{2} [0-9:.]+) (INFO) \[[TP]-[0-9]{1,6}\] \[([a-zA-Z0-9._$-]+)\] flush: \[flushDocuments\] (.*)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="LogLevel" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="URL" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;failure">
		<Name>{Condition:SectionName} {Condition:Timestamp} version of module is incorrect for {Condition:ModuleName}, error message: {Condition:Error}.  Open a ticket with API Connect L2 Support.</Name>
		<Expression LogLevel="Error">
			<Section Name="site_action.log" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>([0-9]{4}\-[0-9]{2}\-[0-9]{2}\s[0-9]{2}\:[0-9]{2}\:[0-9]{2})\: The version of the ([a-zA-Z-_.0-9]+) module found on this platform\W+(\w+\W+).*(has a lower Schema version than the one the site has installed)</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ModuleName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="Error" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration" SortCondition="Timestamp" SortMethod="Descending">
		<Name>{Condition:SectionName} Upgrade/CLI commands</Name>
		<DisplayMessage>{Condition:SectionName} {Condition:Timestamp}||{Condition:UpgradeMsg}</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="messages" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\b([0-9-]+ [0-9:.]+) [0-9a-zA-Z_\.\-]+\: cnlog\[[0-9]+\]\: \[[0-9a-fA-Fx]+\] INFO (upgrade|cli) (.*)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="UpgradeMsg" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" ExpressionGroup="ResetSearch">
			<Section Name="var/log/informix/online.log" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>([0-9]{1,2}\/[0-9]{1,2}\/[0-9]{1,2} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,2})\s\s(Conversion from version [a-zA-Z0-9.]+ Started|\(5\) connection rejected - no calls allowed for sqlexec|Cannot convert server.(.*)|The Master Daemon Died|oninit\:(.*))</RegExp>
			<Condition FieldPosition="1" RegGroup="AllResult" ConditionName="TempTimestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="AllResult" InValue="{Condition:TempTimestamp}" ConditionName="Month" Operation="NotEqualTo" Value="" NextOperation="And">\b([0-9]{1,2})\/([0-9]{1,2})\/([0-9]{1,2}) ([0-9]{1,2}:[0-9]{1,2}:[0-9]{1,2})\b</Condition>		
			<Condition FieldPosition="2" RegGroup="AllResult" InValue="{Condition:TempTimestamp}" ConditionName="Day" Operation="NotEqualTo" Value="" NextOperation="And">\b([0-9]{1,2})\/([0-9]{1,2})\/([0-9]{1,2}) ([0-9]{1,2}:[0-9]{1,2}:[0-9]{1,2})\b</Condition>		
			<Condition FieldPosition="3" RegGroup="AllResult" InValue="{Condition:TempTimestamp}" ConditionName="Year" Operation="NotEqualTo" Value="" NextOperation="And">\b([0-9]{1,2})\/([0-9]{1,2})\/([0-9]{1,2}) ([0-9]{1,2}:[0-9]{1,2}:[0-9]{1,2})\b</Condition>		
			<Condition FieldPosition="4" RegGroup="AllResult" InValue="{Condition:TempTimestamp}" ConditionName="Time" Operation="NotEqualTo" Value="" NextOperation="And">\b([0-9]{1,2})\/([0-9]{1,2})\/([0-9]{1,2}) ([0-9]{1,2}:[0-9]{1,2}:[0-9]{1,2})\b</Condition>		
			<Condition FieldPosition="-2" RegGroup="AllResult" InValue="20{Condition:Year}-{Condition:Month}-{Condition:Day} {Condition:Time}" ConditionName="Timestamp" Operation="Append" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="AllResult" ConditionName="UpgradeMsg" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
</Analytics>