<Analytics version="DataPower_1.9.7" date="Jul 08 2016 1:00PM EST">
	<!-- establish firmware version for any intentional matches on major firmware level -->
	<Formula CollapseResult="true" FormulaID="V500FirmwareCheck">
		<Expression LogLevel="Warning">
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="5" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="0"/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" FormulaID="V600FirmwareCheck">
		<Expression LogLevel="Warning">
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="0"/>
		</Expression>
	</Formula>

	<Formula CollapseResult="true" FormulaID="V601FirmwareCheck">
		<Expression LogLevel="Warning">
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="1"/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" FormulaID="V700FirmwareCheck">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0"/>
			</Expression>
	</Formula>
	
	<Formula CollapseResult="true" FormulaID="V710FirmwareCheck">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="1"/>
			</Expression>
	</Formula>
	
	<Formula CollapseResult="true" FormulaID="V720FirmwareCheck">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="2"/>
			</Expression>
	</Formula>
	
	<Formula CollapseResult="true" FormulaID="V750FirmwareCheckOrGreater">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="GreaterThan" Value="6" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="GreaterThan" Value="4"/>
			</Expression>
	</Formula>
	
	<!-- check for 7.2.0 or later -->
	<Formula CollapseResult="true" FormulaID="V720FirmwareCheckOrGreater">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="GreaterThan" Value="1"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="GreaterThan" Value="7"/>
			</Expression>
	</Formula>
	
	<!-- check for 7.1.0 or earlier (before all object attributes were added) -->
	<Formula CollapseResult="true" FormulaID="V710FirmwareCheckOrLower">
			<Expression LogLevel="Warning">
			 <!-- we check for both status providers because we need to match at least one status provider to check -->
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="2"/>
			</Expression>
			<Expression LogLevel="Warning">
			 <!-- we check for both status providers because we need to match at least one status provider to check -->
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="LessThan" Value="7"/>
			</Expression>
	</Formula>
	
	<!-- status checks -->
	<Formula CollapseResult="true" OmitPrintingMetConditions="true" TopPositionResult="true" Categories="general">
		<Name>DateTimeStatus, CurrentTime: {Condition:Time} {Condition:TimeZone}, Uptime: {Condition:Uptime} (reload), BootUptime: {Condition:BootUptime}</Name>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="DateTimeStatus" XPath="/Status/DateTimeStatus//time"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="Time" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="DateTimeStatus" XPath="/Status/DateTimeStatus//uptime"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="Uptime" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="DateTimeStatus" XPath="/Status/DateTimeStatus//bootuptime"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="BootUptime" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="DateTimeStatus" XPath="/Status/DateTimeStatus//timezone"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="TimeZone" Operation="NotEqualTo" Value=""/>
		</Expression>
		<!-- start of 6.0 datetimestatus2 -->
		<Expression LogLevel="Info" NextOperation="And" ExpressionGroup="DateTimeStatus2">
			<Section Name="DateTimeStatus" XPath="/Status/DateTimeStatus//time"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="Time" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And" ExpressionGroup="DateTimeStatus2">
			<Section Name="DateTimeStatus" XPath="/Status/DateTimeStatus//uptime2"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="Uptime" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And" ExpressionGroup="DateTimeStatus2">
			<Section Name="DateTimeStatus" XPath="/Status/DateTimeStatus//bootuptime2"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="BootUptime" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" ExpressionGroup="DateTimeStatus2">
			<Section Name="DateTimeStatus" XPath="/Status/DateTimeStatus//timezone"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="TimeZone" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
		
		<Formula CollapseResult="true" OmitPrintingMetConditions="true" TopPositionResult="true" Categories="general">
		<Name>System name is &lt;font color='#006666'&gt;{Condition:SysName}&lt;/font&gt;.</Name>
		<Expression LogLevel="Info">
			<Section Name="default-config" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\bsystem\W+(\w+\W+)*?(name \"([a-zA-Z0-9.\-_]+)|exit)\b</RegExp>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="SysName" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>

	<Formula CollapseResult="true" OmitPrintingMetConditions="true" TopPositionResult="true" Categories="general">
		<Name>Firmware Version: &lt;font color='red'&gt;{Condition:FirmwareVersion}&lt;/font&gt;, Serial Number: &lt;font color='#009900'&gt;{Condition:SerialNumber}&lt;/font&gt;, Build Number: {Condition:Build}, Build Date: {Condition:BuildDate}, MachineType: {Condition:MachineType}</Name>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="LessThan" Value="6"/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="FirmwareVersion" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Serial"/>
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Serial"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="SerialNumber" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Build"/>
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Build"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="Build" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//BuildDate"/>
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//BuildDate"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="BuildDate" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//MachineType"/>
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//MachineType"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MachineType" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" OmitPrintingMetConditions="true" TopPositionResult="true" Categories="general">
		<Name>Firmware Version: &lt;font color='#009900'&gt;{Condition:FirmwareVersion}&lt;/font&gt;, Serial Number: &lt;font color='#009900'&gt;{Condition:SerialNumber}&lt;/font&gt;, Build Number: {Condition:Build}, Build Date: {Condition:BuildDate}, MachineType: {Condition:MachineType}</Name>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="GreaterThan" Value="5"/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="FirmwareVersion" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Serial"/>
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Serial"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="SerialNumber" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Build"/>
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Build"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="Build" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//BuildDate"/>
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//BuildDate"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="BuildDate" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//MachineType"/>
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//MachineType"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MachineType" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<!-- Out of Service/Ending of Service Markers -->
	<Formula Categories="general">
		<Name>Firmware Version Reached End of Service</Name>
		<DisplayMessage>Customer is running Out of Date Firmware Version &lt;font color='red'&gt;{/Status/FirmwareVersion//Version}&lt;/font&gt; - Out of Support!!</DisplayMessage>
		<URL description="Firmware Support Lifecycle Document: ">http://www.ibm.com/support/docview.wss?uid=swg21246298</URL>
		<Expression LogLevel="Critical">
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/> <!-- v6.0.1 and earlier -->
			<Condition FieldPosition="4" Operation="LessThan" Value="2"/> <!-- v6.0.1 and earlier -->
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="LessThan" Value="6"/> <!-- v5.0.0 and earlier -->
		</Expression>
	</Formula>
	
	<!-- <Formula Categories="general">
		<Name>Firmware Version Nearing End of Service</Name>
		<DisplayMessage>Customer is running firmware nearing end of service &lt;font color='red'&gt;{/Status/FirmwareVersion//Version}&lt;/font&gt; - End of Service ????</DisplayMessage>
		<URL description="Firmware Support Lifecycle Document: ">http://www.ibm.com/support/docview.wss?uid=swg21246298</URL>
		<Expression LogLevel="Critical">
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="?" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="LessThan" Value="?"/>
		</Expression>
	</Formula> -->
	<!-- End of Out of Service/Ending Service Markers -->
		
	<!-- failsafe due to wrong platform/os -->
		<Formula Categories="configuration;failure">
		<Name>{Condition:Timestamp} {Condition:SectionName} The platform (&lt;font color='red'&gt;{Condition:Platform}&lt;/font&gt;) or OS (&lt;font color='red'&gt;{Condition:OSDistro}&lt;/font&gt;) is not supported.</Name>
		<URL description="Deploying the Debian package on Softlayer, Amazon EC2 and Microsoft Azure: ">http://www-01.ibm.com/support/knowledgecenter/SS9H2Y_7.2.0/com.ibm.dp.doc/virtual_deployingcloud.html</URL>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="default-log" Wildcard="True" XPath="/Root/text()" ReadNextSection="True"/>
			<Section Name="DefaultLogBeforeReload" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>The platform or the OS distribution is not supported</IndexSearch>
			<RegExp>([0-9TZ.]+) \[0x804001ba\]\[cli\]\[error\] : tid\(([0-9]*)\): The platform or the OS distribution is not supported</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="VirtualPlatform" XPath="/Status/VirtualPlatform/Platform"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="Platform" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="VirtualPlatform" XPath="/Status/VirtualPlatform/OSDistro"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="OSDistro" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- end of info for failsafe wrong platform/os -->
	
	<Formula CollapseResult="true" OmitPrintingMetConditions="true" TopPositionResult="true" Categories="general;cpuload" FormulaID="CPUUsage">
		<Name>CPU Usage - 10s: {Condition:CPUTenSeconds}%, 1m: {Condition:CPUOneMinute}%, 10m: {Condition:CPUTenMinutes}%, 1hr: {Condition:CPUOneHour}%, 1day: {Condition:CPUOneDay}%</Name>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="CPUUsage" XPath="/Status/CPUUsage/tenSeconds"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="CPUTenSeconds" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="CPUUsage" XPath="/Status/CPUUsage/oneMinute"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="CPUOneMinute" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="CPUUsage" XPath="/Status/CPUUsage/tenMinutes"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="CPUTenMinutes" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="CPUUsage" XPath="/Status/CPUUsage/oneHour"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="CPUOneHour" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="CPUUsage" XPath="/Status/CPUUsage/oneDay"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="CPUOneDay" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" OmitPrintingMetConditions="true" TopPositionResult="true" Categories="general;cpuload" FormulaID="LoadUsage">
		<Name>Load Usage - {Condition:Load}%, WorkList: {Condition:WorkList}</Name>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="SystemUsage" XPath="/Status/SystemUsage/Load"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="Load" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="SystemUsage" XPath="/Status/SystemUsage/WorkList"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="WorkList" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula OmitPrintingMetConditions="true" TopPositionResult="true" Categories="general">
	<Name>[BLADE DEVICE 4195]</Name>
			<Expression LogLevel="Info">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//MachineType"/>
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//MachineType"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MachineType" Operation="EqualsTo" Value="4195"/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" OmitPrintingMetConditions="true" TopPositionResult="true" Categories="general;memory" FormulaID="MemoryUsage">
		<Name>MemoryStatus: Used/Total Memory {Condition:UsedMemory}/{Condition:TotalMemory} kB&lt;br/&gt;Free Memory: {Condition:FreeMemory} kB, Requested Memory: {Condition:ReqMemory} kB, Hold Memory: {Condition:HoldMemory} kB, Reserved Memory: {Condition:ReservedMemory} kB, Installed Memory: {Condition:InstalledMemory} kB.</Name>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="MemoryStatus" XPath="/Status/MemoryStatus/TotalMemory"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="TotalMemory" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="MemoryStatus" XPath="/Status/MemoryStatus/UsedMemory"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="UsedMemory" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="MemoryStatus" XPath="/Status/MemoryStatus/FreeMemory"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="FreeMemory" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="MemoryStatus" XPath="/Status/MemoryStatus/ReqMemory"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="ReqMemory" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="MemoryStatus" XPath="/Status/MemoryStatus/HoldMemory"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="HoldMemory" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="MemoryStatus" XPath="/Status/MemoryStatus/ReservedMemory"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="ReservedMemory" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="MemoryStatus" XPath="/Status/MemoryStatus/InstalledMemory"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="InstalledMemory" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" OmitPrintingMetConditions="true" TopPositionResult="true" Categories="general;memory" FormulaID="FileSystemUsage">
		<Name>FilesystemStatus(Free/Total): Encrypted {Condition:FreeEncrypted}MB/{Condition:TotalEncrypted}MB, Temporary {Condition:FreeTemporary}MB/{Condition:TotalTemporary}MB, Internal {Condition:FreeInternal}MB/{Condition:TotalInternal}MB.</Name>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="FilesystemStatus" XPath="/Status/FilesystemStatus/FreeEncrypted"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="FreeEncrypted" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="FilesystemStatus" XPath="/Status/FilesystemStatus/TotalEncrypted"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="TotalEncrypted" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="FilesystemStatus" XPath="/Status/FilesystemStatus/FreeTemporary"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="FreeTemporary" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="FilesystemStatus" XPath="/Status/FilesystemStatus/TotalTemporary"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="TotalTemporary" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="FilesystemStatus" XPath="/Status/FilesystemStatus/FreeInternal"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="FreeInternal" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="FilesystemStatus" XPath="/Status/FilesystemStatus/TotalInternal"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="TotalInternal" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- end status checks -->
	
	
	
	<!-- basic device info cascaded -->
	<Formula CollapseResult="true" OmitPrintingMetConditions="true" TopPositionResult="true" Categories="general">
		<Name>Library Info: &lt;font color='#009933'&gt;{Condition:LibName}&lt;/font&gt;, Version: &lt;font color='#009933'&gt;{Condition:LibVer}&lt;/font&gt;</Name>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="LibraryVersion" XPath="/Status/LibraryVersion//Library"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="LibName" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="LibraryVersion" XPath="/Status/LibraryVersion//Version"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="LibVer" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" OmitPrintingMetConditions="true" TopPositionResult="true" Categories="general">
		<Name>License Info: &lt;font color='#009933'&gt;{Condition:FeatureName}&lt;/font&gt;, Enabled: {Condition:LicenseEnabled}, Available: {Condition:LicenseAvailable}</Name>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="LicenseStatus" XPath="/Status/LicenseStatus//Feature"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="FeatureName" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="LicenseStatus" XPath="/Status/LicenseStatus//Enabled"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="LicenseEnabled" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="LicenseStatus" XPath="/Status/LicenseStatus//Available"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="LicenseAvailable" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<!-- end of basic info cascaded -->
	
	<!-- search for bad build 248248 6.0.0.8, 248247 5.0.0.16, 248249 6.0.1.4 -->
	<Formula OmitPrintingMetConditions="true" Categories="general">
			<Name>APAR IT03781 Customer Firmware Version Affected: {Condition:FirmwareVersion}, Build: {Condition:Build}</Name>
			<DisplayMessage>Objects with a period will have issues showing up in the WebGUI, firmware affected: 6.0.1.4 build 248249.  New builds are available on FixCentral to replace these affected.</DisplayMessage>		
			<URL description="APAR IT03781: ">http://www.ibm.com/support/docview.wss?uid=swg1IT03781</URL>
			<Expression LogLevel="Critical" NextOperation="And">
				<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>*</RegExp>
				<Condition FieldPosition="0" ConditionName="FirmwareVersion" Operation="NotEqualTo" Value=""/>
			</Expression>
			<!-- search for bad build 248248 6.0.0.8, 248247 5.0.0.16, 248249 6.0.1.4 -->
			<Expression LogLevel="Critical" NextOperation="And">
				<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="EqualsTo" Value="4"/>
			</Expression>
			<Expression LogLevel="Critical">
				<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Build"/>
				<RegExp>*</RegExp>
				<Condition FieldPosition="0" ConditionName="Build" Operation="EqualsTo" Value="248249"/>
			</Expression>
	</Formula>
	<Formula OmitPrintingMetConditions="true" Categories="general">
			<Name>APAR IT03781 Customer Firmware Version Affected: {Condition:FirmwareVersion}, Build: {Condition:Build}</Name>
			<DisplayMessage>Objects with a period will have issues showing up in the WebGUI, firmware affected: 5.0.0.16 build 248247.  New builds are available on FixCentral to replace these affected.</DisplayMessage>		
			<URL description="APAR IT03781: ">http://www.ibm.com/support/docview.wss?uid=swg1IT03781</URL>
			<Expression LogLevel="Info" NextOperation="And">
				<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>*</RegExp>
				<Condition FieldPosition="0" ConditionName="FirmwareVersion" Operation="NotEqualTo" Value=""/>
			</Expression>
			<!-- search for bad build 248248 6.0.0.8, 248247 5.0.0.16, 248249 6.0.1.4 -->
			<Expression LogLevel="Critical" NextOperation="And">
				<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="5" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="EqualsTo" Value="16"/>
			</Expression>
			<Expression LogLevel="Critical">
				<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Build"/>
				<RegExp>*</RegExp>
				<Condition FieldPosition="0" ConditionName="Build" Operation="EqualsTo" Value="248247"/>
			</Expression>
	</Formula>
	<Formula OmitPrintingMetConditions="true" Categories="general">
			<Name>APAR IT03781 Customer Firmware Version Affected: {Condition:FirmwareVersion}, Build: {Condition:Build}</Name>
			<DisplayMessage>Objects with a period will have issues showing up in the WebGUI, firmware affected: 6.0.0.8 build 248248.  New builds are available on FixCentral to replace these affected.</DisplayMessage>		
			<URL description="APAR IT03781: ">http://www.ibm.com/support/docview.wss?uid=swg1IT03781</URL>
			<Expression LogLevel="Info" NextOperation="And">
				<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>*</RegExp>
				<Condition FieldPosition="0" ConditionName="FirmwareVersion" Operation="NotEqualTo" Value=""/>
			</Expression>
			<!-- search for bad build 248248 6.0.0.8, 248247 5.0.0.16, 248249 6.0.1.4 -->
			<Expression LogLevel="Critical" NextOperation="And">
				<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="EqualsTo" Value="8"/>
			</Expression>
			<Expression LogLevel="Critical">
				<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Build"/>
				<RegExp>*</RegExp>
				<Condition FieldPosition="0" ConditionName="Build" Operation="EqualsTo" Value="248248"/>
			</Expression>
	</Formula>
	<!-- end of search for bad build -->
	
	<!-- search for throttler -->
	<Formula Categories="failure;memory"  SortCondition="Timestamp" SortMethod="descending">
		<Name>Throttler forced box reload at {Condition:Timestamp}, reason: {Condition:Reason}</Name>
		<Expression LogLevel="Critical">
			<Section Name="AuditLog" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>Throttler forced</IndexSearch>
			<RegExp>([0-9TZ.]+).*Throttler forced[a ]+system reload( due to (.*)|. Reason : ([a-zA-Z0-9 ]*))</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="Reason" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="AuditLog" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>Throttler forced</IndexSearch>
			<RegExp>([0-9TZ.]+).*Throttler forced[a ]+system reload( due to (.*)|. Reason : ([a-zA-Z0-9 ]*))</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="Reason" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- end of throttler search -->
	
	
	<!-- ISAM restart in progress IT08507 -->
	<Formula Categories="configuration;failure">
		<Name>{Condition:Timestamp} ISAM Runtime is not working correctly in domain {Condition:Domain}.</Name>
		<URL description="IT08507: IBM SECURITY ACCESS MANAGER RUNTIME OBJECT IS VISIBLE ALTHOUGH ISAM PROXY MODULE IS NOT LICENSED ON THE APPLIANCE (Fix in 7.1.0.5): ">http://www.ibm.com/support/docview.wss?uid=swg1IT08507</URL>		
		<Expression LogLevel="Error" NextOperation="And">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="1" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="5"/>
		</Expression>
		<Expression LogLevel="Error">
			<Section Name="default-log" Wildcard="True" XPath="/Root/text()" ReadNextSection="True"/>
			<Section Name="DefaultLogBeforeReload" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>The Access Manager Runtime feature was not found on this system</IndexSearch>
			<RegExp>([0-9TZ.]+) \[([a-zA-Z0-9_.\-]+)\]\[[a-zA-Z0-9_.\-]+\]\[isamproxy\]\[error\] isam-runtime\([a-zA-Z0-9_.\-]+\): tid\(([0-9]*)\): The Access Manager Runtime feature was not found on this system</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="Domain" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- end ISAM restart in proress IT08507 -->
	
	<!-- throttler catches cpu issues -->
		<Formula Categories="failure;general;cpuload"  SortCondition="Timestamp" SortMethod="descending">
		<Name>[CPU] Throttler notes at {Condition:Timestamp}, reason: {Condition:Reason}.</Name>
		<URL FormulaIDMatch="V600FirmwareCheck" description="System Requirements v6.0.0: ">http://pic.dhe.ibm.com/infocenter/wsdatap/v6r0m0/index.jsp?topic=%2Fcom.ibm.dp.xg.doc%2Fvirtual_systemrequirements.html</URL>
		<URL FormulaIDMatch="V601FirmwareCheck" description="System Requirements v6.0.1: ">http://pic.dhe.ibm.com/infocenter/wsdatap/v6r0m1/index.jsp?topic=%2Fcom.ibm.dp.xg.doc%2Fvirtual_systemrequirements.html</URL>
		<URL FormulaIDMatch="V700FirmwareCheck" description="System Requirements v7.0.0: ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_7.0.0/com.ibm.dp.xi.doc/virtual_systemrequirements.html</URL>
		<URL FormulaIDMatch="V710FirmwareCheck" description="System Requirements v7.1.0: ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_7.1.0/com.ibm.dp.doc/virtual_systemrequirements.html</URL>
		<URL FormulaIDMatch="V720FirmwareCheckOrGreater" description="System Requirements v7.1.0: ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_7.1.0/com.ibm.dp.doc/virtual_systemrequirements.html</URL>
		<Expression LogLevel="Critical">
			<Section Name="default-log" Wildcard="True" XPath="/Root/text()" ReadNextSection="True"/>
			<Section Name="DefaultLogBeforeReload" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".log" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>CPUs missing, expected</IndexSearch>
			<RegExp>([0-9TZ.]+) [a-zA-Z0-9_.\-\[\] ]* ([a-zA-Z]*)\(([a-zA-Z0-9.\- ]*)\): tid\(([0-9]*)\)[a-zA-Z0-9_.\-\[\]. ]*: (CPUs missing, expected [0-9]+, have [0-9]+)\.</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="5" RegGroup="All" ConditionName="Reason" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="failure;general;cpuload">
		<Name>Device reports {Condition:CPUs} virtual CPU's available, a minimum of 4 virtual CPU's is recommended.</Name>
		<URL FormulaIDMatch="V600FirmwareCheck" description="System Requirements v6.0.0: ">http://pic.dhe.ibm.com/infocenter/wsdatap/v6r0m0/index.jsp?topic=%2Fcom.ibm.dp.xg.doc%2Fvirtual_systemrequirements.html</URL>
		<URL FormulaIDMatch="V601FirmwareCheck" description="System Requirements v6.0.1: ">http://pic.dhe.ibm.com/infocenter/wsdatap/v6r0m1/index.jsp?topic=%2Fcom.ibm.dp.xg.doc%2Fvirtual_systemrequirements.html</URL>
		<URL FormulaIDMatch="V700FirmwareCheck" description="System Requirements v7.0.0: ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_7.0.0/com.ibm.dp.xi.doc/virtual_systemrequirements.html</URL>
		<URL FormulaIDMatch="V710FirmwareCheck" description="System Requirements v7.1.0: ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_7.1.0/com.ibm.dp.doc/virtual_systemrequirements.html</URL>
		<URL FormulaIDMatch="V720FirmwareCheckOrGreater" description="System Requirements v7.1.0: ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_7.1.0/com.ibm.dp.doc/virtual_systemrequirements.html</URL>
		<Expression LogLevel="Critical">
			<Section Name="Hypervisor" XPath="/Status/Hypervisor/VirtualCPUs"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="CPUs" Operation="LessThan" Value="4"/>
			</Expression>
	</Formula>
	<!-- throttler notes cpu's missing -->
	
	<!-- gateway check -->
	<Formula Categories="configuration;failure;network">
		<Name>{Condition:InterfaceName} has a ip default-gateway {Condition:Gateway}</Name>
		<URL description="Best practice for configuring default gateway on WebSphere DataPower device: ">http://www.ibm.com/support/docview.wss?uid=swg21320815</URL>
		<URL description="(DWAnswers) Best practice for configuring default gateway on WebSphere DataPower device: ">https://developer.ibm.com/answers/questions/27222/what-is-best-practice-for-configuring-default-gateway-on-websphere-datapower-device.html</URL>
		<Expression LogLevel="Error" NextOperation="And">
			<Section Name="default-config" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>ip default-gateway ([0-9.]+)</RegExp>
			<Condition FieldPosition="1" RegGroup="Count" ConditionName="Count" Operation="GreaterThan" Value="1"/>
		</Expression>
		<Expression LogLevel="Error">
			<Section Name="default-config" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>(interface \"([a-zA-Z-_.0-9]{0,40})\"|ip default-gateway ([\".0-9]{0,40})|exit)</RegExp>
			<Condition FieldPosition="2" RegGroup="Ordered" ConditionName="InterfaceName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="Ordered" ConditionName="Gateway" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- end gateway check -->
	
	<!-- Interface Markers -->
	<Formula Categories="network">
		<Name>Interface {/Status/EthernetInterfaceStatus//Name} Receive Errors</Name>
		<DisplayMessage>Total of {/Status/EthernetInterfaceStatus//RxErrors2} receive errors over interface {/Status/EthernetInterfaceStatus//Name} over IP {/Status/EthernetInterfaceStatus//IP}</DisplayMessage>
		<URL description="DataPower Network Interface Packet Errors or Drops: ">http://www.ibm.com/support/docview.wss?uid=swg21650780</URL>
		<Expression LogLevel="Critical">
			<Section Name="EthernetInterfaceStatus" XPath="/Status/EthernetInterfaceStatus//RxErrors2"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>
	<Formula Categories="network">
		<Name>Interface {/Status/EthernetInterfaceStatus//Name} Transmission Errors</Name>
		<DisplayMessage>Total of {/Status/EthernetInterfaceStatus//TxErrors2} transmission errors over interface {/Status/EthernetInterfaceStatus//Name} over IP {/Status/EthernetInterfaceStatus//IP}</DisplayMessage>
		<URL description="DataPower Network Interface Packet Errors or Drops: ">http://www.ibm.com/support/docview.wss?uid=swg21650780</URL>
		<Expression LogLevel="Critical">
			<Section Name="EthernetInterfaceStatus" XPath="/Status/EthernetInterfaceStatus//TxErrors2"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>
		<Formula Categories="network">
		<Name>Interface {/Status/EthernetInterfaceStatus//Name} Transmit Drop Errors</Name>
		<DisplayMessage>Total of {/Status/EthernetInterfaceStatus//TxDrops2} transmit drop errors over interface {/Status/EthernetInterfaceStatus//Name} over IP {/Status/EthernetInterfaceStatus//IP}</DisplayMessage>
		<URL description="DataPower Network Interface Packet Errors or Drops: ">http://www.ibm.com/support/docview.wss?uid=swg21650780</URL>
		<Expression LogLevel="Critical">
			<Section Name="EthernetInterfaceStatus" XPath="/Status/EthernetInterfaceStatus//TxDrops2"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>
		<Formula Categories="network">
		<Name>Interface {/Status/EthernetInterfaceStatus//Name} Receive Drop Errors</Name>
		<DisplayMessage>Total of {/Status/EthernetInterfaceStatus//RxDrops2} receive drop errors over interface {/Status/EthernetInterfaceStatus//Name} over IP {/Status/EthernetInterfaceStatus//IP}</DisplayMessage>
		<URL description="DataPower Network Interface Packet Errors or Drops: ">http://www.ibm.com/support/docview.wss?uid=swg21650780</URL>
		<Expression LogLevel="Critical">
			<Section Name="EthernetInterfaceStatus" XPath="/Status/EthernetInterfaceStatus//RxDrops2"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>
		<Formula Categories="network">
		<Name>Interface {/Status/EthernetInterfaceStatus//Name} Collision Errors</Name>
		<DisplayMessage>Total of {/Status/EthernetInterfaceStatus//Collisions2} Collisions over interface {/Status/EthernetInterfaceStatus//Name} over IP {/Status/EthernetInterfaceStatus//IP}</DisplayMessage>
		<URL description="DataPower Network Interface Packet Errors or Drops: ">http://www.ibm.com/support/docview.wss?uid=swg21650780</URL>
		<Expression LogLevel="Critical">
			<Section Name="EthernetInterfaceStatus" XPath="/Status/EthernetInterfaceStatus//Collisions2"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>
	
	
	<Formula Categories="network">
		<Name>Interface {/Status/NetworkInterfaceStatus//Name} Receive Errors</Name>
		<DisplayMessage>Total of {/Status/NetworkInterfaceStatus//RxErrors2} receive errors over interface {/Status/NetworkInterfaceStatus//Name} over IP {/Status/NetworkInterfaceStatus//IP}</DisplayMessage>
		<URL description="DataPower Network Interface Packet Errors or Drops: ">http://www.ibm.com/support/docview.wss?uid=swg21650780</URL>
		<Expression LogLevel="Critical">
			<Section Name="NetworkInterfaceStatus" XPath="/Status/NetworkInterfaceStatus//RxErrors2"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>
	<Formula Categories="network">
		<Name>Interface {/Status/NetworkInterfaceStatus//Name} Transmission Errors</Name>
		<DisplayMessage>Total of {/Status/NetworkInterfaceStatus//TxErrors2} transmission errors over interface {/Status/NetworkInterfaceStatus//Name} over IP {/Status/NetworkInterfaceStatus//IP}</DisplayMessage>
		<URL description="DataPower Network Interface Packet Errors or Drops: ">http://www.ibm.com/support/docview.wss?uid=swg21650780</URL>
		<Expression LogLevel="Critical">
			<Section Name="NetworkInterfaceStatus" XPath="/Status/NetworkInterfaceStatus//TxErrors2"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>
		<Formula Categories="network">
		<Name>Interface {/Status/NetworkInterfaceStatus//Name} Transmit Drop Errors</Name>
		<DisplayMessage>Total of {/Status/NetworkInterfaceStatus//TxDrops2} transmit drop errors over interface {/Status/NetworkInterfaceStatus//Name} over IP {/Status/NetworkInterfaceStatus//IP}</DisplayMessage>
		<URL description="DataPower Network Interface Packet Errors or Drops: ">http://www.ibm.com/support/docview.wss?uid=swg21650780</URL>
		<Expression LogLevel="Critical">
			<Section Name="NetworkInterfaceStatus" XPath="/Status/NetworkInterfaceStatus//TxDrops2"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>
		<Formula Categories="network">
		<Name>Interface {/Status/NetworkInterfaceStatus//Name} Receive Drop Errors</Name>
		<DisplayMessage>Total of {/Status/NetworkInterfaceStatus//RxDrops2} receive drop errors over interface {/Status/NetworkInterfaceStatus//Name} over IP {/Status/NetworkInterfaceStatus//IP}</DisplayMessage>
		<URL description="DataPower Network Interface Packet Errors or Drops: ">http://www.ibm.com/support/docview.wss?uid=swg21650780</URL>
		<Expression LogLevel="Critical">
			<Section Name="NetworkInterfaceStatus" XPath="/Status/NetworkInterfaceStatus//RxDrops2"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>
		<Formula Categories="network">
		<Name>Interface {/Status/NetworkInterfaceStatus//Name} Collision Errors</Name>
		<DisplayMessage>Total of {/Status/NetworkInterfaceStatus//Collisions2} Collisions over interface {/Status/NetworkInterfaceStatus//Name} over IP {/Status/NetworkInterfaceStatus//IP}</DisplayMessage>
		<URL description="DataPower Network Interface Packet Errors or Drops: ">http://www.ibm.com/support/docview.wss?uid=swg21650780</URL>
		<Expression LogLevel="Critical">
			<Section Name="NetworkInterfaceStatus" XPath="/Status/NetworkInterfaceStatus//Collisions2"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>
	
	
	<Formula Categories="network">
		<Name>Interface {/Status/EthernetInterfaceStatus//Name} Receive Errors</Name>
		<DisplayMessage>Total of {/Status/EthernetInterfaceStatus//RxErrors} receive errors over interface {/Status/EthernetInterfaceStatus//Name} over IP {/Status/EthernetInterfaceStatus//IP}</DisplayMessage>
		<URL description="DataPower Network Interface Packet Errors or Drops: ">http://www.ibm.com/support/docview.wss?uid=swg21650780</URL>
		<Expression LogLevel="Critical">
			<Section Name="EthernetInterfaceStatus" XPath="/Status/EthernetInterfaceStatus//RxErrors"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>
	<Formula Categories="network">
		<Name>Interface {/Status/EthernetInterfaceStatus//Name} Transmission Errors</Name>
		<DisplayMessage>Total of {/Status/EthernetInterfaceStatus//TxErrors} transmission errors over interface {/Status/EthernetInterfaceStatus//Name} over IP {/Status/EthernetInterfaceStatus//IP}</DisplayMessage>
		<URL description="DataPower Network Interface Packet Errors or Drops: ">http://www.ibm.com/support/docview.wss?uid=swg21650780</URL>
		<Expression LogLevel="Critical">
			<Section Name="EthernetInterfaceStatus" XPath="/Status/EthernetInterfaceStatus//TxErrors"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>
		<Formula Categories="network">
		<Name>Interface {/Status/EthernetInterfaceStatus//Name} Transmit Drop Errors</Name>
		<DisplayMessage>Total of {/Status/EthernetInterfaceStatus//TxDrops} transmit drop errors over interface {/Status/EthernetInterfaceStatus//Name} over IP {/Status/EthernetInterfaceStatus//IP}</DisplayMessage>
		<URL description="DataPower Network Interface Packet Errors or Drops: ">http://www.ibm.com/support/docview.wss?uid=swg21650780</URL>
		<Expression LogLevel="Critical">
			<Section Name="EthernetInterfaceStatus" XPath="/Status/EthernetInterfaceStatus//TxDrops"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>
		<Formula Categories="network">
		<Name>Interface {/Status/EthernetInterfaceStatus//Name} Receive Drop Errors</Name>
		<DisplayMessage>Total of {/Status/EthernetInterfaceStatus//RxDrops} receive drop errors over interface {/Status/EthernetInterfaceStatus//Name} over IP {/Status/EthernetInterfaceStatus//IP}</DisplayMessage>
		<URL description="DataPower Network Interface Packet Errors or Drops: ">http://www.ibm.com/support/docview.wss?uid=swg21650780</URL>
		<Expression LogLevel="Critical">
			<Section Name="EthernetInterfaceStatus" XPath="/Status/EthernetInterfaceStatus//RxDrops"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>
		<Formula Categories="network">
		<Name>Interface {/Status/EthernetInterfaceStatus//Name} Collision Errors</Name>
		<DisplayMessage>Total of {/Status/EthernetInterfaceStatus//Collisions} Collisions over interface {/Status/EthernetInterfaceStatus//Name} over IP {/Status/EthernetInterfaceStatus//IP}</DisplayMessage>
		<URL description="DataPower Network Interface Packet Errors or Drops: ">http://www.ibm.com/support/docview.wss?uid=swg21650780</URL>
		<Expression LogLevel="Critical">
			<Section Name="EthernetInterfaceStatus" XPath="/Status/EthernetInterfaceStatus//Collisions"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>
	
	<Formula Categories="network" FormulaID="HalfDuplexMatch">
		<Name>Interface {/Status/EthernetInterfaceStatus//Name} Running at Half Duplex</Name>
		<DisplayMessage>Interface Running Half Duplex - {/Status/EthernetInterfaceStatus//Name} over IP {/Status/EthernetInterfaceStatus//IP}</DisplayMessage>
		<URL description="DataPower Network Interface Packet Errors or Drops (Also Half-Duplex): ">http://www.ibm.com/support/docview.wss?uid=swg21650780</URL>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="EthernetInterfaceStatus" XPath="/Status/EthernetInterfaceStatus//Mode"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="Contains" Value="HD"/>
		</Expression>
				<Expression LogLevel="Critical">
			<Section Name="EthernetInterfaceStatus" XPath="/Status/EthernetInterfaceStatus//Status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="ok"/>
		</Expression>
	</Formula>
	
	<Formula Categories="network">
		<Name>{Condition:SectionName} Interface {Condition:InterfaceName} is unable to auto-negotiate, AutoNegRemoteSignaling={Condition:AutoNegStatus}.</Name>
		<Expression LogLevel="Critical" FormulaIDMatch="HalfDuplexMatch" NextOperation="And">
			<Section Name="EthernetMAUStatus" XPath="/Status//EthernetMAUStatus/Name"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="InterfaceName" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="EthernetMAUStatus" XPath="/Status//EthernetMAUStatus/Status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="available"/>
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="EthernetMAUStatus" XPath="/Status//EthernetMAUStatus/AutoNegRemoteSignaling"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="AutoNegStatus" Operation="NotEqualTo" Value="detected"/>
		</Expression>
	</Formula>
	
	<!-- End of Interface Markers -->
	
	<!-- misc interface concerns -->
	<Formula Categories="configuration;cpuload;network">
		<Name>{Condition:SectionName} {Condition:InterfaceName} has self-balance 'on' in self balance group {Condition:SelfBalanceGroup} with distribution algorithm set to weight least connections (wlc).</Name>
		<DisplayMessage>Prior to the 7.2 release there may be increased latency and cpu when using the WLC self-balance algorithm.  Alternatively using the round robin algorithm can workaround this problem.</DisplayMessage>
		<Expression LogLevel="Warning" FormulaIDMatch="V710FirmwareCheckOrLower">
			<Section Name="default-config" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="InterfaceName" Operation="NotEqualTo" Value="" NextOperation="And">interface \"([a-zA-Z-_.0-9]{0,40})\"\W+(\w+\W+)*?(standby \"([0-9]+)\" self-balance \"on\"|exit)</Condition>
			<Condition FieldPosition="3" RegGroup="AllResult" ConditionName="SelfBalanceGroup" Operation="NotEqualTo" Value="" NextOperation="And">interface \"{Condition:InterfaceName}\"\W+(\w+\W+)*?(standby \"([0-9]+)\" self-balance \"on\"|exit)</Condition>
			<Condition FieldPosition="2" RegGroup="AllResult" ConditionName="DistributionAlgorithm" Operation="NotEqualTo" Value="exit">interface \"{Condition:InterfaceName}\"\W+(\w+\W+)*?(standby \"{Condition:SelfBalanceGroup}\" distribution-algorithm \"wlc\"|exit)</Condition>
		</Expression>
	</Formula>
	<!-- end of misc interface concerns -->
	
	<!-- internal issue which caused device to reboot (this may happen if the box is busy or low on resources) -->
	<Formula Categories="failure">
		<Name>{Condition:Timestamp} Detected an internal issue while attempting to reload the appliance.  The appliance attempted a reboot to complete recovery.</Name>
		<DisplayMessage>The device had issues reloading at {Condition:Timestamp} and the device attempted a reboot in attempt to recover a good state.  L2 should open an investigation with L3.</DisplayMessage>
		<Expression LogLevel="Error">
			<Section Name="AuditLog" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>Detected an internal issue while attempting to reload the appliance.</IndexSearch>
			<RegExp>\b([0-9TZ.]+) [a-zA-Z0-9_.\-\[\] ]* Detected an internal issue while attempting to reload the appliance. The appliance will attempt to reboot to complete recovery\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- end of internal issue which caused device reboot -->

	<Formula Categories="memory;failure">
		<Name>Backtrace Available</Name>
		<DisplayMessage>Backtrace Available (Requires Internal Decoding)</DisplayMessage>
		<Expression LogLevel="Error">
			<Section Name="&lt;ExtendedBacktrace@datapower.ibm.com&gt;" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
		<Expression LogLevel="Error">
			<Section Name="&lt;Backtrace@datapower.ibm.com&gt;" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
		<Expression LogLevel="Error">
			<Section Name="&lt;PreviousBacktrace@datapower.ibm.com&gt;" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
	</Formula>
	
	<Formula Categories="cpuload;memory;failure">
		<Name>QPool</Name>
		<DisplayMessage>QPool (XML Names,References,URIs)</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="&lt;QPool@datapower.ibm.com&gt;" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
	</Formula>
	
	<Formula Categories="network;configuration">
		<Name>Routing Table Data</Name>
		<DisplayMessage>Routing Status XML</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="&lt;RoutingStatus2@datapower.ibm.com&gt;" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="&lt;RoutingStatus@datapower.ibm.com&gt;" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
	</Formula>
	
	<Formula Categories="network;configuration">
		<Name>Network Info</Name>
		<DisplayMessage>NetworkInfo Data</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="&lt;NetworkInfo@datapower.ibm.com&gt;" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
	</Formula>
	
	<Formula Categories="network;failure">
		<Name>Background PCAP Available</Name>
		<DisplayMessage>FFDC Background PCAP Decoded</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="&lt;BackgroundPacketCapture@datapower.ibm.com&gt;" MIME="true"/>
		</Expression>
	</Formula>
	
	<Formula Categories="network;failure">
		<Name>SysRecord Available</Name>
		<DisplayMessage>FFDC SysRecord Available (Requires Internal Decoding)</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="&lt;SysRecord@datapower.ibm.com&gt;" Base64="true" MIME="true"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="&lt;SysRecord-Backup.1@datapower.ibm.com&gt;" Base64="true" MIME="true"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="&lt;SysRecord-Backup.2@datapower.ibm.com&gt;" Base64="true" MIME="true"/>
		</Expression>
	</Formula>
	
	<Formula Categories="memory;failure">
		<Name>Memory Report Available</Name>
		<DisplayMessage>Memory Report Available (Requires Internal Decoding)</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="&lt;Memory@datapower.ibm.com&gt;" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
	</Formula>
	
	<Formula Categories="memory;failure">
		<Name>Usage Log Available</Name>
		<DisplayMessage>Usage Log Available, historical memory and qpool information</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="&lt;UsageLog@datapower.ibm.com&gt;" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="&lt;UsageLog-Backup.1@datapower.ibm.com&gt;" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="&lt;UsageLog-Backup.2@datapower.ibm.com&gt;" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
	</Formula>
	
	<Formula Categories="memory;failure">
		<Name>CLI Log Available</Name>
		<DisplayMessage>CLI Log Available, historical CLI/GUI/XML-MGMT Configuration Activity</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="&lt;CLILog@datapower.ibm.com&gt;" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="&lt;CLILog-Backup.1@datapower.ibm.com&gt;" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="&lt;CLILog-Backup.2@datapower.ibm.com&gt;" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
	</Formula>
		
	<Formula Categories="network;failure">
		<Name>DPOSDiagnostics Available</Name>
		<DisplayMessage>DPOSDiagnostics Available (Requires Internal Decoding)</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="&lt;DPOSDiagnostics@datapower.ibm.com&gt;" Base64="true" MIME="true"/>
		</Expression>
	</Formula>

	
	<!-- Hardware Engine Failures -->
	<Formula Categories="hardware">
		<Name>Hardware Reports Interface Errors ({/Hardware//diagifstats})</Name>
		<URL description="DataPower Network Interface Packet Errors or Drops: ">http://www.ibm.com/support/docview.wss?uid=swg21650780</URL>
		<Expression LogLevel="Warning">
			<Section Name="Hardware" XPath="/Hardware//diagifstats/@status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="error"/>
			</Expression>
	</Formula>
	
	<Formula Categories="hardware">
		<Name>Hardware Reports Voltage Problems ({/Hardware//diagvoltstat})</Name>
		<Expression LogLevel="Error">
			<Section Name="Hardware" XPath="/Hardware//diagvoltstat/@status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="error"/>
			</Expression>
	</Formula>
	
	<Formula Categories="hardware">
		<Name>Hardware Reports An Error with the CPU ({/Hardware//diagcpuok})</Name>
		<Expression LogLevel="Error">
			<Section Name="Hardware" XPath="/Hardware//diagcpuok/@status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="error"/>
			</Expression>
	</Formula>
	
	<Formula Categories="hardware">
		<Name>Hardware Reports An Error with the Memory ({/Hardware//diagmemorypresent})</Name>
		<Expression LogLevel="Error">
			<Section Name="Hardware" XPath="/Hardware//diagmemorypresent/@status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="error"/>
			</Expression>
	</Formula>
	
	<Formula Categories="hardware">
		<Name>Hardware Reports Power Supply has no AC Power ({/Hardware//diagaclost})</Name>
		<Expression LogLevel="Error">
			<Section Name="Hardware" XPath="/Hardware//diagaclost/@status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="error"/>
			</Expression>
	</Formula>
	
	<!-- split up missing hardware interfaces to only report url description to 7199/7198 devices -->
	<Formula Categories="hardware">
		<Name>Hardware Reports Missing Interfaces ({/Hardware//diagifnum})!</Name>
		<URL description="7199/7198 Ethernet Interfaces eth20 or eth21 missing: ">http://www.ibm.com/support/docview.wss?uid=swg21639816</URL>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="Hardware" XPath="/Hardware//diagifnum/@status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value="ok"/>
			</Expression>
		<Expression LogLevel="Critical">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//MachineType"/>
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//MachineType"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MachineType" Operation="EqualsTo" Value="7199" NextOperation="Or"/>
			<Condition FieldPosition="0" ConditionName="MachineType" Operation="EqualsTo" Value="7198"/>
		</Expression>
	</Formula>
	
	<!-- this performs the opposite check on the firmware version and we don't show the URL as we do above since it would not apply -->
	<Formula Categories="hardware">
		<Name>Hardware Reports Missing Interfaces ({/Hardware//diagifnum})!</Name>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="Hardware" XPath="/Hardware//diagifnum/@status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value="ok"/>
			</Expression>
		<Expression LogLevel="Critical">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//MachineType"/>
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//MachineType"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MachineType" Operation="NotEqualTo" Value="7199" NextOperation="And"/>
			<Condition FieldPosition="0" ConditionName="MachineType" Operation="NotEqualTo" Value="7198" NextOperation="And"/>
			<Condition FieldPosition="0" ConditionName="MachineType" Operation="NotEqualTo" Value="5725"/>
		</Expression>
	</Formula>
	
	<Formula Categories="hardware">
		<Name>Hardware Reports Interface MAC Address Error: {/Hardware//diagifmac}</Name>
		<Expression LogLevel="Error">
			<Section Name="Hardware" XPath="/Hardware//diagifmac/@status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="error"/>
			</Expression>
	</Formula>
	
	<Formula Categories="hardware">
		<Name>Crypto Hardware Failure, Status: {Condition:HardwareFailure}!</Name>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="Hardware" XPath="/Hardware/diagcryptostat"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="Contains" ConditionName="HardwareFailure" Value="Runtime error detected."/>
			</Expression>
		<Expression LogLevel="Critical">
			<Section Name="CryptoEngineStatus" XPath="/Status/CryptoEngineStatus//EngineStatus"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="Contains" ConditionName="HardwareFailure" Value="Runtime error detected"/>
			</Expression>
	</Formula>
	
	<Formula Categories="hardware">
		<Name>Crypto Hardware Failure, Status: {Condition:EngineStatus}!</Name>
		<Expression LogLevel="Critical">
			<Section Name="CryptoEngineStatus" XPath="/Status/CryptoEngineStatus//EngineStatus"/>
			<Section Name="CryptoEngineStatus2" XPath="/Status/CryptoEngineStatus2//EngineStatus"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" ConditionName="EngineStatus" Value="fully operational"/>
			</Expression>
	</Formula>
	
	<Formula CollapseResult="true" OmitPrintingMetConditions="true" Categories="general;hardware">
		<Name>Crypto Hardware is OK!</Name>
		<DisplayMessage>The crypto hardware is up and running, the status is: {/Status/CryptoEngineStatus//EngineStatus}</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="CryptoEngineStatus" XPath="/Status/CryptoEngineStatus//EngineStatus"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="fully operational"/>
			</Expression>
	</Formula>
	
	<Formula Categories="general;hardware">
		<Name>Battery Error!</Name>
		<DisplayMessage>The hardware section reports a problem with the battery: {Hardware/diagbattdate}.</DisplayMessage>
		<URL description="Installed battery nearing end of life: " >http://www.ibm.com/support/docview.wss?uid=swg21322505</URL>
		<Expression LogLevel="Critical">
			<Section Name="Hardware" XPath="/Hardware/diagbattdate/@status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="error"/>
			</Expression>
	</Formula>
	
	<Formula Categories="general;hardware">
		<Name>Battery Failure!</Name>
		<DisplayMessage>There is a report by the internal sensors that the battery has failed.</DisplayMessage>
		<URL description="Installed battery nearing end of life: " >http://www.ibm.com/support/docview.wss?uid=swg21322505</URL>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="OtherSensors" XPath="/Status/OtherSensors//Name"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="Battery Failed"/>
			</Expression>
		<Expression LogLevel="Critical">
			<Section Name="OtherSensors" XPath="/Status/OtherSensors//Value"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="true"/>
			</Expression>
	</Formula>
	
	<Formula Categories="hardware">
		<Name>RAID Disk Reports Error ({/Hardware//diagraidnotoptimal/text()})</Name>
		<Expression LogLevel="Error">
			<Section Name="Hardware" XPath="/Hardware//diagraidnotoptimal/@status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="error"/>
			</Expression>
	</Formula>
	
	<Formula Categories="hardware">
		<Name>RAID Disk Reports Critical Error ({/Hardware//diagraidbbu_temptoohigh/text()})</Name>
		<Expression LogLevel="Critical">
			<Section Name="Hardware" XPath="/Hardware//diagraidbbu_temptoohigh/@status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="critical"/>
			</Expression>
	</Formula>
	
	<!-- track failure of raid drive 
	<diagraidlogdrive_badstate code="0x804000db" status="error">RAID logical drive 1 state : degraded.</diagraidlogdrive_badstate>
	-->
	<Formula Categories="hardware">
		<Name>RAID Disk Reports Error ({/Hardware//diagraidlogdrive_badstate/text()})</Name>
		<Expression LogLevel="Error">
			<Section Name="Hardware" XPath="/Hardware//diagraidlogdrive_badstate/@status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="error"/>
			</Expression>
	</Formula>
	
	<Formula Categories="hardware">
		<Name>RAID Physical Drive Reports Status: {/Hardware//diagraidphydrive_badstate_replace/@status}, drive needs replacement.</Name>
		<DisplayMessage>RAID Status Message: {/Hardware//diagraidphydrive_badstate_replace/text()}</DisplayMessage>
		<Expression LogLevel="Error">
			<Section Name="Hardware" XPath="/Hardware//diagraidphydrive_badstate_replace/@status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="critical" NextOperation="Or"/>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="error"/>
			</Expression>
	</Formula>
	<!-- End of Hardware Failures -->
	
	<!-- General High Usage markers on appliance -->
	<Formula OmitPrintingMetConditions="true" TopPositionResult="true" Categories="memory">
		<Name>&lt;font color='red'&gt;!FREE MEMORY LESS THAN 50% ON RELOAD!&lt;/font&gt; MemStatsBeforeReload, MemFree/MemTotal: {Condition:MemFree} / {Condition:MemTotal} kB</Name>
		<Expression LogLevel="Critical">
			<Section Name="MemStatsBeforeReload" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="3" ConditionName="MemTotal" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(MemTotal:\s+([0-9]+) kB)\b</Condition>
			<Condition FieldPosition="3" ConditionName="MemFree" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(MemFree:\s+([0-9]+) kB)\b</Condition>
			<Condition FieldPosition="3" ConditionName="MemFreePercentage" Operation="DivideBy" Value="{Condition:MemTotal}" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(MemFree:\s+([0-9]+) kB)\b</Condition>
			<Condition FieldPosition="{Condition:MemFreePercentage}" Operation="LessThan" Value=".51"/> <!-- check for less than 51% -->
		</Expression>
	</Formula>
	
		<Formula OmitPrintingMetConditions="true" TopPositionResult="true" Categories="memory">
		<Name>MemStatsBeforeReload, MemFree/MemTotal: {Condition:MemFree}/{Condition:MemTotal} kB, Buffers: {Condition:Buffers} kB, Cached: {Condition:Cached} kB, VmallocTotal: {Condition:VmallocTotal} kB, VmallocUsed: {Condition:VmallocUsed} kB, VmallocChunk: {Condition:VmallocChunk} kB</Name>
		<DisplayMessage>Task Memory Usage: FDSize: {Condition:FDSize}, VmSize: {Condition:VmSize} kB, VmRSS: {Condition:VmRSS} kB</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="MemStatsBeforeReload" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="3" ConditionName="MemTotal" Operation="GreaterThan" Value="4000000" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(MemTotal:\s+([0-9]+) kB)\b</Condition>
			<Condition FieldPosition="3" ConditionName="MemFree" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(MemFree:\s+([0-9]+) kB)\b</Condition>
			<Condition FieldPosition="3" ConditionName="Buffers" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(Buffers:\s+([0-9]+) kB)\b</Condition>
			<Condition FieldPosition="3" ConditionName="Cached" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(Cached:\s+([0-9]+) kB)\b</Condition>
			<Condition FieldPosition="3" ConditionName="VmallocTotal" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(VmallocTotal:\s+([0-9]+) kB)\b</Condition>
			<Condition FieldPosition="3" ConditionName="VmallocUsed" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(VmallocUsed:\s+([0-9]+) kB)\b</Condition>
			<Condition FieldPosition="3" ConditionName="VmallocChunk" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(VmallocChunk:\s+([0-9]+) kB)\b</Condition>
			<!-- task memory -->
			<Condition FieldPosition="3" ConditionName="FDSize" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(FDSize:\s+([0-9]+))\b</Condition>
			<Condition FieldPosition="3" ConditionName="VmSize" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(VmSize:\s+([0-9]+) kB)\b</Condition>
			<Condition FieldPosition="3" ConditionName="VmRSS" Operation="NotEqualTo" Value="">\bSystem Memory:.*\W+(\w+\W+)*?(VmRSS:\s+([0-9]+) kB)\b</Condition>
		</Expression>
		</Formula>
		
		<Formula OmitPrintingMetConditions="true" TopPositionResult="true" Categories="memory">
		<Name>&lt;font color='red'&gt;!LOW TOTAL MEMORY!&lt;/font&gt; MemStatsBeforeReload, MemFree/MemTotal: {Condition:MemFree}/&lt;font color='red'&gt;{Condition:MemTotal} kB&lt;/font&gt;, Buffers: {Condition:Buffers} kB, Cached: {Condition:Cached} kB, VmallocTotal: {Condition:VmallocTotal} kB, VmallocUsed: {Condition:VmallocUsed} kB, VmallocChunk: {Condition:VmallocChunk} kB</Name>
		<DisplayMessage>Task Memory Usage: FDSize: {Condition:FDSize}, VmSize: {Condition:VmSize} kB, VmRSS: {Condition:VmRSS} kB</DisplayMessage>
		<URL FormulaIDMatch="V600FirmwareCheck" description="System Requirements v6.0.0: ">http://pic.dhe.ibm.com/infocenter/wsdatap/v6r0m0/index.jsp?topic=%2Fcom.ibm.dp.xg.doc%2Fvirtual_systemrequirements.html</URL>
		<URL FormulaIDMatch="V601FirmwareCheck" description="System Requirements v6.0.1: ">http://pic.dhe.ibm.com/infocenter/wsdatap/v6r0m1/index.jsp?topic=%2Fcom.ibm.dp.xg.doc%2Fvirtual_systemrequirements.html</URL>
		<URL FormulaIDMatch="V700FirmwareCheck" description="System Requirements v7.0.0: ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_7.0.0/com.ibm.dp.xi.doc/virtual_systemrequirements.html</URL>
		<URL FormulaIDMatch="V710FirmwareCheck" description="System Requirements v7.1.0: ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_7.1.0/com.ibm.dp.doc/virtual_systemrequirements.html</URL>
		<URL FormulaIDMatch="V720FirmwareCheckOrGreater" description="System Requirements v7.1.0: ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_7.1.0/com.ibm.dp.doc/virtual_systemrequirements.html</URL>
				<Expression LogLevel="Critical">
			<Section Name="MemStatsBeforeReload" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="3" ConditionName="MemTotal" Operation="LessThan" Value="4000001" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(MemTotal:\s+([0-9]+) kB)\b</Condition>
			<Condition FieldPosition="3" ConditionName="MemFree" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(MemFree:\s+([0-9]+) kB)\b</Condition>
			<Condition FieldPosition="3" ConditionName="Buffers" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(Buffers:\s+([0-9]+) kB)\b</Condition>
			<Condition FieldPosition="3" ConditionName="Cached" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(Cached:\s+([0-9]+) kB)\b</Condition>
			<Condition FieldPosition="3" ConditionName="VmallocTotal" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(VmallocTotal:\s+([0-9]+) kB)\b</Condition>
			<Condition FieldPosition="3" ConditionName="VmallocUsed" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(VmallocUsed:\s+([0-9]+) kB)\b</Condition>
			<Condition FieldPosition="3" ConditionName="VmallocChunk" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(VmallocChunk:\s+([0-9]+) kB)\b</Condition>
			<!-- task memory -->
			<Condition FieldPosition="3" ConditionName="FDSize" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(FDSize:\s+([0-9]+))\b</Condition>
			<Condition FieldPosition="3" ConditionName="VmSize" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(VmSize:\s+([0-9]+) kB)\b</Condition>
			<Condition FieldPosition="3" ConditionName="VmRSS" Operation="NotEqualTo" Value="">\bSystem Memory:.*\W+(\w+\W+)*?(VmRSS:\s+([0-9]+) kB)\b</Condition>
		</Expression>
		</Formula>
		
	<Formula OmitPrintingMetConditions="true" Categories="memory">
		<Name>Total Memory Available is lower than expected, {Condition:MemoryTotal} kilobytes are available.  Memory issues can occur with 4GB or less, 'standard' 8GB minimum total memory recommended.</Name>
		<URL FormulaIDMatch="V600FirmwareCheck" description="System Requirements v6.0.0: ">http://pic.dhe.ibm.com/infocenter/wsdatap/v6r0m0/index.jsp?topic=%2Fcom.ibm.dp.xg.doc%2Fvirtual_systemrequirements.html</URL>
		<URL FormulaIDMatch="V601FirmwareCheck" description="System Requirements v6.0.1: ">http://pic.dhe.ibm.com/infocenter/wsdatap/v6r0m1/index.jsp?topic=%2Fcom.ibm.dp.xg.doc%2Fvirtual_systemrequirements.html</URL>
		<URL FormulaIDMatch="V700FirmwareCheck" description="System Requirements v7.0.0: ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_7.0.0/com.ibm.dp.xi.doc/virtual_systemrequirements.html</URL>
		<URL FormulaIDMatch="V710FirmwareCheck" description="System Requirements v7.1.0: ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_7.1.0/com.ibm.dp.doc/virtual_systemrequirements.html</URL>
		<URL FormulaIDMatch="V720FirmwareCheckOrGreater" description="System Requirements v7.1.0: ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_7.1.0/com.ibm.dp.doc/virtual_systemrequirements.html</URL>
		<Expression LogLevel="Critical">
			<Section Name="MemoryStatus" XPath="/Status/MemoryStatus/TotalMemory"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemoryTotal" Operation="LessThan" Value="4000000"/>
		</Expression>
	</Formula>
	
	<Formula OmitPrintingMetConditions="true" Categories="memory">
		<Name>Total Memory Available is low and OOM situations may occur, {Condition:MemoryTotal} kilobytes are available.  Memory issues can occur with 4GB or less, 'standard' 8GB minimum total memory recommended.</Name>
		<URL FormulaIDMatch="V600FirmwareCheck" description="System Requirements v6.0.0: ">http://pic.dhe.ibm.com/infocenter/wsdatap/v6r0m0/index.jsp?topic=%2Fcom.ibm.dp.xg.doc%2Fvirtual_systemrequirements.html</URL>
		<URL FormulaIDMatch="V601FirmwareCheck" description="System Requirements v6.0.1: ">http://pic.dhe.ibm.com/infocenter/wsdatap/v6r0m1/index.jsp?topic=%2Fcom.ibm.dp.xg.doc%2Fvirtual_systemrequirements.html</URL>
		<URL FormulaIDMatch="V700FirmwareCheck" description="System Requirements v7.0.0: ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_7.0.0/com.ibm.dp.xi.doc/virtual_systemrequirements.html</URL>
		<URL FormulaIDMatch="V710FirmwareCheck" description="System Requirements v7.1.0: ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_7.1.0/com.ibm.dp.doc/virtual_systemrequirements.html</URL>
		<URL FormulaIDMatch="V720FirmwareCheckOrGreater" description="System Requirements v7.1.0: ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_7.1.0/com.ibm.dp.doc/virtual_systemrequirements.html</URL>
		<Expression LogLevel="Error">
			<Section Name="MemoryStatus" XPath="/Status/MemoryStatus/TotalMemory"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemoryTotal" Operation="LessThan" Value="5000000" NextOperation="And"/>
			<Condition FieldPosition="0" ConditionName="MemoryTotal" Operation="GreaterThan" Value="4000000"/>
		</Expression>
	</Formula>
	
	<Formula OmitPrintingMetConditions="true" Categories="memory">
		<Name>Memory Usage is High, {/Status/MemoryStatus/Usage}%.</Name>
		<URL description="Memory MustGather Script: ">http://www.ibm.com/support/docview.wss?uid=swg21377610</URL>
		<Expression LogLevel="Warning">
			<Section Name="MemoryStatus" XPath="/Status/MemoryStatus/Usage"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="59"/>
			</Expression>
	</Formula>
	
	<Formula Categories="memory">
		<Name>{Condition:SectionName} Usage is High, Type: {/Status/XMLNamesStatus//Type}, currently {/Status/XMLNamesStatus//PercentFree}% free.</Name>
		<DisplayMessage>The XML name status for field {/Status/XMLNamesStatus//Type} has high usage, currently {/Status/XMLNamesStatus//PercentFree}% free, {/Status/XMLNamesStatus//Used} entries used.</DisplayMessage>
		<URL description="High XML Names: ">http://www.ibm.com/support/docview.wss?uid=swg21409683</URL>
		<Expression LogLevel="Critical">
			<Section Name="XMLNamesStatus" XPath="/Status/XMLNamesStatus//PercentFree"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="LessThan" Value="20"/>
			</Expression>
	</Formula>
	
	<Formula Categories="configuration;cpu;memory;failure">
		<Name>{Condition:SectionName} {Condition:Timestamp} System is exhausted in XML-names, attempting to free up used names, stage: {Condition:Stage}.</Name>
		<URL description="High XML Names: ">http://www.ibm.com/support/docview.wss?uid=swg21409683</URL>
		<URL description="DataPower v7.1 or later has XML names enhancement to allow more xml-name space: ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_7.1.0/com.ibm.dp.doc/releasenotes.html</URL>
		<Expression LogLevel="Critical">
			<Section Name="DiagnosticLog" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>The number of XML Names currently being used by the system is high</IndexSearch>
			<RegExp>1,([0-9TZ.]+),default,system,notice,throttle,Throttler,([0-9]+),,,0x804000b5,,,\"The number of XML Names currently being used by the system is high\. The system is attempting to free unused XML names \(([0-9])\)\.\"</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="Stage" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- End of the General High Usage Markers -->
	
	<!-- FileSystemStatus markers, check for low temporary,encrypted and internal space -->
	
	<!-- formula used for a check at the bottom for files in temporary if we are low in space -->
	<Formula Categories="memory" FormulaID="LowTemporarySpaceFlag">
		<Name>FilesystemStatus Free Temporary Space is less than 50%, {/Status/FilesystemStatus//FreeTemporary}MB left free.</Name>
		<URL description="FileSystem Details: ">http://www.ibm.com/support/docview.wss?uid=swg21496334</URL>
		<URL description="Hash Files in Temporary Folder: ">http://www.ibm.com/support/docview.wss?uid=swg21606519</URL>
		<Expression LogLevel="Error">
			<Section Name="FilesystemStatus" XPath="/Status/FilesystemStatus//FreeTemporary"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="{/Status/FilesystemStatus//TotalTemporary}" Operation="NotEqualTo" ConditionName="TotalTemporary" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="DivideBy" ConditionName="PercentageFreeTemporary" Value="{Condition:TotalTemporary}" NextOperation="And"/>
			<Condition FieldPosition="{Condition:PercentageFreeTemporary}" Operation="LessThan" Value=".51"/> <!-- check for less than 51% -->
		</Expression>
	</Formula>
	
	<!-- this will only appear if the FormulaID LowTemporarySpaceFlag is triggered -->
	<Formula CollapseResult="true" Categories="memory" SortCondition="Size" SortMethod="Descending" SumCondition="Size">
		<Name>Temporary FileSystem File {Condition:FileName} size {Condition:Size} bytes.</Name>
		<Expression LogLevel="Error" FormulaIDMatch="LowTemporarySpaceFlag" NextOperation="And">
			<Section Name="FlashFiles" XPath="/flash/file[contains(text(),'drouter/temporary/')]"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="FileName" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Error" FormulaIDMatch="LowTemporarySpaceFlag">
			<Section Name="FlashFiles" XPath="/flash/file[contains(text(),'drouter/temporary/')]/@size"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="Size" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- end temporary filesystem review -->
	
	<Formula Categories="memory">
		<Name>FilesystemStatus Free Encrypted Space is less than 50%, {/Status/FilesystemStatus//FreeEncrypted}MB left free.</Name>
		<URL description="FileSystem Details: ">http://www.ibm.com/support/docview.wss?uid=swg21496334</URL>
		<Expression LogLevel="Error">
			<Section Name="FilesystemStatus" XPath="/Status/FilesystemStatus//FreeEncrypted"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="{/Status/FilesystemStatus//TotalEncrypted}" Operation="NotEqualTo" ConditionName="TotalEncrypted" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="DivideBy" ConditionName="PercentageFreeEncrypted" Value="{Condition:TotalEncrypted}" NextOperation="And"/>
			<Condition FieldPosition="{Condition:PercentageFreeEncrypted}" Operation="LessThan" Value=".51"/> <!-- check for less than 51% -->
		</Expression>
	</Formula>

	<Formula Categories="memory" FormulaID="LowInternalSpaceFlag">
		<Name>FilesystemStatus Free Internal Space is less than 50%, {/Status/FilesystemStatus//FreeInternal}MB left free.</Name>
		<URL description="FileSystem Details: ">http://www.ibm.com/support/docview.wss?uid=swg21496334</URL>
		<Expression LogLevel="Error">
			<Section Name="FilesystemStatus" XPath="/Status/FilesystemStatus//FreeInternal"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="{/Status/FilesystemStatus//TotalInternal}" Operation="NotEqualTo" ConditionName="TotalInternal" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="DivideBy" ConditionName="PercentageFreeInternal" Value="{Condition:TotalInternal}" NextOperation="And"/>
			<Condition FieldPosition="{Condition:PercentageFreeInternal}" Operation="LessThan" Value=".51"/> <!-- check for less than 51% -->
		</Expression>
	</Formula>
		
	<!-- this will only appear if the FormulaID LowInternalSpaceFlag is triggered -->
	<Formula CollapseResult="true" Categories="memory" SortCondition="Size" SortMethod="Descending" SumCondition="Size">
		<Name>Internal FileSystem File {Condition:FileName} size {Condition:Size} bytes.</Name>
		<Expression LogLevel="Error" FormulaIDMatch="LowInternalSpaceFlag" NextOperation="And">
			<Section Name="FlashFiles" XPath="/flash/file[contains(text(),'drouter/ramdisk2/')]"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="FileName" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Error" FormulaIDMatch="LowInternalSpaceFlag">
			<Section Name="FlashFiles" XPath="/flash/file[contains(text(),'drouter/ramdisk2/')]/@size"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="Size" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- end temporary filesystem review -->
	
	<!-- End of FileSystemStatus checks -->

	
	<!-- Beginning of MQQM Status Fault Checks -->
	
	<Formula Categories="configuration">
		<Name>{Condition:SectionName} MQ Queue Manager {/Status/MQQMstatus//QueueManager} Reports Receive Faults (Total: {/Status/MQQMstatus//ReceiveFaults})</Name>
			<Expression LogLevel="Warning">
			<Section Name="MQQMstatus" Wildcard="True" XPath="/Status/MQQMstatus//ReceiveFaults"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0"/>
			</Expression>
	</Formula>
	<Formula Categories="configuration">
		<Name>{Condition:SectionName} MQ Queue Manager {/Status/MQQMstatus//QueueManager} Reports Send Faults (Total: {/Status/MQQMstatus//SendFaults})</Name>
			<Expression LogLevel="Warning">
			<Section Name="MQQMstatus" Wildcard="True" XPath="/Status/MQQMstatus//SendFaults"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0"/>
			</Expression>
	</Formula>
	
	<!-- End of MQQM Status Fault Checks -->
	
	
	<!-- LoadBalancerGroup Status Checks -->
	
	<!-- Updated formula July 17th 2013 to no longer show disabled Load Balancer Groups (check for AdminState=enabled) -->
	<Formula Categories="network">
		<Name>{Condition:SectionName} LoadBalancer ({/Status/LoadBalancerStatus2//Group}) Reports Group Member Down</Name>
		<DisplayMessage>The LoadBalancer Group {/Status/LoadBalancerStatus2//Group}, has a downed member {/Status/LoadBalancerStatus2//Server} over port {/Status/LoadBalancerStatus2//Port}.</DisplayMessage>
			<Expression LogLevel="Warning" NextOperation="And">
			<Section Name="LoadBalancerStatus2" Wildcard="True" XPath="/Status/LoadBalancerStatus2//Health"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="down"/>
			</Expression>
			<Expression LogLevel="Warning">
			<Section Name="LoadBalancerStatus2" Wildcard="True" XPath="/Status/LoadBalancerStatus2//AdminState"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="enabled"/>
			</Expression>
	</Formula>
	
	<!-- End of LoadBalancerGroup Status Checks -->
	
	<!-- IPMISelEvents checks -->
	
	<!-- investigation 46984 -->
	<Formula Categories="failure" SortCondition="Timestamp" SortMethod="descending" SortOption="EEE MMM dd HH:mm:ss yyyy">
		<Name>Possible Firmware or Hardware Watchdog Restart (watchdog2TimeExpired) ({/Status/IPMISelEvents//Timestamp})!</Name>
		<DisplayMessage>Review DPOSDiagnostics or SysRecord (if available) for more information (INFO level, available at bottom of Analytics Report).  Versions prior to 7.0 this is more likely a firmware watchdog.</DisplayMessage>
			<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//EventReadingTypeCode"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="watchdog2TimeExpired"/>
			</Expression>
			<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//SensorNumber"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="0x0001"/>
			</Expression>
			<Expression LogLevel="Critical">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//Timestamp"/>
			<!-- "Tue Jan  9 00:35:54 2007" -->
			<RegExp>\s+</RegExp>
			<Condition FieldPosition="4" ConditionName="Timestamp" Operation="Contains" Value="2015"/>
			<Condition FieldPosition="4" ConditionName="Timestamp" Operation="Contains" Value="2016"/>
			</Expression>
	</Formula>
	
	<Formula Categories="failure">
		<Name>Kernel Panic!</Name>
		<DisplayMessage>The device reported a kernel panic.</DisplayMessage>
		<URL description="NFS Kernel Panic (APAR IC92153, v5.0.0.10 and 6.0.0.2): ">http://www.ibm.com/support/docview.wss?uid=swg1IC92153</URL>
				<Expression LogLevel="Error" NextOperation="And">
				<Section Name="FirmwareVersion" SectionName="false" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="2"/>
		</Expression>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//EventReadingTypeCode"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="kernelPanic"/>
			</Expression>
		<Expression LogLevel="Critical">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//Extra"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="Fatal exception"/>
			</Expression>
	</Formula>
	
		<Formula Categories="failure">
		<Name>Kernel Panic!</Name>
		<DisplayMessage>The device reported a kernel panic.</DisplayMessage>
		<URL description="NFS Kernel Panic (APAR IC92153, v5.0.0.10 and 6.0.0.2): ">http://www.ibm.com/support/docview.wss?uid=swg1IC92153</URL>
				<Expression LogLevel="Error" NextOperation="And">
				<Section Name="FirmwareVersion" SectionName="false" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="5" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="10"/>
		</Expression>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//EventReadingTypeCode"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="kernelPanic"/>
			</Expression>
		<Expression LogLevel="Critical">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//Extra"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="Fatal exception"/>
			</Expression>
	</Formula>

	<Formula Categories="failure" SortCondition="Timestamp" SortMethod="descending" SortOption="EEE MMM dd HH:mm:ss yyyy">
		<Name>BMC Restart ({/Status/IPMISelEvents//Timestamp})!</Name>
		<URL description="9235 may restart due to Baseboard Management Controller (BMC) communications loss: ">http://www.ibm.com/support/docview.wss?uid=swg21585939</URL>
			<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//MachineType"/>
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//MachineType"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MachineType" Operation="EqualsTo" Value="9235"/>
			</Expression>
			<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//EventReadingTypeCode"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="watchdog2HardReset"/>
			</Expression>
			<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//SensorNumber"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="0x00BF"/>
			</Expression>
			<Expression LogLevel="Critical">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//Timestamp"/>
			<!-- "Tue Jan  9 00:35:54 2007" -->
			<RegExp>\s+</RegExp>
			<Condition FieldPosition="4" ConditionName="Timestamp" Operation="Contains" Value="2015"/>
			<Condition FieldPosition="4" ConditionName="Timestamp" Operation="Contains" Value="2016"/>
			</Expression>
	</Formula>
	
		<!-- track systemfirmwareprogress -->
	<Formula Categories="general" SortMethod="reverse">
		<Name>{Condition:SectionName} - &lt;font color='#CC3300'&gt;{/Status/IPMISelEvents//Timestamp}&lt;/font&gt; Sensor: &lt;font color='#CC3300'&gt;{Condition:SensorType}&lt;/font&gt; Code: &lt;font color='#CC3300'&gt;{Condition:EventReadingTypeCode}&lt;/font&gt;</Name>
		<DisplayMessage>Sensor Name: {/Status/IPMISelEvents//SensorName}, SensorNumber: {/Status/IPMISelEvents//SensorNumber}, Extra: {/Status/IPMISelEvents//Extra}</DisplayMessage>
		<URL description="IPMISelEvents HW Status (systemFirmwareProgress=reload/reboot)">http://www.ibm.com/support/knowledgecenter/SS9H2Y_7.0.0/com.ibm.dp.xg.doc/hardwarestatusproviders.html?lang=en</URL>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//SensorType"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="SensorType" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//EventReadingTypeCode"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="EventReadingTypeCode" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- end of systemfirmwareprogress -->
	
		<!-- Covers correctableEcc and uncorrectableEcc (looks for contains to match both) - memory related issues -->
	<Formula Categories="failure;hardware">
		<Name>IPMISelEvents Reports ECC Memory Issues ({/Status/IPMISelEvents//Timestamp})!</Name>
		<URL description="ECC Memory Issues: ">http://www.ibm.com/support/docview.wss?uid=swg21650782</URL>
			<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//EventReadingTypeCode"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="Contains" Value="correctableEcc"/>
			</Expression>
			<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//SensorType"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="memory"/>
			</Expression>
			<Expression LogLevel="Critical">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//Timestamp"/>
			<!-- "Tue Jan  9 00:35:54 2007" -->
			<RegExp>\s+</RegExp>
			<Condition FieldPosition="4" Operation="Contains" Value="2015"/>
			<Condition FieldPosition="4" Operation="Contains" Value="2016"/>
			</Expression>
	</Formula>
	<!-- end IPMISelEvents checks -->
	
	<!-- Stylesheet Execution Times -->
	<Formula Categories="memory">
		<Name>{Condition:SectionName} High Stylesheet Execution Times from XMLMgr {/Status/StylesheetMeanExecutionTimeSimpleIndex//XMLManager} ({/Status/StylesheetMeanExecutionTimeSimpleIndex//URL})!</Name>
		<DisplayMessage>Excessive execution time for stylesheet: {/Status/StylesheetMeanExecutionTimeSimpleIndex//URL}, XMLMgr: {/Status/StylesheetMeanExecutionTimeSimpleIndex//XMLManager}, Buckets - 10s: {/Status/StylesheetMeanExecutionTimeSimpleIndex//tenSeconds}, 1m: {/Status/StylesheetMeanExecutionTimeSimpleIndex//oneMinute}, 10m: {/Status/StylesheetMeanExecutionTimeSimpleIndex//tenMinutes}, 1hr: {/Status/StylesheetMeanExecutionTimeSimpleIndex//oneHour}, day: {/Status/StylesheetMeanExecutionTimeSimpleIndex//oneDay}.</DisplayMessage>
		<URL description="WebSphere DataPower SOA Appliances and XSLT, Part 1 of 2 - Tools (Stylesheet Profiling): ">http://www.ibm.com/support/docview.wss?uid=swg27019118&amp;aid=1</URL>
		<Expression LogLevel="Critical" NextOperation="Or">
			<Section Name="StylesheetMeanExecutionTimeSimpleIndex" Wildcard="True" XPath="/Status/StylesheetMeanExecutionTimeSimpleIndex//tenSeconds"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="4999"/>
		</Expression>
		<Expression LogLevel="Critical" NextOperation="Or">
			<Section Name="StylesheetMeanExecutionTimeSimpleIndex" Wildcard="True" XPath="/Status/StylesheetMeanExecutionTimeSimpleIndex//oneMinute"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="4999"/>
		</Expression>
		<Expression LogLevel="Critical" NextOperation="Or">
			<Section Name="StylesheetMeanExecutionTimeSimpleIndex" Wildcard="True" XPath="/Status/StylesheetMeanExecutionTimeSimpleIndex//tenMinutes"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="4999"/>
		</Expression>
		<Expression LogLevel="Critical" NextOperation="Or">
			<Section Name="StylesheetMeanExecutionTimeSimpleIndex" Wildcard="True" XPath="/Status/StylesheetMeanExecutionTimeSimpleIndex//oneHour"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="4999"/>
		</Expression>
		<Expression LogLevel="Critical" NextOperation="Or">
			<Section Name="StylesheetMeanExecutionTimeSimpleIndex" Wildcard="True" XPath="/Status/StylesheetMeanExecutionTimeSimpleIndex//oneDay"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="4999"/>
		</Expression>
	</Formula>
	
	<!-- End execution stylesheet tests -->
	
	<!-- Log target tests -->		
	<Formula Categories="configuration" FormulaID="BadLogTarget">
		<Name>{Condition:SectionName} Log Target has 25% or more dropped events, {/Status/LogTargetStatus//EventsDropped} dropped events from target {/Status/LogTargetStatus//LogTarget}!  There were {/Status/LogTargetStatus//EventsProcessed} log events processed successfully.</Name>
		<URL description="(DWAnswers) DataPower remote log targets, tracking efficieny : ">https://developer.ibm.com/answers/questions/172794/datapower-remote-log-targets-tracking-efficieny/</URL>
		<Expression LogLevel="Warning" NextOperation="And">
			<Section Name="LogTargetStatus" Wildcard="True" XPath="/Status/LogTargetStatus//EventsDropped"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="{/Status/LogTargetStatus//EventsProcessed}" Operation="Add" ConditionName="ProcessedEvents" Value="1" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="DivideBy" ConditionName="DroppedEvents" Value="{Condition:ProcessedEvents}" NextOperation="And"/>
			<Condition FieldPosition="{Condition:DroppedEvents}" Operation="GreaterThan" Value=".25"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="LogTargetStatus" Wildcard="True" XPath="/Status/LogTargetStatus//LogTarget"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="LogTargetName" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- end log target tests -->
	
	<!-- Find log targets using event-detection -->
	
	<!-- through PMR 29525,442,000 encountered a customer who had high load from event-detection -->
	<Formula Categories="configuration;memory;cpuload" SortCondition="SuppressionPeriod" SortMethod="descending">
		<Name>{Condition:SectionName} Logging Target {Condition:ObjectName} is configured with 'event-detection' on with a suppression period of {Condition:SuppressionPeriod} seconds, longer suppression periods may cause high memory, may also cause high load.  This feature is set in the logging target as the radio button 'Identical Event Detection'.</Name>
		<URL description="Logging Identical Event Suppression Tuning Considerations: ">http://www.ibm.com/support/docview.wss?uid=swg21606954</URL>
		<Expression LogLevel="Warning">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And">\b(logging target \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit)\b</Condition>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ConfigInfo" Operation="Contains" Value="event-detection" NextOperation="And">\b(logging target \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit)\b</Condition>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ConfigInfo" Operation="NotContain" Value="no event-detection" NextOperation="And">\b(logging target \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit)\b</Condition>
			<Condition FieldPosition="3" RegGroup="AllResult" ConditionName="SuppressionPeriod" Operation="GreaterThan" Value="0">logging target \"{Condition:ObjectName}\"\W+(\w+\W+)*?(suppression-period ([0-9]+)|exit)</Condition>
		</Expression>
	</Formula>
	
	<!-- end of log target check for event detection -->
	
	<!-- Beginning of Tibco EMS Status Fault Checks -->
	
	<Formula Categories="configuration">
		<Name>{Condition:SectionName} Tibco EMS Server Reports Receive Faults</Name>
		<DisplayMessage>The Receive Faults field in the TibcoEMS Status Provider {/Status/TibcoEMSStatus//Server}, {/Status/TibcoEMSStatus//ReceivedFaults} faults found.</DisplayMessage>
			<Expression LogLevel="Warning">
			<Section Name="TibcoEMSStatus" Wildcard="True" XPath="/Status/TibcoEMSStatus//ReceivedFaults"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0"/>
			</Expression>
	</Formula>
	<Formula Categories="configuration">
		<Name>{Condition:SectionName} Tibco EMS Server Reports Send Faults ({/Status/TibcoEMSStatus//Server})</Name>
		<DisplayMessage>The Send Faults field in the TibcoEMS Status Provider {/Status/TibcoEMSStatus//Server}, {/Status/TibcoEMSStatus//SentFaults} faults found.</DisplayMessage>
			<Expression LogLevel="Warning">
			<Section Name="TibcoEMSStatus" Wildcard="True" XPath="/Status/TibcoEMSStatus//SentFaults"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0"/>
			</Expression>
	</Formula>
	
	<!-- End of Tibco EMS Status Fault Checks -->
	
	
	<!-- Beginning of FailureNotificationStatus2 Fault Checks -->
	<Formula OmitPrintingMetConditions="true" Categories="failure;memory">
		<Name>Failure Notification Event - Error Report (Error!) Generated on {/Status/FailureNotificationStatus2//Date} (Reason Code: {/Status/FailureNotificationStatus2//Reason})</Name>
		<DisplayMessage>There is a failure notification entry on {/Status/FailureNotificationStatus2//Date} which indicates an error report was generated due to reason: {/Status/FailureNotificationStatus2//Reason}.</DisplayMessage>
		<Expression LogLevel="Error" NextOperation="And">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<!-- versions under 5.0 do not properly handle user-requested -->
			<Condition FieldPosition="2" Operation="GreaterThan" Value="4"/>
		</Expression>
		<Expression LogLevel="Error">
			<Section Name="FailureNotificationStatus2" XPath="/Status/FailureNotificationStatus2//Reason"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value="user-requested" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value="on-startup"/>
		</Expression>
	</Formula>
	
	<!-- report backtrace transaction ids below failure notification so user knows if its a reload or a watchdog -->
	<Formula Categories="failure" SortCondition="Timestamp" SortMethod="descending" SortOption="EEE MMM dd HH:mm:ss yyyy">
		<Name>[BACKTRACE] Recorded on {Condition:Timestamp}</Name>
		<DisplayMessage>Transaction ID: {Condition:TransID}, Seconds Up: {Condition:SecsUp}, SigNum: {Condition:SigNum}</DisplayMessage>
		<URL description="Backtraces Provide Transaction ID, in case of Watchdog Events, there may be multiple backtraces in a 30 second timeframe, these transaction IDs may not relate to the reload: ">TBD Technote</URL>
		<Expression LogLevel="Error">
			<Section Name="Backtrace" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And">0x[0-9a-fA-F]*\: ([a-zA-Z]{3} [a-zA-Z]{3}\s+\d+\s\d{2}:\d{2}:\d{2}\s\d{4})</Condition>
			<Condition FieldPosition="1" RegGroup="All" Conversion="hex2long" ConditionName="TransID" Operation="NotEqualTo" Value="0" NextOperation="And">xactid 0x([a-zA-Z-_.0-9]+)</Condition>
			<Condition FieldPosition="1" RegGroup="All" Conversion="hex2long" ConditionName="SecsUp" Operation="NotEqualTo" Value="" NextOperation="And">SecsUp 0x([a-zA-Z-_.0-9]+),</Condition>
			<Condition FieldPosition="1" RegGroup="All" Conversion="hex2long" ConditionName="SigNum" Operation="NotEqualTo" Value="">signum 0x([a-zA-Z-_.0-9]+),</Condition>
		</Expression>
	</Formula>
	
	<Formula Categories="failure" SortCondition="Timestamp" SortMethod="descending">
		<Name>[BACKTRACE] Recorded on {Condition:Timestamp}</Name>
		<DisplayMessage>Transaction ID: {Condition:TransID}, Seconds Up: {Condition:SecsUp}, SigNum: {Condition:SigNum}</DisplayMessage>
		<URL description="Backtraces Provide Transaction ID, in case of Watchdog Events, there may be multiple backtraces in a 30 second timeframe, these transaction IDs may not relate to the reload: ">TBD Technote</URL>
		<Expression LogLevel="Error">
			<Section Name="Backtrace" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And">Thread 0x[0-9a-fA-F]*\: (\d{4}\-\d{2}\-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z)</Condition>
			<Condition FieldPosition="1" RegGroup="All" Conversion="hex2long" ConditionName="TransID" Operation="NotEqualTo" Value="0" NextOperation="And">xactid 0x([a-zA-Z-_.0-9]+)</Condition>
			<Condition FieldPosition="1" RegGroup="All" Conversion="hex2long" ConditionName="SecsUp" Operation="NotEqualTo" Value="" NextOperation="And">SecsUp 0x([a-zA-Z-_.0-9]+),</Condition>
			<Condition FieldPosition="1" RegGroup="All" Conversion="hex2long" ConditionName="SigNum" Operation="NotEqualTo" Value="">signum 0x([a-zA-Z-_.0-9]+),</Condition>
		</Expression>
	</Formula>
	
		<Formula OmitPrintingMetConditions="true" Categories="failure">
		<Name>Failure Notification Event - Error Report Generated on {/Status/FailureNotificationStatus2//Date} (Reason Code: {/Status/FailureNotificationStatus2//Reason})</Name>
		<DisplayMessage>There is a failure notification entry on {/Status/FailureNotificationStatus2//Date} which indicates an error report was generated due to reason: {/Status/FailureNotificationStatus2//Reason}.</DisplayMessage>
		<Expression LogLevel="Warning" NextOperation="And">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="GreaterThan" Value="4"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="FailureNotificationStatus2" XPath="/Status/FailureNotificationStatus2//Reason"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="user-requested"/>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="on-startup"/>
		</Expression>
	</Formula>
	
	<Formula OmitPrintingMetConditions="true" Categories="failure">
		<Name>Failure Notification Event - Error Report (Warning) Generated on {/Status/FailureNotificationStatus2//Date} (Reason Code: {/Status/FailureNotificationStatus2//Reason})</Name>
		<DisplayMessage>There is a failure notification entry on {/Status/FailureNotificationStatus2//Date} - the error report may have been user-requested or it could be related to an unexpected reload (check the URL below for a known issue with FFDC reason code issues).  This issue was resolved in 5.0.0.0.</DisplayMessage>
		<Expression LogLevel="Warning" NextOperation="And">
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<!-- versions under 5.0 do not properly handle user-requested -->
			<Condition FieldPosition="2" Operation="EqualsTo" Value="4"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="FailureNotificationStatus2" XPath="/Status/FailureNotificationStatus2//Reason"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="user-requested"/>
		</Expression>
	</Formula>
	
	<Formula OmitPrintingMetConditions="true" Categories="failure;configuration">
		<Name>{/Status/FailureNotificationStatus2//Date} Failed to generate error report to location {/Status/FailureNotificationStatus2//Location}.</Name>
		<URL description="Configuring Failure Notification: ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_7.0.0/com.ibm.dp.xg.doc/failurenotification.html?lang=en</URL>
		<Expression LogLevel="Error">
			<Section Name="FailureNotificationStatus2" XPath="/Status/FailureNotificationStatus2//UploadStatus"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="failure"/>
		</Expression>
	</Formula>
	<!-- End of FailureNotificationStatus2 Checks -->
	
	
	<!-- SLMSummary Checks -->
	<!-- slm errors are when a transaction fails multistep (or such as a 500 internal backend) -->
	<Formula Categories="configuration">
		<Name>{Condition:SectionName} SLMSummaryStatus Reports Error Count (Failed Transaction) ({/Status/SLMSummaryStatus//SLMPolicy})</Name>
		<DisplayMessage>The SLM policy {/Status/SLMSummaryStatus//SLMPolicy} (SLMID: {/Status/SLMSummaryStatus//SLMId}) reports {/Status/SLMSummaryStatus//TotalErrors} total errors against {/Status/SLMSummaryStatus//TotalMessages} total successful messages.</DisplayMessage>
		<URL description="What details does SLM Summary Status provide?: ">https://developer.ibm.com/answers/questions/248325/what-details-does-slm-summary-status-provide.html</URL>	
		<Expression LogLevel="Warning">
			<Section Name="SLMSummaryStatus" Wildcard="True" XPath="/Status/SLMSummaryStatus//TotalErrors"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>
	
	<!-- latency in this variable occurs when the response time is high, we can get the minimum, average and maximum response times -->
	<Formula Categories="configuration;network" SortCondition="TotalMaximum" SortMethod="descending">
		<Name>{Condition:SectionName} SLMSummaryStatus Reports Latency ({/Status/SLMSummaryStatus//SLMPolicy})</Name>
		<DisplayMessage>The SLM policy {/Status/SLMSummaryStatus//SLMPolicy} (SLMID: {/Status/SLMSummaryStatus//SLMId}) reports &lt;b&gt;{/Status/SLMSummaryStatus//TotalMaximum}ms&lt;/b&gt; maximum response time against &lt;b&gt;{/Status/SLMSummaryStatus//TotalAverage}ms&lt;/b&gt; average response time.</DisplayMessage>
		<URL description="What details does SLM Summary Status provide?: ">https://developer.ibm.com/answers/questions/248325/what-details-does-slm-summary-status-provide.html</URL>	
		<Expression LogLevel="Warning">
			<Section Name="SLMSummaryStatus" Wildcard="True" XPath="/Status/SLMSummaryStatus//TotalMaximum"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="TotalMaximum" Operation="GreaterThan" Value="999"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration">
		<Name>{Condition:SectionName} SLMSummaryStatus Reports Throttle Count ({/Status/SLMSummaryStatus//SLMPolicy})</Name>
		<DisplayMessage>The SLM policy {/Status/SLMSummaryStatus//SLMPolicy} (SLMID: {/Status/SLMSummaryStatus//SLMId}) reports {/Status/SLMSummaryStatus//TotalThrottled} total throttled messages against {/Status/SLMSummaryStatus//TotalMessages} total successful messages.</DisplayMessage>
		<URL description="What details does SLM Summary Status provide?: ">https://developer.ibm.com/answers/questions/248325/what-details-does-slm-summary-status-provide.html</URL>	
		<Expression LogLevel="Warning">
			<Section Name="SLMSummaryStatus" Wildcard="True" XPath="/Status/SLMSummaryStatus//TotalThrottled"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>
	<!-- End of SLMSummaryStatus Checks -->
	
	<!-- Probe checks -->
	
	<Formula Categories="failure;general;cpuload"  SortCondition="Timestamp" SortMethod="descending">
		<Name>[Probe] {Condition:Timestamp} Logs report there is a probe running and hitting max concurrency, this means a service with the probe is receiving load, thus the probe should not be enabled, this log message does not describe the service at fault.  Transaction ID: {Condition:TransactionID}.</Name>
		<URL description="DataPower SOA Appliance Probe - Setting the limit for concurrent transactions (also notes debugging only not production): ">http://www.ibm.com/support/docview.wss?uid=swg21367127</URL>
		<URL description="dwAnswers: How to disable the probe: ">https://developer.ibm.com/answers/questions/28078/how-do-i-disable-the-probe-on-datapower.html</URL>
		<URL description="Webcast Replay: Tips and Tricks for Use of the DataPower Multistep Probe Debugging Tool: ">http://www.ibm.com/support/docview.wss?uid=swg27042061</URL>
		<Expression LogLevel="Critical">
			<Section Name="log" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>Max concurrent transactions exceeded for Probe. Transaction is not captured.</IndexSearch>
			<RegExp>1,([0-9TZ.]+),([a-zA-Z0-9_-]+),([a-zA-Z0-9.\_-]+),([a-zA-Z0-9.\_-]+),,,([0-9]+),([0-9.]+),([0-9a-fx]+),,,"Max concurrent transactions exceeded for Probe. Transaction is not captured."</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="5" RegGroup="All" ConditionName="TransactionID" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;cpuload">
		<Name>Probe Enabled in domain {/Status//DomainStatus/Domain} (Warning!).</Name>
		<DisplayMessage>Probe is currently enabled in the domain {/Status//DomainStatus/Domain}.</DisplayMessage>
		<URL description="DataPower SOA Appliance Probe - Setting the limit for concurrent transactions (also notes debugging only not production): ">http://www.ibm.com/support/docview.wss?uid=swg21367127</URL>
		<URL description="dwAnswers: How to disable the probe: ">https://developer.ibm.com/answers/questions/28078/how-do-i-disable-the-probe-on-datapower.html</URL>
		<URL description="Webcast Replay: Tips and Tricks for Use of the DataPower Multistep Probe Debugging Tool: ">http://www.ibm.com/support/docview.wss?uid=swg27042061</URL>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="DomainStatus" XPath="/Status//DomainStatus/ProbeEnabled"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="on"/>
		</Expression>
	</Formula> 
	
	
	<Formula CollapseResult="true" Categories="configuration;cpuload" SortCondition="Timestamp" SortMethod="descending">
		<Name>{Condition:Timestamp} Probe was enabled on the service {Condition:ServiceName}, Domain: {Condition:Domain}, Service Type: {Condition:ServiceType}</Name>
		<DisplayMessage>Logs note that the probe was enabled at {Condition:Timestamp} on the service {Condition:ServiceName} in the domain {Condition:Domain}, this service is of the type {Condition:ServiceType}.</DisplayMessage>
		<URL description="DataPower SOA Appliance Probe - Setting the limit for concurrent transactions (also notes debugging only not production): ">http://www.ibm.com/support/docview.wss?uid=swg21367127</URL>
		<URL description="dwAnswers: How to disable the probe: ">https://developer.ibm.com/answers/questions/28078/how-do-i-disable-the-probe-on-datapower.html</URL>
		<URL description="Webcast Replay: Tips and Tricks for Use of the DataPower Multistep Probe Debugging Tool: ">http://www.ibm.com/support/docview.wss?uid=swg27042061</URL>
		<Expression LogLevel="Warning">
			<Section Name="AuditLog" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>: Multistep Probe enabled</IndexSearch>
			<RegExp>\b([0-9TZ.]+) [a-zA-Z0-9_\-\[\] ]* ([a-zA-Z]*)\(([a-zA-Z0-9.\- ]*)\): Multistep Probe enabled\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="Domain" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ServiceType" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" Categories="configuration;cpuload" SortCondition="Timestamp" SortMethod="descending">
		<Name>{Condition:Timestamp} Probe was enabled on the service {Condition:ServiceName}, Domain: {Condition:Domain}, Service Type: {Condition:ServiceType}</Name>
		<DisplayMessage>Logs note that the probe was enabled at {Condition:Timestamp} on the service {Condition:ServiceName} in the domain {Condition:Domain}, this service is of the type {Condition:ServiceType}.</DisplayMessage>
		<URL description="DataPower SOA Appliance Probe - Setting the limit for concurrent transactions (also notes debugging only not production): ">http://www.ibm.com/support/docview.wss?uid=swg21367127</URL>
		<URL description="dwAnswers: How to disable the probe: ">https://developer.ibm.com/answers/questions/28078/how-do-i-disable-the-probe-on-datapower.html</URL>
		<URL description="Webcast Replay: Tips and Tricks for Use of the DataPower Multistep Probe Debugging Tool: ">http://www.ibm.com/support/docview.wss?uid=swg27042061</URL>
		<Expression LogLevel="Warning">
			<Section Name="AuditLog" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch> - Multistep Probe enabled</IndexSearch>
			<RegExp>\b([0-9TZ.]+) [a-zA-Z0-9_.\-\[\] ]* \([a-zA-Z0-9]*:([a-zA-Z0-9\-.]*):\*:\*\): ([a-zA-Z0-9\-.]*) \'([a-zA-Z0-9\-.]*)\' - Multistep Probe enabled\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="Domain" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ServiceType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="ServiceName" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" Categories="configuration;cpuload" SortCondition="Timestamp" SortMethod="descending">
		<Name>{Condition:SectionName} {Condition:Timestamp} Probe was enabled on the service {Condition:ServiceName}, Service Type: {Condition:ServiceType}, transaction id {Condition:TransactionID}</Name>
		<DisplayMessage>Logs note that the probe was enabled during a transaction {Condition:Timestamp} on the service {Condition:ServiceName}, this service is of the type {Condition:ServiceType} and had a transaction id of {Condition:TransactionID}.</DisplayMessage>
		<URL description="DataPower SOA Appliance Probe - Setting the limit for concurrent transactions (also notes debugging only not production): ">http://www.ibm.com/support/docview.wss?uid=swg21367127</URL>
		<URL description="dwAnswers: How to disable the probe: ">https://developer.ibm.com/answers/questions/28078/how-do-i-disable-the-probe-on-datapower.html</URL>
		<URL description="Webcast Replay: Tips and Tricks for Use of the DataPower Multistep Probe Debugging Tool: ">http://www.ibm.com/support/docview.wss?uid=swg27042061</URL>
		<Expression LogLevel="Warning">
			<Section Name="-log" Wildcard="True" XPath="/Root/text()" ReadNextSection="True"/>
			<Section Name="DefaultLogBeforeReload" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".log" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>: Multistep Probe enabled</IndexSearch>
			<RegExp>\b([0-9TZ.]+) [a-zA-Z0-9_.\-\[\] ]* ([a-zA-Z]*)\(([a-zA-Z0-9.\-_ ]*)\): tid\(([0-9]*)\)[a-zA-Z0-9_.\-\[\]. ]*: Multistep Probe enabled\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ServiceType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ServiceName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="TransactionID" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" Categories="configuration;cpuload" SortCondition="Timestamp" SortMethod="descending">
		<Name>{Condition:SectionName} {Condition:Timestamp} Probe was enabled on the service {Condition:ServiceName}, Service Type: {Condition:ServiceType}, transaction id {Condition:TransactionID}</Name>
		<DisplayMessage>Logs note that the probe was enabled during a transaction {Condition:Timestamp} on the service {Condition:ServiceName}, this service is of the type {Condition:ServiceType} and had a transaction id of {Condition:TransactionID}.</DisplayMessage>
		<URL description="DataPower SOA Appliance Probe - Setting the limit for concurrent transactions (also notes debugging only not production): ">http://www.ibm.com/support/docview.wss?uid=swg21367127</URL>
		<URL description="dwAnswers: How to disable the probe: ">https://developer.ibm.com/answers/questions/28078/how-do-i-disable-the-probe-on-datapower.html</URL>
		<URL description="Webcast Replay: Tips and Tricks for Use of the DataPower Multistep Probe Debugging Tool: ">http://www.ibm.com/support/docview.wss?uid=swg27042061</URL>
		<Expression LogLevel="Warning">
			<Section Name="-log" Wildcard="True" XPath="/Root/text()" ReadNextSection="True"/>
			<Section Name="DefaultLogBeforeReload" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".log" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>[request]: Multistep Probe enabled</IndexSearch>
			<RegExp>\b([0-9TZ.]+) [a-zA-Z0-9_.\-\[\] ]* ([a-zA-Z]*)\(([a-zA-Z0-9.\- ]*)\): tid\(([0-9]+)\)\[request\]: Multistep Probe enabled\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ServiceType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ServiceName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="TransactionID" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- end probe checks -->

	<!-- port conflict checks-->
	<Formula Categories="configuration" SortCondition="Timestamp" SortMethod="descending">
		<Name>&lt;font color='red'&gt;{Condition:SectionName}&lt;/font&gt; {Condition:Timestamp} Service &lt;font color='red'&gt;{Condition:ServiceName}&lt;/font&gt;, Service Type: {Condition:ServiceType}: conflicting with registration of IP:port &lt;font color='red'&gt;{Condition:IPHostConflict}&lt;/font&gt;, it is owned by &lt;font color='red'&gt;{Condition:OwnedByServiceName}&lt;/font&gt; in domain &lt;font color='red'&gt;{Condition:OwnedByDomain}&lt;/font&gt;.</Name>
		<Expression LogLevel="Error">
			<Section Name="-log" Wildcard="True" XPath="/Root/text()" ReadNextSection="True"/>
			<Section Name="DefaultLogBeforeReload" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".log" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>: Request to activate gateway on</IndexSearch>
			<RegExp>\b([0-9TZ.]+) \[[0-9a-ex]+\]\[[a-zA-Z0-9_.-]+\]\[[a-zA-Z0-9_.-]+\] ([a-zA-Z0-9_.-]+)\(([a-zA-Z0-9_.-]+)\): tid\([0-9]+\): Request to activate gateway on ([a-zA-Z0-9_.:]+) failed. The conflicting registration is owned by ([a-zA-Z0-9_.-]+) in domain ([a-zA-Z0-9_.-]+)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ServiceType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ServiceName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="IPHostConflict" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="5" RegGroup="All" ConditionName="OwnedByServiceName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="6" RegGroup="All" ConditionName="OwnedByDomain" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration" SortCondition="Timestamp" SortMethod="descending">
		<Name>&lt;font color='red'&gt;{Condition:CurrentDomain}&lt;/font&gt; {Condition:Timestamp} Service &lt;font color='red'&gt;{Condition:ServiceName}&lt;/font&gt;, Service Type: {Condition:ServiceType}: conflicting with registration of IP:port &lt;font color='red'&gt;{Condition:IPHostConflict}&lt;/font&gt;, it is owned by &lt;font color='red'&gt;{Condition:OwnedByServiceName}&lt;/font&gt; in domain &lt;font color='red'&gt;{Condition:OwnedByDomain}&lt;/font&gt;.</Name>
		<Expression LogLevel="Error">
			<Section Name="default-log" Wildcard="True" XPath="/Root/text()" ReadNextSection="True"/>
			<Section Name="DefaultLogBeforeReload" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".log" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>: Request to activate gateway on</IndexSearch>
			<RegExp>\b([0-9TZ.]+) \[([a-zA-Z0-9_.-]+)\]\[[0-9a-ex]+\]\[[a-zA-Z0-9_.-]+\]\[[a-zA-Z0-9_.-]+\] ([a-zA-Z0-9_.-]+)\(([a-zA-Z0-9_.-]+)\): tid\([0-9]+\): Request to activate gateway on ([a-zA-Z0-9_.:]+) failed. The conflicting registration is owned by ([a-zA-Z0-9_.-]+) in domain ([a-zA-Z0-9_.-]+)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="CurrentDomain" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ServiceType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="ServiceName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="5" RegGroup="All" ConditionName="IPHostConflict" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="6" RegGroup="All" ConditionName="OwnedByServiceName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="7" RegGroup="All" ConditionName="OwnedByDomain" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- port conflict checks-->
	
	<Formula Categories="configuration;failure;cpuload;memory" SortCondition="CompileTime" SortMethod="descending">
		<Name>{Condition:SectionName} StylesheetStatusSimpleIndex Reports XML Manager {/Status//StylesheetStatusSimpleIndex/XMLManager/text()} has file {/Status//StylesheetStatusSimpleIndex/URL/text()} compile time {/Status//StylesheetStatusSimpleIndex/CompileSpeed} milliseconds and compiled on {/Status//StylesheetStatusSimpleIndex/LastRefresh}</Name>
		<URL description="WebSphere DataPower SOA Appliance performance tuning: ">http://www.ibm.com/developerworks/library/ws-dpperformance/</URL>
		<Expression LogLevel="Warning">
			<Section Name="StylesheetStatusSimpleIndex" Wildcard="True" XPath="/Status//StylesheetStatusSimpleIndex/CompileSpeed"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="CompileTime" Operation="GreaterThan" Value="999" NextOperation="And"/>
			<Condition FieldPosition="{/Status//StylesheetStatusSimpleIndex/URL}" ConditionName="URL" Operation="NotContain" Value="store:///dp/aaapolicy.xsl"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="StylesheetStatusSimpleIndex" Wildcard="True" XPath="/Status//StylesheetStatusSimpleIndex/CompileSpeed"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="CompileTime" Operation="GreaterThan" Value="5000" NextOperation="And"/>
			<Condition FieldPosition="{/Status//StylesheetStatusSimpleIndex/URL}" ConditionName="URL" Operation="Contains" Value="store:///dp/aaapolicy.xsl"/>
		</Expression>
	</Formula>
	
	<!-- Begin WSRR/WSDL Subscription Checks -->
	<Formula Categories="configuration">
		<Name>{Condition:SectionName} WSRRSubscriptionStatus Reports Subscription {/Status//WSRRSubscriptionStatus/Subscription} is in {/Status//WSRRSubscriptionStatus/Status} State</Name>
		<DisplayMessage>WSRRSubscriptionStatus reports the Subscription {/Status//WSRRSubscriptionStatus/Subscription} is in {/Status//WSRRSubscriptionStatus/Status} state.</DisplayMessage>
			<Expression LogLevel="Warning">
			<Section Name="WSRRSubscriptionStatus" Wildcard="True" XPath="/Status//WSRRSubscriptionStatus/Status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value="Okay"/>
			</Expression>
	</Formula>
	
	<!-- This will handle WSDL's that have a log message available to help the user determine the problem -->
	<Formula Categories="configuration">
		<Name>{Condition:SectionName} WSWSDLStatusSimpleIndex Reports WSDL {/Status//WSWSDLStatusSimpleIndex/WSDLSourceLocation} in the WSP {/Status//WSWSDLStatusSimpleIndex/WSGateway} is in {/Status//WSWSDLStatusSimpleIndex/Status} State</Name>
		<DisplayMessage>WSWSDLStatusSimpleIndex Reason Message: {/Status//WSWSDLStatusSimpleIndex/Log}</DisplayMessage>
			<Expression LogLevel="Warning" NextOperation="And">
			<Section Name="WSWSDLStatusSimpleIndex" Wildcard="True" XPath="/Status//WSWSDLStatusSimpleIndex/Status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value="Okay"/>
			</Expression>
			<Expression LogLevel="Warning">
			<Section Name="WSWSDLStatusSimpleIndex" Wildcard="True" XPath="/Status//WSWSDLStatusSimpleIndex/Log"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value=""/>
			</Expression>
	</Formula>
	
	<!-- This will handle WSDL's that have no log message recorded -->
	<Formula Categories="configuration">
		<Name>{Condition:SectionName} WSWSDLStatusSimpleIndex Reports WSDL {/Status//WSWSDLStatusSimpleIndex/WSDLSourceLocation} in the WSP {/Status//WSWSDLStatusSimpleIndex/WSGateway} is in {/Status//WSWSDLStatusSimpleIndex/Status} State</Name>
		<DisplayMessage>WSWSDLStatusSimpleIndex has no reason message recorded.</DisplayMessage>
			<Expression LogLevel="Warning" NextOperation="And">
			<Section Name="WSWSDLStatusSimpleIndex" Wildcard="True" XPath="/Status//WSWSDLStatusSimpleIndex/Status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value="Okay"/>
			</Expression>
			<Expression LogLevel="Warning">
			<Section Name="WSWSDLStatusSimpleIndex" Wildcard="True" XPath="/Status//WSWSDLStatusSimpleIndex/Log"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value=""/>
			</Expression>
	</Formula>
	<!-- End WSRR/WSDL Subscription Checks -->
	
	<Formula CollapseResult="true" Categories="configuration;cpuload" FormulaID="BadDocumentCache">
		<Name>&lt;font color='#CC3300'&gt;{Condition:SectionName}&lt;/font&gt; There is a document cache, &lt;font color='#CC3300'&gt;{Condition:ObjectName}&lt;/font&gt; configured allowing &lt;font color='#CC3300'&gt;{Condition:BytesPerDocument} bytes&lt;/font&gt; per document.  Caches set to 0 bytes will not cache, others may get full before document count is reached.</Name>
		<DisplayMessage>Max Document Count: &lt;b&gt;{Condition:MaxDocsCount}&lt;/b&gt;, Max Cache Size (Bytes): &lt;b&gt;{Condition:MaxSizeBytes}&lt;/b&gt;</DisplayMessage>
		<URL FormulaIDMatch="V600FirmwareCheck" description="IBM Knowledge Center - DataPower Document cache policies: ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_6.0.0/com.ibm.dp.xi.doc/xmlmanager_documentcache_policies.html</URL>
		<URL FormulaIDMatch="V601FirmwareCheck" description="IBM Knowledge Center - DataPower Document cache policies: ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_6.0.1/com.ibm.dp.xi.doc/xmlmanager_documentcache_policies.html</URL>
		<URL FormulaIDMatch="V700FirmwareCheck" description="IBM Knowledge Center - DataPower Document cache policies: ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_7.0.0/com.ibm.dp.xi.doc/xmlmanager_documentcache_policies.html</URL>
		<URL FormulaIDMatch="V710FirmwareCheck" description="IBM Knowledge Center - DataPower Document cache policies: ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_7.1.0/com.ibm.dp.doc/xmlmanager_documentcache_policies.html</URL>
		<URL FormulaIDMatch="V720FirmwareCheckOrGreater" description="IBM Knowledge Center - DataPower Document cache policies: ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_7.2.0/com.ibm.dp.doc/xmlmanager_documentcache_policies.html</URL>
		<Expression LogLevel="Warning">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>documentcache \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(maxdocs \"([0-9]+)\"|exit)</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="MaxDocsCount" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="MaxSizeBytes" Operation="NotEqualTo" Value="" NextOperation="And">documentcache \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(size \"([0-9]+)\"|exit)</Condition>
			<Condition FieldPosition="{Condition:MaxSizeBytes}" RegGroup="All" ConditionName="BytesPerDocument" Operation="DivideBy" Value="{Condition:MaxDocsCount}" NextOperation="And"/>
			<Condition FieldPosition="{Condition:BytesPerDocument}" RegGroup="All" Operation="LessThan" Value="1000"/>
		</Expression>
	</Formula>
	
	<!-- MQ configuration search for cache-timeout -->
	<Formula Categories="configuration;cpuload" FormulaID="MQCacheTimeout">
		<Name>&lt;font color='#CC3300'&gt;{Condition:SectionName}&lt;/font&gt; There is an MQ-QM Object &lt;font color='#CC3300'&gt;{Condition:ObjectName}&lt;/font&gt; configured without a cache-timeout</Name>
		<URL description="WebSphere DataPower SOA Appliance MQ Queue Manager Object's connections are not closed as expected (cache-timeout default value is unlimited and connections may not be closed even if terminated on the MQ end): ">http://www.ibm.com/support/docview.wss?uid=swg21380213</URL>
		<Expression LogLevel="Critical">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>mq-qm \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(cache-timeout ([1-9]+)|exit)</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="CacheTimeout" Operation="EqualsTo" Value="exit"/> <!-- if default of 0 -->
		</Expression>
	</Formula>
	<!-- End of MQ configuration search -->
	
	<!-- MQ Config search for retry interval of 0 -->
	<Formula Categories="configuration;cpuload" FormulaID="MQLongRetryNotSet">
		<Name>&lt;font color='#CC3300'&gt;{Condition:SectionName}&lt;/font&gt; There is an MQ-QM Object &lt;font color='#CC3300'&gt;{Condition:ObjectName}&lt;/font&gt; configured with the default retry attempts of 0.</Name>
		<DisplayMessage>{Condition:ObjectName} is configured without a retry attempt value, the default value is 0 and negates long retry intervals.</DisplayMessage>
		<URL description="WebSphere DataPower spikes with high CPU when WebSphere MQ connection is unavailable: ">http://www.ibm.com/support/docview.wss?uid=swg21431301</URL>
		<Expression LogLevel="Critical">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>mq-qm \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(retry-attempts ([1-9]+)|exit)</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ConfigInfo" Operation="EqualsTo" Value="exit"/>
		</Expression>
	</Formula>
	
	<!-- end MQ Config search for retry interval -->
	
	<!-- Backtrace search for objects related to reloads -->
	<Formula Categories="failure">
		<Name>Backtrace on {Condition:Timestamp} Contained Configuration Object Information: Component={Condition:Component}, Domain={Condition:Domain}, Config={Condition:Config}</Name>
		<DisplayMessage>Component={Condition:Component}, Domain={Condition:Domain}, Config={Condition:Config} should be reviewed further as it could be related to a reload of the appliance.</DisplayMessage>
		<URL description="Backtrace generated during reload notes domain and configuration object: ">http://www.ibm.com/support/docview.wss?uid=swg21652035</URL>
		<Expression LogLevel="Critical">
			<Section Name="Backtrace" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And">(Mon|Tue|Wed|Thu|Fri|Sat|Sun)(\s)([a-zA-Z].*)(\s+(.+))</Condition>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Component" Operation="NotEqualTo" Value="" NextOperation="And">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="Domain" Operation="NotEqualTo" Value="" NextOperation="And">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="Config" Operation="NotEqualTo" Value="">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
		</Expression>
	</Formula>
	
	<!-- 6.0 backtrace search -->
	<Formula Categories="failure">
		<Name>Backtrace on {Condition:Timestamp} Contained Configuration Object Information: Component={Condition:Component}, Domain={Condition:Domain}, Config={Condition:Config}</Name>
		<DisplayMessage>Component={Condition:Component}, Domain={Condition:Domain}, Config={Condition:Config} should be reviewed further as it could be related to a reload of the appliance.</DisplayMessage>
		<URL description="Backtrace generated during reload notes domain and configuration object: ">http://www.ibm.com/support/docview.wss?uid=swg21652035</URL>
		<Expression LogLevel="Critical">
			<Section Name="Backtrace" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And">Thread 0x[0-9a-fA-F]*\: (\d{4}\-\d{2}\-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z)</Condition>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Component" Operation="NotEqualTo" Value="" NextOperation="And">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="Domain" Operation="NotEqualTo" Value="" NextOperation="And">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="Config" Operation="NotEqualTo" Value="">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
		</Expression>
	</Formula>
	<!-- End of backtrace search -->
	
	<!-- search for use of shutdown reboot -->
	<Formula Categories="general" SortCondition="Timestamp" SortMethod="descending">
		<Name>Customer rebooted/halted the box on {Condition:Timestamp} with the command: {Condition:Command}</Name>
		<DisplayMessage>{Condition:SectionName} - {Condition:LogMsg}</DisplayMessage>
		<Expression LogLevel="Warning">
			<Section Name="AuditLog" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>shutdown </IndexSearch>
			<RegExp>([0-9TZ.]+).*(shutdown (reload|reboot|halt)\s\d{0,2})(.*)</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="Command" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" RegGroup="All" ConditionName="LogMsg" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- End of shutdown reboot search -->
	
	<!-- search for use of restart domain -->
	<Formula Categories="general" SortCondition="Timestamp" SortMethod="descending">
		<Name>{Condition:SectionName} {Condition:Timestamp} Restart domain issued inside domain {Condition:Domain}, if default domain, command may include domain name.</Name>
		<DisplayMessage>Customer restarted a domain with the command: "{Condition:Command}", this was issued inside domain {Condition:Domain} at {Condition:Timestamp}.</DisplayMessage>
		<Expression LogLevel="Warning">
			<Section Name="AuditLog" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>restart domain</IndexSearch>
			<RegExp>\b([0-9TZ.]+).* \([a-zA-Z-_.0-9]+:([a-zA-Z-_.0-9]+):[a-zA-Z-_.0-9]+:[a-zA-Z-_.0-9]+\):.* (restart domain.*)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="Domain" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="Command" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="general">
		<Name>{Condition:SectionName} Customer restarted a domain at {Condition:Timestamp} with command: {Condition:Domain}</Name>
		<DisplayMessage>Domain restarted at {Condition:Timestamp} domain name: {Condition:Domain}</DisplayMessage>
		<Expression LogLevel="Warning">
			<Section Name="CLILog" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>restart domain</IndexSearch>
			<RegExp>1,([0-9TZ.]+),([a-zA-Z0-9-._]+),.*: (restart domain [a-zA-Z0-9-._"]+)</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="Domain" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- End of restart domain search -->
	
	<Formula Categories="general">
		<Name>{Condition:SectionName} User {Condition:User} at {Condition:ClientIP} deleted a domain at {Condition:Timestamp} inside domain {Condition:DomainRanIn} using the command: {Condition:Command}</Name>
		<Expression LogLevel="Warning">
			<Section Name="CLILog" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>no domain</IndexSearch>
			<RegExp>1,([0-9TZ.]+),([a-zA-Z0-9-._]+),cli,debug,,,0,,,[a-zA-Z0-9]+,,,"\(([a-zA-Z0-9-._]+):([a-zA-Z0-9-._]+):([a-zA-Z0-9-._]+):([a-zA-Z0-9-._]+)\): (no domain [a-zA-Z0-9-._"]+)</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="DomainRanIn" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="User" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="6" RegGroup="All" ConditionName="ClientIP" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="7" RegGroup="All" ConditionName="Command" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<!-- Interface search for preempt on -->
		<Formula Categories="configuration;network">
		<Name>Interface {Condition:ObjectName} is configured with 'preempt on' in standby control, this is not recommended.</Name>
		<DisplayMessage>Interface {Condition:ObjectName} is configured with preempt on in standby control, this is not recommended, review Step #5 in Troubleshooting: Standby Control.</DisplayMessage>
		<URL description="Troubleshooting: Standby Control not working correctly on DataPower Appliance: ">http://www.ibm.com/support/docview.wss?uid=swg21420179</URL>
		<Expression LogLevel="Critical" FormulaIDMatch="V720FirmwareCheckOrGreater">
			<Section Name="default-config" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\b(ethernet|interface) \"([a-zA-Z-_.0-9]+)"\W+(\w+\W+)*?([no ]{0,3}standby-preempt|exit)\b</RegExp>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="ConfigInfo" Operation="EqualsTo" Value="standby-preempt"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;network">
		<Name>Interface {Condition:ObjectName} is configured with 'preempt on' in standby control, this is not recommended.</Name>
		<DisplayMessage>Interface {Condition:ObjectName} is configured with preempt on in standby control, this is not recommended, review Step #5 in Troubleshooting: Standby Control.</DisplayMessage>
		<URL description="Troubleshooting: Standby Control not working correctly on DataPower Appliance: ">http://www.ibm.com/support/docview.wss?uid=swg21420179</URL>
		<Expression LogLevel="Critical" FormulaIDMatch="V710FirmwareCheckOrLower">
			<Section Name="default-config" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And">\b(interface \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit)\b</Condition>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ConfigInfo" Operation="Contains" Value="preempt on">\b(interface \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit)\b</Condition>
		</Expression>
	</Formula>
	
	<!-- end Interface Config search for retry interval -->
	
	
	<!-- Search for modified xml managers bytes scanned -->
	<Formula CollapseResult="true" Categories="configuration;memory" SortCondition="BytesScanned">
		<Name>{Condition:SectionName} Contains a modified bytes-scanned of {Condition:BytesScanned} bytes, xml manager {Condition:XMLManager} allowing larger documents.</Name>
		<DisplayMessage>XML Manager {Condition:XMLManager} has a custom bytes-scanned value of {Condition:BytesScanned} bytes.  This means that the service can accept larger messages, this is noted in customer situations where memory may be high that services tied to this XML Manager may be a contributor.</DisplayMessage>
		<Expression LogLevel="Warning">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<!-- FieldPositions, 0=XMLMgr Config, 1=XML Manager name (without quotes), 2=N/A, 3=bytes-scanned #num#, 4=#num# of bytes scanned
						0=xmlmgr "default" ... exit, 1=default,2=N/A,3=bytes-scanned 4194304, 4=4194304 -->
			<RegExp>\bxmlmgr \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?(bytes-scanned ([0-9]+)|exit)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="XMLManager" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<!-- the default value of the XML Manager bytes-scanned is 4194304, if it is greater than it is likely a modified object -->
			<Condition FieldPosition="4" RegGroup="All" ConditionName="BytesScanned" Operation="GreaterThan" Value="4194304" NextOperation="And"/>
			<!-- the XML Manager for stream based services has a default Bytes-Scanned of 268435456, so lets just omit those since they will always exist -->
			<Condition FieldPosition="4" RegGroup="All" Operation="NotEqualTo" Value="268435456"/>
		</Expression>
	</Formula>
	<!-- End of search xml managers -->
	
	
	<!-- track DNS TTL APAR IC97354 -->
	
	<Formula Categories="configuration;network;memory">
		<Name>DataPower DNS Round Robin Algorithm does not honor time to live on hostname entries (v4.0.2.15 and below affected).</Name>
		<DisplayMessage>The round robin algorithm does not honor the DNS time to live on the hostname.  This issue can be worked around by using the first-alive algorithm in the DNS Settings or upgrading to a newer fixpack.</DisplayMessage>
		<URL description="APAR IC97354 DP Does Not Honor TTL Value Passed in DNS CName Record: ">http://www.ibm.com/support/docview.wss?uid=swg1IC97354</URL>
		<Expression LogLevel="Error" NextOperation="And">
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="4" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="2" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="16"/>
		</Expression>
		<Expression LogLevel="Error">
			<Section Name="default-config" Wildcard="True" XPath="/Root/text()"/>
			<!-- FieldPositions, 0=dns config, 1=N/A, 2=load-balance <value>, 3=<value>
						0=dns config... exit,1=N/A,2=load-balance first-alive, 3=first-alive -->
			<RegExp>\bdns\W+(\w+\W+)*?(load-balance ([a-zA-Z\-]+)|exit)\b</RegExp>
			<!-- the XML Manager for stream based services has a default Bytes-Scanned of 268435456, so lets just omit those since they will always exist -->
			<Condition FieldPosition="2" RegGroup="All" Operation="EqualsTo" Value="exit"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;network;memory">
		<Name>DataPower DNS Round Robin Algorithm does not honor time to live on hostname entries (v5.0.0.11 and below affected).</Name>
		<DisplayMessage>The round robin algorithm does not honor the DNS time to live on the hostname and thus does not cache entries.  This issue can be worked around by using the first-alive algorithm in the DNS Settings or upgrading to a newer fixpack.</DisplayMessage>
		<URL description="APAR IC97354 DP Does Not Honor TTL Value Passed in DNS CName Record: ">http://www.ibm.com/support/docview.wss?uid=swg1IC97354</URL>
		<Expression LogLevel="Error" NextOperation="And">
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="5" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="12"/>
		</Expression>
		<Expression LogLevel="Error">
			<Section Name="default-config" Wildcard="True" XPath="/Root/text()"/>
			<!-- FieldPositions, 0=dns config, 1=N/A, 2=load-balance <value>, 3=<value>
						0=dns config... exit,1=N/A,2=load-balance first-alive, 3=first-alive -->
			<RegExp>\bdns\W+(\w+\W+)*?(load-balance ([a-zA-Z\-]+)|exit)\b</RegExp>
			<!-- the XML Manager for stream based services has a default Bytes-Scanned of 268435456, so lets just omit those since they will always exist -->
			<Condition FieldPosition="2" Operation="EqualsTo" Value="exit"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;network;memory">
		<Name>DataPower DNS Round Robin Algorithm does not honor time to live on hostname entries (v6.0.0.3 and below affected).</Name>
		<DisplayMessage>The round robin algorithm does not honor the DNS time to live on the hostname and thus does not cache entries.  This issue can be worked around by using the first-alive algorithm in the DNS Settings or upgrading to a newer fixpack.</DisplayMessage>
		<URL description="APAR IC97354 DP Does Not Honor TTL Value Passed in DNS CName Record: ">http://www.ibm.com/support/docview.wss?uid=swg1IC97354</URL>
		<Expression LogLevel="Error" NextOperation="And">
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="4"/>
		</Expression>
		<Expression LogLevel="Error">
			<Section Name="default-config" Wildcard="True" XPath="/Root/text()"/>
			<!-- FieldPositions, 0=dns config, 1=N/A, 2=load-balance <value>, 3=<value>
						0=dns config... exit,1=N/A,2=load-balance first-alive, 3=first-alive -->
			<RegExp>\bdns\W+(\w+\W+)*?(load-balance ([a-zA-Z\-]+)|exit)\b</RegExp>
			<!-- the XML Manager for stream based services has a default Bytes-Scanned of 268435456, so lets just omit those since they will always exist -->
			<Condition FieldPosition="2" RegGroup="All" Operation="EqualsTo" Value="exit"/>
		</Expression>
	</Formula>
	
	<!-- end of track DNS TTL APAR IC97354 -->
	
	
	<!-- Search for use of dns config first-alive -->
	
	<Formula Categories="configuration;network;memory">
		<Name>DataPower has the DNS configuration set to load-balance as first-alive, this is not recommended.</Name>
		<DisplayMessage>In certain circumstances latency issues can arise if the DNS server is unresponsive, it is advised to use round-robin in the DNS configuration instead of first-alive.</DisplayMessage>
		<Expression LogLevel="Warning">
			<Section Name="default-config" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<!-- FieldPositions, 0=dns config, 1=N/A, 2=load-balance <value>, 3=<value>
						0=dns config... exit,1=N/A,2=load-balance first-alive, 3=first-alive -->
			<RegExp>\bdns\W+(\w+\W+)*?(load-balance ([a-zA-Z\-]+)|exit)\b</RegExp>
			<!-- the XML Manager for stream based services has a default Bytes-Scanned of 268435456, so lets just omit those since they will always exist -->
			<Condition FieldPosition="3" RegGroup="All" Operation="EqualsTo" Value="first-alive"/>
		</Expression>
	</Formula>
	<!-- End of search dns -->
		
		
	<!-- Bad physical memory track -->
	<Formula Categories="hardware">
		<Name>Customer has an issue with their physical memory module, error: {/Hardware/diagmemorydisabled}</Name>
		<DisplayMessage>This typically indicates the device has bad physical memory, the device can be rebooted to see if this message goes away, otherwise the device must be replaced.</DisplayMessage>
		<Expression LogLevel="Critical">
			<Section Name="Hardware" XPath="/Hardware/diagmemorydisabled"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value=""/>
			</Expression>
	</Formula>
	<!-- End bad physical memory -->
	
	<!-- Search memory section for nuclear event -->
	<Formula Categories="failure">
		<Name>{Condition:SectionName} notes that the device went nuclear and memory was collected {Condition:MemTimesCollected} times, starting {Condition:ZuluDate}{Condition:ZuluTime}.  Local time recorded as {Condition:LocalTime} (local time can be different than zulu indicating another throttle event more recently).</Name>
		<DisplayMessage>This indicates the device likely throttled due to low memory starting at {Condition:ZuluDate}{Condition:ZuluTime} (indicates first throttle).  There is a local time of {Condition:LocalTime} which may represent a more recent throttle event.</DisplayMessage>
		<Expression LogLevel="Error">
			<Section Name="Memory" XPath="/Root/text()"/>
			<!-- FieldPositions, 0=Memory collected line, 1=DateTime, 2=Day, 3=Amount of times mem collected, 4=Zulu date,5=Zulu time -->
			<RegExp>\b((Mon|Tue|Wed|Thu|Fri|Sat|Sun) [a-zA-Z0-9 :]+): Memory collected (\d+) times, starting (\d{8}T)(\d{6}Z)\b</RegExp>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="MemTimesCollected" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="ZuluDate" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="5" RegGroup="All" ConditionName="ZuluTime" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="LocalTime" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- End of nuclear memory search -->
	
	
	<!-- domain mem status -->
	<Formula OmitPrintingMetConditions="true" Categories="memory" SortCondition="MemUsage" SortMethod="Descending">
		<Name>Domain {/Status/DomainsMemoryStatus//Domain} reports memory usage.  DocCacheSize: {/Status/DomainsMemoryStatus//DocumentCaches} KB, StylesheetCacheSize: {/Status/DomainsMemoryStatus//StylesheetCaches} KB</Name>
		<DisplayMessage>Kilobyte buckets (ex. 500 = 500Kb, 1000 = 1Mb), Buckets - Current: {/Status/DomainsMemoryStatus//ServicesCurrent}, 1m: {/Status/DomainsMemoryStatus//ServicesOneMinute}, 5m: {/Status/DomainsMemoryStatus//ServicesFiveMinutes}, 10m: {/Status/DomainsMemoryStatus//ServicesTenMinutes}, 1hr: {/Status/DomainsMemoryStatus//ServicesOneHour}, 12hr: {/Status/DomainsMemoryStatus//ServicesTwelveHours}, day: {/Status/DomainsMemoryStatus//ServicesOneDay}, lifetime: {/Status/DomainsMemoryStatus//ServicesLifetime}.</DisplayMessage>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="DomainsMemoryStatus" Wildcard="True" XPath="/Status/DomainsMemoryStatus//ServicesCurrent"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="DomainsMemoryStatus" Wildcard="True" XPath="/Status/DomainsMemoryStatus//ServicesOneMinute"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="DomainsMemoryStatus" Wildcard="True" XPath="/Status/DomainsMemoryStatus//ServicesFiveMinutes"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="DomainsMemoryStatus" Wildcard="True" XPath="/Status/DomainsMemoryStatus//ServicesTenMinutes"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="DomainsMemoryStatus" Wildcard="True" XPath="/Status/DomainsMemoryStatus//ServicesOneHour"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="DomainsMemoryStatus" Wildcard="True" XPath="/Status/DomainsMemoryStatus//ServicesTwelveHours"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="DomainsMemoryStatus" Wildcard="True" XPath="/Status/DomainsMemoryStatus//ServicesOneDay"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="DomainsMemoryStatus" Wildcard="True" XPath="/Status/DomainsMemoryStatus//ServicesLifetime"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
	</Formula>
	
	
	<!-- 7.2+ -->
	<Formula OmitPrintingMetConditions="true" Categories="memory" SortCondition="MemUsage" SortMethod="Descending">
		<Name>Domain {/Status/DomainsMemoryStatus2//Domain} reports memory usage.  DocCacheSize: {/Status/DomainsMemoryStatus2//DocumentCaches} KB, StylesheetCacheSize: {/Status/DomainsMemoryStatus2//StylesheetCaches} KB</Name>
		<DisplayMessage>Kilobyte buckets (ex. 500 = 500Kb, 1000 = 1Mb), Buckets - Current: {/Status/DomainsMemoryStatus2//ServicesCurrent}, 1m: {/Status/DomainsMemoryStatus2//ServicesOneMinute}, 5m: {/Status/DomainsMemoryStatus2//ServicesFiveMinutes}, 10m: {/Status/DomainsMemoryStatus2//ServicesTenMinutes}, 1hr: {/Status/DomainsMemoryStatus2//ServicesOneHour}, 12hr: {/Status/DomainsMemoryStatus2//ServicesTwelveHours}, day: {/Status/DomainsMemoryStatus2//ServicesOneDay}, lifetime: {/Status/DomainsMemoryStatus2//ServicesLifetime}.</DisplayMessage>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="DomainsMemoryStatus2" Wildcard="True" XPath="/Status/DomainsMemoryStatus2//ServicesCurrent"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="DomainsMemoryStatus2" Wildcard="True" XPath="/Status/DomainsMemoryStatus2//ServicesOneMinute"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="DomainsMemoryStatus2" Wildcard="True" XPath="/Status/DomainsMemoryStatus2//ServicesFiveMinutes"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="DomainsMemoryStatus2" Wildcard="True" XPath="/Status/DomainsMemoryStatus2//ServicesTenMinutes"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="DomainsMemoryStatus2" Wildcard="True" XPath="/Status/DomainsMemoryStatus2//ServicesOneHour"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="DomainsMemoryStatus2" Wildcard="True" XPath="/Status/DomainsMemoryStatus2//ServicesTwelveHours"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="DomainsMemoryStatus2" Wildcard="True" XPath="/Status/DomainsMemoryStatus2//ServicesOneDay"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="DomainsMemoryStatus2" Wildcard="True" XPath="/Status/DomainsMemoryStatus2//ServicesLifetime"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
	</Formula>
	<!-- end of domain mem status -->
	
	<!-- Check services for memory usage higher than 100MB -->
	<Formula OmitPrintingMetConditions="true" Categories="memory" SortCondition="MemUsage" SortMethod="Descending">
		<Name>{Condition:SectionName} High Memory usage in service {/Status/ServicesMemoryStatus//serviceName}, type of service: ({/Status/ServicesMemoryStatus//serviceClass})</Name>
		<DisplayMessage>Should a device be encountering high memory usage, these are the services using high memory, {/Status/ServicesMemoryStatus//serviceName} service kilobyte buckets (ex. 500 = 500Kb, 1000 = 1Mb), Buckets - Current: {/Status/ServicesMemoryStatus//current}, 1m: {/Status/ServicesMemoryStatus//oneMinute}, 5m: {/Status/ServicesMemoryStatus//fiveMinutes}, 10m: {/Status/ServicesMemoryStatus//tenMinutes}, 1hr: {/Status/ServicesMemoryStatus//oneHour}, 12hr: {/Status/ServicesMemoryStatus//twelveHours}, day: {/Status/ServicesMemoryStatus//oneDay}, lifetime: {/Status/ServicesMemoryStatus//lifetime}.</DisplayMessage>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryStatus" Wildcard="True" XPath="/Status/ServicesMemoryStatus//current"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryStatus" Wildcard="True" XPath="/Status/ServicesMemoryStatus//oneMinute"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryStatus" Wildcard="True" XPath="/Status/ServicesMemoryStatus//fiveMinutes"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryStatus" Wildcard="True" XPath="/Status/ServicesMemoryStatus//tenMinutes"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryStatus" Wildcard="True" XPath="/Status/ServicesMemoryStatus//oneHour"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryStatus" Wildcard="True" XPath="/Status/ServicesMemoryStatus//twelveHours"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryStatus" Wildcard="True" XPath="/Status/ServicesMemoryStatus//oneDay"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryStatus" Wildcard="True" XPath="/Status/ServicesMemoryStatus//lifetime"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
	</Formula>
	
	<!-- 7.2+ -->
	<Formula OmitPrintingMetConditions="true" Categories="memory" SortCondition="MemUsage" SortMethod="Descending">
		<Name>{Condition:SectionName} High Memory usage in service {/Status/ServicesMemoryStatus2//serviceName}, type of service: ({/Status/ServicesMemoryStatus2//serviceClass})</Name>
		<DisplayMessage>Should a device be encountering high memory usage, these are the services using high memory, {/Status/ServicesMemoryStatus2//serviceName} service megabyte buckets (ex. 100 = 100MB, 1000 = 1GB), Buckets - Current: {/Status/ServicesMemoryStatus2//current}, 1m: {/Status/ServicesMemoryStatus2//oneMinute}, 5m: {/Status/ServicesMemoryStatus2//fiveMinutes}, 10m: {/Status/ServicesMemoryStatus2//tenMinutes}, 1hr: {/Status/ServicesMemoryStatus2//oneHour}, 12hr: {/Status/ServicesMemoryStatus2//twelveHours}, day: {/Status/ServicesMemoryStatus2//oneDay}, lifetime: {/Status/ServicesMemoryStatus2//lifetime}.</DisplayMessage>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryStatus2" Wildcard="True" XPath="/Status/ServicesMemoryStatus2//current"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryStatus2" Wildcard="True" XPath="/Status/ServicesMemoryStatus2//oneMinute"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryStatus2" Wildcard="True" XPath="/Status/ServicesMemoryStatus2//fiveMinutes"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryStatus2" Wildcard="True" XPath="/Status/ServicesMemoryStatus2//tenMinutes"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryStatus2" Wildcard="True" XPath="/Status/ServicesMemoryStatus2//oneHour"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryStatus2" Wildcard="True" XPath="/Status/ServicesMemoryStatus2//twelveHours"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryStatus2" Wildcard="True" XPath="/Status/ServicesMemoryStatus2//oneDay"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryStatus2" Wildcard="True" XPath="/Status/ServicesMemoryStatus2//lifetime"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100"/>
		</Expression>
	</Formula>
	<!-- end services memory usage check -->
	
		<Formula OmitPrintingMetConditions="true" Categories="memory" SortCondition="MemUsage" SortMethod="Descending">
		<Name>{Condition:SectionName} Cached Memory Status on Failure - High Memory usage in service {/Status/ServicesMemoryStatus//serviceName}, type of service: ({/Status/ServicesMemoryStatus//serviceClass})</Name>
		<DisplayMessage>Should a device be encountering high memory usage, these are the services using high memory, {/Status/ServicesMemoryStatus//serviceName} service kilobyte buckets (ex. 500 = 500Kb, 1000 = 1Mb), Buckets - Current: {/Status/ServicesMemoryStatus//current}, 1m: {/Status/ServicesMemoryStatus//oneMinute}, 5m: {/Status/ServicesMemoryStatus//fiveMinutes}, 10m: {/Status/ServicesMemoryStatus//tenMinutes}, 1hr: {/Status/ServicesMemoryStatus//oneHour}, 12hr: {/Status/ServicesMemoryStatus//twelveHours}, day: {/Status/ServicesMemoryStatus//oneDay}, lifetime: {/Status/ServicesMemoryStatus//lifetime}.</DisplayMessage>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryOnFailure" Wildcard="True" XPath="/Status/ServicesMemoryStatus//current"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryOnFailure" Wildcard="True" XPath="/Status/ServicesMemoryStatus//oneMinute"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryOnFailure" Wildcard="True" XPath="/Status/ServicesMemoryStatus//fiveMinutes"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryOnFailure" Wildcard="True" XPath="/Status/ServicesMemoryStatus//tenMinutes"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryOnFailure" Wildcard="True" XPath="/Status/ServicesMemoryStatus//oneHour"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryOnFailure" Wildcard="True" XPath="/Status/ServicesMemoryStatus//twelveHours"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryOnFailure" Wildcard="True" XPath="/Status/ServicesMemoryStatus//oneDay"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryOnFailure" Wildcard="True" XPath="/Status/ServicesMemoryStatus//lifetime"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
	</Formula>
	
	<!-- find backside connection failures -->
	<Formula Categories="network;memory" SortCondition="Timestamp" SortMethod="Descending">
		<Name>{Condition:Timestamp} NFS mount failed on {Condition:ObjectName} (nfs-static-mount), Domain: {Condition:DomainName}.</Name>
		<URL description="Tuning the NFS mount on the DataPower and B2B: ">http://www.ibm.com/support/docview.wss?uid=swg21585229</URL>
		<Expression LogLevel="Warning">
			<Section Name="-log" Wildcard="True" XPath="/Root/text()" ReadNextSection="True"/>
			<Section Name="DefaultLogBeforeReload" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".log" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>: NFS mount of</IndexSearch>
			<RegExp>\b([0-9TZ.]+) \[([a-zA-Z._\-0-9]+)\]\[0x80e002d7\]\[network-file\]\[error\] nfs-static-mount\(([a-zA-Z._\-0-9]+)\): NFS mount of ([a-zA-Z0-9-_.:?=;/\ ]*) failed\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="DomainName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="URL" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="network;memory" SortCondition="Timestamp" SortMethod="Descending">
		<Name>{Condition:SectionName} {Condition:Timestamp} Backside connection failed on {Condition:ServiceName}, Service Type: {Condition:ServiceType}, transaction id {Condition:TransactionID}</Name>
		<DisplayMessage>Logs note that we failed to establish a backside connection at {Condition:Timestamp} on the service {Condition:ServiceName}, this service is of the type {Condition:ServiceType} and had a transaction id of {Condition:TransactionID}.  The destination URL it attempted to reach was {Condition:URL}.  This type of backend failure is usually due to a service timeout being triggered, the backend may be held up (header is empty, eg. no response from backend, was only able to establish the TCP connection, but no further, no http headers).</DisplayMessage>
		<Expression LogLevel="Warning">
			<Section Name="-log" Wildcard="True" XPath="/Root/text()" ReadNextSection="True"/>
			<Section Name="DefaultLogBeforeReload" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".log" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>failed to parse due to: Failed to establish a backside connection</IndexSearch>
			<RegExp>\b([0-9TZ.]+) ([a-zA-Z0-9.-_\[\] ]*) ([a-zA-Z-_]*)\(([a-zA-Z0-9.\-_]*)\): tid\(([0-9]*)\)[a-zA-Z0-9_.\-\[\]. ]*: Backside header \('N/A'\) failed to parse due to: Failed to establish a backside connection\, URL: ([a-zA-Z0-9-_.:?=;/\ ]*)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ServiceType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="ServiceName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="5" RegGroup="All" ConditionName="TransactionID" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="6" RegGroup="All" ConditionName="URL" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="network;memory" SortCondition="Timestamp" SortMethod="Descending">
		<Name>{Condition:SectionName} {Condition:Timestamp} Backside connection failed on {Condition:ServiceName}, Service Type: {Condition:ServiceType}, transaction id {Condition:TransactionID}</Name>
		<DisplayMessage>Logs note that we failed to establish a backside connection at {Condition:Timestamp} on the service {Condition:ServiceName}, this service is of the type {Condition:ServiceType} and had a transaction id of {Condition:TransactionID}.  The destination URL it attempted to reach was {Condition:URL}.  This type of backend failure is usually related to DNS failure, look for other DNS failure entries in the logs against the same hostname.</DisplayMessage>
		<Expression LogLevel="Warning">
			<Section Name="-log" Wildcard="True" XPath="/Root/text()" ReadNextSection="True"/>
			<Section Name="DefaultLogBeforeReload" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".log" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>Failed to establish a connection to the server</IndexSearch>
			<RegExp>\b([0-9TZ.]+) ([a-zA-Z0-9.-_\[\] ]*) ([a-zA-Z-_]*)\(([a-zA-Z0-9.\-_]*)\): tid\(([0-9]*)\)[a-zA-Z0-9_.\-\[\]. ]*: Failed to establish a connection to the server\, URL: ([a-zA-Z0-9-_.:?=;/\ ]*)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ServiceType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="ServiceName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="5" RegGroup="All" ConditionName="TransactionID" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="6" RegGroup="All" ConditionName="URL" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="network;memory" SortCondition="Timestamp" SortMethod="Descending">
		<Name>{Condition:SectionName} {Condition:Timestamp} Backside connection failed on {Condition:ServiceName}, Service Type: {Condition:ServiceType}, transaction id {Condition:TransactionID}</Name>
		<DisplayMessage>Logs note that we failed to establish a backside connection at {Condition:Timestamp} on the service {Condition:ServiceName}, this service is of the type {Condition:ServiceType} and had a transaction id of {Condition:TransactionID}.  The destination URL it attempted to reach was {Condition:URL}.  This type of backend failure is usually related to resolved hostnames, but unable to establish a TCP connection (timed out).</DisplayMessage>
		<Expression LogLevel="Warning">
			<Section Name="-log" Wildcard="True" XPath="/Root/text()" ReadNextSection="True"/>
			<Section Name="DefaultLogBeforeReload" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".log" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>Valid backside connection could not be established: Failed to establish a backside connection</IndexSearch>
			<RegExp>\b([0-9TZ.]+) ([a-zA-Z0-9.-_\[\] ]*) ([a-zA-Z-_]*)\(([a-zA-Z0-9.\-_]*)\): tid\(([0-9]*)\)[a-zA-Z0-9_.\-\[\]. ]*: Valid backside connection could not be established: Failed to establish a backside connection\, url: ([a-zA-Z0-9-_.:?=;/\ ]*)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ServiceType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="ServiceName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="5" RegGroup="All" ConditionName="TransactionID" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="6" RegGroup="All" ConditionName="URL" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
		
	<Formula Categories="network;memory" SortCondition="Timestamp" SortMethod="Descending">
		<Name>{Condition:SectionName} {Condition:Timestamp} Connection failed on object {Condition:ObjectName}, Service Type: {Condition:Type}, Connection Error: {Condition:ErrorCode}, transaction id {Condition:TransactionID}</Name>
		<DisplayMessage>Logs note that we failed to establish a backside connection at {Condition:Timestamp} on the object {Condition:ObjectName}, this object is of the type {Condition:Type} and had a transaction id of {Condition:TransactionID}.  The destination URL it attempted to reach was {Condition:URL}.</DisplayMessage>
		<Expression LogLevel="Warning">
			<Section Name="-log" Wildcard="True" XPath="/Root/text()" ReadNextSection="True"/>
			<Section Name="DefaultLogBeforeReload" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".log" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>: Connection error</IndexSearch>
			<RegExp>\b([0-9TZ.]+) ([a-zA-Z0-9.-_\[\]]*) ([a-zA-Z ]*)\(([a-zA-Z0-9.\-_]*)\): tid\(([0-9]*)\)[a-zA-Z0-9_.\-\[\]. ]*: Connection error\(([0-9]+)\) at '([a-zA-Z0-9-_.:/\ ]*)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="Type" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="5" RegGroup="All" ConditionName="TransactionID" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="6" RegGroup="All" ConditionName="ErrorCode" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="7" RegGroup="All" ConditionName="URL" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>

	<!-- end backside connection failures -->
	
	<!-- dns failures -->
	
	<Formula Categories="network;memory">
		<Name>{Condition:SectionName} {Condition:Timestamp} DNS resolution failed on hostname: {Condition:URL} in service {Condition:ServiceName}, Service Type: {Condition:ServiceType}, transaction id {Condition:TransactionID}.</Name>
		<DisplayMessage>Logs note that we failed to establish a backside connection at {Condition:Timestamp} on the service {Condition:ServiceName}, this service is of the type {Condition:ServiceType} and had a transaction id of {Condition:TransactionID}.  The hostname it attempted to resolve was {Condition:URL}.</DisplayMessage>
		<Expression LogLevel="Warning">
			<Section Name="-log" Wildcard="True" XPath="/Root/text()" ReadNextSection="True"/>
			<Section Name="DefaultLogBeforeReload" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".log" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>: DNS Callback cannot resolve host</IndexSearch>
			<RegExp>\b([0-9TZ.]+) ([a-zA-Z0-9.-_\[\] ]*) ([a-zA-Z-_]*)\(([a-zA-Z0-9.\-_]*)\): tid\(([0-9]*)\)[a-zA-Z0-9_.\-\[\]. ]*: DNS Callback cannot resolve host '([a-zA-Z0-9-_.:/\ ]*)': returning error\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ServiceType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="ServiceName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="5" RegGroup="All" ConditionName="TransactionID" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="6" RegGroup="All" ConditionName="URL" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- end of dns failures -->
	
	<!-- latency line search -->
	<Formula Categories="network;memory" Popup="latency.analytics.html" SortCondition="TimeMS" SortMethod="descending">
		<Name>{Condition:SectionName} Latency Line Reported with at least a {Condition:TimeMS} millisecond delay</Name>
		<DisplayMessage>Latency in transaction, Service name: {Condition:ServiceName}, transaction id: {Condition:TransactionID} backend URL destination was {Condition:URL}.  See details for read out of transaction latency -- {Condition:LatencyLine}</DisplayMessage>
		<Expression LogLevel="Warning">
			<Section Name="-log" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".log" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>: Latency</IndexSearch>
			<RegExp>\b([0-9TZ.]+) [a-zA-Z0-9_.\-\[\] ]* ([a-zA-Z]*)\(([a-zA-Z0-9.\-_]*)\): tid\(([0-9]*)\)[a-zA-Z0-9_.\-\[\].]*: Latency:.*\s+([1-9]\d{3,8})\s+.*\[([a-zA-Z0-9=:?/\-_.&amp;]*)\b</RegExp>
			<!-- LatencyLine condition is fed for purposes of latency.analytics.html as a argument passed -->
			<Condition FieldPosition="0" RegGroup="All" ConditionName="LatencyLine" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="5" RegGroup="All" ConditionName="TimeMS" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ServiceName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="TransactionID" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="6" RegGroup="All" ConditionName="URL" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- end of latency line search -->
	
	<Formula Categories="memory;cpuload">
		<Name>{Condition:SectionName} Growth in ActiveUsers due to ITCAM/XML-MGMT Usage, counted {Condition:UserCount} 'system' connections.</Name>
		<DisplayMessage>Workarounds.  A) Change web-mgmt idle-timeout to be shorter (60 seconds), this will clean-up entries faster.  B) Disable ITCAM/Xml-Mgmt monitor or xml-mgmt interface.</DisplayMessage>
		<Expression LogLevel="Critical">
			<Section Name="ActiveUsers" Wildcard="True" XPath="/Status/ActiveUsers//connection[text()='system' or text()='saml-artifact']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" RegGroup="Count" ConditionName="UserCount" Operation="GreaterThan" Value="20"/>
		</Expression>
	</Formula>
	
	<!-- track a memory leak currently under investigation, qrefs from clonepolicy and wspolicy become rampant -->
	<Formula Categories="memory">
		<Name>QPool section reports a count {Condition:WSPolicyCount} dp:wspolicy entries.</Name>
		<DisplayMessage>If the customer is having memory issues, review the QPool for a large count of dp:wspolicy entries alongside clonepolicy.</DisplayMessage>
		<URL description="IC99865 (Fixed in 6.0.0.8, 6.0.1.4 and 7.0.0.0): WSPOLICY DOCUMENTS REFERENCED BY WSP:POLICYREFERENCE DURING WSDL COMPILATION MIGHT NOT BE RELEASED AND CAUSE MEMORY GROWTH: ">http://www.ibm.com/support/docview.wss?uid=swg1IC99865</URL>
		<Expression LogLevel="Error" NextOperation="And">
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="8"/>
		</Expression>
		<Expression LogLevel="Error">
			<Section Name="QPool" XPath="/Root/text()"/>
			<RegExp>([1-9]\d{0,10}): 0x\d+ "dp:wspolicy"</RegExp>
			<Condition FieldPosition="1" RegGroup="Count" ConditionName="WSPolicyCount" Operation="GreaterThan" Value="2000"/>
		</Expression>
	</Formula>
	
		<Formula Categories="memory">
		<Name>QPool section reports a count {Condition:WSPolicyCount} dp:wspolicy entries.</Name>
		<DisplayMessage>If the customer is having memory issues, review the QPool for a large count of dp:wspolicy entries alongside clonepolicy.</DisplayMessage>
		<URL description="IC99865 (Fixed in 6.0.0.8, 6.0.1.4 and 7.0.0.0): WSPOLICY DOCUMENTS REFERENCED BY WSP:POLICYREFERENCE DURING WSDL COMPILATION MIGHT NOT BE RELEASED AND CAUSE MEMORY GROWTH: ">http://www.ibm.com/support/docview.wss?uid=swg1IC99865</URL>
		<Expression LogLevel="Error" NextOperation="And">
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="1" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="4"/>
		</Expression>
		<Expression LogLevel="Error">
			<Section Name="QPool" XPath="/Root/text()"/>
			<RegExp>([1-9]\d{0,10}): 0x\d+ "dp:wspolicy"</RegExp>
			<Condition FieldPosition="1" RegGroup="Count" ConditionName="WSPolicyCount" Operation="GreaterThan" Value="2000"/>
		</Expression>
	</Formula>
	<!-- end memory leak track -->
	
	<!-- track APAR IC91025 -->
		<Formula Categories="configuration;memory">
		<Name>QPool section reports a count {Condition:LDAPCount} aaapolicy.xsl entries.</Name>
		<DisplayMessage>If the customer is having memory issues, review the QPool for a large count of aaapolicy.xsl entries.  If this accompanies high memory, the customer may be encountering APAR IC91025, fixed in 5.0.0.8.</DisplayMessage>
		<URL description="IC91025 (Fixed in 5.0.0.8): GRADUAL MEMORY GROWTH MIGHT OCCUR WHEN USING LDAP HEALTH CHECK IN DATAPOWER: ">http://www.ibm.com/support/docview.wss?uid=swg1IC91025</URL>
		<Expression LogLevel="Error" NextOperation="And">
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="5" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="8"/>
		</Expression>
		<Expression LogLevel="Error">
			<Section Name="QPool" XPath="/Root/text()"/>
			<RegExp>(\d+): 0x\d+ "store:///dp/aaapolicy.xsl"</RegExp>
			<Condition FieldPosition="1" RegGroup="Count" ConditionName="LDAPCount" Operation="GreaterThan" Value="100"/>
		</Expression>
	</Formula>
	<!-- end of tracking APAR IC91025 -->
	
	<!-- track APAR IC99850 -->
	<Formula Categories="configuration;memory">
		<Name>QPool section reports a count {Condition:LDAPCount} dp:ldap-search entries.</Name>
		<DisplayMessage>If the customer is having memory issues, review the QPool for a large count of aaapolicy.xsl and dp:ldap-search entries.  If this accompanies high memory, the customer may be encountering APAR IC99850, fixed in 6.0.0.6 and 6.0.1.2.</DisplayMessage>
		<URL description="IC99850 (Fixed in 6.0.0.6 and 6.0.1.2): MEMORY GROWTH MIGHT OCCUR WHILE USING LDAP SEARCH: ">http://www.ibm.com/support/docview.wss?uid=swg1IC99850</URL>
		<Expression LogLevel="Error" NextOperation="And">
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<!-- right now it was seen in 6.0.0.4, so it must exist in 6.0+ -->
			<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="6"/>
		</Expression>
		<Expression LogLevel="Error">
			<Section Name="QPool" XPath="/Root/text()"/>
			<RegExp>(\d+): 0x\d+ "\*dp:ldap-search</RegExp>
			<Condition FieldPosition="1" RegGroup="Count" ConditionName="LDAPCount" Operation="GreaterThan" Value="1000"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;memory">
		<Name>QPool section reports a count {Condition:LDAPCount} dp:ldap-search entries.</Name>
		<DisplayMessage>If the customer is having memory issues, review the QPool for a large count of aaapolicy.xsl and dp:ldap-search entries.  If this accompanies high memory, the customer may be encountering APAR IC99850, fixed in 6.0.0.6 and 6.0.1.2.</DisplayMessage>
		<URL description="IC99850 (Fixed in 6.0.0.6 and 6.0.1.2): MEMORY GROWTH MIGHT OCCUR WHILE USING LDAP SEARCH: ">http://www.ibm.com/support/docview.wss?uid=swg1IC99850</URL>
		<Expression LogLevel="Error" NextOperation="And">
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<!-- right now it was seen in 6.0.0.4, so it must exist in 6.0+ -->
			<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="1" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="2"/>
		</Expression>
		<Expression LogLevel="Error">
			<Section Name="QPool" XPath="/Root/text()"/>
			<RegExp>(\d+): 0x\d+ "\*dp:ldap-search</RegExp>
			<Condition FieldPosition="1" RegGroup="Count" ConditionName="LDAPCount" Operation="GreaterThan" Value="1000"/>
		</Expression>
	</Formula>
	<!-- end of tracking IC99850 -->
	
	<Formula Categories="configuration;memory">
		<Name>QPool section reports a count {Condition:AAACount} aaapolicy.xsl entries.</Name>
		<DisplayMessage>If the customer is having memory issues, review the QPool for a large count of aaapolicy.xsl entries.  If this accompanies high memory, the customer may be encountering an RBM LDAP memory leak and need to move to fixpacks (or later) 5.0.0.18, 6.0.0.10, 6.0.1.6 and 7.0.0.3.</DisplayMessage>
		<Expression LogLevel="Error" NextOperation="And">
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="5" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="18"/>
		</Expression>
		<Expression LogLevel="Error" NextOperation="And">
			<Section Name="QPool" XPath="/Root/text()"/>
			<RegExp>(\d+): 0x\d+ "\*dp:ldap-search</RegExp>
			<Condition FieldPosition="1" RegGroup="Count" ConditionName="LDAPCount" Operation="LessThan" Value="100"/>
		</Expression>
		<Expression LogLevel="Error">
			<Section Name="QPool" XPath="/Root/text()"/>
			<RegExp>(\d+): 0x\d+ "store:///dp/aaapolicy.xsl"</RegExp>
			<Condition FieldPosition="1" RegGroup="Count" ConditionName="AAACount" Operation="GreaterThan" Value="1000"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;memory">
		<Name>QPool section reports a count {Condition:AAACount} aaapolicy.xsl entries.</Name>
		<DisplayMessage>If the customer is having memory issues, review the QPool for a large count of aaapolicy.xsl entries.  If this accompanies high memory, the customer may be encountering an RBM LDAP memory leak and need to move to fixpacks (or later) 5.0.0.18, 6.0.0.10, 6.0.1.6 and 7.0.0.3.</DisplayMessage>
		<Expression LogLevel="Error" NextOperation="And">
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="10"/>
		</Expression>
		<Expression LogLevel="Error" NextOperation="And">
			<Section Name="QPool" XPath="/Root/text()"/>
			<RegExp>(\d+): 0x\d+ "\*dp:ldap-search</RegExp>
			<Condition FieldPosition="1" RegGroup="Count" ConditionName="LDAPCount" Operation="LessThan" Value="100"/>
		</Expression>
		<Expression LogLevel="Error">
			<Section Name="QPool" XPath="/Root/text()"/>
			<RegExp>(\d+): 0x\d+ "store:///dp/aaapolicy.xsl"</RegExp>
			<Condition FieldPosition="1" RegGroup="Count" ConditionName="AAACount" Operation="GreaterThan" Value="1000"/>
		</Expression>
	</Formula>
	
	
	<Formula Categories="configuration;memory">
		<Name>QPool section reports a count {Condition:AAACount} aaapolicy.xsl entries.</Name>
		<DisplayMessage>If the customer is having memory issues, review the QPool for a large count of aaapolicy.xsl entries.  If this accompanies high memory, the customer may be encountering an RBM LDAP memory leak and need to move to fixpacks (or later) 5.0.0.18, 6.0.0.10, 6.0.1.6 and 7.0.0.3.</DisplayMessage>
		<Expression LogLevel="Error" NextOperation="And">
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="1" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="6"/>
		</Expression>
		<Expression LogLevel="Error" NextOperation="And">
			<Section Name="QPool" XPath="/Root/text()"/>
			<RegExp>(\d+): 0x\d+ "\*dp:ldap-search</RegExp>
			<Condition FieldPosition="1" RegGroup="Count" ConditionName="LDAPCount" Operation="LessThan" Value="100"/>
		</Expression>
		<Expression LogLevel="Error">
			<Section Name="QPool" XPath="/Root/text()"/>
			<RegExp>(\d+): 0x\d+ "store:///dp/aaapolicy.xsl"</RegExp>
			<Condition FieldPosition="1" RegGroup="Count" ConditionName="AAACount" Operation="GreaterThan" Value="1000"/>
		</Expression>
	</Formula>
	
	
	<Formula Categories="configuration;memory">
		<Name>QPool section reports a count {Condition:AAACount} aaapolicy.xsl entries.</Name>
		<DisplayMessage>If the customer is having memory issues, review the QPool for a large count of aaapolicy.xsl entries.  If this accompanies high memory, the customer may be encountering an RBM LDAP memory leak and need to move to fixpacks (or later) 5.0.0.18, 6.0.0.10, 6.0.1.6 and 7.0.0.3.</DisplayMessage>
		<Expression LogLevel="Error" NextOperation="And">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="3"/>
		</Expression>
		<Expression LogLevel="Error" NextOperation="And">
			<Section Name="QPool" XPath="/Root/text()"/>
			<RegExp>(\d+): 0x\d+ "(https://|http://|sftp://|ftp://).*"</RegExp>
			<Condition FieldPosition="1" RegGroup="Count" ConditionName="LDAPCount" Operation="LessThan" Value="100"/>
		</Expression>
		<Expression LogLevel="Error">
			<Section Name="QPool" XPath="/Root/text()"/>
			<RegExp>(\d+): 0x\d+ "store:///dp/aaapolicy.xsl"</RegExp>
			<Condition FieldPosition="1" RegGroup="Count" ConditionName="AAACount" Operation="GreaterThan" Value="1000"/>
		</Expression>
	</Formula>
	
	
	<Formula Categories="configuration;memory">
		<Name>QPool section reports a count {Condition:AAACount} aaapolicy.xsl entries, this could be potentially caused by many AAA documents cached.</Name>
		<DisplayMessage>If the customer is having memory issues, review the QPool for a large count of aaapolicy.xsl entries.</DisplayMessage>
		<Expression LogLevel="Warning" NextOperation="And">
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="GreaterThan" Value="9"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="QPool" XPath="/Root/text()"/>
			<RegExp>(\d+): 0x\d+ "store:///dp/aaapolicy.xsl"</RegExp>
			<Condition FieldPosition="1" RegGroup="Count" ConditionName="AAACount" Operation="GreaterThan" Value="1000"/>
		</Expression>
	</Formula>
	
	
	<Formula Categories="configuration;memory">
		<Name>QPool section reports a count {Condition:AAACount} aaapolicy.xsl entries, this could be potentially caused by many AAA documents cached.</Name>
		<DisplayMessage>If the customer is having memory issues, review the QPool for a large count of aaapolicy.xsl entries.</DisplayMessage>
		<Expression LogLevel="Warning" NextOperation="And">
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="1" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="GreaterThan" Value="5"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="QPool" XPath="/Root/text()"/>
			<RegExp>(\d+): 0x\d+ "store:///dp/aaapolicy.xsl"</RegExp>
			<Condition FieldPosition="1" RegGroup="Count" ConditionName="AAACount" Operation="GreaterThan" Value="1000"/>
		</Expression>
	</Formula>
	
	
	<Formula Categories="configuration;memory">
		<Name>QPool section reports a count {Condition:AAACount} aaapolicy.xsl entries, this could be potentially caused by many AAA documents cached.</Name>
		<DisplayMessage>If the customer is having memory issues, review the QPool for a large count of aaapolicy.xsl entries.</DisplayMessage>
		<Expression LogLevel="Warning" NextOperation="And">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="GreaterThan" Value="6"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="QPool" XPath="/Root/text()"/>
			<RegExp>(\d+): 0x\d+ "store:///dp/aaapolicy.xsl"</RegExp>
			<Condition FieldPosition="1" RegGroup="Count" ConditionName="AAACount" Operation="GreaterThan" Value="1000"/>
		</Expression>
	</Formula>
	
	
	<!-- nfs static mount should use soft mount as it is recommended practice -->
		<Formula Categories="configuration">
		<Name>{Condition:SectionName} There is an NFS static mount {Condition:ObjectName} configured as a hard mount instead of a soft mount.</Name>
		<DisplayMessage>{Condition:ObjectName} is configured with a hard mount instead of soft mount, the default value is hard-mount, but sometimes this can have unexpected behavior and it is recommended to use soft-mount for NFS.  See technote below for more information.</DisplayMessage>
		<URL description="Tuning the NFS mount on the DataPower and B2B: ">http://www.ibm.com/support/docview.wss?uid=swg21585229</URL>
		<Expression LogLevel="Warning">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\b(nfs-static-mount \"([a-zA-Z-_.0-9]+).*\"\W+(\w+\W+)*?exit)\b</RegExp>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ConfigInfo" Operation="NotContain" Value="mount-type soft"/>
		</Expression>
	</Formula>
	<!-- end of soft-mount check -->
	
	<!-- interface NetworkInfo check for NO-CARRIER -->
	<Formula CollapseResult="true" Categories="network">
		<Name>(NetworkInfo) Interface {Condition:InterfaceName} is UP, but reporting NO-CARRIER</Name>
		<DisplayMessage>Routing is likely missing from the interface {Condition:InterfaceName}.  Network and port test required for interface. Interface information: {Condition:InterfaceStatus}.</DisplayMessage>
		<Expression LogLevel="Warning" NextOperation="And">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//MachineType"/>
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//MachineType"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MachineType" Operation="NotEqualTo" Value="4195"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="NetworkInfo" XPath="/Root/text()"/>
			<RegExp>\b[0-9]+: ([a-zA-Z0-9_]+): &lt;(([a-zA-Z0-9-_ ]+),([a-zA-Z0-9-_ ]+),([a-zA-Z0-9-_ ]+),([a-zA-Z0-9-_ ]+)).*&gt;.*\b</RegExp>
			<!-- try and find the 'UP' state of the interface -->
			<Condition FieldPosition="2" RegGroup="All" ConditionName="InterfaceState" Operation="Contains" Value=",UP" NextOperation="And"/>
			<!-- grab the interface name -->
			<Condition FieldPosition="1" RegGroup="All" ConditionName="InterfaceName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<!-- pull the interface status together -->
			<Condition FieldPosition="2" RegGroup="All" ConditionName="InterfaceStatus" Operation="Contains" Value="NO-CARRIER"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="And" ExpressionGroup="InternalState">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//MachineType"/>
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//MachineType"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MachineType" Operation="NotEqualTo" Value="4195"/>
		</Expression>
		<Expression LogLevel="Warning" ExpressionGroup="InternalState">
			<Section Name="InternalState" XPath="/Root/text()"/>
			<RegExp>\b[0-9]+: ([a-zA-Z0-9_]+): &lt;(([a-zA-Z0-9-_ ]+),([a-zA-Z0-9-_ ]+),([a-zA-Z0-9-_ ]+),([a-zA-Z0-9-_ ]+)).*&gt;.*\b</RegExp>
			<!-- try and find the 'UP' state of the interface -->
			<Condition FieldPosition="2" RegGroup="All" ConditionName="InterfaceState" Operation="Contains" Value=",UP" NextOperation="And"/>
			<!-- grab the interface name -->
			<Condition FieldPosition="1" RegGroup="All" ConditionName="InterfaceName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<!-- pull the interface status together -->
			<Condition FieldPosition="2" RegGroup="All" ConditionName="InterfaceStatus" Operation="Contains" Value="NO-CARRIER"/>
		</Expression>
	</Formula>
	<!-- end of interface NetworkInfo check for NO-CARRIER -->
	
		<Formula Categories="configuration;network">
		<Name>IPMI-Lan-Channel IP Conflict, {Condition:IPMIAddress} is being used in the ipmi-lan-channel and also interface {Condition:InterfaceName}</Name>
		<DisplayMessage>The IPMI-Lan-Channel IP address must be distinct from all IP addresses on the appliance and from all IP address on the connected subnet (broadcast domain).</DisplayMessage>
		<URL description="IPMI Lan Channel IP Address Command Reference: ">http://pic.dhe.ibm.com/infocenter/wsdatap/v6r0m0/topic/com.ibm.dp.xg.doc/ip-address_ipmilanchannel.html#ip-address_ipmilanchannel</URL>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="default-config" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\bipmi-lan-channel \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?(ip address ([a-zA-Z0-9._\/-]+)|exit)\b</RegExp>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="IPMIAddress" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="default-config" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\binterface \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?(ip address ([a-zA-Z0-9._\/-]+)|exit)\b</RegExp>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="IPAddress" Operation="EqualsTo" Value="{Condition:IPMIAddress}" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="InterfaceName" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- end of testing ipmi channel -->
	
		<Formula Categories="hardware;failure">
		<Name>Hardware Security Module (HSM) on 7199 device may cause unexpected reload under heavy load without APAR IT01563</Name>
		<DisplayMessage>Customer is using {Condition:ModuleName} which will be affected by APAR IT01563, records of this event can only be matched up with IPMISelEvents systemFirmwareProgress.</DisplayMessage>
		<URL description="APAR IT01563 Appliances with HSM feature may reboot under load(5.0.0.16, 6.0.0.8, 6.0.1.4): ">http://www.ibm.com/support/docview.wss?uid=swg1IT01563</URL>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="Hardware" XPath="/Hardware/diagcryptostat"/>
			<RegExp>Status of crypto '(hsm[0-9]+)' : fully operational.</RegExp>
			<Condition FieldPosition="1" Operation="Contains" ConditionName="ModuleName" Value="hsm"/>
			</Expression>
			<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//MachineType"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="7199"/>
			</Expression>
		<Expression LogLevel="Critical">
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="5" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="16"/>
		</Expression>
		<Expression LogLevel="Critical" NextOperation="And" ExpressionGroup="6.0.0Level">
			<Section Name="Hardware" XPath="/Hardware/diagcryptostat"/>
			<RegExp>Status of crypto '(hsm[0-9]+)' : fully operational.</RegExp>
			<Condition FieldPosition="1" Operation="Contains" ConditionName="ModuleName" Value="hsm"/>
			</Expression>
			<Expression LogLevel="Critical" NextOperation="And" ExpressionGroup="6.0.0Level">
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//MachineType"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="7199"/>
			</Expression>
		<Expression LogLevel="Critical" ExpressionGroup="6.0.0Level">
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="8"/>
		</Expression>
		<Expression LogLevel="Critical" NextOperation="And" ExpressionGroup="6.0.1Level">
			<Section Name="Hardware" XPath="/Hardware/diagcryptostat"/>
			<RegExp>Status of crypto '(hsm[0-9]+)' : fully operational.</RegExp>
			<Condition FieldPosition="1" Operation="Contains" ConditionName="ModuleName" Value="hsm"/>
			</Expression>
			<Expression LogLevel="Critical" NextOperation="And" ExpressionGroup="6.0.1Level">
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//MachineType"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="7199"/>
			</Expression>
		<Expression LogLevel="Critical" ExpressionGroup="6.0.1Level">
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="1" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="4"/>
		</Expression>
	</Formula>
	
	<!-- mpgw check for persistent connections on loopback -->
	<Formula Categories="configuration;network;cpuload;memory">
		<Name>{Condition:SectionName} {Condition:ObjectType} {Condition:ObjectName} Persistent Connections should be off</Name>
		<DisplayMessage>Set to static backend, configured with a {Condition:BackendURL}.  Persistent connections should be OFF.</DisplayMessage>
		<URL description="Best Practices for configuring local chained services on WebSphere DataPower SOA Appliances: ">http://www.ibm.com/support/docview.wss?uid=swg21417934</URL>
		<Expression LogLevel="Error">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>(wsgw|mpgw) \"([a-zA-Z-_0-9.]+)\"\W+(\w+\W+)*?exit</RegExp>
			<Condition FieldPosition="0" RegGroup="All" Operation="NotContain" Value="no persistent-connections" NextOperation="And"/>
			<Condition FieldPosition="0" RegGroup="All" Operation="NotContain" Value="persistent-connections off" NextOperation="And"/>
			<Condition FieldPosition="0" RegGroup="All" Operation="NotContain" Value="type dynamic-backend" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ObjectType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="AllResult" ConditionName="BackendURL" Operation="NotEqualTo" Value="exit">\b{Condition:ObjectType} \"({Condition:ObjectName})\"\W+(\w+\W+)*?(backend-url \"((http|https):\/\/(127.0.0.1|localhost)).*|exit)\b</Condition>
		</Expression>
	</Formula>
	<!-- end check for persistent connections on loopback -->
	
	<Formula Categories="configuration;network">
		<Name>{Condition:SectionName} MPGW {Condition:ObjectName} Front End Timeout</Name>
		<DisplayMessage>Has a front-end timeout greater than 120 seconds, front-end timeout is {Condition:FrontTimeout}.</DisplayMessage>
		<URL description="Connection Timeouts: ">https://publib.boulder.ibm.com/infocenter/ieduasst/v1r1m0/topic/com.ibm.iea.wdatapower/wdatapower/1.0/xa35/DP_373_Timeouts.pdf?dmuid=20090730163013045496</URL>
		<Expression LogLevel="Info">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\bmpgw \"([a-zA-Z-_0-9.]+)\"\W+(\w+\W+)*?(front-timeout ([0-9]+)|exit)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="FrontTimeout" Operation="GreaterThan" Value="120"/>
		</Expression>
	</Formula>
	<Formula Categories="configuration;network">
		<Name>{Condition:SectionName} MPGW {Condition:ObjectName} Back End Timeout</Name>
		<DisplayMessage>Has a back-end timeout greater than 120 seconds, back-end timeout is {Condition:BackTimeout}.</DisplayMessage>
		<URL description="Connection Timeouts: ">https://publib.boulder.ibm.com/infocenter/ieduasst/v1r1m0/topic/com.ibm.iea.wdatapower/wdatapower/1.0/xa35/DP_373_Timeouts.pdf?dmuid=20090730163013045496</URL>
		<Expression LogLevel="Info">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\bmpgw \"([a-zA-Z-_0-9.]+)\"\W+(\w+\W+)*?(back-timeout ([0-9]+)|exit)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="BackTimeout" Operation="GreaterThan" Value="120"/>
		</Expression>
	</Formula>
	
	<!-- sharing conversation MQ tracking -->
		<Formula Categories="configuration;failure;network;cpuload">
		<Name>{Condition:SectionName} There is an MQ-QM Object {Condition:ObjectName} configured with sharing-conversation.</Name>
		<URL description="When to enable Conversation Sharing in DataPower MQ Queue Manager (mq-qm) object: ">http://www.ibm.com/support/docview.wss?uid=swg21647231</URL>
		<URL description="IT02476 (Fixed in 5.0.0.16, 6.0.0.8, 6.0.1.4, and 7.0.0.2): WITH SHARING CONVERSATION ENABLED, MQ-QM OBJECTS RUN INTO PENDING STATE AND HIGH CPU IS OBSERVED WHEN THERE IS MQ ERROR: ">http://www.ibm.com/support/docview.wss?uid=swg1IT02476</URL>
		<Expression LogLevel="Error" FormulaIDMatch="V500FirmwareCheck">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\bmq-qm \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(sharing-conversations ([0-9]+)|exit)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="SharingCount" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>

	<Formula Categories="configuration;failure;network;cpuload">
		<Name>{Condition:SectionName} There is an MQ-QM Object {Condition:ObjectName} configured with sharing-conversation.</Name>
		<URL description="When to enable Conversation Sharing in DataPower MQ Queue Manager (mq-qm) object: ">http://www.ibm.com/support/docview.wss?uid=swg21647231</URL>
		<URL description="IT09316 (Fixed in 7.5.0.0): UNEXPECTED 2009 MQ ERRORS WITH MQ WHEN USING MQ-SHARING: ">http://www.ibm.com/support/docview.wss?uid=swg1IT09316</URL>
		<URL description="IT10128 (Fixed in 6.0.0.16, 6.0.1.12, 7.0.0.9, 7.1.0.6, 7.2.0.0): HIGH TRAFFIC WITH MQ SHARING-CONVERSATION ENABLED MAY CAUSE RELOAD: ">http://www.ibm.com/support/docview.wss?uid=swg1IT10128</URL>
		<URL description="IT08838 (Fixed in 6.0.0.16, 6.0.1.12, 7.0.0.9, 7.1.0.6, 7.2.0.0): UNEXPECTED RESTART WHEN USING MQ-SHARING CONVERSATION WITH OLD MQv7 SERVER: ">http://www.ibm.com/support/docview.wss?uid=swg1IT08838</URL>
		<URL description="IT05998 (Fixed in 6.0.0.12, 6.0.1.8, 7.0.0.5, 7.1.0.3): DATAPOWER APPLIANCE MIGHT NOT RESPOND UNDER HIGH LOAD WITH MQ QUEUE MANAGER OBJECT CONFIGURED TO USE SHARED CONVERSATIONS: ">http://www.ibm.com/support/docview.wss?uid=swg1IT05998</URL>
		<URL description="IT02476 (Fixed in 5.0.0.16, 6.0.0.8, 6.0.1.4, 7.0.0.2): WITH SHARING CONVERSATION ENABLED, MQ-QM OBJECTS RUN INTO PENDING STATE AND HIGH CPU IS OBSERVED WHEN THERE IS MQ ERROR: ">http://www.ibm.com/support/docview.wss?uid=swg1IT02476</URL>
		<Expression LogLevel="Error"  FormulaIDMatch="V600FirmwareCheck">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\b(mq-qm \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit)\b</RegExp>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ConfigInfo" Operation="Contains" Value="sharing-conversations"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;failure;network;cpuload">
		<Name>{Condition:SectionName} There is an MQ-QM Object {Condition:ObjectName} configured with sharing-conversation.</Name>
		<URL description="When to enable Conversation Sharing in DataPower MQ Queue Manager (mq-qm) object: ">http://www.ibm.com/support/docview.wss?uid=swg21647231</URL>
		<URL description="IT09316 (Fixed in 7.5.0.0): UNEXPECTED 2009 MQ ERRORS WITH MQ WHEN USING MQ-SHARING: ">http://www.ibm.com/support/docview.wss?uid=swg1IT09316</URL>
		<URL description="IT10128 (Fixed in 6.0.0.16, 6.0.1.12, 7.0.0.9, 7.1.0.6, 7.2.0.0): HIGH TRAFFIC WITH MQ SHARING-CONVERSATION ENABLED MAY CAUSE RELOAD: ">http://www.ibm.com/support/docview.wss?uid=swg1IT10128</URL>
		<URL description="IT08838 (Fixed in 6.0.0.16, 6.0.1.12, 7.0.0.9, 7.1.0.6, 7.2.0.0): UNEXPECTED RESTART WHEN USING MQ-SHARING CONVERSATION WITH OLD MQv7 SERVER: ">http://www.ibm.com/support/docview.wss?uid=swg1IT08838</URL>
		<URL description="IT05998 (Fixed in 6.0.0.12, 6.0.1.8, 7.0.0.5, 7.1.0.3): DATAPOWER APPLIANCE MIGHT NOT RESPOND UNDER HIGH LOAD WITH MQ QUEUE MANAGER OBJECT CONFIGURED TO USE SHARED CONVERSATIONS: ">http://www.ibm.com/support/docview.wss?uid=swg1IT05998</URL>
		<URL description="IT02476 (Fixed in 5.0.0.16, 6.0.0.8, 6.0.1.4, and 7.0.0.2): WITH SHARING CONVERSATION ENABLED, MQ-QM OBJECTS RUN INTO PENDING STATE AND HIGH CPU IS OBSERVED WHEN THERE IS MQ ERROR: ">http://www.ibm.com/support/docview.wss?uid=swg1IT02476</URL>
		<Expression LogLevel="Error"  FormulaIDMatch="V601FirmwareCheck">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\bmq-qm \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(sharing-conversations ([0-9]+)|exit)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="SharingCount" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;failure;network;cpuload">
		<Name>{Condition:SectionName} There is an MQ-QM Object {Condition:ObjectName} configured with sharing-conversation.</Name>
		<URL description="When to enable Conversation Sharing in DataPower MQ Queue Manager (mq-qm) object: ">http://www.ibm.com/support/docview.wss?uid=swg21647231</URL>
		<URL description="IT09316 (Fixed in 7.5.0.0): UNEXPECTED 2009 MQ ERRORS WITH MQ WHEN USING MQ-SHARING: ">http://www.ibm.com/support/docview.wss?uid=swg1IT09316</URL>
		<URL description="IT10128 (Fixed in 6.0.0.16, 6.0.1.12, 7.0.0.9, 7.1.0.6, 7.2.0.0): HIGH TRAFFIC WITH MQ SHARING-CONVERSATION ENABLED MAY CAUSE RELOAD: ">http://www.ibm.com/support/docview.wss?uid=swg1IT10128</URL>
		<URL description="IT08838 (Fixed in 6.0.0.16, 6.0.1.12, 7.0.0.9, 7.1.0.6, 7.2.0.0): UNEXPECTED RESTART WHEN USING MQ-SHARING CONVERSATION WITH OLD MQv7 SERVER: ">http://www.ibm.com/support/docview.wss?uid=swg1IT08838</URL>
		<URL description="IT05998 (Fixed in 6.0.0.12, 6.0.1.8, 7.0.0.5, 7.1.0.3): DATAPOWER APPLIANCE MIGHT NOT RESPOND UNDER HIGH LOAD WITH MQ QUEUE MANAGER OBJECT CONFIGURED TO USE SHARED CONVERSATIONS: ">http://www.ibm.com/support/docview.wss?uid=swg1IT05998</URL>
		<URL description="IT02476 (Fixed in 5.0.0.16, 6.0.0.8, 6.0.1.4, and 7.0.0.2): WITH SHARING CONVERSATION ENABLED, MQ-QM OBJECTS RUN INTO PENDING STATE AND HIGH CPU IS OBSERVED WHEN THERE IS MQ ERROR: ">http://www.ibm.com/support/docview.wss?uid=swg1IT02476</URL>
		<Expression LogLevel="Error"  FormulaIDMatch="V700FirmwareCheck">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\b(mq-qm \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit)\b</RegExp>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ConfigInfo" Operation="Contains" Value="sharing-conversations"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;failure;network;cpuload">
		<Name>{Condition:SectionName} There is an MQ-QM Object {Condition:ObjectName} configured with sharing-conversation.</Name>
		<URL description="When to enable Conversation Sharing in DataPower MQ Queue Manager (mq-qm) object: ">http://www.ibm.com/support/docview.wss?uid=swg21647231</URL>
		<URL description="IT09316 (Fixed in 7.5.0.0): UNEXPECTED 2009 MQ ERRORS WITH MQ WHEN USING MQ-SHARING: ">http://www.ibm.com/support/docview.wss?uid=swg1IT09316</URL>
		<URL description="IT10498 (Fixed in 7.1.0.7): UNEXPECTED RESTART MIGHT OCCUR DURING MQ TRAFFIC WITH MQ SHARING CONVERSATION: ">http://www.ibm.com/support/docview.wss?uid=swg1IT10498</URL>
		<URL description="IT10128 (Fixed in 6.0.0.16, 6.0.1.12, 7.0.0.9, 7.1.0.6, 7.2.0.0): HIGH TRAFFIC WITH MQ SHARING-CONVERSATION ENABLED MAY CAUSE RELOAD: ">http://www.ibm.com/support/docview.wss?uid=swg1IT10128</URL>
		<URL description="IT08838 (Fixed in 6.0.0.16, 6.0.1.12, 7.0.0.9, 7.1.0.6, 7.2.0.0): UNEXPECTED RESTART WHEN USING MQ-SHARING CONVERSATION WITH OLD MQv7 SERVER: ">http://www.ibm.com/support/docview.wss?uid=swg1IT08838</URL>
		<URL description="IT05998 (Fixed in 6.0.0.12, 6.0.1.8, 7.0.0.5, 7.1.0.3): DATAPOWER APPLIANCE MIGHT NOT RESPOND UNDER HIGH LOAD WITH MQ QUEUE MANAGER OBJECT CONFIGURED TO USE SHARED CONVERSATIONS: ">http://www.ibm.com/support/docview.wss?uid=swg1IT05998</URL>
		<Expression LogLevel="Error"  FormulaIDMatch="V710FirmwareCheck">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\bmq-qm \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(sharing-conversations ([0-9]+)|exit)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="SharingCount" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>

	<Formula Categories="configuration;failure;network;cpuload">
		<Name>{Condition:SectionName} There is an MQ-QM Object {Condition:ObjectName} configured with sharing-conversation: {Condition:SharingCount}.</Name>
		<URL description="When to enable Conversation Sharing in DataPower MQ Queue Manager (mq-qm) object: ">http://www.ibm.com/support/docview.wss?uid=swg21647231</URL>
		<URL description="IT10128 (Fixed in 6.0.0.16, 6.0.1.12, 7.0.0.9, 7.1.0.6, 7.2.0.0): HIGH TRAFFIC WITH MQ SHARING-CONVERSATION ENABLED MAY CAUSE RELOAD: ">http://www.ibm.com/support/docview.wss?uid=swg1IT10128</URL>
		<URL description="IT08838 (Fixed in 6.0.0.16, 6.0.1.12, 7.0.0.9, 7.1.0.6, 7.2.0.0): UNEXPECTED RESTART WHEN USING MQ-SHARING CONVERSATION WITH OLD MQv7 SERVER: ">http://www.ibm.com/support/docview.wss?uid=swg1IT08838</URL>
		<Expression LogLevel="Error" FormulaIDMatch="V720FirmwareCheckOrGreater">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\bmq-qm \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(sharing-conversations ([0-9]+)|exit)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="SharingCount" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>	
	<!-- end of MQ sharing conversation -->
	
	
	<!-- APAR IT11147 tracking (MQ-QM with SSL may have connection errors like 2538) -->
	<Formula CollapseResult="true" FormulaID="APAR-IT10598-OR-IT11147-Fixpacks">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="17"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="13"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="10"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="7"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="2" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="2"/>
			</Expression>
	</Formula>
	
	<Formula Categories="configuration;failure;network;cpuload">
		<Name>{Condition:SectionName} There is an MQ-QM Object &lt;font color='#CC3300'&gt;{Condition:ObjectName}&lt;/font&gt; configured with SSL Profile &lt;font color='#CC3300'&gt;{Condition:SSLProfile}&lt;/font&gt;, current firmware may be affected by APAR in related URL listing.</Name>
		<URL description="IT11147 (Fixed in 6.0.0.17, 6.0.1.13, 7.0.0.10, 7.1.0.7 and 7.2.0.2): DATAPOWER MQ-QM FAILS TO CONNECT WITH AN MQ REASON CODE OF 2538 WHEN SSL IS USED: ">http://www.ibm.com/support/docview.wss?uid=swg1IT11147</URL>
		<Expression LogLevel="Error" FormulaIDMatch="APAR-IT10598-OR-IT11147-Fixpacks">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\bmq-qm \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(ssl ([a-zA-Z-_.0-9]+)|exit)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="SSLProfile" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- end of APAR IT11147 tracking (MQ-QM with SSL may have connection errors like 2538) -->
	
	<!-- SFTP poller APAR tracking -->
	
	<Formula CollapseResult="true" FormulaID="V50011FirmwareCheck">
		<Expression LogLevel="Warning">
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="5" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="11"/>
		</Expression>
	</Formula>
	
	<!-- WSRR APAR IT10165 can cause random reloading during wsrr-subscription pull -->
		<Formula CollapseResult="true" FormulaID="WSRRAPARCheck">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="9"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="6"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="2" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="2"/>
			</Expression>
		</Formula>
		
	<Formula Categories="failure">
		<Name>Backtrace on {Condition:Timestamp} Contained Component: {Condition:Data}.  Review WSRR Related APAR's.</Name>
		<URL description="IT10165: APPLIANCE MAY RESTART IF XML MANAGEMENT INTERFACE IS LISTENING ON A HOST-ALIAS, ::, OR 0.0.0.0 AND WSRR SUBSCRIPTION IS USED: ">http://www.ibm.com/support/docview.wss?uid=swg1IT10165</URL>
		<Expression LogLevel="Critical" FormulaIDMatch="WSRRAPARCheck">
			<Section Name="Backtrace" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And">Thread 0x[0-9a-fA-F]*\: (\d{4}\-\d{2}\-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z)</Condition>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Data" Operation="NotEqualTo" Value="">\b(Component=wsrr-subscription.*)\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
		</Expression>
	</Formula>
	<!-- end APAR IT10165 check -->
	
	<Formula Categories="failure">
		<Name>Backtrace on {Condition:Timestamp} Contained Component: {Condition:Data}.  Review Failure Notification for Internal-State setting, if 'on' try having it turned 'off'.  Reboot is required to fix failure-notification as down.</Name>
		<Expression LogLevel="Critical">
			<Section Name="Backtrace" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And">Thread 0x[0-9a-fA-F]*\: (\d{4}\-\d{2}\-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z)</Condition>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Data" Operation="NotEqualTo" Value="">\b(Component=ErrorReport, Domain=default, Config=ErrorReport)\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
		</Expression>
	</Formula>
	
	<Formula Categories="failure">
		<Name>Backtrace on {Condition:Timestamp} Contained source-sftp-poller component in Domain={Condition:Domain}, Config={Condition:Config}.  Possible APAR's listed, may need investigation by IBM support.</Name>
		<URL description="IC99082: USING SFTP POLLER FRONT SIDE HANDLER OR SQLDATA SOURCE BACKEND MIGHT RESTART DURING DATA TRANSFER (Fixed in 5.0.0.13): ">http://www.ibm.com/support/docview.wss?uid=swg1IC99082</URL>
		<URL description="IC93084: SFTP POLLER USED AGAINST A DISABLED SFTP SUBSYSTEM MIGHT CAUSE THE APPLIANCE TO RESTART (Fixed in 5.0.0.11): ">http://www.ibm.com/support/docview.wss?uid=swg1IC93084</URL>
		<Expression LogLevel="Error" FormulaIDMatch="V50011FirmwareCheck">
			<Section Name="Backtrace" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And">Thread 0x[0-9a-fA-F]*\: (\d{4}\-\d{2}\-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z)</Condition>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="Domain" Operation="NotEqualTo" Value="" NextOperation="And">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="Config" Operation="NotEqualTo" Value="" NextOperation="And">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Component" Operation="EqualsTo" Value="source-sftp-poller">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
		</Expression>
	</Formula>
	
	<Formula Categories="failure">
		<Name>Backtrace on {Condition:Timestamp} Contained source-sftp-poller component in Domain={Condition:Domain}, Config={Condition:Config}.  Possible APAR's listed, may need investigation by IBM support.</Name>
		<URL description="IT09825 (Fixed in 6.0.0.16, 6.0.1.12, 7.0.0.9, 7.1.0.6 and 7.2.0.1): MANY CONCURRENT SFTP POLLER CONNECTIONS MIGHT RESULT IN AN UNEXPECTED IMMEDIATE RESTART: ">http://www.ibm.com/support/docview.wss?uid=swg1IT06471</URL>
		<URL description="IT06471: DATAPOWER APPLIANCE USING A SFTP POLLER MIGHT EXPERIENCE AN IMMEDIATE RESTART (Fixed in 6.0.0.14): ">http://www.ibm.com/support/docview.wss?uid=swg1IT06471</URL>
		<URL description="IT02106: APPLIANCE RESTART MIGHT OCCUR UNDER HIGH TRAFFIC LOAD OR CONFIGURATION CHANGE (Fixed in 6.0.0.8): ">http://www.ibm.com/support/docview.wss?uid=swg1IT02106</URL>
		<URL description="IC99082: USING SFTP POLLER FRONT SIDE HANDLER OR SQLDATA SOURCE BACKEND MIGHT RESTART DURING DATA TRANSFER (Fixed in 6.0.0.5): ">http://www.ibm.com/support/docview.wss?uid=swg1IC99082</URL>
		<URL description="IC93084: SFTP POLLER USED AGAINST A DISABLED SFTP SUBSYSTEM MIGHT CAUSE THE APPLIANCE TO RESTART (Fixed in 6.0.0.3): ">http://www.ibm.com/support/docview.wss?uid=swg1IC93084</URL>
		<Expression LogLevel="Error" FormulaIDMatch="V600FirmwareCheck">
			<Section Name="Backtrace" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And">Thread 0x[0-9a-fA-F]*\: (\d{4}\-\d{2}\-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z)</Condition>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="Domain" Operation="NotEqualTo" Value="" NextOperation="And">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="Config" Operation="NotEqualTo" Value="" NextOperation="And">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Component" Operation="EqualsTo" Value="source-sftp-poller">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
		</Expression>
	</Formula>
	
	<Formula Categories="failure">
		<Name>Backtrace on {Condition:Timestamp} Contained source-sftp-poller component in Domain={Condition:Domain}, Config={Condition:Config}.  Possible APAR's listed, may need investigation by IBM support.</Name>
		<URL description="IT09825 (Fixed in 6.0.1.12, 7.0.0.9, 7.1.0.6 and 7.2.0.1): MANY CONCURRENT SFTP POLLER CONNECTIONS MIGHT RESULT IN AN UNEXPECTED IMMEDIATE RESTART: ">http://www.ibm.com/support/docview.wss?uid=swg1IT06471</URL>
		<URL description="IT06471: DATAPOWER APPLIANCE USING A SFTP POLLER MIGHT EXPERIENCE AN IMMEDIATE RESTART (Fixed in 6.0.1.10): ">http://www.ibm.com/support/docview.wss?uid=swg1IT06471</URL>
		<URL description="IC99082: USING SFTP POLLER FRONT SIDE HANDLER OR SQLDATA SOURCE BACKEND MIGHT RESTART DURING DATA TRANSFER (Fixed in 6.0.1.1): ">http://www.ibm.com/support/docview.wss?uid=swg1IC99082</URL>
		<URL description="IT02106: APPLIANCE RESTART MIGHT OCCUR UNDER HIGH TRAFFIC LOAD OR CONFIGURATION CHANGE (Fixed in 6.0.1.4): ">http://www.ibm.com/support/docview.wss?uid=swg1IT02106</URL>
		<Expression LogLevel="Error" FormulaIDMatch="V601FirmwareCheck">
			<Section Name="Backtrace" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And">Thread 0x[0-9a-fA-F]*\: (\d{4}\-\d{2}\-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z)</Condition>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="Domain" Operation="NotEqualTo" Value="" NextOperation="And">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="Config" Operation="NotEqualTo" Value="" NextOperation="And">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Component" Operation="EqualsTo" Value="source-sftp-poller">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
		</Expression>
	</Formula>
	
	<Formula Categories="failure">
		<Name>Backtrace on {Condition:Timestamp} Contained source-sftp-poller component in Domain={Condition:Domain}, Config={Condition:Config}.  Possible APAR's listed, may need investigation by IBM support.</Name>
		<URL description="IT09825 (7.0.0.9, 7.1.0.6 and 7.2.0.1): MANY CONCURRENT SFTP POLLER CONNECTIONS MIGHT RESULT IN AN UNEXPECTED IMMEDIATE RESTART: ">http://www.ibm.com/support/docview.wss?uid=swg1IT06471</URL>
		<URL description="IT06471: DATAPOWER APPLIANCE USING A SFTP POLLER MIGHT EXPERIENCE AN IMMEDIATE RESTART (Fixed in 7.0.0.7): ">http://www.ibm.com/support/docview.wss?uid=swg1IT06471</URL>
		<Expression LogLevel="Error" FormulaIDMatch="V700FirmwareCheck">
			<Section Name="Backtrace" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And">Thread 0x[0-9a-fA-F]*\: (\d{4}\-\d{2}\-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z)</Condition>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="Domain" Operation="NotEqualTo" Value="" NextOperation="And">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="Config" Operation="NotEqualTo" Value="" NextOperation="And">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Component" Operation="EqualsTo" Value="source-sftp-poller">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
		</Expression>
	</Formula>
	
	<Formula Categories="failure">
		<Name>Backtrace on {Condition:Timestamp} Contained source-sftp-poller component in Domain={Condition:Domain}, Config={Condition:Config}.  Possible APAR's listed, may need investigation by IBM support.</Name>
		<URL description="IT09825 (Fixed in 7.1.0.6 and 7.2.0.1): MANY CONCURRENT SFTP POLLER CONNECTIONS MIGHT RESULT IN AN UNEXPECTED IMMEDIATE RESTART: ">http://www.ibm.com/support/docview.wss?uid=swg1IT06471</URL>
		<URL description="IT06471: DATAPOWER APPLIANCE USING A SFTP POLLER MIGHT EXPERIENCE AN IMMEDIATE RESTART (Fixed in 7.1.0.5): ">http://www.ibm.com/support/docview.wss?uid=swg1IT06471</URL>
		<Expression LogLevel="Error" FormulaIDMatch="V710FirmwareCheck">
			<Section Name="Backtrace" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And">Thread 0x[0-9a-fA-F]*\: (\d{4}\-\d{2}\-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z)</Condition>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="Domain" Operation="NotEqualTo" Value="" NextOperation="And">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="Config" Operation="NotEqualTo" Value="" NextOperation="And">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Component" Operation="EqualsTo" Value="source-sftp-poller">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
		</Expression>
	</Formula>
	
	<Formula Categories="failure">
		<Name>Backtrace on {Condition:Timestamp} Contained source-sftp-poller component in Domain={Condition:Domain}, Config={Condition:Config}.  Possible APAR's listed, may need investigation by IBM support.</Name>
		<URL description="IT09825 (Fixed in 7.2.0.1): MANY CONCURRENT SFTP POLLER CONNECTIONS MIGHT RESULT IN AN UNEXPECTED IMMEDIATE RESTART: ">http://www.ibm.com/support/docview.wss?uid=swg1IT06471</URL>
		<Expression LogLevel="Error" FormulaIDMatch="V720FirmwareCheck">
			<Section Name="Backtrace" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And">Thread 0x[0-9a-fA-F]*\: (\d{4}\-\d{2}\-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z)</Condition>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="Domain" Operation="NotEqualTo" Value="" NextOperation="And">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="Config" Operation="NotEqualTo" Value="" NextOperation="And">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Component" Operation="EqualsTo" Value="source-sftp-poller">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
		</Expression>
	</Formula>
	<!-- end of SFTP poller APAR tracking -->
	
	
	<!-- begin of CVE-2014-3566 tracking -->
	<Formula CollapseResult="true" FormulaID="FirmwareV4OrHigherCheck">
		<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion" SectionName="false" XPath="/Status/FirmwareVersion//Version"/>
				<Section Name="FirmwareVersion2" SectionName="false" XPath="/Status/FirmwareVersion2//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="GreaterThan" Value="4"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration">
		<Name>{Condition:SectionName} Crypto Profile {Condition:ObjectName} has SSLv3 enabled.</Name>
		<URL description="Security Bulletin: Vulnerability in SSLv3 affects DataPower (CVE-2014-3566): ">http://www.ibm.com/support/docview.wss?uid=swg21687189</URL>
		<URL description="Disable SSLv3 in DataPower Web management and XML management services: ">http://www.ibm.com/support/docview.wss?uid=swg21687774</URL>
		<Expression LogLevel="Warning" FormulaIDMatch="FirmwareV4OrHigherCheck">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\b(profile \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit)\b</RegExp>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ConfigInfo" Operation="NotContain" Value="Disable-SSLv3"/>
		</Expression>
	</Formula>
	<!-- end of CVE-2014-3566 tracking -->
	
	
	<!-- begin of CVE-2014-0224 tracking -->
	<Formula Categories="configuration">
		<Name>SSL Vulnerability CVE-2014-0224 exists prior to 5.0.0.15 fixpack level.</Name>
		<URL description="IT02314: CVE-2014-0224 - VULNERABILITY IN SSL CHANGECIPHERSPEC PROCESSING: ">http://www.ibm.com/support/docview.wss?uid=swg1IT02314</URL>
		<URL description="Critical updates for IBM DataPower Gateways: ">http://www.ibm.com/support/docview.wss?uid=swg21390112</URL>
		<Expression LogLevel="Critical" ExpressionGroup="5.0.0.15Level">
				<Section Name="FirmwareVersion" SectionName="false" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="5" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="15"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration">
		<Name>SSL Vulnerability CVE-2014-0224 exists prior to 6.0.0.7 fixpack level.</Name>
		<URL description="IT02314: CVE-2014-0224 - VULNERABILITY IN SSL CHANGECIPHERSPEC PROCESSING: ">http://www.ibm.com/support/docview.wss?uid=swg1IT02314</URL>
		<URL description="Critical updates for IBM DataPower Gateways: ">http://www.ibm.com/support/docview.wss?uid=swg21390112</URL>
		<Expression LogLevel="Critical" ExpressionGroup="6.0.0.7Level">
				<Section Name="FirmwareVersion" SectionName="false" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="7"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration">
		<Name>SSL Vulnerability CVE-2014-0224 exists prior to 6.0.1.3 fixpack level.</Name>
		<URL description="IT02314: CVE-2014-0224 - VULNERABILITY IN SSL CHANGECIPHERSPEC PROCESSING: ">http://www.ibm.com/support/docview.wss?uid=swg1IT02314</URL>
		<URL description="Critical updates for IBM DataPower Gateways: ">http://www.ibm.com/support/docview.wss?uid=swg21390112</URL>
		<Expression LogLevel="Critical" ExpressionGroup="6.0.1.3Level">
				<Section Name="FirmwareVersion" SectionName="false" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="3"/>
		</Expression>
	</Formula>
	<!-- end of CVE-2014-0224 tracking -->
	
	
	<!-- begin of CVE-2015-0235 and CVE-2014-6040 tracking -->
	<Formula Categories="configuration">
		<Name>(CVE-2015-0235 and CVE-2014-6040) IT06941: SECURITY ISSUES IN SOME GNU C LIBRARY (GLIBC) FUNCTIONS</Name>
		<URL description="IT06941: SECURITY ISSUES IN SOME GNU C LIBRARY (GLIBC) FUNCTIONS: ">http://www.ibm.com/support/docview.wss?uid=swg1IT06941</URL>
		<Expression LogLevel="Critical">
				<Section Name="FirmwareVersion" SectionName="false" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="12"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration">
		<Name>(CVE-2015-0235 and CVE-2014-6040) IT06941: SECURITY ISSUES IN SOME GNU C LIBRARY (GLIBC) FUNCTIONS</Name>
		<URL description="IT06941: SECURITY ISSUES IN SOME GNU C LIBRARY (GLIBC) FUNCTIONS: ">http://www.ibm.com/support/docview.wss?uid=swg1IT06941</URL>
		<Expression LogLevel="Critical">
				<Section Name="FirmwareVersion" SectionName="false" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="8"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration">
		<Name>(CVE-2015-0235 and CVE-2014-6040) IT06941: SECURITY ISSUES IN SOME GNU C LIBRARY (GLIBC) FUNCTIONS</Name>
		<URL description="IT06941: SECURITY ISSUES IN SOME GNU C LIBRARY (GLIBC) FUNCTIONS: ">http://www.ibm.com/support/docview.wss?uid=swg1IT06941</URL>
		<Expression LogLevel="Critical">
				<Section Name="FirmwareVersion" SectionName="false" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="5"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration">
		<Name>(CVE-2015-0235 and CVE-2014-6040) IT06941: SECURITY ISSUES IN SOME GNU C LIBRARY (GLIBC) FUNCTIONS</Name>
		<URL description="IT06941: SECURITY ISSUES IN SOME GNU C LIBRARY (GLIBC) FUNCTIONS: ">http://www.ibm.com/support/docview.wss?uid=swg1IT06941</URL>
		<Expression LogLevel="Critical">
				<Section Name="FirmwareVersion" SectionName="false" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="3"/>
		</Expression>
	</Formula>
	<!-- end of CVE-2015-0235 and CVE-2014-6040 tracking -->
	
	
	
	<Formula Categories="configuration;memory;failure">
		<Name>{Condition:SectionName} {Condition:Timestamp} issues communicating to LDAP MSGID mismatch against server {Condition:ServerName}.</Name>
		<URL description="IC99958 (Fixed in 6.0.0.6, and 6.0.1.2): LDAP SEARCHES MIGHT FAIL WITH 'MSGID MISMATCH' ERROR IF USING LDAP CONNECTION POOLING (this may cause high memory): ">http://www.ibm.com/support/docview.wss?uid=swg1IC99958</URL>
		<Expression LogLevel="Error">
			<Section Name="DiagnosticLog" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>Searching LDAP server</IndexSearch>
			<RegExp>1,([0-9TZ.]+),([a-zA-Z0-9-_]+),.*,"Searching LDAP server ([a-zA-Z0-9.\-_]+) for .* failed: MSGID mismatch.*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ServerName" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;failure">
		<Name>{Condition:SectionName} {Condition:Timestamp} LDAP server {Condition:ServerName} throwing unknown reply tag 115 error.</Name>
		<DisplayMessage>{Condition:LineInfo}</DisplayMessage>
		<URL description="IBM WebSphere DataPower SOA Appliance: Searching LDAP server results in message..: ">http://www.ibm.com/support/docview.wss?uid=swg21404222</URL>
		<Expression LogLevel="Warning">
			<Section Name="DiagnosticLog" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>Searching LDAP server</IndexSearch>
			<RegExp>1,([0-9TZ.]+),([a-zA-Z0-9-_]+),.*,"Searching LDAP server ([a-zA-Z0-9.\-_]+) for .* failed: Unknown reply tag 115</RegExp>
			<Condition FieldPosition="0" RegGroup="All" ConditionName="LineInfo" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ServerName" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<!-- ethernet interface restriction APAR IT05767 7.0.0.5, 7.1.0.3-->
	<Formula Categories="configuration;memory;failure">
		<Name>{Condition:SectionName} {Condition:Timestamp} Interface {Condition:InterfaceName} is reporting as invalid; this interface will not come up until configuration is resolved.</Name>
		<URL description="IT05767 (Fixed in 7.0.0.5 and 7.1.0.3): RESTORE THE ABILITY TO USE ADDITIONAL VNICS DEFINED IN THE VMWARE HYPERVISOR: ">http://www.ibm.com/support/docview.wss?uid=swg1IT05767</URL>
		<Expression LogLevel="Critical">
			<Section Name="DiagnosticLog" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>Invalid Ethernet interface name </IndexSearch>
			<RegExp>1,([0-9TZ.]+),[a-zA-Z0-9-_]+,.*,"Invalid Ethernet interface name '([a-zA-Z0-9.\-_]+)'.*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="InterfaceName" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- not going to bother checking the version of firmware, this still might be useful even if the APAR doesn't apply so L2 is aware there is a bad config -->
	<!-- end of ethernet interface tracking -->
	
	<!-- tracking of ephemeral port range -->
		<Formula Categories="configuration">
		<Name>{Condition:SectionName} Customer has a service running on {Condition:PortNumber} - this is inside the ephemeral range of {Condition:MinEphemeralPort} - {Condition:MaxEphemeralPort}.</Name>
		<URL description="WebSphere DataPower - Best practice for specifying port values: ">http://www.ibm.com/support/docview.wss?uid=swg21427424</URL>
		<Expression LogLevel="Warning">
			<Section Name="DiagnosticLog" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch> is within the ephemeral range </IndexSearch>
			<RegExp>1,([0-9TZ.]+),([a-zA-Z0-9-_]+),.*,"Requested port \(([0-9]+)\) is within the ephemeral range \(([0-9]+) - ([0-9]+)\)"</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="PortNumber" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="MinEphemeralPort" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="5" RegGroup="All" ConditionName="MaxEphemeralPort" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- end of ephemeral port range check -->
	
	<!-- Find strip-attachments actions -->
	
		<!-- firmware check of 7.0.0.2 for strip attachment formula -->
		<Formula CollapseResult="true" FormulaID="7002FirmwareCheck">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="2"/>
			</Expression>
		</Formula>
		
		<Formula Categories="configuration;failure">
			<Name>{Condition:SectionName} There is an Strip Attachments Action {Condition:ObjectName} configured.</Name>
			<URL description="IT03488 (Fixed in 7.0.0.2): STRIP-ATTACHMENTS ACTION MIGHT CAUSE A RESTART UNDER CERTAIN CIRCUMSTANCES: ">http://www.ibm.com/support/docview.wss?uid=swg1IT03488</URL>
			<Expression LogLevel="Warning" FormulaIDMatch="7002FirmwareCheck">
				<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
				<RegExp>*</RegExp>
				<Condition FieldPosition="2" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And">\b(action \"([a-zA-Z-_.0-9]+).*\"\W+(\w+\W+)*?exit)\b</Condition>
				<Condition FieldPosition="1" RegGroup="All" ConditionName="ConfigInfo" Operation="Contains" Value="type strip-attachments">\b(action \"([a-zA-Z-_.0-9]+).*\"\W+(\w+\W+)*?exit)\b</Condition>
			</Expression>
		</Formula>
		<!-- end 7.0.0.2 strip attachment check -->

		<!-- firmware check of 6.0.1.5 for strip attachment formula -->
		<Formula CollapseResult="true" FormulaID="6015FirmwareCheck">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="5"/>
			</Expression>
		</Formula>
		
		<Formula Categories="configuration;failure">
			<Name>{Condition:SectionName} There is an Strip Attachments Action {Condition:ObjectName} configured.</Name>
			<URL description="IT03488 (Fixed in 6.0.1.5): STRIP-ATTACHMENTS ACTION MIGHT CAUSE A RESTART UNDER CERTAIN CIRCUMSTANCES: ">http://www.ibm.com/support/docview.wss?uid=swg1IT03488</URL>
			<Expression LogLevel="Warning" FormulaIDMatch="6015FirmwareCheck">
				<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
				<RegExp>*</RegExp>
				<Condition FieldPosition="2" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And">\b(action \"([a-zA-Z-_.0-9]+).*\"\W+(\w+\W+)*?exit)\b</Condition>
				<Condition FieldPosition="1" RegGroup="All" ConditionName="ConfigInfo" Operation="Contains" Value="type strip-attachments">\b(action \"([a-zA-Z-_.0-9]+).*\"\W+(\w+\W+)*?exit)\b</Condition>
			</Expression>
		</Formula>
	<!-- End of finding strip-attachments actions -->
	
	
	
	<!-- tracking of front side handler use of compression for APAR IT04947 -->
	<Formula CollapseResult="true" FormulaID="60012FirmwareCheck">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="12"/>
			</Expression>
		</Formula>
		
	<Formula Categories="configuration;cpuload;network">
		<Name>{Condition:SectionName} There is a {Condition:ComponentType} Object {Condition:ObjectName} configured with compression on.</Name>
		<URL description="IT04947 (Fixed in 6.0.0.12): READING OF CHUNKED ENCODING WITH HTTP BODY COMPRESSION MAY CAUSE UNEXPECTED BEHAVIOR UNABLE TO PROCESS REQUEST OR RESPONSE: ">http://www.ibm.com/support/docview.wss?uid=swg1IT04947</URL>
			<Expression LogLevel="Warning" FormulaIDMatch="60012FirmwareCheck">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\b((wsgw|mpgw|source-http[s]?) \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit)\b</RegExp>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ComponentType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ConfigInfo" Operation="Contains" Value="compression" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ConfigInfo" Operation="NotContain" Value="no compression"/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" FormulaID="6018FirmwareCheck">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="8"/>
			</Expression>
		</Formula>
		
		<Formula Categories="configuration;cpuload;network">
		<Name>{Condition:SectionName} There is a {Condition:ComponentType} Object {Condition:ObjectName} configured with compression on.</Name>
		<URL description="IT04947 (Fixed in 6.0.1.8): READING OF CHUNKED ENCODING WITH HTTP BODY COMPRESSION MAY CAUSE UNEXPECTED BEHAVIOR UNABLE TO PROCESS REQUEST OR RESPONSE: ">http://www.ibm.com/support/docview.wss?uid=swg1IT04947</URL>
			<Expression LogLevel="Warning" FormulaIDMatch="6018FirmwareCheck">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\b((wsgw|mpgw|source-http[s]?) \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit)\b</RegExp>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ComponentType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ConfigInfo" Operation="Contains" Value="compression" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ConfigInfo" Operation="NotContain" Value="no compression"/>
		</Expression>
	</Formula>
	
	
	<Formula CollapseResult="true" FormulaID="7005FirmwareCheck">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="5"/>
			</Expression>
		</Formula>
		
		<Formula Categories="configuration;cpuload;network">
		<Name>{Condition:SectionName} There is a {Condition:ComponentType} Object {Condition:ObjectName} configured with compression on.</Name>
		<URL description="IT04947 (Fixed in 7.0.0.5): READING OF CHUNKED ENCODING WITH HTTP BODY COMPRESSION MAY CAUSE UNEXPECTED BEHAVIOR UNABLE TO PROCESS REQUEST OR RESPONSE: ">http://www.ibm.com/support/docview.wss?uid=swg1IT04947</URL>
			<Expression LogLevel="Warning" FormulaIDMatch="7005FirmwareCheck">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\b((wsgw|mpgw|source-http[s]?) \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit)\b</RegExp>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ComponentType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ConfigInfo" Operation="Contains" Value="compression" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ConfigInfo" Operation="NotContain" Value="no compression"/>
		</Expression>
	</Formula>
	
	
		<Formula CollapseResult="true" FormulaID="7103FirmwareCheck">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="3"/>
			</Expression>
		</Formula>
		
	<Formula Categories="configuration;cpuload;network">
		<Name>{Condition:SectionName} There is a {Condition:ComponentType} Object {Condition:ObjectName} configured with compression on.</Name>
		<URL description="IT04947 (Fixed in 7.1.0.3): READING OF CHUNKED ENCODING WITH HTTP BODY COMPRESSION MAY CAUSE UNEXPECTED BEHAVIOR UNABLE TO PROCESS REQUEST OR RESPONSE: ">http://www.ibm.com/support/docview.wss?uid=swg1IT04947</URL>
			<Expression LogLevel="Warning" FormulaIDMatch="7103FirmwareCheck">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\b((wsgw|mpgw|source-http[s]?) \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit)\b</RegExp>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ComponentType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ConfigInfo" Operation="Contains" Value="compression" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ConfigInfo" Operation="NotContain" Value="no compression"/>
		</Expression>
	</Formula>
	<!-- end of APAR IT04947 tracking -->
		
	<Formula Categories="configuration;memory">
		<Name>{Condition:SectionName} There is a TAM object {Condition:ObjectName} configured with tracing enabled, this may cause low temporary space!</Name>
		<DisplayMessage>TAM File is &lt;b&gt;{Condition:TamFileEnabled}&lt;/b&gt; using file &lt;b&gt;{Condition:TamFileName}&lt;/b&gt; max byte size &lt;b&gt;{Condition:TamFileSize}&lt;/b&gt;.&lt;br&gt;LDAP File is &lt;b&gt;{Condition:LdapFileEnabled}&lt;/b&gt; using file &lt;b&gt;{Condition:LdapFileName}&lt;/b&gt; max byte size &lt;b&gt;{Condition:LdapFileSize}&lt;/b&gt;.&lt;br&gt;GSKit File is &lt;b&gt;{Condition:GSKitEnabled}&lt;/b&gt; using file &lt;b&gt;{Condition:GSKitFileName}&lt;/b&gt;, gskit does not have a file size limit.</DisplayMessage>
		<URL description="Knowledge Center tam-ras-trace debugging tool (7.1.0): ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_7.1.0/com.ibm.dp.doc/tam-ras-trace_tam.html</URL>
		<Expression LogLevel="Error">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>((tam \"([a-zA-Z-_.0-9]{0,40})\"|tam-ras-trace \"on\" \"([a-zA-Z-_.0-9]{0,40})\" \"([0-9]{0,20})\" \"([a-zA-Z-_.0-9]{0,40})\" \"([a-zA-Z-_.*:0-9]{0,40})\" \"(on|off)\" \"([a-zA-Z-_.0-9]{0,40})\" \"([0-9]{0,20})\" \"([0-9]{0,20})\" \"(on|off)\" \"([a-zA-Z-_.0-9]{0,40})\" \"(on|off)\")|exit)</RegExp>
			<Condition FieldPosition="3" RegGroup="Ordered" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="Ordered" ConditionName="TamFileName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="5" RegGroup="Ordered" ConditionName="TamFileSize" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="8" RegGroup="Ordered" ConditionName="TamFileEnabled" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="9" RegGroup="Ordered" ConditionName="LdapFileName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="10" RegGroup="Ordered" ConditionName="LdapFileSize" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="12" RegGroup="Ordered" ConditionName="LdapFileEnabled" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="13" RegGroup="Ordered" ConditionName="GSKitFileName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="14" RegGroup="Ordered" ConditionName="GSKitEnabled" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>

	<Formula Categories="configuration;memory">
		<Name>{Condition:SectionName} There is an XML Manager {Condition:ObjectName} configured with a scheduled-rule.</Name>
		<DisplayMessage>Rule {Condition:ConfigInfo} is ran every {Condition:TimeSeconds} seconds.</DisplayMessage>
		<URL description="DataPower Scheduled Rules if polling SOMA constantly with a large set of status providers can cause high cpu, load or other delays with traffic: ">TBD Technote</URL>
		<Expression LogLevel="Warning">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>((xml-manager \"([a-zA-Z-_.0-9]{0,40})\"|schedule-rule \"([a-zA-Z-_.0-9]{0,40})\"\s\"([0-9]{0,10})\")|exit)</RegExp>
			<Condition FieldPosition="3" RegGroup="Ordered" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="Ordered" ConditionName="ConfigInfo" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="5" RegGroup="Ordered" ConditionName="TimeSeconds" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<!-- track APAR IT06691 on 7.1.0.0 - 7.1.0.3 -->
	<Formula CollapseResult="true" FormulaID="NonXB7104FirmwareCheck">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="1" Operation="NotContain" Value="XB" NextOperation="And"/>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="4"/>
			</Expression>
	</Formula>

	<Formula Categories="configuration;failure">
		<Name>{Condition:SectionName} There is a logging target {Condition:ObjectName} configured for SMTP, this will throw invalid URL unless upgraded to 7.1.0.4.</Name>
		<URL description="APAR IT06691 (Fixed v7.1.0.4): ">http://www.ibm.com/support/docview.wss?uid=swg1IT06691</URL>
		<Expression LogLevel="Error" FormulaIDMatch="NonXB7104FirmwareCheck">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>((logging target \"([a-zA-Z-_.0-9]{0,40})\"|type (smtp))|exit)</RegExp>
			<Condition FieldPosition="3" RegGroup="Ordered" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="Ordered" ConditionName="SMTPCheck" Operation="EqualsTo" Value="smtp"/>
		</Expression>
	</Formula>
	<!-- end of IT06691 tracking -->
	
	<!-- tcp table handlers -->
	<Formula Categories="memory;cpuload;network" CollapseResult="true" CondenseCondition="CombinedIPPort" SortCondition="CondenseCondition" SortMethod="descending">
		<Name>{Condition:SectionName} (Backside) Local IP/Port(Ephemeral/Listener): &lt;font color='#CC0066'&gt;{Condition:localIP}:{Condition:localPort}&lt;/font&gt; - Remote IP/Port: &lt;font color='#CC0066'&gt;{Condition:RemoteIPAndPort}&lt;/font&gt;</Name>
		<Expression LogLevel="Info">
			<Section Name="TCPTable" Wildcard="True" XPath="/Status/TCPTable[state/text()!='listen' and serviceClass/text() = 'MQGW' and localIP/text() != '127.0.0.1']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="{/Status/TCPTable/serviceClass[../state/text()!='listen' and ../serviceClass/text() = 'MQGW' and ../localIP/text() != '127.0.0.1']}" ConditionName="ServiceClass" Operation="EqualsTo" Value="MQGW" NextOperation="And"/>
			<Condition FieldPosition="{/Status/TCPTable/localIP[../state/text()!='listen' and ../serviceClass/text() = 'MQGW' and ../localIP/text() != '127.0.0.1']}" ConditionName="localIP" Operation="NotEqualTo" Value="127.0.0.1" NextOperation="And"/>
			<Condition FieldPosition="{/Status/TCPTable/localPort[../state/text()!='listen' and ../serviceClass/text() = 'MQGW' and ../localIP/text() != '127.0.0.1']}" ConditionName="localPort" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/TCPTable/remoteIP[../state/text()!='listen' and ../serviceClass/text() = 'MQGW' and ../localIP/text() != '127.0.0.1']}" ConditionName="remoteIP" Operation="Append" Value=":" NextOperation="And"/>
			<Condition FieldPosition="{Condition:remoteIP}" ConditionName="RemoteIPAndPort" Operation="Append" Value="{/Status/TCPTable//remotePort[../state/text()!='listen' and ../serviceClass/text() = 'MQGW' and ../localIP/text() != '127.0.0.1']}" NextOperation="And"/>
			<Condition FieldPosition="{Condition:localIP}" ConditionName="LocalIPAndSpace" Operation="Append" Value=" , " NextOperation="And"/>
			<Condition FieldPosition="{Condition:LocalIPAndSpace}" ConditionName="CombinedIPPort" Operation="Append" Value="{Condition:RemoteIPAndPort}"/>
		</Expression>
	</Formula>
	
	<Formula Categories="memory;cpuload;network" CollapseResult="true" CondenseCondition="LocalIPAndPort" SortCondition="CondenseCondition" SortMethod="descending">
		<Name>{Condition:SectionName} (Front-Side) Domain: {Condition:serviceDomain}, Service Name: {Condition:serviceName} Local IP/Port: &lt;font color='#CC0066'&gt;{Condition:LocalIPAndPort}&lt;/font&gt;</Name>
		<Expression LogLevel="Info">
			<Section Name="TCPTable" Wildcard="True" XPath="/Status/TCPTable[state/text()!='listen' and serviceClass/text() != 'MQGW']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="{/Status/TCPTable/serviceClass[../state/text()!='listen' and ../serviceClass/text() != 'MQGW']}" ConditionName="ServiceClass" Operation="NotEqualTo" Value="MQGW" NextOperation="And"/>
			<Condition FieldPosition="{/Status/TCPTable/serviceDomain[../state/text()!='listen' and ../serviceClass/text() != 'MQGW']}" ConditionName="serviceDomain" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/TCPTable/serviceName[../state/text()!='listen' and ../serviceClass/text() != 'MQGW']}" ConditionName="serviceName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/TCPTable/localIP[../state/text()!='listen' and ../serviceClass/text() != 'MQGW']}" ConditionName="localIP" Operation="Append" Value=":" NextOperation="And"/>
			<Condition FieldPosition="{Condition:localIP}" ConditionName="LocalIPAndPort" Operation="Append" Value="{/Status/TCPTable/localPort[../state/text()!='listen' and ../serviceClass/text() != 'MQGW']}"/>
		</Expression>
	</Formula>
	
	<Formula Categories="memory;cpuload;network" CollapseResult="true" CondenseCondition="LocalIPAndPort" SortCondition="CondenseCondition" SortMethod="descending">
		<Name>{Condition:SectionName} (Loopback) Local IP/Port: &lt;font color='#CC0066'&gt;{Condition:LocalIPAndPort}&lt;/font&gt; RemotePort (Ephemeral/Listener): {Condition:remotePort}</Name>
		<Expression LogLevel="Info">
			<Section Name="TCPTable" Wildcard="True" XPath="/Status/TCPTable[state/text()!='listen' and localIP/text() = '127.0.0.1' and serviceClass/text() = 'MQGW']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="{/Status/TCPTable/localIP[../state/text()!='listen' and ../localIP/text() = '127.0.0.1' and ../serviceClass/text() = 'MQGW']}" ConditionName="localIP" Operation="EqualsTo" Value="127.0.0.1" NextOperation="And"/>
			<Condition FieldPosition="{/Status/TCPTable/remotePort[../state/text()!='listen' and ../localIP/text() = '127.0.0.1' and ../serviceClass/text() = 'MQGW']}" ConditionName="remotePort" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{Condition:localIP}" ConditionName="localIPAppended" Operation="Append" Value=":" NextOperation="And"/>
			<Condition FieldPosition="{Condition:localIPAppended}" ConditionName="LocalIPAndPort" Operation="Append" Value="{/Status/TCPTable/localPort[../state/text()!='listen' and ../localIP/text() = '127.0.0.1' and ../serviceClass/text() = 'MQGW']}"/>
		</Expression>
	</Formula>
	
	<!-- MQ appliance driven tcp tables -->
	<Formula Categories="memory;cpuload;network" CollapseResult="true" CondenseCondition="LocalIPAndPort" SortCondition="CondenseCondition" SortMethod="descending">
		<Name>{Condition:SectionName} (MQ Listeners) Local IP/Port: &lt;font color='#CC0066'&gt;{Condition:LocalIPAndPort}&lt;/font&gt;</Name>
		<Expression LogLevel="Info">
			<Section Name="TCPTable" Wildcard="True" XPath="/Status/TCPTable[state/text()='listen' and serviceClass/text() = 'None']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="{/Status/TCPTable/serviceClass[../state/text()='listen' and ../serviceClass/text() = 'None']}" ConditionName="ServiceClass" Operation="NotEqualTo" Value="MQGW" NextOperation="And"/>
			<!-- MQ appliance seems to not have serviceName or domain on the majority of its connections -->
			<Condition FieldPosition="{/Status/TCPTable/serviceDomain[../state/text()='listen' and ../serviceClass/text() = 'None']}" ConditionName="serviceDomain" Operation="EqualsTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/TCPTable/serviceName[../state/text()='listen' and ../serviceClass/text() = 'None']}" ConditionName="serviceName" Operation="EqualsTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/TCPTable/localIP[../state/text()='listen' and ../serviceClass/text() = 'None']}" ConditionName="localIP" Operation="Append" Value=":" NextOperation="And"/>
			<Condition FieldPosition="{Condition:localIP}" ConditionName="LocalIPAndPort" Operation="Append" Value="{/Status/TCPTable/localPort[../state/text()='listen' and ../serviceClass/text() = 'None']}"/>
		</Expression>
	</Formula>
	
	<Formula Categories="memory;cpuload;network" CollapseResult="true" CondenseCondition="LocalIPAndPort" SortCondition="CondenseCondition" SortMethod="descending">
		<Name>{Condition:SectionName} (Service Traffic) Local IP/Port: &lt;font color='#CC0066'&gt;{Condition:LocalIPAndPort}&lt;/font&gt;</Name>
		<Expression LogLevel="Info">
			<Section Name="TCPTable" Wildcard="True" XPath="/Status/TCPTable[state/text()!='listen' and serviceClass/text() = 'None']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="{/Status/TCPTable/serviceClass[../state/text()!='listen' and ../serviceClass/text() = 'None']}" ConditionName="ServiceClass" Operation="NotEqualTo" Value="MQGW" NextOperation="And"/>
			<!-- MQ appliance seems to not have serviceName or domain on the majority of its connections -->
			<Condition FieldPosition="{/Status/TCPTable/serviceDomain[../state/text()!='listen' and ../serviceClass/text() = 'None']}" ConditionName="serviceDomain" Operation="EqualsTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/TCPTable/serviceName[../state/text()!='listen' and ../serviceClass/text() = 'None']}" ConditionName="serviceName" Operation="EqualsTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/TCPTable/localIP[../state/text()!='listen' and ../serviceClass/text() = 'None']}" ConditionName="localIP" Operation="Append" Value=":" NextOperation="And"/>
			<Condition FieldPosition="{Condition:localIP}" ConditionName="LocalIPAndPort" Operation="Append" Value="{/Status/TCPTable/localPort[../state/text()!='listen' and ../serviceClass/text() = 'None']}"/>
		</Expression>
	</Formula>
	<!-- MQ appliance driven tcp tables end -->
	
	<!-- end tcp table handling -->
	
	<Formula Categories="configuration;memory;failure;cpuload" CollapseResult="true">
		<Name>[Sidecar Data] FD: {Condition:FileDescriptor} Sidecar: {Condition:SidecarName}</Name>
		<Expression LogLevel="Info">
			<Section Name="&lt;FileDescriptors@datapower.ibm.com&gt;" XPath="/Root/text()"/>
			<RegExp>([0-9]+)\s+[a-z]{1}\s+-\s+-\s+ramdisk2/sidecar-([a-zA-Z_.0-9\-]+)</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="FileDescriptor" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="SidecarName" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<!-- todo: After April we need to set fixpack checks -->
	<Formula Categories="configuration;memory;failure;cpuload">
		<Name>{Condition:SectionName} - reports a count of {Condition:DisableEntries} disable cache or flush entries.  If this count is high and customer experiences instability, watchdog or latency type issues review urlrefresh objects in this domain for duplicate attributes such as disable cache and flush.</Name>
		<URL description="IT03762: URLREFRESH CONFIGURATION PROPERTIES CONTAINS DUPLICATE ENTRIES (6.0.0.13, 6.0.1.9, 7.0.0.6, 7.1.0.5): ">http://www.ibm.com/support/docview.wss?uid=swg1IT03762</URL>
		<Expression LogLevel="Error">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>(disable cache|disable flush).*</RegExp>
			<Condition FieldPosition="1" RegGroup="Count" ConditionName="DisableEntries" Operation="GreaterThan" Value="1000"/>
		</Expression>
	</Formula>
	
	

	<Formula CollapseResult="true" FormulaID="APAR-IT11825-IT11824-Fixpacks">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="18"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="14"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="11"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="8"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="2" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="2"/>
			</Expression>
	</Formula>
	
	<Formula Categories="configuration;cpuload">
		<Name>{Condition:SectionName} Domain {/Status//DomainStatus/Domain} is currently running the command {Condition:CurrentCommand}, review WebGUI Domain Status or CLI show domains to see if secure-backup command persists. If command persists, reload or reboot may be required to resolve.</Name>
		<URL FormulaIDMatch="APAR-IT11825-IT11824-Fixpacks" description="IT11825: USING SECURE BACKUP CAN LEAD TO UNEXPECTED BEHAVIOR INCLUDING HUNG TRANSACTIONS AND RESTARTS (6.0.0.18, 6.0.1.14, 7.0.0.11, 7.1.0.8 and 7.2.0.2): ">http://www.ibm.com/support/docview.wss?uid=swg1IT11825</URL>
		<URL FormulaIDMatch="APAR-IT11825-IT11824-Fixpacks" description="IT11824: IN RARE CASES, USING SECURE BACKUP CAN LEAD TO UNEXPECTED BEHAVIOR INCLUDING RESTARTS OR HUNG TRANSACTIONS. (6.0.0.18, 6.0.1.14, 7.0.0.11, 7.1.0.8 and 7.2.0.2): ">http://www.ibm.com/support/docview.wss?uid=swg1IT11824</URL>
		<URL FormulaIDMatch="APAR-IT10598-OR-IT11147-Fixpacks" description="IT10598: SECURE-BACKUP MAY CAUSE DEVICE TO HANG UNEXPECTEDLY (6.0.0.17, 6.0.1.13, 7.0.0.10, 7.1.0.7, 7.2.0.2): ">http://www.ibm.com/support/docview.wss?uid=swg1IT10598</URL>
		<URL description="Best Practices on secure-backup and restore: ">http://www.ibm.com/developerworks/websphere/library/techarticles/1009_furbee/1009_furbee.html</URL>
		<URL description="Backing up, exporting and importing the configuration of an IBM WebSphere DataPower SOA Appliance or Virtual Edition: ">http://www.ibm.com/support/docview.wss?uid=swg21416135</URL>
		<Expression LogLevel="Critical">
			<Section Name="DomainStatus" XPath="/Status//DomainStatus/CurrentCommand"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="CurrentCommand" Operation="EqualsTo" Value="secure-backup"/>
		</Expression>
	</Formula> 
	
	<Formula Categories="configuration;cpuload">
		<Name>Domain {/Status//DomainStatus/Domain} is currently running the command {Condition:CurrentCommand} (Warning!).</Name>
		<Expression LogLevel="Warning">
			<Section Name="DomainStatus" XPath="/Status//DomainStatus/CurrentCommand"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="CurrentCommand" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" ConditionName="CurrentCommand" Operation="NotEqualTo" Value="secure-backup"/>
		</Expression>
	</Formula> 
	
		<!-- track APAR IT09552 on fixpacks below 6.0.0.16, 6.0.1.12, 7.0.0.9, 7.1.0.6 and 7.2.0.2 -->
		<Formula CollapseResult="true" FormulaID="APAR-IT09552-6.0VersionChecks">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="16"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="12"/>
			</Expression>
	</Formula>
	
	<Formula CollapseResult="true" FormulaID="APAR-IT09552-7.0LaterVersionChecks">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="9"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="6"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="2" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="2"/>
			</Expression>
	</Formula>

	<Formula Categories="configuration;memory" FormulaID="APAR-IT09552">
		<Name>{Condition:SectionName} There is a logging target {Condition:ObjectName} configured for SFTP, temporary space may be exhausted when remote endpoint is unavailable.</Name>
		<URL FormulaIDMatch="APAR-IT09552-6.0VersionChecks" description="IT09552: ARCHIVE MODE LOG TARGET MAY CONSUME TEMPORARY SPACE IF REMOTE SERVER IS DOWN (Fixed in 6.0.0.16, 6.0.1.12): ">http://www.ibm.com/support/docview.wss?uid=swg1IT09552</URL>
		<URL FormulaIDMatch="APAR-IT09552-7.0LaterVersionChecks" description="IT09552: ARCHIVE MODE LOG TARGET MAY CONSUME TEMPORARY SPACE IF REMOTE SERVER IS DOWN (Fixed in 7.0.0.9, 7.1.0.6 and 7.2.0.2): ">http://www.ibm.com/support/docview.wss?uid=swg1IT09552</URL>
		<Expression LogLevel="Critical" FormulaIDMatch="APAR-IT09552-6.0VersionChecks">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>logging target \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(archive-mode ([a-zA-Z]+)|exit)</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" Operation="EqualsTo" Value="upload" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" Operation="EqualsTo" Value="sftp">logging target \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(upload-method ([a-zA-Z]+)|exit)</Condition>
		</Expression>
		<Expression LogLevel="Critical" FormulaIDMatch="APAR-IT09552-7.0LaterVersionChecks">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>logging target \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(archive-mode ([a-zA-Z]+)|exit)</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" Operation="EqualsTo" Value="upload" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" Operation="EqualsTo" Value="sftp">logging target \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(upload-method ([a-zA-Z]+)|exit)</Condition>
		</Expression>
	</Formula>
	<!-- end of IT09552 tracking -->
	
	<!-- Import Package / Execute AND Auto Execute Search -->
	<Formula Categories="configuration">
		<Name>{Condition:SectionName} Found {Condition:ObjectName} package is NOT configured with auto-execute OFF</Name>
		<DisplayMessage>{Condition:ObjectName} is NOT configured with auto-execute OFF, this causes the configuration not to be saved to the persisted (startup) configuration.</DisplayMessage>
		<Expression LogLevel="Critical">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\b(import-package \"([a-zA-Z-_0-9]+).*"\W+(\w+\W+)*?exit)\b</RegExp>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ConfigInfo" Operation="NotContain" Value="no auto-execute"/>
		</Expression>
	</Formula>
	<!-- End of Import Package / Execute AND Auto Execute Search -->
	
	
	<!-- new test MQ formula for AllResult RegGroup ( mq-qm backout settings required for units-of-work ) -->
	<Formula Categories="configuration;cpuload;memory" FormulaID="MQBadPracticeBackoutSettingsPrimary">
		<Name>&lt;font color='#CC3300'&gt;{Condition:SectionName}&lt;/font&gt; There is an Source-MQ Object &lt;font color='#CC3300'&gt;{Condition:SourceMQName}&lt;/font&gt; configured with QM Group &lt;font color='#CC3300'&gt;{Condition:QueueManagerName}&lt;/font&gt; and &lt;font color='#CC3300'&gt;{Condition:PrimaryQueue}&lt;/font&gt; as the primary queue.</Name>
		<DisplayMessage>When using units-of-work on the MQ-QM, the best practice is for the MQ-QM to have automatic-backout on and the source-mq or source-mqfte object to have retrieve-backout-settings off.  Having retrieve-backout-settings 'on' may cause higher resource consumption (memory/cpu/load).</DisplayMessage>
		<URL description="Best practices for integrating IBM WebSphere DataPower SOA Appliances with WebSphere MQ(automatic backout ON with units-of-work is best practice): ">http://www.ibm.com/developerworks/websphere/library/techarticles/1410_sahoo/1410_sahoo.html</URL>
		<URL description="Backout Settings Required with units-of-work: ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_7.1.0/com.ibm.dp.doc/mq_usingthebackoutsettingsfromthewebspheremqserver.html</URL>
		<Expression LogLevel="Critical">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="SourceMQName" Operation="NotEqualTo" Value="" NextOperation="And">source-mq[fte]{0,3} \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(queue-manager ([a-zA-Z-_.0-9]+)|exit)</Condition>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="QueueManagerName" Operation="NotEqualTo" Value="" NextOperation="And">source-mq[fte]{0,3} \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(queue-manager ([a-zA-Z-_.0-9]+)|exit)</Condition>
			<Condition FieldPosition="4" RegGroup="AllResult" ConditionName="PrimaryQueue" Operation="NotEqualTo" Value="" NextOperation="And">mq-qm-group \"({Condition:QueueManagerName})\"\W+(\w+\W+)*?(primary ([a-zA-Z-_.0-9]+)|exit)</Condition>
			<Condition FieldPosition="3" RegGroup="AllResult" Operation="EqualsTo" Value="exit" NextOperation="And">mq-qm \"({Condition:PrimaryQueue})\"\W+(\w+\W+)*?((?&lt;!no )automatic-backout|exit)</Condition>
			<Condition FieldPosition="3" RegGroup="AllResult" Operation="NotEqualTo" Value="exit">mq-qm \"({Condition:PrimaryQueue})\"\W+(\w+\W+)*?(units-of-work [1-9]+|exit)</Condition>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;cpuload;memory" FormulaID="MQBadPracticeBackoutSettingsBackup">
		<Name>&lt;font color='#CC3300'&gt;{Condition:SectionName}&lt;/font&gt; There is an Source-MQ Object &lt;font color='#CC3300'&gt;{Condition:SourceMQName}&lt;/font&gt; configured with QM Group &lt;font color='#CC3300'&gt;{Condition:QueueManagerName}&lt;/font&gt; and &lt;font color='#CC3300'&gt;{Condition:BackupQueue}&lt;/font&gt; as the backup queue.</Name>
		<DisplayMessage>When using units-of-work on the MQ-QM, the best practice is for the MQ-QM to have automatic-backout on and the source-mq or source-mqfte object to have retrieve-backout-settings off.  Having retrieve-backout-settings 'on' may cause higher resource consumption (memory/cpu/load).</DisplayMessage>
		<URL description="Best practices for integrating IBM WebSphere DataPower SOA Appliances with WebSphere MQ(automatic backout ON with units-of-work is best practice): ">http://www.ibm.com/developerworks/websphere/library/techarticles/1410_sahoo/1410_sahoo.html</URL>
		<URL description="Backout Settings Required with units-of-work: ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_7.1.0/com.ibm.dp.doc/mq_usingthebackoutsettingsfromthewebspheremqserver.html</URL>
		<Expression LogLevel="Warning">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="SourceMQName" Operation="NotEqualTo" Value="" NextOperation="And">source-mq[fte]{0,3} \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(queue-manager ([a-zA-Z-_.0-9]+)|exit)</Condition>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="QueueManagerName" Operation="NotEqualTo" Value="" NextOperation="And">source-mq[fte]{0,3} \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(queue-manager ([a-zA-Z-_.0-9]+)|exit)</Condition>
			<Condition FieldPosition="4" RegGroup="AllResult" ConditionName="BackupQueue" Operation="NotEqualTo" Value="" NextOperation="And">mq-qm-group \"({Condition:QueueManagerName})\"\W+(\w+\W+)*?(backup ([a-zA-Z-_.0-9]+)|exit)</Condition>
			<Condition FieldPosition="3" RegGroup="AllResult" Operation="EqualsTo" Value="exit" NextOperation="And">mq-qm \"({Condition:BackupQueue})\"\W+(\w+\W+)*?((?&lt;!no )automatic-backout|exit)</Condition>
			<Condition FieldPosition="3" RegGroup="AllResult" Operation="NotEqualTo" Value="exit">mq-qm \"({Condition:BackupQueue})\"\W+(\w+\W+)*?(units-of-work [1-9]+|exit)</Condition>
		</Expression>
	</Formula>

	<Formula Categories="configuration;cpuload;memory" FormulaID="MQBadPracticeBackoutSettingsNoMQGroup">
		<Name>&lt;font color='#CC3300'&gt;{Condition:SectionName}&lt;/font&gt; There is an Source-MQ Object &lt;font color='#CC3300'&gt;{Condition:SourceMQName}&lt;/font&gt; configured with the queue manager &lt;font color='#CC3300'&gt;{Condition:QueueManagerName}&lt;/font&gt;.</Name>
		<DisplayMessage>When using units-of-work on the MQ-QM, the best practice is for the MQ-QM to have automatic-backout on and the source-mq or source-mqfte object to have retrieve-backout-settings off.  Having retrieve-backout-settings 'on' may cause higher resource consumption (memory/cpu/load).</DisplayMessage>
		<URL description="Best practices for integrating IBM WebSphere DataPower SOA Appliances with WebSphere MQ(automatic backout ON with units-of-work is best practice): ">http://www.ibm.com/developerworks/websphere/library/techarticles/1410_sahoo/1410_sahoo.html</URL>
		<URL description="Backout Settings Required with units-of-work: ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_7.1.0/com.ibm.dp.doc/mq_usingthebackoutsettingsfromthewebspheremqserver.html</URL>
		<Expression LogLevel="Warning">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="SourceMQName" Operation="NotEqualTo" Value="" NextOperation="And">source-mq[fte]{0,3} \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(queue-manager ([a-zA-Z-_.0-9]+)|exit)</Condition>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="QueueManagerName" Operation="NotEqualTo" Value="" NextOperation="And">source-mq[fte]{0,3} \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(queue-manager ([a-zA-Z-_.0-9]+)|exit)</Condition>
			<Condition FieldPosition="3" RegGroup="AllResult" Operation="EqualsTo" Value="exit" NextOperation="And">mq-qm \"({Condition:QueueManagerName})\"\W+(\w+\W+)*?((?&lt;!no )automatic-backout|exit)</Condition>
			<Condition FieldPosition="3" RegGroup="AllResult" Operation="NotEqualTo" Value="exit">mq-qm \"({Condition:QueueManagerName})\"\W+(\w+\W+)*?(units-of-work [1-9]+|exit)</Condition>
		</Expression>
	</Formula>
	<!-- end of mq-qm backout settings required for units-of-work -->
	
	
	<Formula CollapseResult="true" FormulaID="APARIT09304FWCheck">
		<Expression LogLevel="Warning">
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="5" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="11"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="1" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="12"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="9"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="1" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="6"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="2" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="2"/>
		</Expression>
	</Formula>
	
	<Formula Categories="failure;general;cpuload">
		<Name>APAR IT09304 may cause instability at the current firmware level including unexpected reloads (can also occur if VIRTUAL with CPU HOTPLUG ENABLED) - {/Status/Hypervisor/VirtualCPUs} CPUs.</Name>
		<DisplayMessage>Disabling CPU hotplug in the VM config and rebooting the DP VMs workaround: Power VM's off, In vSphere Client: click the VM, Summary tab - Edit Settings - Options tab - Disable Memory/CPU Hotplug</DisplayMessage>
		<URL description="IT09304: APPLIANCES WITH 40 CPUS AND MORE MAY UNEXPECTEDLY RESTART: ">http://www.ibm.com/support/docview.wss?uid=swg1IT09304</URL>
		<Expression LogLevel="Critical" FormulaIDMatch="APARIT09304FWCheck">
			<Section Name="Hypervisor" XPath="/Status/Hypervisor/VirtualCPUs"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="CPUs" Operation="GreaterThan" Value="39"/>
		</Expression>
		<!-- check for virtual devices if the amount of CPUs is not greater than 39 as this issue can occur on VM due to hotplug despite cpu count -->
		<Expression LogLevel="Critical" FormulaIDMatch="APARIT09304FWCheck" NextOperation="And">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//MachineType"/>
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//MachineType"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MachineType" Operation="EqualsTo" Value="5725"/>
		</Expression>
		<!-- since the previous 'GreaterThan' 39 CPU's check did not match we still need to assign the CPUs condition -->
		<Expression LogLevel="Critical">
			<Section Name="Hypervisor" XPath="/Status/Hypervisor/VirtualCPUs"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="CPUs" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;cpuload" FormulaID="SQLSourceDebug">
		<Name>&lt;font color='#CC3300'&gt;{Condition:SectionName}&lt;/font&gt; There is an SQL-Source &lt;font color='#CC3300'&gt;{Condition:SQLName}&lt;/font&gt; configured with a sql-config-param 'TraceFile', this may create files that consume the filesystem, review SQL-Debug files (.cli).</Name>
		<DisplayMessage>Trace file configured to {Condition:FileDirectory}.</DisplayMessage>
		<URL description="query-timeout in sql-source (v7.2.0 documentation): ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_7.2.0/com.ibm.dp.doc/query-timeout_sqldatasource.html?lang=en</URL>
		<URL description="MustGather: Collecting data when experiencing ODBC issues on IBM WebSphere DataPower SOA Appliances: ">http://www.ibm.com/support/docview.wss?uid=swg21447477</URL>
		<Expression LogLevel="Critical">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>sql-source \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(sql-config-param \"TraceFile\" \"([a-zA-Z-_.0-9:/]+)\"|exit)</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="SQLName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="FileDirectory" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;cpuload">
		<Name>&lt;font color='#CC3300'&gt;{Condition:SectionName}&lt;/font&gt; There is an SQL-Source &lt;font color='#CC3300'&gt;{Condition:SQLName}&lt;/font&gt; configured with a query-timeout=&lt;font color='#006666'&gt;{Condition:QueryTimeout} second(s)&lt;/font&gt; shorter or equal to the connect-timeout=&lt;font color='#006666'&gt;{Condition:ConnectTimeout} second(s)&lt;/font&gt;.</Name>
		<DisplayMessage>Depending on connection delay, queries may fail due to shorter query timeout (query timeout should be greater than connection timeout)</DisplayMessage>
		<URL description="MustGather: Collecting data when experiencing ODBC issues on IBM WebSphere DataPower SOA Appliances: ">http://www.ibm.com/support/docview.wss?uid=swg21447477</URL>
		<Expression LogLevel="Critical">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="SQLName" Operation="NotEqualTo" Value="" NextOperation="And">sql-source \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(query-timeout ([0-9]+)|exit)</Condition>
			<Condition FieldPosition="3" RegGroup="All" Operation="NotEqualTo" Value="exit" NextOperation="And">sql-source \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(query-timeout ([0-9]+)|exit)</Condition>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="QueryTimeout" Operation="NotEqualTo" Value="0" NextOperation="And">sql-source \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(query-timeout ([0-9]+)|exit)</Condition>
			<Condition FieldPosition="3" RegGroup="All" Operation="NotEqualTo" Value="exit" NextOperation="And">sql-source \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(connect-timeout ([0-9]+)|exit)</Condition>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="ConnectTimeout" Operation="NotEqualTo" Value="" NextOperation="And">sql-source \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(connect-timeout ([0-9]+)|exit)</Condition>
			<Condition FieldPosition="{Condition:QueryTimeout}" RegGroup="All" Operation="Subtract" ConditionName="ResultValue" Value="{Condition:ConnectTimeout}" NextOperation="And">sql-source \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(connect-timeout ([0-9]+)|exit)</Condition>
			<Condition FieldPosition="{Condition:ResultValue}" RegGroup="All" Operation="LessThan" Value="1">sql-source \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(connect-timeout ([0-9]+)|exit)</Condition>
		</Expression>
	</Formula>
	
	<Formula Categories="memory" SortCondition="Size" SortMethod="Descending" SumCondition="Size">
		<Name>{Condition:SectionName} Possible SQL-Debug File {Condition:FileName} size {Condition:Size} bytes.</Name>
		<Expression LogLevel="Critical" FormulaIDMatch="SQLSourceDebug" NextOperation="And">
			<Section Name="FlashFiles" XPath="/flash/file[contains(text(),'.cli') or contains(text(),'.trace')]"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="FileName" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Critical" FormulaIDMatch="SQLSourceDebug">
			<Section Name="FlashFiles" XPath="/flash/file[contains(text(),'.cli') or contains(text(),'.trace')]/@size"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="Size" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	
	
	<Formula Categories="configuration;failure">
		<Name>{Condition:SectionName} &lt;font color='#006666'&gt;{Condition:ObjectName}&lt;/font&gt; : Class &lt;font color='#006666'&gt;{Condition:ObjectClass}&lt;/font&gt; is currently down.</Name>
		<DisplayMessage>{Condition:ErrorCode}</DisplayMessage>
		<Expression LogLevel="Warning" NextOperation="And">
			<Section Name="ObjectStatus" Wildcard="True" XPath="/Status/ObjectStatus/AdminState"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="AdminState" Operation="EqualsTo" Value="enabled"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="And">
			<Section Name="ObjectStatus" Wildcard="True" XPath="/Status/ObjectStatus/Class"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="ObjectClass" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="And">
			<Section Name="ObjectStatus" Wildcard="True" XPath="/Status/ObjectStatus/Name"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="ObjectName" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="And">
			<Section Name="ObjectStatus" Wildcard="True" XPath="/Status/ObjectStatus/OpState"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="OpState" Operation="EqualsTo" Value="down"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="ObjectStatus" Wildcard="True" XPath="/Status/ObjectStatus/ErrorCode"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="ErrorCode" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	
	<!-- Crypto runtime issue -->
	<Formula Categories="failure;general;cpuload"  SortCondition="Timestamp" SortMethod="descending">
		<Name>{Condition:Timestamp} : The Crypto Engine threw an error.</Name>
		<DisplayMessage>{Condition:Reason}.  This may have disrupted some cryptography or signing functionality.</DisplayMessage>
		<URL description="Review co; crypto-fallback output in CLI, fallback=true means we stopped using crypto hardware and using software: ">TBD</URL>
		<Expression LogLevel="Critical">
			<Section Name="default-log" Wildcard="True" XPath="/Root/text()" ReadNextSection="True"/>
			<Section Name="DefaultLogBeforeReload" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".log" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>Runtime error detected in crypto engine</IndexSearch>
			<RegExp>([0-9TZ.]+) \[0x8060016b\]\[crypto\]\[critic\] : tid\(([0-9]*)\): (Runtime error detected in crypto engine \(code: [0-9]+, count: [0-9]+\))</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="Reason" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;failure;cpuload">
		<Name>{Condition:SectionName} sql-runtime-settings has enable-sharing ENABLED, this may cause HIGH CPU usage.  Review APAR details for APAR IT14456.</Name>
		<URL FormulaIDMatch="APARIT14456Check" description="APAR IT14456 (Fixed in 7.0.0.14, 7.1.0.11, 7.2.0.7, 7.5.0.1): IT MAY CAUSE HIGH CPU USAGE WHEN ENABLE-SHARING IS ENABLED IN SQL DATA SOURCE RUNTIME SETTINGS: ">http://www.ibm.com/support/docview.wss?uid=swg1IT14456</URL>
		<URL FormulaIDMatch="V600FirmwareCheck" description="SQL Data Source Runtime Settings commands (enable-sharing): ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_6.0.0/com.ibm.dp.xi.doc/sqlruntimesettingscommands.html</URL>
		<URL FormulaIDMatch="V601FirmwareCheck" description="SQL Data Source Runtime Settings commands (enable-sharing): ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_6.0.1/com.ibm.dp.xi.doc/sqlruntimesettingscommands.html</URL>
		<URL FormulaIDMatch="V700FirmwareCheck" description="SQL Data Source Runtime Settings commands (enable-sharing): ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_7.0.0/com.ibm.dp.xi.doc/sqlruntimesettingscommands.html</URL>
		<URL FormulaIDMatch="V710FirmwareCheck" description="SQL Data Source Runtime Settings commands (enable-sharing): ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_7.1.0/com.ibm.dp.doc/sqlruntimesettingscommands.html</URL>
		<URL FormulaIDMatch="V720FirmwareCheckOrGreater" description="SQL Data Source Runtime Settings commands (enable-sharing): ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_7.2.0/com.ibm.dp.doc/sqlruntimesettingscommands.html</URL>
		<Expression LogLevel="Warning" FormulaIDMatch="APARIT14456Check">
			<Section Name="default-config" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="SharingEnabled" Operation="EqualsTo" Value="exit">\bsql-runtime-settings\W+(\w+\W+)*?(no enable-sharing|exit)\b</Condition>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;failure;memory">
		<Name>{Condition:SectionName} sql-runtime-settings has enable-sharing DISABLED, this may cause HIGH MEMORY usage.  &lt;font color='#006666'&gt;Each sql-source will individually allocate {Condition:MemorySizeMB}MB&lt;/font&gt;.  Best practice is to have enable-sharing enabled and increase the memory profile size.</Name>
		<URL FormulaIDMatch="V600FirmwareCheck" description="SQL Data Source Runtime Settings commands (enable-sharing): ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_6.0.0/com.ibm.dp.xi.doc/sqlruntimesettingscommands.html</URL>
		<URL FormulaIDMatch="V601FirmwareCheck" description="SQL Data Source Runtime Settings commands (enable-sharing): ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_6.0.1/com.ibm.dp.xi.doc/sqlruntimesettingscommands.html</URL>
		<URL FormulaIDMatch="V700FirmwareCheck" description="SQL Data Source Runtime Settings commands (enable-sharing): ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_7.0.0/com.ibm.dp.xi.doc/sqlruntimesettingscommands.html</URL>
		<URL FormulaIDMatch="V710FirmwareCheck" description="SQL Data Source Runtime Settings commands (enable-sharing): ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_7.1.0/com.ibm.dp.doc/sqlruntimesettingscommands.html</URL>
		<URL FormulaIDMatch="V720FirmwareCheckOrGreater" description="SQL Data Source Runtime Settings commands (enable-sharing): ">http://www.ibm.com/support/knowledgecenter/SS9H2Y_7.2.0/com.ibm.dp.doc/sqlruntimesettingscommands.html</URL>
		<Expression LogLevel="Warning">
			<Section Name="default-config" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="SharingEnabled" Operation="EqualsTo" Value="no enable-sharing" NextOperation="And">\bsql-runtime-settings\W+(\w+\W+)*?(no enable-sharing|exit)\b</Condition>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="MemorySizeMB" Operation="NotEqualTo" Value="">\bsql-runtime-settings\W+(\w+\W+)*?(profiles \"default\" \"([0-9]+)|exit)\b</Condition>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;memory" SortCondition="MemSize" SortMethod="descending" SumCondition="MemSize">
		<Name>{Condition:SectionName} StylesheetStatusSimpleIndex Reports {Condition:MemSize}KB in usage.</Name>
		<URL description="Max Stylesheet Cache per xml-manager is 2GB: ">https://developer.ibm.com/answers/questions/196707/is-there-a-maximum-size-limit-for-stylesheet-cache.html</URL>
		<Expression LogLevel="Info">
			<Section Name="StylesheetStatusSimpleIndex" Wildcard="True" XPath="/Status//StylesheetStatusSimpleIndex/MemSize"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" RegGroup="Sum" ConditionName="MemSize" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="cpuload">
		<Name>{Condition:SectionName} NFS Mount {Condition:MountName} has {Condition:FilesOpen} files open, mount state is {Condition:MountState}.  A total of {Condition:FilesWritten} files written and {Condition:FilesRead} files read.</Name>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="NFSMountStatus" Wildcard="True" XPath="/Status/NFSMountStatus/Name"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MountName" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="NFSMountStatus" Wildcard="True" XPath="/Status/NFSMountStatus/FilesOpen"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="FilesOpen" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="NFSMountStatus" Wildcard="True" XPath="/Status/NFSMountStatus/FilesWritten"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="FilesWritten" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="NFSMountStatus" Wildcard="True" XPath="/Status/NFSMountStatus/FilesRead"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="FilesRead" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="NFSMountStatus" Wildcard="True" XPath="/Status/NFSMountStatus/State"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MountState" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<!-- New CVE's (late 2015 into May 2016) -->
	<Formula Categories="configuration">
		<Name>IT14230: A VULNERABILITY IN THE SSL COMPONENT OF IBM DATAPOWER GATEWAYS. (CVE-2016-0701 &amp; CVE-2015-3197)</Name>
		<DisplayMessage>SSL vulnerabilities disclosed on January 28th, 2016 include CVE-2015-3197.  IBM DataPower Gateways releases 7.x are affected by this CVE.&lt;br&gt;&lt;br&gt; SSL could allow a remote attacker to conduct man-in-the-middle attacks, caused by an error related to the negotiation of disabled SSLv2 ciphers by malicious SSL/TLS clients. (CVE-2015-3197).</DisplayMessage>
		<URL description="IT14230 (Fixed in 7.0.0.13, 7.1.0.10 and 7.2.0.6, 7.5.0.x planned): A VULNERABILITY IN THE SSL COMPONENT OF IBM DATAPOWER GATEWAYS. (CVE-2016-0701 &amp; CVE-2015-3197): ">http://www.ibm.com/support/docview.wss?uid=swg1IT14230</URL>
		<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion" SectionName="false" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="6"/>
		</Expression>
		<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" SectionName="false" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="13"/>
		</Expression>
		<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" SectionName="false" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="10"/>
		</Expression>
		<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" SectionName="false" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="2" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="6"/>
		</Expression>
		<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" SectionName="false" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="5" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="2"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration">
		<Name>IT14231: A VULNERABILITY IN THE SSL COMPONENT OF IBM DATAPOWER GATEWAYS. (CVE-2015-3195 &amp; CVE-2015-1794) - Only fixed in v7.0 or later.</Name>
		<DisplayMessage>SSL could allow a remote attacker to obtain sensitive information, caused by a memory leak (CVE-2015-3195). SSL is vulnerable to a denial of service, caused by a client cipher suite error (CVE-2015-1794).</DisplayMessage>
		<URL description="IT14231 (Fixed in 7.0.0.13, 7.1.0.10, does not apply to 7.2 or later): A VULNERABILITY IN THE SSL COMPONENT OF IBM DATAPOWER GATEWAYS. (CVE-2015-3195 &amp; CVE-2015-1794): ">http://www.ibm.com/support/docview.wss?uid=swg1IT14231</URL>
		<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion" SectionName="false" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="6"/>
		</Expression>
		<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" SectionName="false" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="13"/>
		</Expression>
		<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" SectionName="false" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="10"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration">
		<Name>IT13989: GNU C LIBRARY (GLIBC) VULNERABILITY AFFECTS IBM DATAPOWER GATEWAYS (CVE-2015-7547)</Name>
		<DisplayMessage>GNU C Library (glibc) is vulnerable to a stack-based buffer overflow in the getaddrinfo() function. A remote attacker could overflow a buffer and execute arbitrary code on the system or cause the application to crash.</DisplayMessage>
		<URL description="IT13989 (Fixed in 6.0.0.19, 6.0.1.15, 7.1.0.9, 7.2.0.4): GNU C LIBRARY (GLIBC) VULNERABILITY AFFECTS IBM DATAPOWER GATEWAYS (CVE-2015-7547): ">http://www.ibm.com/support/docview.wss?uid=swg1IT13989</URL>
		<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion" SectionName="false" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="19"/>
		</Expression>
		<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion" SectionName="false" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="15"/>
		</Expression>
		<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" SectionName="false" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="12"/>
		</Expression>
		<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" SectionName="false" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="9"/>
		</Expression>
		<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" SectionName="false" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="2" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="4"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration">
		<Name>IT13742: SLOTH: VULNERABILITIES IN TLS HANDSHAKE DUE TO USE OF MD5 SIGNATURES (CVE-2015-7575)</Name>
		<DisplayMessage>The TLS protocol could allow weaker than expected security caused by a collision attack when using the MD5 hash function for signing a ServerKeyExchange message during a TLS handshake.  An attacker could exploit this vulnerability using man-in-the-middle techniques to impersonate a TLS server and obtain credentials.</DisplayMessage>
		<URL description="IT13742 (Fixed in 6.0.0.18, 6.0.1.14, 7.0.0.11, 7.1.0.8): SLOTH: VULNERABILITIES IN TLS HANDSHAKE DUE TO USE OF MD5 SIGNATURES(CVE-2015-7575): ">http://www.ibm.com/support/docview.wss?uid=swg1IT13742</URL>
		<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion" SectionName="false" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="18"/>
		</Expression>
		<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion" SectionName="false" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="14"/>
		</Expression>
		<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" SectionName="false" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="11"/>
		</Expression>
		<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" SectionName="false" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="8"/>
		</Expression>
	</Formula>
	<!-- end of late 2015 to May 2016 CVE's -->
	
	<Formula Categories="configuration;memory" CollapseResult="true" CondenseCondition="QPoolEntry" SortCondition="CondenseCondition" SortMethod="descending">
		<Name>{Condition:SectionName} QRef Section contains {Condition:QPoolEntry}</Name>
		<Expression LogLevel="Info">
			<Section Name="QPool" XPath="/Root/text()"/>
			<RegExp>\d+: 0x\d+ "([a-zA-Z0-9-_.:?=*;/\ ]*)"</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="QPoolEntry" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;memory" CollapseResult="true" CondenseCondition="QPoolEntry" SortCondition="CondenseCondition" SortMethod="descending">
		<Name>{Condition:SectionName} QRef DP v7.5+ Section contains {Condition:QPoolEntry}</Name>
		<Expression LogLevel="Info" FormulaIDMatch="V750FirmwareCheckOrGreater">
			<Section Name="QPool" XPath="/Root/text()"/>
			<RegExp>\d+: 0x\d+ ((domain|name)\(([a-zA-Z0-9-_.:?=*;/\()" ]*))</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="QPoolEntry" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<!-- APAR IT15006 Check for LBG half health check setting -->
	<Formula CollapseResult="true" FormulaID="APARIT15006Check">
		<Expression LogLevel="Warning">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="2" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="EqualsTo" Value="7"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="5" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="EqualsTo" Value="2"/>
		</Expression>
	</Formula>
	
	<Formula Categories="failure;general">
		<Name>{Condition:SectionName} Load Balancer Group &lt;font color='#006666'&gt;{Condition:LBG}&lt;/font&gt; using tcp half health check, advise upgrading past APAR IT15006 or workaround with tcp full health check.</Name>
		<URL description="APAR IT15006 (Fixed in 7.2.0.7, 7.5.0.2 and 7.5.1.0): USING TCP PARTIAL HEALTH CHECKS CAN LEAD TO UNEXPECTED BEHAVIOR: ">http://www.ibm.com/support/docview.wss?uid=swg1IT15006</URL>
		<Expression LogLevel="Critical" FormulaIDMatch="APARIT15006Check">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()" ReadNextSection="True"/>
			<Section Name=".config" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>tcp-conn-type Partial</IndexSearch>
			<RegExp>loadbalancer-group \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(type TCPConnection|exit)</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="LBG" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="LBGType" Operation="NotEqualTo" Value="exit" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="LBGTypeSetting" Operation="NotEqualTo" Value="exit">loadbalancer-group \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(tcp-conn-type Partial|exit)</Condition>
		</Expression>
	</Formula>
	<!-- end APAR IT15006 check -->
	
	
	<Formula Categories="memory" FormulaID="LowB2BPersistenceStorage">
		<Name>{Condition:SectionName} &lt;font color='#ff7733'&gt;{Condition:Purpose} is low&lt;/font&gt; on volume &lt;font color='#006666'&gt;{/Status/RaidPartitionStatus//VolumeName}&lt;/font&gt; partition idx &lt;font color='#006666'&gt;{/Status/RaidPartitionStatus//PartitionIndex}&lt;/font&gt;, &lt;font color='#ff7733'&gt;{/Status/RaidPartitionStatus//FreeSpace}KB&lt;/font&gt; of &lt;font color='#ff7733'&gt;{Condition:TotalSize}KB&lt;/font&gt; left free.</Name>
		<URL description="How to resolve and avoid the B2B Persistence down problem due to running out of space: ">http://www.ibm.com/support/docview.wss?uid=swg21639436</URL>
		<Expression LogLevel="Critical">
			<Section Name="RaidPartitionStatus" XPath="/Status/RaidPartitionStatus//FreeSpace"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="{/Status/RaidPartitionStatus//Purpose}" Operation="NotEqualTo" ConditionName="Purpose" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/RaidPartitionStatus//TotalSize}" Operation="NotEqualTo" ConditionName="TotalSize" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="DivideBy" ConditionName="PercentageFree" Value="{Condition:TotalSize}" NextOperation="And"/>
			<Condition FieldPosition="{Condition:PercentageFree}" Operation="LessThan" Value=".26"/> <!-- check for less than 26% -->
		</Expression>
		<Expression LogLevel="Error">
			<Section Name="RaidPartitionStatus" XPath="/Status/RaidPartitionStatus//FreeSpace"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="{/Status/RaidPartitionStatus//Purpose}" Operation="NotEqualTo" ConditionName="Purpose" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/RaidPartitionStatus//TotalSize}" Operation="NotEqualTo" ConditionName="TotalSize" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="DivideBy" ConditionName="PercentageFree" Value="{Condition:TotalSize}" NextOperation="And"/>
			<Condition FieldPosition="{Condition:PercentageFree}" Operation="LessThan" Value=".51"/> <!-- check for less than 51% -->
		</Expression>
	</Formula>
	
	<!-- tracking APAR IT15693 resource exhaustion due to source-mqfte -->
	<Formula CollapseResult="true" FormulaID="APARIT15693Check">
		<Expression LogLevel="Warning">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="14"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="1" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="11"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="2" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="7"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="5" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="2"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="5" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="1" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="2"/>
		</Expression>
	</Formula>

	<Formula Categories="failure">
		<Name>Backtrace on {Condition:Timestamp} Contained Component: {Condition:Data}.  Review Source-MQFTE Related APAR's.</Name>
		<URL description="IT15693: WHILE USING MQ FTE FRONT SIDE HANDLER APPLIANCE MAY UNEXPECTEDLY RELOAD: ">http://www.ibm.com/support/docview.wss?uid=swg1IT15693</URL>
		<Expression LogLevel="Critical" FormulaIDMatch="APARIT15693Check">
			<Section Name="Backtrace" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And">Thread 0x[0-9a-fA-F]*\: (\d{4}\-\d{2}\-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z)</Condition>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Data" Operation="NotEqualTo" Value="">\b(Component=source-mqfte.*)\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
		</Expression>
	</Formula>
	<!-- end tracking APAR IT15693 resource exhaustion due to source-mqfte -->

</Analytics>