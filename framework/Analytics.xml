<Analytics version="DataPower_4.0.12" date="September 27 2024 3:30PM EST">
	<Formula CollapseResult="true" FormulaID="IsHardwareDevice">
		<Expression LogLevel="Warning" NextOperation="And">
			<Section Name="LicenseStatus" XPath="/Status/LicenseStatus//Feature"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="RealHardware"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="LicenseStatus" XPath="/Status/LicenseStatus//Available"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="Yes"/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" FormulaID="IsTenantDevice">
		<Expression LogLevel="Info">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3/Tenant"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="TenantName" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" FormulaID="IsTenantOrVirtualDevice">
		<Expression LogLevel="Info">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3/Tenant"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" ExpressionGroup="TestVirtual">
			<Section Name="VirtualPlatform" Wildcard="True" XPath="/Status//*[starts-with(local-name(),'VirtualPlatform')]/Platform"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="Platform" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" FormulaID="MachineType8441">
		<Expression LogLevel="Info">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//MachineType"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="8441"/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" FormulaID="MachineType9235">
		<Expression LogLevel="Info">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//MachineType"/>
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//MachineType"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MachineType" Operation="EqualsTo" Value="9235"/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" FormulaID="PlatformDocker">
		<Expression LogLevel="Info">
			<Section Name="VirtualPlatform3" XPath="/Status/VirtualPlatform3/Platform"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="Platform" Operation="EqualsTo" Value="docker"/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" FormulaID="PlatformNotDocker">
		<Expression LogLevel="Info">
			<Section Name="VirtualPlatform3" XPath="/Status/VirtualPlatform3/Platform"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="Platform" Operation="NotEqualTo" Value="docker"/>
		</Expression>
	</Formula>
	
	<!-- establish any APAR fixpacks -->
	
	<Formula CollapseResult="true" FormulaID="APARCHECK:IT19465">
		<Expression LogLevel="Warning">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="5" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="2" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="4"/>
		</Expression>
	</Formula>

	<!-- March 2018 7.5.2.13 and 7.6.0.6 fixpack tracking -->
		<Formula CollapseResult="true" FormulaID="APARCHECK:IT23520">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.2" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="13"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.6.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="6"/>
			</Expression>
	</Formula>
	
	<!-- december 2017 fixpack tracking -->
	<Formula CollapseResult="true" FormulaID="APARCHECK:IT22300">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.1.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="21"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.2.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="18"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="12"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.1" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="11"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.2" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="11"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.6.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="4"/>
			</Expression>
	</Formula>
	
	<!-- october 2017 fixpack tracking -->
	<Formula CollapseResult="true" FormulaID="APARCHECK:IT21626">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.1.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="20"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.2.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="17"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="11"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.1" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="10"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.2" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="10"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.6.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="3"/>
			</Expression>
	</Formula>
	
	<!-- november 2016 fixpack tracking -->
	<Formula CollapseResult="true" FormulaID="APARCHECK:IT17895">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.0.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="16"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.1.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="13"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.2.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="10"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="4"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.1" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="3"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.2" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="1"/>
			</Expression>
	</Formula>

	<Formula CollapseResult="true" FormulaID="APARCHECK:IT16765">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.2.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="10"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="4"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.1" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="3"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.2" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="1"/>
			</Expression>
	</Formula>

	<Formula CollapseResult="true" FormulaID="APARCHECK:IT20998">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.1.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="18"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.2.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="15"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="9"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.1" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="8"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.2" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="8"/>
			</Expression>
	</Formula>
	
	<Formula CollapseResult="true" FormulaID="APARCHECK:IT22213">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.1.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="21"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.2.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="18"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="12"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.1" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="11"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.2" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="11"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.6.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="4"/>
			</Expression>
	</Formula>
	
	<Formula CollapseResult="true" FormulaID="APARCHECK:IT21264">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="14"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.1" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="13"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.2" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="13"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.6.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="6"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.7.0"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.7.1" NextOperation="And"/>
				<!-- was fixed in  7.7.1.2, so 7.7.1.0 and 7.7.1.1 will match here -->
				<Condition FieldPosition="3" Operation="LessThan" Value="2"/>
			</Expression>
	</Formula>
	
	<!-- issue was introduced in these firmware levels, fixed +1 iteration -->
	<Formula CollapseResult="true" FormulaID="APARCHECK:IT21215">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.1.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="17"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.2.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="14"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="8"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.1" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="7"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.2" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="7"/>
			</Expression>
	</Formula>
	
	<Formula CollapseResult="true" FormulaID="APARCHECK:IT21040">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.1.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="19"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.2.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="16"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="10"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.1" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="9"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.2" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="9"/>
			</Expression>
	</Formula>
	
	<Formula CollapseResult="true" FormulaID="APARCHECK:IT19283">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.2.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="14"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="8"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.1" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="7"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.2" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="7"/>
			</Expression>
	</Formula>
	
	<!-- this is used in the NFS files open formula at info level -->
	<Formula CollapseResult="true" FormulaID="APARCHECK:IT10924">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="10"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="7"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="2" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="1"/>
			</Expression>
	</Formula>
	
	<!-- this is used in the NFS files open formula at info level -->
	<Formula CollapseResult="true" FormulaID="APARCHECK:IT12165,IT14136">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="13"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="10"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="2" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="6"/>
			</Expression>
	</Formula>
	
	<!-- this is used in the NFS files open formula at info level -->
	<Formula CollapseResult="true" FormulaID="APARCHECK:IT15099">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="14"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="11"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="2" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="8"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="5" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="2"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="5" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="2"/>
			</Expression>
	</Formula>

	<!-- this is used in the NFS files open formula at info level -->
	<Formula CollapseResult="true" FormulaID="APARCHECK:IT15340">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="14"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="11"/>
			</Expression>
	</Formula>

	<!-- this is used in the NFS files open formula at info level -->
	<Formula CollapseResult="true" FormulaID="APARCHECK:IT15457,IT16042,IT16229,IT15445,IT16715">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="15"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="12"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="2" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="9"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="5" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="3"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="5" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="2"/>
			</Expression>
	</Formula>
	
	
	<!-- this is used in the NFS files open formula at info level -->
	<Formula CollapseResult="true" FormulaID="APARCHECK:IT15997">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="16"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="13"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="2" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="10"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="5" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="4"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="5" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="3"/>
			</Expression>
	</Formula>
	
	<Formula CollapseResult="true" FormulaID="APARCHECK:IT17833">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.0.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="17"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.1.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="14"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.2.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="11"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="5"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.1" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="4"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.2" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="2"/>
			</Expression>
	</Formula>
	<!-- end APAR lists -->
	
	<!-- establish firmware version for any intentional matches on major firmware level -->
	<Formula CollapseResult="true" FormulaID="V700FirmwareCheck">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0"/>
			</Expression>
	</Formula>
	
	<Formula CollapseResult="true" FormulaID="V710FirmwareCheck">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="1"/>
			</Expression>
	</Formula>
	
	<Formula CollapseResult="true" FormulaID="V720FirmwareCheck">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="2"/>
			</Expression>
	</Formula>
	

	<Formula CollapseResult="true" FormulaID="V750FirmwareCheckOrGreater">
		<Expression LogLevel="Warning">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="GreaterThan" Value="6" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="GreaterThan" Value="4"/>
		</Expression>
		<Expression LogLevel="Info" ExpressionGroup="ResetReleases">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
			<RegExp>([A-Z]{2,4})[0-9]{0,2}.(((2018|2019|20[2-9][0-9])\.\d+\.\d+)\.(\d+))([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="10"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="2018"/>
		</Expression>
	</Formula>

	<Formula CollapseResult="true" FormulaID="V760FirmwareCheckOrGreater">
		<Expression LogLevel="Warning">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="GreaterThan" Value="5"/> <!-- 7.6 or later -->
		</Expression>
		<Expression LogLevel="Info" ExpressionGroup="ResetReleases">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
			<RegExp>([A-Z]{2,4})[0-9]{0,2}.(((2018|2019|20[2-9][0-9])\.\d+\.\d+)\.(\d+))([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="10"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="2018"/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" FormulaID="V2018FirmwareCheckOrGreater">
		<Expression LogLevel="Info">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
			<RegExp>([A-Z]{2,4})[0-9]{0,2}.(((2018|2019|20[2-9][0-9])\.\d+\.\d+)\.(\d+))([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="10"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="2018"/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" FormulaID="V2018Firmware">
		<Expression LogLevel="Info">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
			<RegExp>([A-Z]{2,4})[0-9]{0,2}.(((2018|2019|20[2-9][0-9])\.\d+\.\d+)\.(\d+))([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="2018"/>
		</Expression>
	</Formula>
	
	<!-- check for 7.0.0 or later -->
	<Formula CollapseResult="true" FormulaID="V700FirmwareCheckOrGreater">
		<Expression LogLevel="Warning">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="GreaterThan" Value="6"/>
		</Expression>
		<Expression LogLevel="Info" ExpressionGroup="ResetReleases">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
			<RegExp>([A-Z]{2,4})[0-9]{0,2}.(((2018|2019|20[2-9][0-9])\.\d+\.\d+)\.(\d+))([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="2018"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="10"/>
		</Expression>
	</Formula>
	
	<!-- check for 7.2.0 or later -->
	<Formula CollapseResult="true" FormulaID="V720FirmwareCheckOrGreater">
		<Expression LogLevel="Warning">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="GreaterThan" Value="1"/>
		</Expression>
		<Expression LogLevel="Info" ExpressionGroup="ResetReleases">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
			<RegExp>([A-Z]{2,4})[0-9]{0,2}.(((2018|2019|20[2-9][0-9])\.\d+\.\d+)\.(\d+))([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="2018"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="10"/>
		</Expression>
	</Formula>
	
	<!-- check for 7.1.0 or earlier (before all object attributes were added) -->
	<Formula CollapseResult="true" FormulaID="V710FirmwareCheckOrLower">
			<Expression LogLevel="Warning">
			 <!-- we check for both status providers because we need to match at least one status provider to check -->
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="2"/>
			</Expression>
			<Expression LogLevel="Warning">
			 <!-- we check for both status providers because we need to match at least one status provider to check -->
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="LessThan" Value="7"/>
			</Expression>
	</Formula>
	
	<!-- check for 7.2.0 or earlier (before all object attributes were added) -->
	<Formula CollapseResult="true" FormulaID="V720FirmwareCheckOrLower">
			<Expression LogLevel="Warning">
			 <!-- we check for both status providers because we need to match at least one status provider to check -->
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="3"/>
			</Expression>
			<Expression LogLevel="Warning">
			 <!-- we check for both status providers because we need to match at least one status provider to check -->
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="LessThan" Value="7"/>
			</Expression>
	</Formula>
	
	<Formula CollapseResult="true" FormulaID="V760FirmwareCheckOrLower">
		<Expression LogLevel="Warning">
			 <!-- we check for both status providers because we need to match at least one status provider to check -->
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="7"/>
		</Expression>
		<Expression LogLevel="Warning">
			 <!-- we check for both status providers because we need to match at least one status provider to check -->
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="LessThan" Value="7"/>
		</Expression>
	</Formula>

	<!-- status checks -->
	<Formula CollapseResult="true" OmitPrintingMetConditions="true" TopPositionResult="true" Categories="general">
		<Name>DateTimeStatus, CurrentTime: {Condition:Time} {Condition:TimeZone}, Uptime: {Condition:Uptime} (reload), BootUptime: {Condition:BootUptime}</Name>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="DateTimeStatus" XPath="/Status/DateTimeStatus//time"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="Time" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="DateTimeStatus" XPath="/Status/DateTimeStatus//uptime"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="Uptime" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="DateTimeStatus" XPath="/Status/DateTimeStatus//bootuptime"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="BootUptime" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="DateTimeStatus" XPath="/Status/DateTimeStatus//timezone"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="TimeZone" Operation="NotEqualTo" Value=""/>
		</Expression>
		<!-- start of 6.0 datetimestatus2 -->
		<Expression LogLevel="Info" NextOperation="And" ExpressionGroup="DateTimeStatus2">
			<Section Name="DateTimeStatus" XPath="/Status/DateTimeStatus//time"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="Time" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And" ExpressionGroup="DateTimeStatus2">
			<Section Name="DateTimeStatus" XPath="/Status/DateTimeStatus//uptime2"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="Uptime" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And" ExpressionGroup="DateTimeStatus2">
			<Section Name="DateTimeStatus" XPath="/Status/DateTimeStatus//bootuptime2"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="BootUptime" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" ExpressionGroup="DateTimeStatus2">
			<Section Name="DateTimeStatus" XPath="/Status/DateTimeStatus//timezone"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="TimeZone" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>

	<Formula CollapseResult="true" OmitPrintingMetConditions="true" TopPositionResult="true" Categories="general;sidebarresult">
		<Name>{Condition:Timestamp} &lt;br/&gt;{Condition:ReportFileName}.</Name>
		<Expression LogLevel="Info">
			<Section Name="ErrorReport" XPath="/Envelope/Body/ErrorReport/@timestamp"/>
			<RegEXP>*</RegEXP>
			<Condition FieldPosition="0" ConditionName="Timestamp" Operation="NotEqualTo" Value=""/>
			<Condition FieldPosition="{Condition:ReportFileName}" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" FormulaIDMatch="!IsTenantDevice" OmitPrintingMetConditions="true" TopPositionResult="true" Categories="general;sidebarresult">
		<Name>System name is &lt;font color='#006666'&gt;{Condition:SysName}&lt;/font&gt;.</Name>
		<Expression LogLevel="Info">
			<Section Name="default-config" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>(^|\s)system\W+(\w+\W+)*?(name \"([a-zA-Z0-9.\-_]+)|exit)</RegExp>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="SysName" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" FormulaIDMatch="IsTenantDevice" OmitPrintingMetConditions="true" TopPositionResult="true" Categories="general;sidebarresult">
		<Name>Tenant name &lt;font color='#006666'&gt;{Condition:TenantName}&lt;/font&gt;.</Name>
		<Expression LogLevel="Info">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3/Tenant"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="TenantName" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula OmitPrintingMetConditions="true" TopPositionResult="true" Categories="general;configuration">
		<Name>{Condition:SectionName} Secure Mode is &lt;font color='#006666'&gt;{Condition:CurrentSecureMode}&lt;/font&gt;, expected 'secure'.  Secure-Backup is not supported in this mode.</Name>
		<URL description="How to enable secure backup mode: ">https://www.ibm.com/docs/en/datapower-gateway/10.6.0?topic=gateway-secure-backup-mode</URL>
		<Expression LogLevel="Warning">
			<Section Name="default-config" XPath="/Root/text()"/>
			<RegExp>\bsecure-mode\W+(\w+\W+)*?(mode \"([a-zA-Z0-9.\-_]+)|exit)\b</RegExp>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="CurrentSecureMode" Operation="NotEqualTo" Value="secure"/>
		</Expression>
	</Formula>

	<!-- as of 2018.4.1.17, 10.0.1.4 and 10.0.2.1, disable-csrf is not a supported feature, it was previously hidden -->
	<Formula CollapseResult="true" FormulaID="DisableCSRFGUICheck">
		<Expression LogLevel="Info">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
			<RegExp>([A-Z]{2,4})[0-9]{0,2}.(((10|2018|2019|20[2-9][0-9])\.(\d+)\.(\d+))\.(\d+))([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="2018" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="EqualsTo" Value="4" NextOperation="And"/>
			<Condition FieldPosition="6" Operation="EqualsTo" Value="1" NextOperation="And"/>
			<Condition FieldPosition="7" Operation="GreaterThan" Value="16"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
			<RegExp>([A-Z]{2,4})[0-9]{0,2}.(((10|2018|2019|20[2-9][0-9])\.(\d+)\.(\d+))\.(\d+))([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="10" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="6" Operation="EqualsTo" Value="1" NextOperation="And"/>
			<Condition FieldPosition="7" Operation="GreaterThan" Value="3"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
			<RegExp>([A-Z]{2,4})[0-9]{0,2}.(((10|2018|2019|20[2-9][0-9])\.(\d+)\.(\d+))\.(\d+))([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="10" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="6" Operation="EqualsTo" Value="2" NextOperation="And"/>
			<Condition FieldPosition="7" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" OmitPrintingMetConditions="true" Categories="general;failure">
		<Name>&lt;font color='#CC3300'&gt;DataPower is configured with disable-csrf on in the web management interface.  This may cause the WebGUI to not behave correctly unable to save, restart domain, etc.&lt;/font&gt;  Recommend removing hidden property via admin SSH: co; web-mgmt; no disable-csrf; exit; write mem</Name>
		<Expression FormulaIDMatch="DisableCSRFGUICheck" LogLevel="Critical">
			<Section Name="default-config" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>web\-mgmt\W+(\w+\W+)*?((?&lt;!no )disable-csrf|exit)</RegExp>
			<!-- can be disable-csrf, no disable-csrf, or exit, latter 2 will allow CSRF to be enabled, 'disable-csrf' will config wise remove CSRF feature -->
			<Condition FieldPosition="2" RegGroup="AllResult" Operation="EqualsTo" Value="disable-csrf"/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" OmitPrintingMetConditions="true" Categories="general;failure">
		<Name>{Condition:SectionName} has a WebSphere JMS Server object {Condition:ObjectName} configured with "Enable JMS-specific logging" ON.  Filesystem growth in logtemp: (temporary) may occur</Name>
		<Expression LogLevel="Warning">
			<Section Name="default-config" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>wasjms-server \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?((?&lt;!no )enable-logging|exit)</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value=""/>
			<Condition FieldPosition="2" RegGroup="All" Operation="EqualsTo" Value="enable-logging"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;failure">
		<Name>{Condition:SectionName} &lt;font color='#006666'&gt;{Condition:ObjectName}&lt;/font&gt; : Class &lt;font color='#006666'&gt;{Condition:ObjectClass}&lt;/font&gt; is currently down.</Name>
		<DisplayMessage>RBM Settings is likely down due to a referenced object such as a LDAP certificate, logs will likely show failures to port 63503.  Review RBM via CLI with 'show rbm' to find down reference.  co;rbm;reset;exit can be used to restore default RBM settings (original appliance settings).</DisplayMessage>
		<URL description="Unable to connect to Datapower using network services: WebGUI or ssh: ">https://www.ibm.com/support/pages/unable-connect-datapower-using-network-services-webgui-or-ssh</URL>
		<URL description="One expired certificate brings down all certificates in the DataPower Validation Credential: ">https://www.ibm.com/support/pages/node/708771</URL>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="ObjectStatus" XPath="/Status/ObjectStatus/Class[text()='RBMSettings']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="ObjectClass" Operation="EqualsTo" Value="RBMSettings"/>
		</Expression>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="ObjectStatus" XPath="/Status/ObjectStatus/AdminState[../Class/text()='RBMSettings']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="AdminState" Operation="EqualsTo" Value="enabled"/>
		</Expression>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="ObjectStatus" XPath="/Status/ObjectStatus/Name[../Class/text()='RBMSettings']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="ObjectName" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="ObjectStatus" XPath="/Status/ObjectStatus/OpState[../Class/text()='RBMSettings']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="OpState" Operation="EqualsTo" Value="down"/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" FormulaID="APARCHECK:IT30192">
		<Expression LogLevel="Warning">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="6" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="0"/>
			<!-- 7.6.0.x likely all applicable, out of date firmware anyway -->
		</Expression>
		<Expression LogLevel="Info" ExpressionGroup="ResetReleases">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
			<RegExp>([A-Z]{2,4})[0-9]{0,2}.(((2018|2019|20[2-9][0-9])\.(\d+)\.(\d+))\.(\d+))([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="2018" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="EqualsTo" Value="4" NextOperation="And"/>
			<Condition FieldPosition="6" Operation="EqualsTo" Value="1" NextOperation="And"/>
			<Condition FieldPosition="7" Operation="LessThan" Value="8"/>
		</Expression>
	</Formula>
	
	<!-- to update -->
	<Formula CollapseResult="true" FormulaID="APARCHECK:IT33621">
		<Expression LogLevel="Info">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
			<RegExp>([A-Z]{2,4})[0-9]{0,2}.(((2018|2019|20[2-9][0-9])\.(\d+)\.(\d+))\.(\d+))([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="2018" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="EqualsTo" Value="4" NextOperation="And"/>
			<Condition FieldPosition="6" Operation="EqualsTo" Value="1" NextOperation="And"/>
			<Condition FieldPosition="7" Operation="LessThan" Value="13"/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" FormulaID="APARCHECK:IT37506">
		<Expression LogLevel="Info">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
			<RegExp>([A-Z]{2,4})[0-9]{0,2}.(((10|2018|2019|20[2-9][0-9])\.(\d+)\.(\d+))\.(\d+))([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="2018" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="EqualsTo" Value="4" NextOperation="And"/>
			<Condition FieldPosition="6" Operation="EqualsTo" Value="1" NextOperation="And"/>
			<Condition FieldPosition="7" Operation="LessThan" Value="18"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
			<RegExp>([A-Z]{2,4})[0-9]{0,2}.(((10|2018|2019|20[2-9][0-9])\.(\d+)\.(\d+))\.(\d+))([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="10" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="6" Operation="EqualsTo" Value="1" NextOperation="And"/>
			<Condition FieldPosition="7" Operation="LessThan" Value="5"/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" FormulaID="APARCHECK:IT36726">
		<Expression LogLevel="Info">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
			<RegExp>([A-Z]{2,4})[0-9]{0,2}.(((10|2018|2019|20[2-9][0-9])\.(\d+)\.(\d+))\.(\d+))([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="2018" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="EqualsTo" Value="4" NextOperation="And"/>
			<Condition FieldPosition="6" Operation="EqualsTo" Value="1" NextOperation="And"/>
			<Condition FieldPosition="7" Operation="LessThan" Value="17"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
			<RegExp>([A-Z]{2,4})[0-9]{0,2}.(((10|2018|2019|20[2-9][0-9])\.(\d+)\.(\d+))\.(\d+))([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="10" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="6" Operation="EqualsTo" Value="1" NextOperation="And"/>
			<Condition FieldPosition="7" Operation="LessThan" Value="4"/>
		</Expression>
	</Formula>
	
	<Formula Categories="cpuload;configuration;failure">
		<Name>{Condition:SectionName} &lt;font color='#006666'&gt;{Condition:ObjectName}&lt;/font&gt; is an APIMgmt v5 domain, susceptible to known APARs listed.</Name>
		<URL description="IT36726 (Fixed in 2018.4.1.17, 10.0.1.4): DATAPOWER MEMORY LEAK WHEN XSLT CALLING DP:GATEWAYSCRIPT EXTENSION FUNCTION: ">https://www.ibm.com/support/pages/apar/IT36726</URL>
		<Expression FormulaIDMatch="APARCHECK:IT36726" LogLevel="Critical" NextOperation="And">
			<Section Name="ObjectStatus" XPath="/Status/ObjectStatus/Class[text()='Domain']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="ObjectClass" Operation="EqualsTo" Value="Domain"/>
		</Expression>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="ObjectStatus" XPath="/Status/ObjectStatus/AdminState[../Class/text()='Domain']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="AdminState" Operation="EqualsTo" Value="enabled"/>
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="ObjectStatus" XPath="/Status/ObjectStatus/Name[../Class/text()='Domain']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="ObjectName" Operation="StartsWith" Value="APIMgmt_"/>
		</Expression>
	</Formula>
	
	<Formula Categories="cpuload;configuration;failure">
		<Name>{Condition:SectionName} &lt;font color='#006666'&gt;{Condition:ObjectName}&lt;/font&gt; is currently quiesced, may lead to higher than expected CPU and/or Load.</Name>
		<URL description="IT30192 (Fixed in 2018.4.1.8): DATAPOWER MAY EXPERIENCE CPU SPIKE WHEN QUIESCE TASK IS RUN DURING OR AFTER HIGH LOAD: ">https://www.ibm.com/support/docview.wss?uid=swg1IT30192</URL>
		<Expression FormulaIDMatch="APARCHECK:IT30192" LogLevel="Critical" NextOperation="And">
			<Section Name="ObjectStatus" XPath="/Status/ObjectStatus/Class[text()='Domain']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="ObjectClass" Operation="EqualsTo" Value="Domain"/>
		</Expression>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="ObjectStatus" XPath="/Status/ObjectStatus/AdminState[../Class/text()='Domain']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="AdminState" Operation="EqualsTo" Value="enabled"/>
		</Expression>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="ObjectStatus" XPath="/Status/ObjectStatus/Name[../Class/text()='Domain']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="ObjectName" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="ObjectStatus" XPath="/Status/ObjectStatus/OpState[../Class/text()='Domain']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="OpState" Operation="EqualsTo" Value="down"/>
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="ObjectStatus" XPath="/Status/ObjectStatus/ErrorCode[../Class/text()='Domain']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="ErrorCode" Operation="EqualsTo" Value="in quiescence"/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" OmitPrintingMetConditions="true" TopPositionResult="true" Categories="general">
		<Name>Firmware Version: &lt;font color='{Condition:DefaultColor}'&gt;{Condition:FirmwareVersion}&lt;/font&gt;, Serial Number: &lt;font color='#009900'&gt;{Condition:SerialNumber}&lt;/font&gt;, Build Number: {Condition:Build}, Build Date: {Condition:BuildDate}, MachineType: {Condition:MachineType}, DeliveryType: {Condition:DeliveryType}</Name>
		<!-- 2018 entering end of service in 2023 -->
		<Expression LogLevel="Info">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="FirmwareVersion" Operation="Contains" Value="2018.4.1" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="DefaultColor" Value="red" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/DeliveryType}" ConditionName="DeliveryType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/Serial}" ConditionName="SerialNumber" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/Build}" ConditionName="Build" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/BuildDate}" ConditionName="BuildDate" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/MachineType}" ConditionName="MachineType" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="FirmwareVersion" Operation="Contains" Value="10.0.2" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="DefaultColor" Value="red" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/DeliveryType}" ConditionName="DeliveryType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/Serial}" ConditionName="SerialNumber" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/Build}" ConditionName="Build" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/BuildDate}" ConditionName="BuildDate" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/MachineType}" ConditionName="MachineType" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="FirmwareVersion" Operation="Contains" Value="10.0.3" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="DefaultColor" Value="red" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/DeliveryType}" ConditionName="DeliveryType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/Serial}" ConditionName="SerialNumber" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/Build}" ConditionName="Build" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/BuildDate}" ConditionName="BuildDate" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/MachineType}" ConditionName="MachineType" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="FirmwareVersion" Operation="Contains" Value="10.0.4" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="DefaultColor" Value="orange" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/DeliveryType}" ConditionName="DeliveryType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/Serial}" ConditionName="SerialNumber" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/Build}" ConditionName="Build" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/BuildDate}" ConditionName="BuildDate" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/MachineType}" ConditionName="MachineType" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="FirmwareVersion" Operation="Contains" Value="10.0.1" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="DefaultColor" Value="red" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/DeliveryType}" ConditionName="DeliveryType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/Serial}" ConditionName="SerialNumber" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/Build}" ConditionName="Build" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/BuildDate}" ConditionName="BuildDate" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/MachineType}" ConditionName="MachineType" Operation="NotEqualTo" Value=""/>
		</Expression>
		<!-- 10.5 or newer firmware -->
		<Expression LogLevel="Info">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="FirmwareVersion" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="DefaultColor" Value="green" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/DeliveryType}" ConditionName="DeliveryType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/Serial}" ConditionName="SerialNumber" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/Build}" ConditionName="Build" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/BuildDate}" ConditionName="BuildDate" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/MachineType}" ConditionName="MachineType" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" ExpressionGroup="MQResetReleases">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" Operation="EqualsTo" Value="MQ00" NextOperation="And">([A-Z]{2,4}[0-9]{0,2}).(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</Condition>
			<Condition FieldPosition="0" ConditionName="FirmwareVersion" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="DefaultColor" Value="green" NextOperation="And"/>
			<Condition FieldPosition="-2" ConditionName="DeliveryType" Operation="Append" Value="N/A" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/Serial}" ConditionName="SerialNumber" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/Build}" ConditionName="Build" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/BuildDate}" ConditionName="BuildDate" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/MachineType}" ConditionName="MachineType" Operation="NotEqualTo" Value=""/>
		</Expression>
		<!-- if we didn't match any supported versions then we have these two expressions handle non-supported versions -->
		<Expression LogLevel="Info" ExpressionGroup="ResetReleases" NextOperation="And">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" Operation="NotEqualTo" Value="MQ00" NextOperation="And">([A-Z]{2,4}[0-9]{0,2}).(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</Condition>
			<Condition FieldPosition="2" Operation="LessThan" Value="7">([A-Z]{2,4})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</Condition>
			<!-- 7.1.0 and 7.2.0 ended service on  09/30/2018 -->
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7.1.0">([A-Z]{2,4})[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</Condition>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7.2.0">([A-Z]{2,4})[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</Condition>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7.7.0">([A-Z]{2,4})[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</Condition>
			<!-- 7.7.1.0 ended service on  06/29/2018 -->
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7.7.1.0">([A-Z]{2,4})[0-9]{0,2}.((\d+\.\d+\.\d+)\.(\d+))([a-zA-Z0-9]*)</Condition>
			<!-- 7.7.1.1 ended service on  07/27/2018 -->
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7.7.1.1">([A-Z]{2,4})[0-9]{0,2}.((\d+\.\d+\.\d+)\.(\d+))([a-zA-Z0-9]*)</Condition>
			<!-- 7.7.1.2 ended service on  08/28/2018 -->
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7.7.1.2">([A-Z]{2,4})[0-9]{0,2}.((\d+\.\d+\.\d+)\.(\d+))([a-zA-Z0-9]*)</Condition>
			<!-- 7.7.1.1 ended service on  11/15/2018 -->
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7.7.1.3">([A-Z]{2,4})[0-9]{0,2}.((\d+\.\d+\.\d+)\.(\d+))([a-zA-Z0-9]*)</Condition>
			<!-- 7.5.x ended service on  04/30/2019 -->
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.0">([A-Z]{2,4})[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</Condition>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.1">([A-Z]{2,4})[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</Condition>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.2">([A-Z]{2,4})[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</Condition>
			<!-- 7.6.0 ended service on  12/31/2019 -->
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7.6.0">([A-Z]{2,4})[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</Condition>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="FirmwareVersion" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/Serial}" ConditionName="SerialNumber" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/Build}" ConditionName="Build" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/BuildDate}" ConditionName="BuildDate" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/MachineType}" ConditionName="MachineType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="DeliveryType" Value="N/A" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="DefaultColor" Value="red"/>
		</Expression>
	</Formula>
	
	<Formula Categories="failure;general;cpuload">
		<Name>Device reports hypervisor edition {Condition:Edition}, this is a free edition and is not supported by IBM.</Name>
		<URL description="Developers-Limited product does not include IBM Software Subscription and Support: ">https://www.ibm.com/docs/en/datapower-gateway/10.6.0?topic=virtual-offerings</URL>
		<Expression LogLevel="Critical" FormulaIDMatch="V750FirmwareCheckOrGreater">
		<Section Name="Hypervisor" Wildcard="True" XPath="/Status//*[starts-with(local-name(),'Hypervisor')]/Edition"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="Edition" Operation="EqualsTo" Value="developers-limited"/>
		</Expression>
		<Expression LogLevel="Critical">
		<Section Name="Hypervisor2" Wildcard="True" XPath="/Status//*[starts-with(local-name(),'Hypervisor2')]/Edition"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="Edition" Operation="EqualsTo" Value="developers-limited"/>
		</Expression>
		<Expression LogLevel="Critical">
		<Section Name="Hypervisor3" Wildcard="True" XPath="/Status//*[starts-with(local-name(),'Hypervisor3')]/Edition"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="Edition" Operation="EqualsTo" Value="developers-limited"/>
		</Expression>
	</Formula>
	
	<!-- X2 minimum version recommended -->
	<Formula CollapseResult="true">
		<Name>&lt;font color='red'&gt;ON TYPE 8441 APPLIANCE SHOW VERSION GIVES N/A FOR MACHINE TYPE&lt;/font&gt; - prior to this version there may be compatability issues with secure-backups from other Machine Types, 7.6.0.8 minimum recommended.  53X model type (HSM) will also not function correctly prior to 7.6.0.8.</Name>
		<URL description="APAR IT25703: ON TYPE 8441 APPLIANCE SHOW VERSION GIVES N/A FOR MACHINE TYPE: ">https://www.ibm.com/support/docview.wss?uid=swg1IT25703</URL>
		<Expression LogLevel="Critical">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/MachineType}" ConditionName="MachineType" Operation="EqualsTo" Value="N/A" NextOperation="And"/>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.6.0" NextOperation="And"/>
				<!-- fixed in 7.6.0.8 -->
				<Condition FieldPosition="3" Operation="LessThan" Value="8"/>
		</Expression>
	</Formula>
	
	<!-- Out of Service/Ending of Service Markers -->
	<Formula CollapseResult="false" OmitPrintingMetConditions="true" TopPositionResult="true" Categories="general">
		<Name>Machine Type {Condition:MachineType} has reached End of Service - review technote for End of Service dates.</Name>
		<URL description="Lifecycle dates for the Appliance Hardware Machine Types (MT): 2426, 7198, 7199, 8436, 8441: ">https://www.ibm.com/support/pages/lifecycle-dates-ibm-datapower-and-ibm-mq-appliances</URL>
		<Expression LogLevel="Critical">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//MachineType"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MachineType" Operation="EqualsTo" Value="7199"/>
			<Condition FieldPosition="0" ConditionName="MachineType" Operation="EqualsTo" Value="7198"/>
			<Condition FieldPosition="0" ConditionName="MachineType" Operation="EqualsTo" Value="2426"/>
		</Expression>
		<Expression LogLevel="Critical" ExpressionGroup="ResetReleases">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//MachineType"/>
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//MachineType"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MachineType" Operation="EqualsTo" Value="7199"/>
			<Condition FieldPosition="0" ConditionName="MachineType" Operation="EqualsTo" Value="7198"/>
			<Condition FieldPosition="0" ConditionName="MachineType" Operation="EqualsTo" Value="2426"/>
			<Condition FieldPosition="0" ConditionName="MachineType" Operation="EqualsTo" Value="9235"/>
			<Condition FieldPosition="0" ConditionName="MachineType" Operation="EqualsTo" Value="4195"/>
		</Expression>
	</Formula>

	<Formula CollapseResult="true" OmitPrintingMetConditions="true" TopPositionResult="true" Categories="general">
		<Name>Machine Type {Condition:MachineType} Model Type {Condition:ModelType} is End of Life - {Condition:ResultString}.  Check technote for more details.</Name>
		<URL description="Lifecycle dates for the Appliance Hardware Machine Types (MT): 2426, 7198, 7199, 8436, 8441: ">https://www.ibm.com/support/pages/lifecycle-dates-ibm-datapower-and-ibm-mq-appliances</URL>
		<!-- MQ 54X M2000 -->
		<Expression LogLevel="Critical">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//MachineType"/>
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//MachineType"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MachineType" Operation="EqualsTo" Value="8436" NextOperation="And"/>
			<Condition FieldPosition="0" InValue="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/Version}" ConditionName="Version" Operation="StartsWith" Value="MQ" NextOperation="And"/>
			<Condition FieldPosition="0" InValue="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/ModelType}" ConditionName="ModelType" Operation="EqualsTo" Value="54X" NextOperation="And"/>
			<Condition FieldPosition="-2" ConditionName="ResultString" Operation="Append" Value="Lifecycle End Date of April 30, 2020"/>
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//MachineType"/>
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//MachineType"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MachineType" Operation="EqualsTo" Value="8436" NextOperation="And"/>
			<Condition FieldPosition="0" InValue="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/Version}" ConditionName="Version" Operation="StartsWith" Value="IDG" NextOperation="And"/>
			<Condition FieldPosition="0" InValue="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/ModelType[text() = '52X' or text() = '53X']}" ConditionName="ModelType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="-2" ConditionName="ResultString" Operation="Append" Value="Lifecycle End Date of June 30, 2023"/>
		</Expression>
		<!-- MQ 55X M2001 -->
		<Expression LogLevel="Critical">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//MachineType"/>
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//MachineType"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MachineType" Operation="EqualsTo" Value="8436" NextOperation="And"/>
			<Condition FieldPosition="0" InValue="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/Version}" ConditionName="Version" Operation="StartsWith" Value="MQ" NextOperation="And"/>
			<Condition FieldPosition="0" InValue="{/Status/*[starts-with(local-name(),'FirmwareVersion')]/ModelType}" ConditionName="ModelType" Operation="EqualsTo" Value="55X" NextOperation="And"/>
			<Condition FieldPosition="-2" ConditionName="ResultString" Operation="Append" Value="Lifecycle End Date of July 10, 2023"/>
		</Expression>
	</Formula>
	
	<Formula Categories="general" CollapseResult="true" OmitPrintingMetConditions="true" TopPositionResult="true">
		<Name>Firmware Version Reached End of Service &lt;font color='red'&gt;{Condition:ResultString}&lt;/font&gt;</Name>
		<URL description="Firmware Support Lifecycle Document: ">https://www.ibm.com/support/pages/node/85901</URL>
		<Expression LogLevel="Critical">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="StartsWith" Value="2018.4.1" NextOperation="And"/>
				<Condition FieldPosition="0" ConditionName="ResultString" Operation="Append" Value=" End of Service Date April 30th 2023"/>
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="StartsWith" Value="10.0.1" NextOperation="And"/>
				<Condition FieldPosition="0" ConditionName="ResultString" Operation="Append" Value=" End of Service April 30th 2024"/>
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="StartsWith" Value="10.0.2" NextOperation="And"/>
				<Condition FieldPosition="0" ConditionName="ResultString" Operation="Append" Value=" End of Service June 25th 2021"/>
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="StartsWith" Value="10.0.3" NextOperation="And"/>
				<Condition FieldPosition="0" ConditionName="ResultString" Operation="Append" Value=" End of Service Date December 13th 2021"/>
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="StartsWith" Value="10.0.4.0sr1" NextOperation="And"/>
				<Condition FieldPosition="0" ConditionName="ResultString" Operation="Append" Value=" End of Service Date October 26th 2022"/>
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="StartsWith" Value="10.0.4.0sr2" NextOperation="And"/>
				<Condition FieldPosition="0" ConditionName="ResultString" Operation="Append" Value=" End of Service Date March 29th 2023"/>
		</Expression>
	</Formula>

	
	<Formula Categories="general" CollapseResult="true" OmitPrintingMetConditions="true" TopPositionResult="true">
		<Name>Firmware Version Reached End of Service &lt;font color='red'&gt;{Condition:ResultString}&lt;/font&gt;</Name>
		<URL description="Firmware Support Lifecycle Document: ">https://www.ibm.com/support/pages/node/85901</URL>
		<Expression LogLevel="Critical">
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="6" NextOperation="And"/> <!-- v6.0.1 and earlier -->
			<Condition FieldPosition="4" Operation="LessThan" Value="2" NextOperation="And"/> <!-- v6.0.1 and earlier -->
			<Condition FieldPosition="0" ConditionName="ResultString" Operation="Append" Value=" End of Service Date June 19th 2016"/>
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="LessThan" Value="6" NextOperation="And"/> <!-- v5.0.0 and earlier -->
				<Condition FieldPosition="0" ConditionName="ResultString" Operation="Append" Value=" End of Service Date June 30th 2015 and earlier"/>
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.0.0" NextOperation="And"/>
				<Condition FieldPosition="0" ConditionName="ResultString" Operation="Append" Value=" End of Service Date September 30th 2017"/>
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.1.0" NextOperation="And"/>
				<Condition FieldPosition="0" ConditionName="ResultString" Operation="Append" Value=" End of Service Date September 30th 2018"/>
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.2.0" NextOperation="And"/>
				<Condition FieldPosition="0" ConditionName="ResultString" Operation="Append" Value=" End of Service Date September 30th 2018"/>
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.7.0" NextOperation="And"/>
				<Condition FieldPosition="0" ConditionName="ResultString" Operation="Append" Value=" End of Service Date June 8th 2018"/>
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.((\d+\.\d+\.\d+)\.(\d+))([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.7.1.0" NextOperation="And"/>
				<Condition FieldPosition="0" ConditionName="ResultString" Operation="Append" Value=" End of Service Date June 29th 2018"/>
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.((\d+\.\d+\.\d+)\.(\d+))([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.7.1.1" NextOperation="And"/>
				<Condition FieldPosition="0" ConditionName="ResultString" Operation="Append" Value=" End of Service Date July 27th 2018"/>
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.((\d+\.\d+\.\d+)\.(\d+))([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.7.1.2" NextOperation="And"/>
				<Condition FieldPosition="0" ConditionName="ResultString" Operation="Append" Value=" End of Service Date August 28th 2018"/>
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.((\d+\.\d+\.\d+)\.(\d+))([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.7.1.3" NextOperation="And"/>
				<Condition FieldPosition="0" ConditionName="ResultString" Operation="Append" Value=" End of Service Date November 15th 2018"/>
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.((\d+\.\d+\.\d+)\.(\d+))([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="StartsWith" Value="7.5." NextOperation="And"/>
				<Condition FieldPosition="0" ConditionName="ResultString" Operation="Append" Value=" End of Service on April 30th 2019"/>
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.((\d+\.\d+\.\d+)\.(\d+))([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="StartsWith" Value="7.6.0" NextOperation="And"/>
				<Condition FieldPosition="0" ConditionName="ResultString" Operation="Append" Value=" End of Service on December 31st 2019"/>
		</Expression>
	</Formula>
	
	<!--<Formula Categories="general" CollapseResult="true" OmitPrintingMetConditions="true" TopPositionResult="true">
		<Name>Firmware Version Nearing End of Service &lt;font color='{Condition:DefaultColor}'&gt;{/Status/FirmwareVersion3//Version}&lt;/font&gt; - {Condition:EndServiceDate}</Name>
		<DisplayMessage>Customer is running firmware nearing end of service</DisplayMessage>
		<URL description="Firmware Support Lifecycle Document: ">https://www.ibm.com/support/pages/node/85901</URL>
		<Expression LogLevel="Critical">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="StartsWith" Value="10.0.1" NextOperation="And"/>
				<Condition FieldPosition="0" ConditionName="EndServiceDate" Operation="Append" Value=" End of Service Date April 30th 2024"/>
		</Expression>
	</Formula>-->
	<!-- End of Out of Service/Ending Service Markers -->
	
	<!-- failsafe due to wrong platform/os -->
		<Formula Categories="configuration;failure">
		<Name>{Condition:Timestamp} {Condition:SectionName} The platform (&lt;font color='red'&gt;{Condition:Platform}&lt;/font&gt;) or OS (&lt;font color='red'&gt;{Condition:OSDistro}&lt;/font&gt;) is not supported.</Name>
		<URL description="Installing from RPM packages: ">https://www.ibm.com/docs/en/datapower-gateway/10.6.0?topic=linux-installing-from-rpm-packages</URL>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="default-log" Wildcard="True" XPath="/Root/text()" ReadNextSection="True"/>
			<Section Name="DefaultLogBeforeReload" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>The platform or the OS distribution is not supported</IndexSearch>
			<RegExp>([0-9TZ.]{16,20}) \[0x804001ba\]\[cli\]\[error\] : tid\(([0-9]*)\): The platform or the OS distribution is not supported</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="VirtualPlatform" Wildcard="True" XPath="/Status//*[starts-with(local-name(),'VirtualPlatform')]/Platform"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="Platform" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="VirtualPlatform" Wildcard="True" XPath="/Status//*[starts-with(local-name(),'VirtualPlatform')]/OSDistro"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="OSDistro" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- end of info for failsafe wrong platform/os -->
	
	<Formula CollapseResult="true" OmitPrintingMetConditions="true" TopPositionResult="true" Categories="general;cpuload" FormulaID="CPUUsage">
		<Name>CPU Usage - 10s: {Condition:CPUTenSeconds}%, 1m: {Condition:CPUOneMinute}%, 10m: {Condition:CPUTenMinutes}%, 1hr: {Condition:CPUOneHour}%, 1day: {Condition:CPUOneDay}%</Name>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="CPUUsage" XPath="/Status/CPUUsage/tenSeconds"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="CPUTenSeconds" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="CPUUsage" XPath="/Status/CPUUsage/oneMinute"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="CPUOneMinute" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="CPUUsage" XPath="/Status/CPUUsage/tenMinutes"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="CPUTenMinutes" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="CPUUsage" XPath="/Status/CPUUsage/oneHour"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="CPUOneHour" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="CPUUsage" XPath="/Status/CPUUsage/oneDay"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="CPUOneDay" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" OmitPrintingMetConditions="true" TopPositionResult="true" Categories="general;cpuload" FormulaID="LoadUsage">
		<Name>Load Usage - {Condition:Load}%, WorkList: {Condition:WorkList}</Name>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="SystemUsage" XPath="/Status/SystemUsage/Load"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="Load" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="SystemUsage" XPath="/Status/SystemUsage/WorkList"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="WorkList" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula OmitPrintingMetConditions="true" TopPositionResult="true" Categories="general">
	<Name>[BLADE DEVICE 4195]</Name>
			<Expression LogLevel="Info">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//MachineType"/>
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//MachineType"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MachineType" Operation="EqualsTo" Value="4195"/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" OmitPrintingMetConditions="true" TopPositionResult="true" Categories="general;memory" FormulaID="MemoryUsage">
		<Name>MemoryStatus: Used/Total Memory {Condition:UsedMemoryRounded}/{Condition:TotalMemoryRounded} GB&lt;br/&gt;Free Memory: {Condition:FreeMemoryRounded} GB, Requested Memory: {Condition:ReqMemoryRounded} GB, Hold Memory: {Condition:HoldMemoryRounded} GB, Reserved Memory: {Condition:ReservedMemoryRounded} GB, Installed Memory: {Condition:InstalledMemoryRounded} GB.</Name>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="MemoryStatus" XPath="/Status/MemoryStatus/TotalMemory"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value=""  NextOperation="And"/>
			<Condition FieldPosition="0" Operation="DivideBy" ConditionName="TotalMemory" Value="1000000" NextOperation="And"/>
			<Condition FieldPosition="{Condition:TotalMemory}" Operation="Round" ConditionName="TotalMemoryRounded" Value="2"/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="MemoryStatus" XPath="/Status/MemoryStatus/UsedMemory"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="DivideBy" ConditionName="UsedMemory" Value="1000000" NextOperation="And"/>
			<Condition FieldPosition="{Condition:UsedMemory}" Operation="Round" ConditionName="UsedMemoryRounded" Value="2"/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="MemoryStatus" XPath="/Status/MemoryStatus/FreeMemory"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="DivideBy" ConditionName="FreeMemory" Value="1000000" NextOperation="And"/>
			<Condition FieldPosition="{Condition:FreeMemory}" Operation="Round" ConditionName="FreeMemoryRounded" Value="2"/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="MemoryStatus" XPath="/Status/MemoryStatus/ReqMemory"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="DivideBy" ConditionName="ReqMemory" Value="1000000" NextOperation="And"/>
			<Condition FieldPosition="{Condition:ReqMemory}" Operation="Round" ConditionName="ReqMemoryRounded" Value="2"/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="MemoryStatus" XPath="/Status/MemoryStatus/HoldMemory"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="DivideBy" ConditionName="HoldMemory" Value="1000000" NextOperation="And"/>
			<Condition FieldPosition="{Condition:HoldMemory}" Operation="Round" ConditionName="HoldMemoryRounded" Value="2"/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="MemoryStatus" XPath="/Status/MemoryStatus/ReservedMemory"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="DivideBy" ConditionName="ReservedMemory" Value="1000000" NextOperation="And"/>
			<Condition FieldPosition="{Condition:ReservedMemory}" Operation="Round" ConditionName="ReservedMemoryRounded" Value="2"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="MemoryStatus" XPath="/Status/MemoryStatus/InstalledMemory"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="DivideBy" ConditionName="InstalledMemory" Value="1000000" NextOperation="And"/>
			<Condition FieldPosition="{Condition:InstalledMemory}" Operation="Round" ConditionName="InstalledMemoryRounded" Value="2"/>
		</Expression>
	</Formula>
		
	<Formula CollapseResult="true" OmitPrintingMetConditions="true" TopPositionResult="true" Categories="general;memory" FormulaID="MemoryUsage">
		<Name>MemoryStatus: Used/Total Memory {Condition:UsedMemoryRounded}/{Condition:TotalMemoryRounded} GB&lt;br/&gt;Free Memory: {Condition:FreeMemoryRounded} GB, Requested Memory: {Condition:ReqMemoryRounded} GB, Hold Memory: {Condition:HoldMemoryRounded} GB, Reserved Memory: {Condition:ReservedMemoryRounded} GB, Installed Memory: {Condition:InstalledMemoryRounded} GB.</Name>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="MemoryStatus2" XPath="/Status/MemoryStatus2/TotalMemory"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value=""  NextOperation="And"/>
			<Condition FieldPosition="0" Operation="DivideBy" ConditionName="TotalMemory" Value="1000000" NextOperation="And"/>
			<Condition FieldPosition="{Condition:TotalMemory}" Operation="Round" ConditionName="TotalMemoryRounded" Value="2"/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="MemoryStatus2" XPath="/Status/MemoryStatus2/UsedMemory"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="DivideBy" ConditionName="UsedMemory" Value="1000000" NextOperation="And"/>
			<Condition FieldPosition="{Condition:UsedMemory}" Operation="Round" ConditionName="UsedMemoryRounded" Value="2"/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="MemoryStatus2" XPath="/Status/MemoryStatus2/FreeMemory"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="DivideBy" ConditionName="FreeMemory" Value="1000000" NextOperation="And"/>
			<Condition FieldPosition="{Condition:FreeMemory}" Operation="Round" ConditionName="FreeMemoryRounded" Value="2"/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="MemoryStatus2" XPath="/Status/MemoryStatus2/ReqMemory"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="DivideBy" ConditionName="ReqMemory" Value="1000000" NextOperation="And"/>
			<Condition FieldPosition="{Condition:ReqMemory}" Operation="Round" ConditionName="ReqMemoryRounded" Value="2"/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="MemoryStatus2" XPath="/Status/MemoryStatus2/HoldMemory"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="DivideBy" ConditionName="HoldMemory" Value="1000000" NextOperation="And"/>
			<Condition FieldPosition="{Condition:HoldMemory}" Operation="Round" ConditionName="HoldMemoryRounded" Value="2"/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="MemoryStatus2" XPath="/Status/MemoryStatus2/ReservedMemory"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="DivideBy" ConditionName="ReservedMemory" Value="1000000" NextOperation="And"/>
			<Condition FieldPosition="{Condition:ReservedMemory}" Operation="Round" ConditionName="ReservedMemoryRounded" Value="2"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="MemoryStatus2" XPath="/Status/MemoryStatus2/InstalledMemory"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="DivideBy" ConditionName="InstalledMemory" Value="1000000" NextOperation="And"/>
			<Condition FieldPosition="{Condition:InstalledMemory}" Operation="Round" ConditionName="InstalledMemoryRounded" Value="2"/>
		</Expression>
	</Formula>

	<Formula CollapseResult="true" TopPositionResult="true" Categories="general;memory">
		<Expression LogLevel="Info" NextOperation="And">
		<Name>{Condition:SectionName} Edition: &lt;font color='#006666'&gt;{Condition:Edition}&lt;/font&gt;, Hypervisor/Platform: &lt;font color='#006666'&gt;{Condition:HypervisorOrPlatform}&lt;/font&gt;, VirtualCPUs: &lt;font color='#006666'&gt;{Condition:VirtualCPUs}&lt;/font&gt;, Memory: &lt;font color='#006666'&gt;{Condition:Memory}&lt;/font&gt;GB.</Name>
			<Section Name="VirtualPlatform" Wildcard="True" XPath="/Status//*[starts-with(local-name(),'VirtualPlatform')]/Edition"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="Edition" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="VirtualPlatform" Wildcard="True" XPath="/Status//*[starts-with(local-name(),'VirtualPlatform')]/VirtualCPUs"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="VirtualCPUs" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="VirtualPlatform" Wildcard="True" XPath="/Status//*[starts-with(local-name(),'VirtualPlatform')]/Memory"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="Memory" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="VirtualPlatform" Wildcard="True" XPath="/Status//*[starts-with(local-name(),'VirtualPlatform')]/Hypervisor"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="HypervisorOrPlatform" Operation="NotEqualTo" Value="none"/>
			<Condition FieldPosition="{/Status//*[starts-with(local-name(),'VirtualPlatform')]/Platform}" ConditionName="HypervisorOrPlatform" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" OmitPrintingMetConditions="true" TopPositionResult="true" Categories="general;memory" FormulaID="FileSystemUsage">
		<Name>FilesystemStatus(Free/Total): Encrypted {Condition:FreeEncrypted}MB/{Condition:TotalEncrypted}MB, Temporary {Condition:FreeTemporary}MB/{Condition:TotalTemporary}MB, Internal {Condition:FreeInternal}MB/{Condition:TotalInternal}MB.</Name>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="FilesystemStatus" XPath="/Status/FilesystemStatus/FreeEncrypted"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="FreeEncrypted" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="FilesystemStatus" XPath="/Status/FilesystemStatus/TotalEncrypted"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="TotalEncrypted" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="FilesystemStatus" XPath="/Status/FilesystemStatus/FreeTemporary"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="FreeTemporary" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="FilesystemStatus" XPath="/Status/FilesystemStatus/TotalTemporary"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="TotalTemporary" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="FilesystemStatus" XPath="/Status/FilesystemStatus/FreeInternal"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="FreeInternal" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="FilesystemStatus" XPath="/Status/FilesystemStatus/TotalInternal"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="TotalInternal" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- end status checks -->
	
	
	
	<!-- basic device info cascaded -->
	<Formula CollapseResult="true" OmitPrintingMetConditions="true" TopPositionResult="true" Categories="general">
		<Name>Library Info: &lt;font color='#009933'&gt;{Condition:LibName}&lt;/font&gt;, Version: &lt;font color='#009933'&gt;{Condition:LibVer}&lt;/font&gt;</Name>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="LibraryVersion" XPath="/Status/LibraryVersion//Library"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="LibName" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="LibraryVersion" XPath="/Status/LibraryVersion//Version"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="LibVer" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" OmitPrintingMetConditions="true" TopPositionResult="true" Categories="general">
		<Name>License Info: &lt;font color='#009933'&gt;{Condition:FeatureName}&lt;/font&gt;, Enabled: {Condition:LicenseEnabled}, Available: {Condition:LicenseAvailable}</Name>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="LicenseStatus" XPath="/Status/LicenseStatus//Feature"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="FeatureName" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="LicenseStatus" XPath="/Status/LicenseStatus//Enabled"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="LicenseEnabled" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="LicenseStatus" XPath="/Status/LicenseStatus//Available"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="LicenseAvailable" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<!-- end of basic info cascaded -->
	
	
	<!-- APIC <-> DP Top Results -->
	
	<Formula Categories="configuration" CollapseResult="true" TopPositionResult="true" SortCondition="Timestamp" SortMethod="descending">
		<Name>{Condition:SectionName} {Condition:Timestamp} API Management Version: Domain &lt;font color='#ff0066'&gt;{Condition:DomainName}&lt;/font&gt; reporting Build &lt;font color='#ff0066'&gt;{Condition:BuildVersion}&lt;/font&gt;.</Name>
		<Expression LogLevel="Info">
			<Section Name="DiagnosticLog" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>scheduled,"Build </IndexSearch>
			<RegExp>1,([0-9TZ.]{16,20}),([a-zA-Z-_.0-9]+),xsltmsg,notice,xmlmgr,webapi,([0-9]+),,,0x80000001,,scheduled,\"Build ([a-zA-Z-_.0-9]+)\"</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="DomainName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="BuildVersion" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<!-- End APIC <-> DP Top Results -->
	
	<!-- search for throttler -->
	<Formula Categories="failure;memory"  SortCondition="Timestamp" SortMethod="descending">
		<Name>Throttler forced box reload at {Condition:Timestamp}, reason: {Condition:Reason}</Name>
		<Expression LogLevel="Critical">
			<Section Name="AuditLog" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>Throttler forced</IndexSearch>
			<RegExp>([0-9TZ.]{16,20}) \[sys\]\[failure\]\[0x[0-9a-f]{8}\] \(SYSTEM\:default\:\*:\*\)\: Throttler forced a system (restart|reload)\. Reason : (Low Memory|Low Ramdisk|Low XML prefix names|Low XML URI names|Low XML local names|Low Ports|Low JSON keys)</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="Reason" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- end of throttler search -->
	
	<!-- APAR IT16765, can trigger throttler -->
    <Formula Categories="configuration;cpuload;memory;failure">
        <Name>&lt;font color='#CC3300'&gt;{Condition:SectionName}&lt;/font&gt; There is an XML-Manager &lt;font color='#CC3300'&gt;{Condition:XMLManager}&lt;/font&gt; with compile-options &lt;font color='#CC3300'&gt;{Condition:CompileOptionsObject}&lt;/font&gt; configured with custom stack-size &lt;font color='#CC3300'&gt;{Condition:CompileStackSize}&lt;/font&gt;.  The device may throttle and/or reload unexpectedly due to this configuration.  This issue has been reported with stack-size of 10MB or higher reported (this has been established after APAR text was created which states 16MB).  Reduce the stack-size configured or upgrade to the fixpack level required by the APAR noted.</Name>
        <URL description="IT16765: DATAPOWER MIGHT RESTART UNEXPECTEDLY WHEN THE COMPILE OPTIONS POLICY STACK-SIZE IS SET TO 16 MB OR GREATER (Fixed in 7.2.0.10, 7.5.0.4, 7.5.1.3 and 7.5.2.1): ">https://www.ibm.com/support/docview.wss?uid=swg1IT16765</URL>
		<Expression LogLevel="Critical" FormulaIDMatch="APARCHECK:IT16765">
            <Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
            <Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
            <RegExp>*</RegExp>
            <Condition FieldPosition="1" RegGroup="All" ConditionName="XMLManager" Operation="NotEqualTo" Value="" NextOperation="And">xslconfig \"([a-zA-Z-_.0-9]+)\" \"([a-zA-Z-_.0-9]+)\"</Condition>
            <Condition FieldPosition="2" RegGroup="All" ConditionName="CompileOptionsObject" Operation="NotEqualTo" Value="" NextOperation="And">xslconfig \"([a-zA-Z-_.0-9]+)\" \"([a-zA-Z-_.0-9]+)\"</Condition>
            <!-- apar says range of 10-32MB+ -->
            <Condition FieldPosition="4" RegGroup="AllResult" ConditionName="CompileStackSize" Operation="GreaterThan" Value="10000000">compile-options \"({Condition:CompileOptionsObject})\"\W+(\w+\W+)*?(stack-size ([0-9]+)|exit)</Condition>
        </Expression>
    </Formula>
	
	<Formula Categories="configuration;failure;network">
		<Name>{Condition:SectionName} There is a source-pop-poller Object {Condition:ObjectName} configured which can be susceptible to APAR IT21040 which may cause the device to watchdog.</Name>
		<URL description="IT21040 (Fixed in 7.1.0.19, 7.2.0.16, 7.5.0.10, 7.5.1.9, 7.5.2.9): FIRMWARE RELOAD IN POP FRONT SIDE HANDLER UNDER SOME CASES: ">https://www.ibm.com/support/docview.wss?uid=swg1IT21040</URL>
			<Expression LogLevel="Critical" FormulaIDMatch="APARCHECK:IT21040">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\bsource-pop-poller \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;failure">
		<Name>&lt;font color='#CC3300'&gt;{Condition:SectionName}&lt;/font&gt; There is an Source-MQ Object &lt;font color='#CC3300'&gt;{Condition:SourceMQName}&lt;/font&gt; configured with a batch-size larger than 0, object batch-size is &lt;font color='#CC3300'&gt;{Condition:BatchSize}&lt;/font&gt;.  Low memory events may occur due to this configuration, either use batch-size 0 or upgrade to a required fixpack to resolve APAR IT19283.</Name>
		<URL description="IT19283 (Fixed in 7.2.0.14, 7.5.0.8, 7.5.1.7, 7.5.2.7): DATAPOWER MAY SUFFER CONTINUOUS MEMORY GROWTH IF MQ FSH BATCH-SIZE > 0: ">https://www.ibm.com/support/docview.wss?uid=swg1IT19283</URL>
		<Expression LogLevel="Critical" FormulaIDMatch="APARCHECK:IT19283">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="SourceMQName" Operation="NotEqualTo" Value="" NextOperation="And">source-mq[fte]{0,3} \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(batch-size ([1-9]+)|exit)</Condition>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="BatchSize" Operation="GreaterThan" Value="0">source-mq[fte]{0,3} \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(batch-size ([1-9]+)|exit)</Condition>
		</Expression>
	</Formula>
	
	<!-- ISAM restart in progress IT08507 -->
	<Formula Categories="configuration;failure">
		<Name>{Condition:Timestamp} ISAM Runtime is not working correctly in domain {Condition:Domain}.</Name>
		<URL description="IT08507: IBM SECURITY ACCESS MANAGER RUNTIME OBJECT IS VISIBLE ALTHOUGH ISAM PROXY MODULE IS NOT LICENSED ON THE APPLIANCE (Fix in 7.1.0.5): ">https://www.ibm.com/support/docview.wss?uid=swg1IT08507</URL>		
		<Expression LogLevel="Error" NextOperation="And">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="1" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="5"/>
		</Expression>
		<Expression LogLevel="Error">
			<Section Name="default-log" Wildcard="True" XPath="/Root/text()" ReadNextSection="True"/>
			<Section Name="DefaultLogBeforeReload" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>The Access Manager Runtime feature was not found on this system</IndexSearch>
			<RegExp>([0-9TZ.]{16,20}) \[([a-zA-Z0-9_.\-]+)\]\[[a-zA-Z0-9_.\-]+\]\[isamproxy\]\[error\] isam-runtime\([a-zA-Z0-9_.\-]+\): tid\(([0-9]*)\): The Access Manager Runtime feature was not found on this system</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="Domain" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- end ISAM restart in proress IT08507 -->
	
	<!-- throttler catches cpu issues -->
		<Formula Categories="failure;general;cpuload"  SortCondition="Timestamp" SortMethod="descending">
		<Name>[CPU] Throttler notes at {Condition:Timestamp}, reason: {Condition:Reason}.</Name>
		<URL description="System requirements for IBM DataPower Gateway appliances: ">https://www.ibm.com/support/pages/node/613133</URL>
		<Expression LogLevel="Critical">
			<Section Name="default-log" Wildcard="True" XPath="/Root/text()" ReadNextSection="True"/>
			<Section Name="DefaultLogBeforeReload" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".log" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>CPUs missing, expected</IndexSearch>
			<RegExp>([0-9TZ.]{16,20}) [a-zA-Z0-9_.\-\[\] ]* ([a-zA-Z]*)\(([a-zA-Z0-9.\- ]*)\): tid\(([0-9]*)\)[a-zA-Z0-9_.\-\[\]. ]*: (CPUs missing, expected [0-9]+, have [0-9]+)\.</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="5" RegGroup="All" ConditionName="Reason" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="failure;general;cpuload">
		<Name>Device reports {Condition:CPUs} virtual CPU's available, a minimum of 4 virtual CPU's is recommended.</Name>
		<URL description="System requirements for IBM DataPower Gateway appliances: ">https://www.ibm.com/support/pages/node/613133</URL>
		<Expression LogLevel="Critical">
		<Section Name="Hypervisor" Wildcard="True" XPath="/Status//*[starts-with(local-name(),'Hypervisor')]/VirtualCPUs"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="CPUs" Operation="LessThan" Value="4"/>
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="Hypervisor" Wildcard="True" XPath="/Status//*[starts-with(local-name(),'Hypervisor')]/VirtualCPUs"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="CPUs" Operation="LessThan" Value="4"/>
		</Expression>
	</Formula>
	
	<Formula Categories="failure;general;cpuload">
		<Name>Device reports {Condition:CPUs} virtual CPU's available, 8 or more is recommended for production.</Name>
		<URL description="System requirements for IBM DataPower Gateway appliances: ">https://www.ibm.com/support/pages/node/613133</URL>
		<Expression LogLevel="Warning" NextOperation="And">
			<Section Name="Hypervisor" Wildcard="True" XPath="/Status//*[starts-with(local-name(),'Hypervisor')]/VirtualCPUs"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="CPUs" Operation="GreaterThan" Value="3" NextOperation="And"/>
			<Condition FieldPosition="0" ConditionName="CPUs" Operation="LessThan" Value="8"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="Hypervisor" Wildcard="True" XPath="/Status//*[starts-with(local-name(),'Hypervisor')]/Edition"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="production"/>
		</Expression>
	</Formula>
	<!-- throttler notes cpu's missing -->
	
	<!-- gateway check -->
	<Formula CollapseResult="true" FormulaID="MoreThanOneDefaultGateway">
		<Expression LogLevel="Warning">
			<Section Name="default-config" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="2" RegGroup="Count" ConditionName="Count" Operation="GreaterThan" Value="1">ipv4-default-gateway ([\"0-9.a-fA-F\:]+)</Condition>
			<Condition FieldPosition="2" RegGroup="Count" ConditionName="Count" Operation="GreaterThan" Value="1">ipv6-default-gateway ([\"0-9.a-fA-F\:]+)</Condition>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;failure;network">
		<Name>More than one default gateway exists.  The {Condition:SectionName} defines network interfaces and default gateways (ipv4-default-gateway / ipv6-default-gateway).  A default gateway creates a default route for all traffic, more than one interface with a default gateway can cause trafic to be routed over one interface or another if no static routes are defined to restrict the traffic.  This results in network communication issues in and out of the device.  It is recommended to have one default gateway and additional interfaces define static routes for traffic that should not pass through the interface with the default-gateway defined.</Name>
		<DisplayMessage>{Condition:InterfaceType}||{Condition:InterfaceName}||ip{Condition:IPVersion}-default-gateway {Condition:Gateway}</DisplayMessage>
		<URL description="Best practice for configuring default gateway on WebSphere DataPower device: ">https://www.ibm.com/support/pages/node/359937</URL>
		<Expression LogLevel="Warning" FormulaIDMatch="MoreThanOneDefaultGateway">
			<Section Name="default-config" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>(ethernet|link-aggregation|vlan)\s\"([a-zA-Z-_.0-9]{0,40})\"\W+(\w+\W+)*?((ip(v4|v6)-default-gateway ([\"0-9.a-fA-F\:]+))|exit)</RegExp>
			<Condition FieldPosition="1" RegGroup="All" TableMapPosition="0" ConditionName="InterfaceType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" TableMapPosition="1" ConditionName="InterfaceName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="6" RegGroup="All" TableMapPosition="-2" ConditionName="IPVersion" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="7" RegGroup="All" TableMapPosition="2" ConditionName="Gateway" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- end gateway check -->
	
	<!-- Interface Markers -->
	
	<Formula Categories="network">
		<Name>Interface Receive Errors / Total Received Packets: {/Status/NetworkInterfaceStatus//RxErrors2} / {/Status/NetworkInterfaceStatus//RxHCPackets} on interface {/Status/NetworkInterfaceStatus//Name} over IP {/Status/NetworkInterfaceStatus//IP}</Name>
		<URL description="DataPower Network Interface Packet Errors or Drops: ">https://www.ibm.com/support/pages/node/709617</URL>
		<Expression LogLevel="Critical">
			<Section Name="NetworkInterfaceStatus" XPath="/Status/NetworkInterfaceStatus//RxErrors2"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" ConditionName="RxErrors" Value="0" NextOperation="And"/>
			<Condition FieldPosition="{/Status/NetworkInterfaceStatus//RxHCPackets}" Operation="Add" ConditionName="RxPackets" Value="1" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="DivideBy" ConditionName="MathDivResult" Value="{Condition:RxPackets}" NextOperation="And"/>
			<Condition FieldPosition="{Condition:MathDivResult}" Operation="GreaterThan" Value=".01"/>
		</Expression>
	</Formula>
	
	<Formula Categories="network">
		<Name>Interface Receive Drops / Total Received Packets: {/Status/NetworkInterfaceStatus//RxDrops2} / {/Status/NetworkInterfaceStatus//RxHCPackets} on interface {/Status/NetworkInterfaceStatus//Name} over IP {/Status/NetworkInterfaceStatus//IP}</Name>
		<URL description="DataPower Network Interface Packet Errors or Drops: ">https://www.ibm.com/support/pages/node/709617</URL>
		<Expression LogLevel="Critical">
			<Section Name="NetworkInterfaceStatus" XPath="/Status/NetworkInterfaceStatus//RxDrops2"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" ConditionName="RxDrops" Value="0" NextOperation="And"/>
			<Condition FieldPosition="{/Status/NetworkInterfaceStatus//RxHCPackets}" Operation="Add" ConditionName="RxPackets" Value="1" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="DivideBy" ConditionName="MathDivResult" Value="{Condition:RxPackets}" NextOperation="And"/>
			<Condition FieldPosition="{Condition:MathDivResult}" Operation="GreaterThan" Value=".01"/>
		</Expression>
	</Formula>
	
	<Formula Categories="network">
		<Name>Interface Transmission Errors / Total Transmitted Packets: {/Status/NetworkInterfaceStatus//TxErrors2} / {/Status/NetworkInterfaceStatus//TxHCPackets} on interface {/Status/NetworkInterfaceStatus//Name} over IP {/Status/NetworkInterfaceStatus//IP}</Name>
		<URL description="DataPower Network Interface Packet Errors or Drops: ">https://www.ibm.com/support/pages/node/709617</URL>
		<Expression LogLevel="Critical">
			<Section Name="NetworkInterfaceStatus" XPath="/Status/NetworkInterfaceStatus//TxErrors2"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" ConditionName="TxErrors" Value="0" NextOperation="And"/>
			<Condition FieldPosition="{/Status/NetworkInterfaceStatus//TxHCPackets}" Operation="Add" ConditionName="TxPackets" Value="1" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="DivideBy" ConditionName="MathDivResult" Value="{Condition:TxPackets}" NextOperation="And"/>
			<Condition FieldPosition="{Condition:MathDivResult}" Operation="GreaterThan" Value=".01"/>
		</Expression>
	</Formula>
	
	<Formula Categories="network">
		<Name>Interface Transmission Drops / Total Transmitted Packets: {/Status/NetworkInterfaceStatus//TxDrops2} / {/Status/NetworkInterfaceStatus//TxHCPackets} on interface {/Status/NetworkInterfaceStatus//Name} over IP {/Status/NetworkInterfaceStatus//IP}</Name>
		<URL description="DataPower Network Interface Packet Errors or Drops: ">https://www.ibm.com/support/pages/node/709617</URL>
		<Expression LogLevel="Critical">
			<Section Name="NetworkInterfaceStatus" XPath="/Status/NetworkInterfaceStatus//TxDrops2"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" ConditionName="TxDrops" Value="0" NextOperation="And"/>
			<Condition FieldPosition="{/Status/NetworkInterfaceStatus//TxHCPackets}" Operation="Add" ConditionName="TxPackets" Value="1" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="DivideBy" ConditionName="MathDivResult" Value="{Condition:TxPackets}" NextOperation="And"/>
			<Condition FieldPosition="{Condition:MathDivResult}" Operation="GreaterThan" Value=".01"/>
		</Expression>
	</Formula>
	
	<Formula Categories="network">
		<Name>Interface {/Status/NetworkInterfaceStatus//Name} Collision Errors</Name>
		<DisplayMessage>Total of {/Status/NetworkInterfaceStatus//Collisions2} Collisions over interface {/Status/NetworkInterfaceStatus//Name} over IP {/Status/NetworkInterfaceStatus//IP}</DisplayMessage>
		<URL description="DataPower Network Interface Packet Errors or Drops: ">https://www.ibm.com/support/pages/node/709617</URL>
		<Expression LogLevel="Critical">
			<Section Name="NetworkInterfaceStatus" XPath="/Status/NetworkInterfaceStatus//Collisions2"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>
	
	
	<Formula Categories="network">
		<Name>Interface Receive Errors / Total Received Packets: {/Status/EthernetInterfaceStatus//RxErrors} / {/Status/EthernetInterfaceStatus//RxPackets} on interface {/Status/EthernetInterfaceStatus//Name} over IP {/Status/EthernetInterfaceStatus//IP}</Name>
		<URL description="DataPower Network Interface Packet Errors or Drops: ">https://www.ibm.com/support/pages/node/709617</URL>
		<Expression LogLevel="Critical">
			<Section Name="EthernetInterfaceStatus" XPath="/Status/EthernetInterfaceStatus//RxErrors"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" ConditionName="RxErrors" Value="0" NextOperation="And"/>
			<Condition FieldPosition="{/Status/EthernetInterfaceStatus//RxPackets}" Operation="Add" ConditionName="RxPackets" Value="1" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="DivideBy" ConditionName="MathDivResult" Value="{Condition:RxPackets}" NextOperation="And"/>
			<Condition FieldPosition="{Condition:MathDivResult}" Operation="GreaterThan" Value=".01"/>
		</Expression>
	</Formula>
	
	<Formula Categories="network">
		<Name>Interface Receive Drops / Total Received Packets: {/Status/EthernetInterfaceStatus//RxDrops} / {/Status/EthernetInterfaceStatus//RxPackets} on interface {/Status/EthernetInterfaceStatus//Name} over IP {/Status/EthernetInterfaceStatus//IP}</Name>
		<URL description="DataPower Network Interface Packet Errors or Drops: ">https://www.ibm.com/support/pages/node/709617</URL>
		<Expression LogLevel="Critical">
			<Section Name="EthernetInterfaceStatus" XPath="/Status/EthernetInterfaceStatus//RxDrops"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" ConditionName="RxDrops" Value="0" NextOperation="And"/>
			<Condition FieldPosition="{/Status/EthernetInterfaceStatus//RxPackets}" Operation="Add" ConditionName="RxPackets" Value="1" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="DivideBy" ConditionName="MathDivResult" Value="{Condition:RxPackets}" NextOperation="And"/>
			<Condition FieldPosition="{Condition:MathDivResult}" Operation="GreaterThan" Value=".01"/>
		</Expression>
	</Formula>
	
	<Formula Categories="network">
		<Name>Interface Transmission Errors / Total Transmitted Packets: {/Status/EthernetInterfaceStatus//TxErrors} / {/Status/EthernetInterfaceStatus//TxPackets} on interface {/Status/EthernetInterfaceStatus//Name} over IP {/Status/EthernetInterfaceStatus//IP}</Name>
		<URL description="DataPower Network Interface Packet Errors or Drops: ">https://www.ibm.com/support/pages/node/709617</URL>
		<Expression LogLevel="Critical">
			<Section Name="EthernetInterfaceStatus" XPath="/Status/EthernetInterfaceStatus//TxErrors"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" ConditionName="TxErrors" Value="0" NextOperation="And"/>
			<Condition FieldPosition="{/Status/EthernetInterfaceStatus//TxPackets}" Operation="Add" ConditionName="TxPackets" Value="1" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="DivideBy" ConditionName="MathDivResult" Value="{Condition:TxPackets}" NextOperation="And"/>
			<Condition FieldPosition="{Condition:MathDivResult}" Operation="GreaterThan" Value=".01"/>
		</Expression>
	</Formula>

	<Formula Categories="network">
		<Name>Interface Transmission Drops / Total Transmitted Packets: {/Status/EthernetInterfaceStatus//TxDrops} / {/Status/EthernetInterfaceStatus//TxPackets} on interface {/Status/EthernetInterfaceStatus//Name} over IP {/Status/EthernetInterfaceStatus//IP}</Name>
		<URL description="DataPower Network Interface Packet Errors or Drops: ">https://www.ibm.com/support/pages/node/709617</URL>
		<Expression LogLevel="Critical">
			<Section Name="EthernetInterfaceStatus" XPath="/Status/EthernetInterfaceStatus//TxDrops"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" ConditionName="TxDrops" Value="0" NextOperation="And"/>
			<Condition FieldPosition="{/Status/EthernetInterfaceStatus//TxPackets}" Operation="Add" ConditionName="TxPackets" Value="1" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="DivideBy" ConditionName="MathDivResult" Value="{Condition:TxPackets}" NextOperation="And"/>
			<Condition FieldPosition="{Condition:MathDivResult}" Operation="GreaterThan" Value=".01"/>
		</Expression>
	</Formula>
	
	<Formula Categories="network">
		<Name>Interface {/Status/EthernetInterfaceStatus//Name} Collision Errors</Name>
		<DisplayMessage>Total of {/Status/EthernetInterfaceStatus//Collisions} Collisions over interface {/Status/EthernetInterfaceStatus//Name} over IP {/Status/EthernetInterfaceStatus//IP}</DisplayMessage>
		<URL description="DataPower Network Interface Packet Errors or Drops: ">https://www.ibm.com/support/pages/node/709617</URL>
		<Expression LogLevel="Critical">
			<Section Name="EthernetInterfaceStatus" XPath="/Status/EthernetInterfaceStatus//Collisions"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>
	
	<Formula Categories="network" FormulaID="HalfDuplexMatch">
		<Name>Interface {/Status/LinkStatus//Name} Running at Half Duplex</Name>
		<DisplayMessage>Interface Running Half Duplex - {/Status/LinkStatus//Name}</DisplayMessage>
		<URL description="DataPower Network Interface Packet Errors or Drops (Also Half-Duplex): ">https://www.ibm.com/support/pages/node/709617</URL>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="LinkStatus" XPath="/Status/LinkStatus//Mode"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="Contains" Value="-HD"/>
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="LinkStatus" XPath="/Status/LinkStatus//Status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="ok"/>
		</Expression>
	</Formula>
	
	<Formula Categories="network" FormulaID="HalfDuplexMatch">
		<Name>Interface {/Status/EthernetInterfaceStatus//Name} Running at Half Duplex</Name>
		<DisplayMessage>Interface Running Half Duplex - {/Status/EthernetInterfaceStatus//Name} over IP {/Status/EthernetInterfaceStatus//IP}</DisplayMessage>
		<URL description="DataPower Network Interface Packet Errors or Drops (Also Half-Duplex): ">https://www.ibm.com/support/pages/node/709617</URL>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="EthernetInterfaceStatus" XPath="/Status/EthernetInterfaceStatus//Mode"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="Contains" Value="HD"/>
		</Expression>
				<Expression LogLevel="Critical">
			<Section Name="EthernetInterfaceStatus" XPath="/Status/EthernetInterfaceStatus//Status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="ok"/>
		</Expression>
	</Formula>
	
	<Formula Categories="network">
		<Name>{Condition:SectionName} Interface {Condition:InterfaceName} is unable to auto-negotiate, AutoNegRemoteSignaling={Condition:AutoNegStatus}.  The switch may not be set to auto-negotiate speed (DP Interfaces should also be auto-negotiate).</Name>
		<Expression LogLevel="Critical" FormulaIDMatch="HalfDuplexMatch" NextOperation="And">
			<Section Name="EthernetMAUStatus" XPath="/Status//EthernetMAUStatus/Name"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="InterfaceName" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="EthernetMAUStatus" XPath="/Status//EthernetMAUStatus/Status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="available"/>
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="EthernetMAUStatus" XPath="/Status//EthernetMAUStatus/AutoNegRemoteSignaling"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="AutoNegStatus" Operation="NotEqualTo" Value="detected"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;cpuload;network">
		<Name>{Condition:SectionName} Interface &lt;font color='red'&gt;{Condition:InterfaceName}&lt;/font&gt; is a fibre interface, best practice is to have the interface disabled unless in use.  Current Network Speed: {Condition:Speed}, Current Duplex Mode: {Condition:Duplex}.</Name>
		<Expression LogLevel="Error" NextOperation="And">
			<Section Name="NetworkInfo" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>(Settings for ([a-zA-Z-_.0-9]+).*\:\W+(\w+\W+)*?Features for)</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ConfigInfo" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="InterfaceName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="1" InValue="{Condition:ConfigInfo}" RegGroup="AllResult" ConditionName="SupportedPort" Operation="Contains" Value="FIBRE" NextOperation="And">Supported ports: \[ ([a-zA-Z-_.0-9]+).* \]</Condition>
			<Condition FieldPosition="1" InValue="{Condition:ConfigInfo}" RegGroup="AllResult" ConditionName="Duplex" Operation="NotEqualTo" Value="Full" NextOperation="And">Duplex: (.*)</Condition>
			<Condition FieldPosition="1" InValue="{Condition:ConfigInfo}" RegGroup="AllResult" ConditionName="Speed" Operation="Contains" Value="Unknown">Speed: (.*)</Condition>
		</Expression>
		<Expression LogLevel="Error">
			<Section Name="default-config" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\bethernet \"{Condition:InterfaceName}\"\W+(\w+\W+)*?exit\b</RegExp>
			<Condition FieldPosition="0" RegGroup="All" ConditionName="ResultCfg" Operation="NotContain" Value="admin-state disabled"/>
		</Expression>
	</Formula>
	
	<Formula Categories="network;configuration" FormulaIDMatch="!IsTenantOrVirtualDevice">
		<Name>Interface &lt;font color='red'&gt;{Condition:InterfaceName}&lt;/font&gt; is (likely) a fibre interface, best practice is to have the interface disabled, unless in use. Currently in Operation State: &lt;font color='red'&gt;{Condition:OperStatus}&lt;/font&gt;.</Name>>
		<Expression LogLevel="Warning" NextOperation="And" FormulaIDMatch="IsHardwareDevice">
			<Section Name="NetworkInterfaceStatus" XPath="/Status//NetworkInterfaceStatus/Name"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="InterfaceName" Operation="EqualsTo" Value="eth21" NextOperation="Or"/>
			<Condition FieldPosition="0" ConditionName="InterfaceName" Operation="EqualsTo" Value="eth20"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="And">
			<Section Name="NetworkInterfaceStatus" XPath="/Status//NetworkInterfaceStatus/AdminStatus"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="AdminStatus" Operation="EqualsTo" Value="up"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="NetworkInterfaceStatus" XPath="/Status//NetworkInterfaceStatus/OperStatus"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="OperStatus" Operation="NotEqualTo" Value="up"/>
		</Expression>
	</Formula>
	
	<!-- End of Interface Markers -->
	
	<!-- misc interface concerns -->
	
	<Formula Categories="configuration;cpuload;network">
		<Name>{Condition:SectionName} {Condition:InterfaceName} has self-balance 'on' in self balance group {Condition:SelfBalanceGroup} with distribution algorithm set to weight least connections (wlc).</Name>
		<DisplayMessage>Prior to the 7.2 release there may be increased latency and cpu when using the WLC self-balance algorithm.  Alternatively using the round robin algorithm can workaround this problem.</DisplayMessage>
		<Expression LogLevel="Warning" FormulaIDMatch="V710FirmwareCheckOrLower">
			<Section Name="default-config" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="InterfaceName" Operation="NotEqualTo" Value="" NextOperation="And">interface \"([a-zA-Z-_.0-9]{0,40})\"\W+(\w+\W+)*?(standby \"([0-9]+)\" self-balance \"on\"|exit)</Condition>
			<Condition FieldPosition="3" RegGroup="AllResult" ConditionName="SelfBalanceGroup" Operation="NotEqualTo" Value="" NextOperation="And">interface \"{Condition:InterfaceName}\"\W+(\w+\W+)*?(standby \"([0-9]+)\" self-balance \"on\"|exit)</Condition>
			<Condition FieldPosition="2" RegGroup="AllResult" ConditionName="DistributionAlgorithm" Operation="NotEqualTo" Value="exit">interface \"{Condition:InterfaceName}\"\W+(\w+\W+)*?(standby \"{Condition:SelfBalanceGroup}\" distribution-algorithm \"wlc\"|exit)</Condition>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" FormulaID="APARCHECK:IT25120">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.7.0"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.7.1" NextOperation="And"/>
				<!-- fixed in 7.7.1.1 -->
				<Condition FieldPosition="3" Operation="LessThan" Value="1"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.6.0"/>
				<!-- fixed in 7.6.0.10 -->
				<Condition FieldPosition="3" Operation="LessThan" Value="10"/>
			</Expression>
	</Formula>
	
	<Formula Categories="network;failure">
		<Name>Interface {Condition:InterfaceName} is not properly named, may be due to known APAR, check URLs.</Name>
		<URL FormulaIDMatch="APARCHECK:IT25120" description="IT25120 (Fixed in 7.7.1.1, 7.6.0.10): Fix race condition when naming ethernet interfaces at start up: ">https://www.ibm.com/support/docview.wss?uid=swg1IT25120</URL>
		<Expression LogLevel="Critical">
			<Section Name="EthernetCountersStatus" XPath="/Status/EthernetCountersStatus//Name"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="InterfaceName" Operation="StartsWith" Value="rename"/>
		</Expression>
	</Formula>
	
	<!-- end of misc interface concerns -->
	
	<!-- internal issue which caused device to reboot (this may happen if the box is busy or low on resources) -->
	<Formula Categories="failure">
		<Name>{Condition:Timestamp} Detected an internal issue while attempting to reload the appliance.  The appliance attempted a reboot to complete recovery.</Name>
		<DisplayMessage>The device had issues reloading at {Condition:Timestamp} and the device attempted a reboot in attempt to recover a good state.  L2 should open an investigation with L3.</DisplayMessage>
		<Expression LogLevel="Error">
			<Section Name="AuditLog" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>Detected an internal issue while attempting to reload the appliance.</IndexSearch>
			<RegExp>\b([0-9TZ.]{16,20}) [a-zA-Z0-9_.\-\[\] ]* Detected an internal issue while attempting to reload the appliance. The appliance will attempt to reboot to complete recovery\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- end of internal issue which caused device reboot -->

	<Formula Categories="memory;failure" TopPositionResult="true">
		<Name>Backtrace Available</Name>
		<DisplayMessage>Backtrace Available (Requires Internal Decoding)</DisplayMessage>
		<Expression LogLevel="Critical">
			<Section Name="&lt;ExtendedBacktrace@datapower.ibm.com&gt;" Decode="true" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="&lt;Backtrace@datapower.ibm.com&gt;" Decode="true" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="&lt;PreviousBacktrace@datapower.ibm.com&gt;" Decode="true" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
	</Formula>
	
	<Formula Categories="cpuload;memory;failure">
		<Name>QPool</Name>
		<DisplayMessage>QPool (XML Names,References,URIs)</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="&lt;QPool@datapower.ibm.com&gt;" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
	</Formula>
	
	<Formula Categories="network;configuration">
		<Name>Routing Table Data</Name>
		<DisplayMessage>Routing Status XML</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="&lt;RoutingStatus2@datapower.ibm.com&gt;" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="&lt;RoutingStatus@datapower.ibm.com&gt;" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
	</Formula>
	
	<Formula Categories="network;configuration">
		<Name>Network Info</Name>
		<DisplayMessage>NetworkInfo Data</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="&lt;NetworkInfo@datapower.ibm.com&gt;" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
	</Formula>
	
	<Formula Categories="network;failure">
		<Name>Background PCAP Available</Name>
		<DisplayMessage>FFDC Background PCAP Decoded</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="&lt;BackgroundPacketCapture@datapower.ibm.com&gt;" MIME="true" Extension=".pcap"/>
		</Expression>
	</Formula>
	
	<Formula Categories="network;failure">
		<Name>SysRecord Available</Name>
		<DisplayMessage>FFDC SysRecord Available (Requires Internal Decoding)</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="&lt;SysRecord(-Backup[0-9\.]+)?@datapower.ibm.com&gt;" Wildcard="True" Decode="true" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
	</Formula>
	
	<!-- RAID Battery failed message in SysRecord -->
	<Formula Categories="configuration;failure;hardware" SortMethod="ascending">
		<Name>{Condition:SectionName} {Condition:Log}</Name>
		<Expression LogLevel="Critical">
			<Section Name="&lt;SysRecord(-Backup[0-9\.]+)?@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>Battery has failed and cannot support data retention. Please replace the battery</IndexSearch>
			<RegExp>([0-9\.]+).*Battery has failed and cannot support data retention. Please replace the battery</RegExp>
			<Condition FieldPosition="0" RegGroup="All" ConditionName="Log" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;failure;hardware" SortMethod="ascending">
		<Name>Review SysRecord for SYN TCP Flood Attacks, may indicate malicious traffic that could impact DataPower stability (unexpected reboots).  Search for port matching on one identified in SysRecord log.</Name>
		<DisplayMessage>{Condition:SectionName}||{Condition:Log}</DisplayMessage>
		<Expression LogLevel="Critical">
			<Section Name="&lt;SysRecord(-Backup[0-9\.]+)?@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>TCP: request_sock_TCP: Possible SYN flooding on port</IndexSearch>
			<RegExp>([0-9\.]+).*TCP\: request_sock_TCP\: Possible SYN flooding on port ([0-9]+)\. Sending cookies\.  Check SNMP counters\.</RegExp>
			<Condition FieldPosition="0" RegGroup="All" ConditionName="Log" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;failure;hardware;network" SortMethod="ascending">
		<Name>VMWare ESX is downgrading the ethernet mode/speed, consider further debugging in ESX, cable or network card replacement.  May cause DataPower instability/watchdog restarts.</Name>
		<DisplayMessage>{Condition:SectionName}||{Condition:Log}</DisplayMessage>
		<Expression LogLevel="Critical">
			<Section Name="&lt;SysRecord(-Backup[0-9\.]+)?@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>Link Speed was downgraded by SmartSpeed</IndexSearch>
			<RegExp>([0-9\.]+).*([a-zA-Z0-9]+)\: Link Speed was downgraded by SmartSpeed</RegExp>
			<Condition FieldPosition="0" RegGroup="All" ConditionName="Log" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;failure;hardware;network" SortMethod="ascending">
		<Name>Ethernet Interface queue transmission timed out, check SysRecord for kernel watchdog tracing.  This can contribute to instability and unexpected reboots in DataPower.</Name>
		<DisplayMessage>{Condition:SectionName}||{Condition:Log}</DisplayMessage>
		<Expression LogLevel="Critical">
			<Section Name="&lt;SysRecord(-Backup[0-9\.]+)?@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>: transmit queue</IndexSearch>
			<RegExp>([0-9\.]+).*\: transmit queue [0-9]+ timed out</RegExp>
			<Condition FieldPosition="0" RegGroup="All" ConditionName="Log" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;failure" SortMethod="ascending">
		<Name>System had a low level watchdog (SysRq Show Blocked State), consider lldiag collection.</Name>
		<URL description="How to use LLDIAG on the DataPower gateways to gather diagnostic information: ">https://www.ibm.com/support/pages/how-use-lldiag-datapower-gateways-gather-diagnostic-information</URL>
		<DisplayMessage>{Condition:SectionName}||{Condition:Log}</DisplayMessage>
		<Expression LogLevel="Critical">
			<Section Name="&lt;SysRecord(-Backup[0-9\.]+)?@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>SysRq : Show Blocked State</IndexSearch>
			<RegExp>([0-9\.]+).*SysRq : Show Blocked State</RegExp>
			<Condition FieldPosition="0" RegGroup="All" ConditionName="Log" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="memory;failure">
		<Name>Memory Report Available</Name>
		<DisplayMessage>Memory Report Available (Requires Internal Decoding)</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="&lt;Memory@datapower.ibm.com&gt;" Decode="true" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="&lt;BackgroundMemoryLeakCapture@datapower.ibm.com&gt;" Wildcard="True" Decode="true" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
	</Formula>
	
	<Formula Categories="memory;failure">
		<Name>Usage Log Available</Name>
		<DisplayMessage>Usage Log Available, historical memory and qpool information</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="&lt;UsageLog@datapower.ibm.com&gt;" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="&lt;UsageLog-Backup.1@datapower.ibm.com&gt;" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="&lt;UsageLog-Backup.2@datapower.ibm.com&gt;" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
	</Formula>
	
	<Formula Categories="memory;failure">
		<Name>Default Log Available</Name>
		<DisplayMessage>Default Log Available, recent service activity of all domains.</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="&lt;default-log(\.[0-9]+)?@datapower.ibm.com&gt;" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="&lt;DefaultLogBeforeReload?(-Backup[0-9\.]+)?@datapower.ibm.com&gt;" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="&lt;QueuedDefaultLogBeforeReload@datapower.ibm.com&gt;" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
	</Formula>
	
	<Formula Categories="memory;failure">
		<Name>CLI Log Available</Name>
		<DisplayMessage>CLI Log Available, historical CLI/GUI/XML-MGMT Configuration Activity</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="&lt;CLILog(BeforeReload)?(-Backup[0-9\.]+)?@datapower.ibm.com&gt;" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
	</Formula>
	
	<Formula Categories="memory;failure">
		<Name>Audit Log Available</Name>
		<DisplayMessage>Audit Log Available, historical CLI/GUI/XML-MGMT Configuration Activity</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="&lt;AuditLog@datapower.ibm.com&gt;" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="&lt;AuditLog-Backup.1@datapower.ibm.com&gt;" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="&lt;AuditLog-Backup.2@datapower.ibm.com&gt;" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
	</Formula>
		
	<Formula Categories="network;failure">
		<Name>DPOSDiagnostics Available</Name>
		<DisplayMessage>DPOSDiagnostics Available (Requires Internal Decoding)</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="&lt;DPOSDiagnostics@datapower.ibm.com&gt;" Decode="true" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
	</Formula>

	<Formula Categories="general;cpuload;memory;failure">
		<Name>DPMON File Available</Name>
		<DisplayMessage>DPMON Available (Requires External Tool in URL)</DisplayMessage>
		<URL description="NMON Visualizer: ">https://nmonvisualizer.github.io/nmonvisualizer/</URL>
		<Expression LogLevel="Info">
			<Section Name="&lt;DPmon(BeforeReload)?(-Backup[0-9\.]+)?@datapower.ibm.com&gt;" Base64="true" MIME="true" LineReturn="true" Extension=".nmon"/>
		</Expression>
	</Formula>
	
	<Formula Categories="general">
		<Name>XACTLog Available</Name>
		<DisplayMessage>Transactions Log File Available (accepted connections from, to, source domain and front side handler)</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="&lt;XACTLog@datapower.ibm.com&gt;" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="&lt;XACTLog-Backup.1@datapower.ibm.com&gt;" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="&lt;XACTLog-Backup.2@datapower.ibm.com&gt;" Base64="true" MIME="true" LineReturn="true"/>
		</Expression>
	</Formula>
	
	<Formula Categories="general">
		<Name>APIC API Schema Files</Name>
		<DisplayMessage>API Schema</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="&lt;([a-zA-Z-_.0-9]+).json@datapower.ibm.com&gt;" MIME="true" NoDecodeCache="True" Base64="true" LineReturn="true" NoEnumeration="true"/>
		</Expression>
	</Formula>
	
	<Formula Categories="general">
		<Name>APIC XSLT/JS Files</Name>
		<DisplayMessage>API File</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="&lt;([a-zA-Z-_.0-9]+).(js|xsl|xslt)@datapower.ibm.com&gt;" MIME="true" NoDecodeCache="True" Base64="true" LineReturn="true" NoEnumeration="true"/>
		</Expression>
	</Formula>
	
	<!-- Hardware Engine Failures -->
	<Formula Categories="hardware" FormulaIDMatch="!IsTenantOrVirtualDevice">
		<Name>Hardware Reports Interface Errors ({/Hardware//diagifstats})</Name>
		<URL description="DataPower Network Interface Packet Errors or Drops: ">https://www.ibm.com/support/pages/node/709617</URL>
		<Expression LogLevel="Warning">
			<Section Name="Hardware" XPath="/Hardware//diagifstats/@status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="error"/>
			</Expression>
	</Formula>
	
	<Formula Categories="hardware" FormulaIDMatch="!IsTenantOrVirtualDevice">
		<Name>Hardware Reports Voltage Problems ({/Hardware//diagvoltstat})</Name>
		<Expression LogLevel="Error">
			<Section Name="Hardware" XPath="/Hardware//diagvoltstat/@status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="error"/>
			</Expression>
	</Formula>
	
	<Formula Categories="hardware" FormulaIDMatch="!IsTenantOrVirtualDevice">
		<Name>Hardware Reports An Error with the CPU ({/Hardware//diagcpuok})</Name>
		<Expression LogLevel="Error">
			<Section Name="Hardware" XPath="/Hardware//diagcpuok/@status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="error"/>
			</Expression>
	</Formula>
	
	<Formula Categories="hardware" FormulaIDMatch="!IsTenantOrVirtualDevice">
		<Name>Hardware Reports An Error with the Memory ({/Hardware//diagmemorypresent})</Name>
		<Expression LogLevel="Error">
			<Section Name="Hardware" XPath="/Hardware//diagmemorypresent/@status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="error"/>
			</Expression>
	</Formula>
	
	<Formula Categories="hardware" FormulaIDMatch="!IsTenantOrVirtualDevice">
		<Name>Hardware Reports Power Supply has no AC Power ({/Hardware//diagaclost})</Name>
		<Expression LogLevel="Error">
			<Section Name="Hardware" XPath="/Hardware//diagaclost/@status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="error"/>
			</Expression>
	</Formula>
	
	<Formula CollapseResult="true" FormulaID="APARCHECK:IT29214,IT29236">
		<Expression LogLevel="Warning">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="6" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="16"/>
		</Expression>
		<Expression LogLevel="Info" ExpressionGroup="ResetReleases">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
			<RegExp>([A-Z]{2,4})[0-9]{0,2}.(((2018|2019|20[2-9][0-9])\.(\d+)\.(\d+))\.(\d+))([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="2018" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="EqualsTo" Value="4" NextOperation="And"/>
			<Condition FieldPosition="6" Operation="EqualsTo" Value="1" NextOperation="And"/>
			<Condition FieldPosition="7" Operation="LessThan" Value="7"/>
		</Expression>
	</Formula>
	
	<Formula Categories="hardware" FormulaIDMatch="!IsTenantOrVirtualDevice">
		<Name>Hardware Reports Missing Interfaces ({/Hardware//diagifnum})!</Name>
		<URL FormulaIDMatch="MachineType8441" description="Why do I not see all the interfaces on my machine type 8441 IDG X2 appliance? ">https://www.ibm.com/support/pages/node/1072854</URL>
		<URL FormulaIDMatch="APARCHECK:IT29214,IT29236" description="IT29214 (Fixed in 7.6.0.16 and 2018.4.1.7): CONNECTION FAILURES WITH CERTAIN FEATURES SUCH AS TIBCO-EMS AND JMS MIGHT RESULT IN EMPTY STATUS PROVIDERS OR RELOAD: ">https://www.ibm.com/support/docview.wss?uid=swg1IT29214</URL>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="Hardware" XPath="/Hardware//diagifnum/@status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value="ok"/>
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="Hardware" XPath="/Hardware//diagifnum"/>
			<RegExp>Expected number of interfaces\: ([0-9]+) \- Found\: ([0-9]+)</RegExp>
			<Condition FieldPosition="1" ConditionName="ExpectedValue" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" ConditionName="ResultValue" Operation="LessThan" Value="{Condition:ExpectedValue}"/>
		</Expression>
	</Formula>
	
	<Formula Categories="hardware">
		<Name>Hardware Reports Interface MAC Address Error: {/Hardware//diagifmac}</Name>
		<Expression LogLevel="Error">
			<Section Name="Hardware" XPath="/Hardware//diagifmac/@status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="error"/>
			</Expression>
	</Formula>
	
	<Formula Categories="hardware" FormulaIDMatch="!IsTenantOrVirtualDevice">
		<Name>Raid Card State Missing</Name>
		<DisplayMessage>{/Hardware/raidcard_state_missing/text()}</DisplayMessage>
		<Expression LogLevel="Critical">
			<Section Name="Hardware" XPath="/Hardware/raidcard_state_missing/@status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="error"/>
			</Expression>
	</Formula>
	
	<Formula Categories="hardware" FormulaIDMatch="!IsTenantOrVirtualDevice">
		<Name>Raid Disk Failure</Name>
		<DisplayMessage>{/Hardware/diagraiddiskfailure/text()}</DisplayMessage>
		<Expression LogLevel="Critical">
			<Section Name="Hardware" XPath="/Hardware/diagraiddiskfailure/@status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="error"/>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="critical"/>
			</Expression>
	</Formula>
	
	<Formula Categories="hardware">
		<Name>Hardware Reports Memory Error ({/Hardware//diagmemoryinerror})!</Name>
		<Expression LogLevel="Critical">
			<Section Name="Hardware" XPath="/Hardware//diagmemoryinerror/@status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value="ok"/>
		</Expression>
	</Formula>
	
	<!-- detect DiagnosticsLog version of crypto engine status -->
	<Formula Categories="configuration;failure;hardware" SortCondition="Timestamp" SortMethod="descending">
		<Name>{Condition:SectionName} {Condition:Timestamp} Reports crypto accelerator is not detected, contact support.</Name>
		<Expression LogLevel="Critical">
			<Section Name="DiagnosticLog" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>crypto accelerator not detected; contact support</IndexSearch>
			<RegExp>1,([0-9TZ.]{16,20}),default,crypto,alert,,,([0-9]+),,,0x8060010d,,,\"crypto accelerator not detected; contact support\"</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="hardware" FormulaIDMatch="!IsTenantOrVirtualDevice">
		<Name>{Condition:SectionName} - Crypto Engine Actual Mode {/Status/CryptoModeStatus/ActualMode} does not match target mode {/Status/CryptoModeStatus/TargetMode}.  FIPS engine may be disabled.</Name>
		<Expression LogLevel="Critical">
			<Section Name="CryptoModeStatus" XPath="/Status/CryptoModeStatus/ActualMode"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value="{/Status/CryptoModeStatus/TargetMode}"/>
		</Expression>
	</Formula>
	
	<Formula Categories="general;hardware" FormulaIDMatch="!IsTenantOrVirtualDevice">
		<Name>Crypto Hardware Failure: {Condition:HardwareFailure}!</Name>
		<Expression LogLevel="Critical">
			<Section Name="Hardware" XPath="/Hardware/diagcryptostat/@status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="error" NextOperation="And"/>
			<Condition FieldPosition="{/Hardware/diagcryptostat}" Operation="NotEqualTo" ConditionName="HardwareFailure" Value=""/>
			</Expression>
	</Formula>
	
	<Formula Categories="hardware" FormulaIDMatch="!IsTenantOrVirtualDevice">
		<Name>Crypto Hardware Failure, Status: {Condition:EngineStatus}!</Name>
		<Expression LogLevel="Critical">
			<Section Name="CryptoEngineStatus" XPath="/Status/CryptoEngineStatus//EngineStatus"/>
			<Section Name="CryptoEngineStatus2" XPath="/Status/CryptoEngineStatus2//EngineStatus"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" ConditionName="EngineStatus" Value="fully operational"/>
			</Expression>
	</Formula>
	
	<Formula CollapseResult="true" OmitPrintingMetConditions="true" Categories="general;hardware">
		<Name>Crypto Hardware is OK!</Name>
		<DisplayMessage>The crypto hardware is up and running, the status is: {/Status/CryptoEngineStatus//EngineStatus}</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="CryptoEngineStatus" XPath="/Status/CryptoEngineStatus//EngineStatus"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="fully operational"/>
			</Expression>
	</Formula>
	
	<Formula Categories="general;hardware" FormulaIDMatch="!IsTenantOrVirtualDevice">
		<Name>Battery Error!</Name>
		<DisplayMessage>The hardware section reports a problem with the battery: {Hardware/diagbattdate}.</DisplayMessage>
		<URL description="Installed battery nearing end of life: " >https://www.ibm.com/support/docview.wss?uid=swg21616668</URL>
		<Expression LogLevel="Critical">
			<Section Name="Hardware" XPath="/Hardware/diagbattdate/@status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="error"/>
			</Expression>
	</Formula>
	
	<Formula Categories="general;hardware" FormulaIDMatch="!IsTenantOrVirtualDevice">
		<Name>Battery Failure!</Name>
		<DisplayMessage>There is a report by the internal sensors that the battery has failed.</DisplayMessage>
		<URL description="Installed battery nearing end of life: " >https://www.ibm.com/support/docview.wss?uid=swg21616668</URL>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="OtherSensors" XPath="/Status/OtherSensors//Name"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="Battery Failed"/>
			</Expression>
		<Expression LogLevel="Critical">
			<Section Name="OtherSensors" XPath="/Status/OtherSensors//Value"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="true"/>
			</Expression>
	</Formula>
	
	<Formula Categories="hardware" FormulaIDMatch="!IsTenantOrVirtualDevice">
		<Name>RAID Disk Reports Error ({/Hardware//diagraidnotoptimal/text()})</Name>
		<Expression LogLevel="Error">
			<Section Name="Hardware" XPath="/Hardware//diagraidnotoptimal/@status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="error"/>
			</Expression>
	</Formula>
	
	<Formula Categories="hardware" FormulaIDMatch="!IsTenantOrVirtualDevice">
		<Name>RAID Disk Reports Critical Error ({/Hardware//diagraidbbu_temptoohigh/text()})</Name>
		<URL FormulaIDMatch="MachineType8441" description="IT37659 (Fixpack TBD): 8441 RAID BATTERY SHOULD REPORT AS WARNING WHEN TEMPERATURE PAST 50 CELSIUS, INCORRECTLY WARNS AT 40 CELSIUS: ">https://www.ibm.com/support/pages/apar/IT37659</URL>
		<Expression LogLevel="Critical">
			<Section Name="Hardware" XPath="/Hardware//diagraidbbu_temptoohigh/@status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="critical"/>
			</Expression>
	</Formula>
	
	<!-- track failure of raid drive 
	<diagraidlogdrive_badstate code="0x804000db" status="error">RAID logical drive 1 state : degraded.</diagraidlogdrive_badstate>
	-->
	<Formula Categories="hardware" FormulaIDMatch="!IsTenantOrVirtualDevice">
		<Name>RAID Disk Reports Error ({/Hardware//diagraidlogdrive_badstate/text()})</Name>
		<Expression LogLevel="Error">
			<Section Name="Hardware" XPath="/Hardware//diagraidlogdrive_badstate/@status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="error"/>
			</Expression>
	</Formula>
	
	<Formula Categories="hardware" FormulaIDMatch="!IsTenantOrVirtualDevice">
		<Name>RAID Physical Drive Reports Status: {/Hardware//diagraidphydrive_badstate_replace/@status}, drive needs replacement.</Name>
		<DisplayMessage>RAID Status Message: {/Hardware//diagraidphydrive_badstate_replace/text()}</DisplayMessage>
		<Expression LogLevel="Error">
			<Section Name="Hardware" XPath="/Hardware//diagraidphydrive_badstate_replace/@status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="critical" NextOperation="Or"/>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="error"/>
			</Expression>
	</Formula>
	<!-- End of Hardware Failures -->
	
	<!-- General High Usage markers on appliance -->
	<Formula CollapseResult="true" OmitPrintingMetConditions="true" TopPositionResult="true" Categories="memory">
		<Name>&lt;font color='red'&gt;!FREE MEMORY LESS THAN 50% ON RELOAD!&lt;/font&gt; MemStatsBeforeReload, MemFree/MemTotal: {Condition:MemFreeRounded} / {Condition:MemTotalRounded} GB</Name>
		<Expression FormulaIDMatch="PlatformNotDocker" LogLevel="Critical">
			<Section Name="MemStatsBeforeReload" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="3" ConditionName="MemTotalDivide" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(MemTotal:\s+([0-9]+) kB)\b</Condition>
			<Condition FieldPosition="{Condition:MemTotalDivide}" Operation="DivideBy" ConditionName="MemTotal" Value="1000000" NextOperation="And"/>
			<Condition FieldPosition="{Condition:MemTotal}" Operation="Round" ConditionName="MemTotalRounded" Value="2" NextOperation="And"/>
			<Condition FieldPosition="3" ConditionName="MemFreeDivide" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(MemFree:\s+([0-9]+) kB)\b</Condition>
			<Condition FieldPosition="{Condition:MemFreeDivide}" Operation="DivideBy" ConditionName="MemFree" Value="1000000" NextOperation="And"/>
			<Condition FieldPosition="{Condition:MemFree}" Operation="Round" ConditionName="MemFreeRounded" Value="2" NextOperation="And"/>
			<Condition FieldPosition="3" ConditionName="MemFreePercentage" Operation="DivideBy" Value="{Condition:MemTotalDivide}" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(MemFree:\s+([0-9]+) kB)\b</Condition>
			<Condition FieldPosition="{Condition:MemFreePercentage}" Operation="LessThan" Value=".51"/> <!-- check for less than 51% -->
		</Expression>
	</Formula>
	
	<Formula OmitPrintingMetConditions="true" TopPositionResult="true" Categories="memory">
		<Name>MemStatsBeforeReload, MemFree/MemTotal: {Condition:MemFreeRounded}/{Condition:MemTotalRounded} GB, Buffers: {Condition:Buffers} kB, Cached: {Condition:Cached} kB, VmallocTotal: {Condition:VmallocTotal} kB, VmallocUsed: {Condition:VmallocUsed} kB, VmallocChunk: {Condition:VmallocChunk} kB</Name>
		<DisplayMessage>Task Memory Usage: FDSize: {Condition:FDSize}, VmSize: {Condition:VmSize} kB, VmRSS: {Condition:VmRSS} kB</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="MemStatsBeforeReload" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="3" ConditionName="MemTotalDivide" Operation="GreaterThan" Value="4000000" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(MemTotal:\s+([0-9]+) kB)\b</Condition>
			<Condition FieldPosition="{Condition:MemTotalDivide}" Operation="DivideBy" ConditionName="MemTotal" Value="1000000" NextOperation="And"/>
			<Condition FieldPosition="{Condition:MemTotal}" Operation="Round" ConditionName="MemTotalRounded" Value="2" NextOperation="And"/>
			<Condition FieldPosition="3" ConditionName="MemFreeDivide" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(MemFree:\s+([0-9]+) kB)\b</Condition>
			<Condition FieldPosition="{Condition:MemFreeDivide}" Operation="DivideBy" ConditionName="MemFree" Value="1000000" NextOperation="And"/>
			<Condition FieldPosition="{Condition:MemFree}" Operation="Round" ConditionName="MemFreeRounded" Value="2" NextOperation="And"/>
			<Condition FieldPosition="3" ConditionName="Buffers" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(Buffers:\s+([0-9]+) kB)\b</Condition>
			<Condition FieldPosition="3" ConditionName="Cached" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(Cached:\s+([0-9]+) kB)\b</Condition>
			<Condition FieldPosition="3" ConditionName="VmallocTotal" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(VmallocTotal:\s+([0-9]+) kB)\b</Condition>
			<Condition FieldPosition="3" ConditionName="VmallocUsed" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(VmallocUsed:\s+([0-9]+) kB)\b</Condition>
			<Condition FieldPosition="3" ConditionName="VmallocChunk" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(VmallocChunk:\s+([0-9]+) kB)\b</Condition>
			<!-- task memory -->
			<Condition FieldPosition="3" ConditionName="FDSize" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(FDSize:\s+([0-9]+))\b</Condition>
			<Condition FieldPosition="3" ConditionName="VmSize" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(VmSize:\s+([0-9]+) kB)\b</Condition>
			<Condition FieldPosition="3" ConditionName="VmRSS" Operation="NotEqualTo" Value="">\bSystem Memory:.*\W+(\w+\W+)*?(VmRSS:\s+([0-9]+) kB)\b</Condition>
		</Expression>
	</Formula>
		
	<Formula OmitPrintingMetConditions="true" TopPositionResult="true" Categories="memory">
		<Name>&lt;font color='red'&gt;!LOW TOTAL MEMORY!&lt;/font&gt; MemStatsBeforeReload, MemFree/MemTotal: {Condition:MemFreeRounded}/&lt;font color='red'&gt;{Condition:MemTotalRounded} GB&lt;/font&gt;, Buffers: {Condition:Buffers} kB, Cached: {Condition:Cached} kB, VmallocTotal: {Condition:VmallocTotal} kB, VmallocUsed: {Condition:VmallocUsed} kB, VmallocChunk: {Condition:VmallocChunk} kB</Name>
		<DisplayMessage>Task Memory Usage: FDSize: {Condition:FDSize}, VmSize: {Condition:VmSize} kB, VmRSS: {Condition:VmRSS} kB</DisplayMessage>
		<URL description="System requirements for IBM DataPower Gateway appliances: ">https://www.ibm.com/support/pages/node/613133</URL>
		<Expression LogLevel="Critical">
			<Section Name="MemStatsBeforeReload" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="3" ConditionName="MemTotalDivide" Operation="LessThan" Value="4000001" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(MemTotal:\s+([0-9]+) kB)\b</Condition>
			<Condition FieldPosition="{Condition:MemTotalDivide}" Operation="DivideBy" ConditionName="MemTotal" Value="1000000" NextOperation="And"/>
			<Condition FieldPosition="{Condition:MemTotal}" Operation="Round" ConditionName="MemTotalRounded" Value="2" NextOperation="And"/>
			<Condition FieldPosition="3" ConditionName="MemFreeDivide" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(MemFree:\s+([0-9]+) kB)\b</Condition>
			<Condition FieldPosition="{Condition:MemFreeDivide}" Operation="DivideBy" ConditionName="MemFree" Value="1000000" NextOperation="And"/>
			<Condition FieldPosition="{Condition:MemFree}" Operation="Round" ConditionName="MemFreeRounded" Value="2" NextOperation="And"/>
			<Condition FieldPosition="3" ConditionName="Buffers" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(Buffers:\s+([0-9]+) kB)\b</Condition>
			<Condition FieldPosition="3" ConditionName="Cached" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(Cached:\s+([0-9]+) kB)\b</Condition>
			<Condition FieldPosition="3" ConditionName="VmallocTotal" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(VmallocTotal:\s+([0-9]+) kB)\b</Condition>
			<Condition FieldPosition="3" ConditionName="VmallocUsed" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(VmallocUsed:\s+([0-9]+) kB)\b</Condition>
			<Condition FieldPosition="3" ConditionName="VmallocChunk" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(VmallocChunk:\s+([0-9]+) kB)\b</Condition>
			<!-- task memory -->
			<Condition FieldPosition="3" ConditionName="FDSize" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(FDSize:\s+([0-9]+))\b</Condition>
			<Condition FieldPosition="3" ConditionName="VmSize" Operation="NotEqualTo" Value="" NextOperation="And">\bSystem Memory:.*\W+(\w+\W+)*?(VmSize:\s+([0-9]+) kB)\b</Condition>
			<Condition FieldPosition="3" ConditionName="VmRSS" Operation="NotEqualTo" Value="">\bSystem Memory:.*\W+(\w+\W+)*?(VmRSS:\s+([0-9]+) kB)\b</Condition>
		</Expression>
	</Formula>
		
	<Formula OmitPrintingMetConditions="true" Categories="memory">
		<Name>Total Memory Available is lower than expected, {Condition:MemoryTotal} kilobytes are available.  Memory issues can occur with 4GB or less, 'standard' 8GB minimum total memory recommended.</Name>
		<URL description="System requirements for IBM DataPower Gateway appliances: ">https://www.ibm.com/support/pages/node/613133</URL>
		<Expression LogLevel="Critical">
			<Section Name="MemoryStatus" XPath="/Status/MemoryStatus/TotalMemory"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemoryTotal" Operation="LessThan" Value="4000000"/>
		</Expression>
	</Formula>
	
	<Formula OmitPrintingMetConditions="true" Categories="memory">
		<Name>Total Memory Available is low and OOM situations may occur, {Condition:MemoryTotal} kilobytes are available.  Memory issues can occur with 4GB or less, 'standard' 8GB minimum total memory recommended.</Name>
		<URL description="System requirements for IBM DataPower Gateway appliances: ">https://www.ibm.com/support/pages/node/613133</URL>
		<Expression LogLevel="Error">
			<Section Name="MemoryStatus" XPath="/Status/MemoryStatus/TotalMemory"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemoryTotal" Operation="LessThan" Value="5000000" NextOperation="And"/>
			<Condition FieldPosition="0" ConditionName="MemoryTotal" Operation="GreaterThan" Value="4000000"/>
		</Expression>
	</Formula>
	
	<Formula OmitPrintingMetConditions="true" Categories="memory">
		<Name>Memory Usage is High, {/Status/MemoryStatus/Usage}%.</Name>
		<URL description="Memory MustGather Script: ">https://www.ibm.com/support/pages/node/622241</URL>
		<Expression LogLevel="Warning">
			<Section Name="MemoryStatus" XPath="/Status/MemoryStatus/Usage"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="59"/>
			</Expression>
	</Formula>
	
	<Formula Categories="memory">
		<Name>{Condition:SectionName} Usage is High, Type: {/Status/XMLNamesStatus//Type}, currently {/Status/XMLNamesStatus//PercentFree}% free.</Name>
		<DisplayMessage>The XML name status for field {/Status/XMLNamesStatus//Type} has high usage, currently {/Status/XMLNamesStatus//PercentFree}% free, {/Status/XMLNamesStatus//Used} entries used.</DisplayMessage>
		<URL description="High XML Names: ">https://www.ibm.com/support/pages/node/708303</URL>
		<Expression LogLevel="Critical">
			<Section Name="XMLNamesStatus" XPath="/Status/XMLNamesStatus//PercentFree"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="LessThan" Value="20"/>
			</Expression>
	</Formula>
	
	<Formula Categories="configuration;cpu;memory;failure">
		<Name>{Condition:SectionName} {Condition:Timestamp} System is exhausted in XML-names, attempting to free up used names, stage: {Condition:Stage}.</Name>
		<URL description="High XML Names: ">https://www.ibm.com/support/pages/node/708303</URL>
		<!-- 7.1.0 xml names was increased from the 65k max to 1 million, release notes for 7.1.0 are no longer available on IBMs site, removed URL to release notes -->
		<Expression LogLevel="Critical">
			<Section Name="DiagnosticLog" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>The number of XML Names currently being used by the system is high</IndexSearch>
			<RegExp>1,([0-9TZ.]{16,20}),default,system,notice,throttle,Throttler,([0-9]+),,,0x804000b5,,,\"The number of XML Names currently being used by the system is high\. The system is attempting to free unused XML names \(([0-9])\)\.\"</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="Stage" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- End of the General High Usage Markers -->
	
	<!-- Quota enforcement tracking -->
	<Formula CollapseResult="true" FormulaID="APARCHECK:IT15995,IT15701">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="5" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="3"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="5" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="2"/>
			</Expression>
	</Formula>
	
	<Formula Categories="memory">
		<Name>{Condition:SectionName} Quota Enforcement Server is in bad state, Mode: {/Status/QuotaEnforcementStatus/Mode}.  Applicable APAR's are listed in reference URLs, if no URLs listed this may need further investigation from L2/L3 Support.</Name>
		<URL FormulaIDMatch="APARCHECK:IT21264" description="APAR IT21264 (Fixed in 7.5.0.14, 7.5.1.13, 7.5.2.13, 7.6.0.6 and 7.7.1.2): THE USE OF QUOTA ENFORCEMENT ON DATAPOWER MAY RESULT IN UNEXPECTED RELOAD: ">https://www.ibm.com/support/docview.wss?uid=swg1IT21264</URL>
		<URL FormulaIDMatch="APARCHECK:IT15995,IT15701" description="APAR IT15995 (Fixed in 7.5.0.3 and 7.5.1.2): DATAPOWER MAY RESTART IF USING QUOTA ENFORCEMENT SERVER AND GATEWAYSCRIPT RATELIMIT MODULE WITH HIGH LOAD: ">https://www.ibm.com/support/docview.wss?uid=swg1IT15995</URL>
		<Expression LogLevel="Error">
			<Section Name="QuotaEnforcementStatus" XPath="/Status/QuotaEnforcementStatus/State"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="up" NextOperation="And"/>
			<Condition FieldPosition="{/Status/QuotaEnforcementStatus/Mode}" Operation="EqualsTo" Value="n/a"/>
		</Expression>
	</Formula>
	<!-- End quota enforcement tracking -->
	
	<!-- FileSystemStatus markers, check for low temporary,encrypted and internal space -->
	
	<!-- formula used for a check at the bottom for files in temporary if we are low in space -->
	<Formula Categories="memory" FormulaID="LowTemporarySpaceFlag">
		<Name>FilesystemStatus Free Temporary Space is less than 50%, {/Status/FilesystemStatus//FreeTemporary}MB left free.</Name>
		<URL description="FileSystem Details: ">https://www.ibm.com/support/pages/node/156957</URL>
		<URL description="Hash Files in Temporary Folder: ">https://www.ibm.com/support/pages/node/211651</URL>
		<Expression LogLevel="Error">
			<Section Name="FilesystemStatus" XPath="/Status/FilesystemStatus//FreeTemporary"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="{/Status/FilesystemStatus//TotalTemporary}" Operation="NotEqualTo" ConditionName="TotalTemporary" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="DivideBy" ConditionName="PercentageFreeTemporary" Value="{Condition:TotalTemporary}" NextOperation="And"/>
			<Condition FieldPosition="{Condition:PercentageFreeTemporary}" Operation="LessThan" Value=".51"/> <!-- check for less than 51% -->
		</Expression>
	</Formula>
	
	<!-- this will only appear if the FormulaID LowTemporarySpaceFlag is triggered -->
	<Formula CollapseResult="true" Categories="memory" SortCondition="Size" SortMethod="Descending" SumCondition="Size">
		<Name>Temporary FileSystem File {Condition:FileName} size {Condition:Size} bytes.</Name>
		<Expression LogLevel="Error" FormulaIDMatch="LowTemporarySpaceFlag" NextOperation="And">
			<Section Name="FlashFiles" XPath="/flash/file[contains(text(),'drouter/temporary/')]"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="FileName" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Error" FormulaIDMatch="LowTemporarySpaceFlag">
			<Section Name="FlashFiles" XPath="/flash/file[contains(text(),'drouter/temporary/')]/@size"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="Size" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- end temporary filesystem review -->
	
	<Formula Categories="memory" FormulaID="LowEncryptedSpaceFlag">
		<Name>{Condition:SectionName} Free Encrypted Space is less than 50%, {/Status/FilesystemStatus//FreeEncrypted}MB left free.</Name>
		<URL description="FileSystem Details: ">https://www.ibm.com/support/pages/node/156957</URL>
		<Expression LogLevel="Error">
			<Section Name="FilesystemStatus" XPath="/Status/FilesystemStatus//FreeEncrypted"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="{/Status/FilesystemStatus//TotalEncrypted}" Operation="NotEqualTo" ConditionName="TotalEncrypted" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="DivideBy" ConditionName="PercentageFreeEncrypted" Value="{Condition:TotalEncrypted}" NextOperation="And"/>
			<Condition FieldPosition="{Condition:PercentageFreeEncrypted}" Operation="LessThan" Value=".51"/> <!-- check for less than 51% -->
		</Expression>
	</Formula>

	<!-- this will only appear if the FormulaID LowEncryptedSpaceFlag is triggered, look for 1MB+ since the local filesystem can be large -->
	<Formula CollapseResult="true" Categories="memory" SortCondition="Size" SortMethod="Descending" SumCondition="Size">
		<Name>Encrypted FileSystem File {Condition:FileName} size {Condition:Size} bytes.</Name>
		<Expression LogLevel="Error" FormulaIDMatch="LowEncryptedSpaceFlag" NextOperation="And">
			<Section Name="FlashFiles" XPath="/flash/file[starts-with(text(),'drouter/local/') or starts-with(text(),'drouter/config/')]"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="FileName" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Error" FormulaIDMatch="LowEncryptedSpaceFlag">
			<Section Name="FlashFiles" XPath="/flash/file[starts-with(text(),'drouter/local/') or starts-with(text(),'drouter/config/')]/@size"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="Size" Operation="GreaterThan" Value="1000000"/>
		</Expression>
	</Formula>
	<!-- end encrypted filesystem review -->

	<Formula Categories="memory" FormulaID="LowInternalSpaceFlag">
		<Name>FilesystemStatus Free Internal Space is less than 50%, {/Status/FilesystemStatus//FreeInternal}MB left free.</Name>
		<URL description="FileSystem Details: ">https://www.ibm.com/support/pages/node/156957</URL>
		<Expression LogLevel="Error">
			<Section Name="FilesystemStatus" XPath="/Status/FilesystemStatus//FreeInternal"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="{/Status/FilesystemStatus//TotalInternal}" Operation="NotEqualTo" ConditionName="TotalInternal" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="DivideBy" ConditionName="PercentageFreeInternal" Value="{Condition:TotalInternal}" NextOperation="And"/>
			<Condition FieldPosition="{Condition:PercentageFreeInternal}" Operation="LessThan" Value=".51"/> <!-- check for less than 51% -->
		</Expression>
	</Formula>
		
	<!-- this will only appear if the FormulaID LowInternalSpaceFlag is triggered -->
	<Formula CollapseResult="true" Categories="memory" SortCondition="Size" SortMethod="Descending" SumCondition="Size">
		<Name>Internal FileSystem File {Condition:FileName} size {Condition:Size} bytes.</Name>
		<Expression LogLevel="Error" FormulaIDMatch="LowInternalSpaceFlag" NextOperation="And">
			<Section Name="FlashFiles" XPath="/flash/file[contains(text(),'drouter/ramdisk2/')]"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="FileName" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Error" FormulaIDMatch="LowInternalSpaceFlag">
			<Section Name="FlashFiles" XPath="/flash/file[contains(text(),'drouter/ramdisk2/')]/@size"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="Size" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>	
	
	<Formula Categories="general;failure;memory" SortCondition="Size" SortMethod="Descending" SumCondition="Size">
		<Name>{Condition:SectionName} Internal FileSystem (Gateway-Peering Persistence Memory) Domain: {Condition:DomainName}, Gateway-Peering Object Name: {Condition:GatewayPeeringObjectName}, FileName: {Condition:FileName} size {Condition:Size} bytes.  Enough exhaustion of internal filesystem may disrupt upgrades.  Disable gateway-peering object, shutdown reboot and then upgrade.  After upgrading re-enable the gateway-peering object.</Name>
		<DisplayMessage>{Condition:DomainName}||{Condition:GatewayPeeringObjectName}||{Condition:FileName}||{Condition:Size}</DisplayMessage>
		<Expression LogLevel="Warning" NextOperation="And">
			<Section Name="FlashFiles" XPath="/flash/file[contains(text(),'drouter/ramdisk2/gateway-peering/persistence/')]"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" ConditionName="DomainName" Operation="NotEqualTo" Value="" NextOperation="And">drouter\/ramdisk2\/gateway-peering\/persistence\/([a-zA-Z-_.0-9]+)\/([a-zA-Z-_.0-9]+)\/(.*)</Condition>
			<Condition FieldPosition="2" ConditionName="GatewayPeeringObjectName" Operation="NotEqualTo" Value="" NextOperation="And">drouter\/ramdisk2\/gateway-peering\/persistence\/([a-zA-Z-_.0-9]+)\/([a-zA-Z-_.0-9]+)\/(.*)</Condition>
			<Condition FieldPosition="3" ConditionName="FileName" Operation="NotEqualTo" Value="">drouter\/ramdisk2\/gateway-peering\/persistence\/([a-zA-Z-_.0-9]+)\/([a-zA-Z-_.0-9]+)\/(.*)</Condition>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="FlashFiles" XPath="/flash/file[contains(text(),'drouter/ramdisk2/gateway-peering/persistence/')]/@size"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="Size" Operation="GreaterThan" Value="100000000"/>
		</Expression>
	</Formula>
	<!-- end internal filesystem review -->

	<!-- End of FileSystemStatus checks -->
	
	
	<!-- Beginning of MQQM Status Fault Checks -->
	<Formula CollapseResult="true" FormulaID="APARCHECK:IT21003">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.0.0" NextOperation="And"/>
				<!-- introduced in 7.0.0.17 -->
				<Condition FieldPosition="3" Operation="GreaterThan" Value="16"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.1.0" NextOperation="And"/>
				<!-- introduced in 7.1.0.14 fixed in 7.1.0.18 -->
				<Condition FieldPosition="3" Operation="GreaterThan" Value="13" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="18"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.2.0" NextOperation="And"/>
				<!-- introduced in 7.2.0.11 fixed in 7.2.0.15 -->
				<Condition FieldPosition="3" Operation="GreaterThan" Value="10" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="15"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.0" NextOperation="And"/>
				<!-- introduced in 7.5.0.5 fixed in 7.5.0.9 -->
				<Condition FieldPosition="3" Operation="GreaterThan" Value="4" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="9"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.1" NextOperation="And"/>
				<!-- introduced in 7.5.1.4 fixed in 7.5.1.8 -->
				<Condition FieldPosition="3" Operation="GreaterThan" Value="3" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="8"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.2" NextOperation="And"/>
				<!-- introduced in 7.5.2.2 fixed in 7.5.2.8 -->
				<Condition FieldPosition="3" Operation="GreaterThan" Value="1" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="8"/>
			</Expression>
	</Formula>
	
	<Formula Categories="configuration">
		<Name>{Condition:SectionName} MQ Queue Manager {/Status/MQQMstatus//QueueManager} Reports Receive Faults (Total: {/Status/MQQMstatus//ReceiveFaults})</Name>
		<URL FormulaIDMatch="APARCHECK:IT21003" description="IT21003 (Fixed in 7.1.0.18, 7.2.0.15, 7.5.0.9, 7.5.1.8, 7.5.2.8 and 7.6.0.0): AFTER A NETWORK FAILURE WITH TWO OR MORE MQ CONNECTIONS, REMOTE MQ QUEUE MANAGER REQUIRES REACTIVATION: ">https://www.ibm.com/support/docview.wss?uid=swg1IT21003</URL>
		<!-- if APAR IT21003 is present, this formula will rise to the top as it is more important -->
		<Expression LogLevel="Critical" FormulaIDMatch="APARCHECK:IT21003">
			<Section Name="MQQMstatus" Wildcard="True" XPath="/Status/MQQMstatus//ReceiveFaults"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="MQQMstatus" Wildcard="True" XPath="/Status/MQQMstatus//ReceiveFaults"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>
	<Formula Categories="configuration">
		<Name>{Condition:SectionName} MQ Queue Manager {/Status/MQQMstatus//QueueManager} Reports Send Faults (Total: {/Status/MQQMstatus//SendFaults})</Name>
		<URL FormulaIDMatch="APARCHECK:IT21003" description="IT21003 (Fixed in 7.1.0.18, 7.2.0.15, 7.5.0.9, 7.5.1.8, 7.5.2.8 and 7.6.0.0): AFTER A NETWORK FAILURE WITH TWO OR MORE MQ CONNECTIONS, REMOTE MQ QUEUE MANAGER REQUIRES REACTIVATION: ">https://www.ibm.com/support/docview.wss?uid=swg1IT21003</URL>
		<!-- if APAR IT21003 is present, this formula will rise to the top as it is more important -->
		<Expression LogLevel="Critical" FormulaIDMatch="APARCHECK:IT21003">
			<Section Name="MQQMstatus" Wildcard="True" XPath="/Status/MQQMstatus//SendFaults"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="MQQMstatus" Wildcard="True" XPath="/Status/MQQMstatus//SendFaults"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>
	
	<!-- End of MQQM Status Fault Checks -->
	
	
	<!-- LoadBalancerGroup Status Checks -->
	
	<!-- Updated formula July 17th 2013 to no longer show disabled Load Balancer Groups (check for AdminState=enabled) -->
	<Formula Categories="network">
		<Name>{Condition:SectionName} LoadBalancer ({/Status/LoadBalancerStatus2//Group}) Reports Group Member Down</Name>
		<DisplayMessage>The LoadBalancer Group {/Status/LoadBalancerStatus2//Group}, has a downed member {/Status/LoadBalancerStatus2//Server} over port {/Status/LoadBalancerStatus2//Port}.</DisplayMessage>
			<Expression LogLevel="Warning" NextOperation="And">
			<Section Name="LoadBalancerStatus2" Wildcard="True" XPath="/Status/LoadBalancerStatus2//Health"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="down"/>
			</Expression>
			<Expression LogLevel="Warning">
			<Section Name="LoadBalancerStatus2" Wildcard="True" XPath="/Status/LoadBalancerStatus2//AdminState"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="enabled"/>
			</Expression>
	</Formula>
	
	<!-- End of LoadBalancerGroup Status Checks -->
	
	<!-- IPMISelEvents checks -->
	<Formula Categories="failure;hardware" SortMethod="descending" FormulaIDMatch="!IsTenantOrVirtualDevice">
		<Name>{Condition:SectionName} {Condition:Timestamp} Power Supply Unit Reporting &lt;font color='#EE0404'&gt;{Condition:SensorName}&lt;/font&gt; SensorNumber &lt;font color='#EE0404'&gt;{Condition:SensorNumber}&lt;/font&gt;</Name>
		<DisplayMessage>Confirm that timestamp of PSU event matches to customer reports.</DisplayMessage>
			<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//EventReadingTypeCode"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="SensorName" Operation="EqualsTo" Value="powerUnitPowerOff"/>
			</Expression>
			<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//SensorNumber"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="SensorNumber" Operation="EqualsTo" Value="0x002D"/>
			</Expression>
			<Expression LogLevel="Critical">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//Timestamp"/>
			<RegExp>\s+</RegExp>
			<Condition FieldPosition="0" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="1" InValue="{Condition:Timestamp}" ConditionName="Year" Operation="NotEqualTo" Value="" NextOperation="And">(20[2-9][0-9])\/?</Condition>
			<Condition FieldPosition="{Condition:Year}" Operation="GreaterThan" Value="2023"/> <!-- allow 2024 or higher for now -->
			</Expression>
	</Formula>
	
	<Formula Categories="failure;hardware" SortMethod="descending">
		<Name>{Condition:SectionName} {Condition:Timestamp} CPU Reporting PROC_STATE -- hardware may need review if suffered recent reloads.</Name>
		<DisplayMessage>Review further with IBM DataPower Support Team.</DisplayMessage>
			<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//SensorName"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="SensorName" Operation="EqualsTo" Value="PROC_STATE"/>
			</Expression>
			<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//SensorType"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="SensorType" Operation="EqualsTo" Value="processor"/>
			</Expression>
			<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//EventDirection"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="EventDirection" Operation="EqualsTo" Value="asserted"/>
			</Expression>
			<Expression LogLevel="Critical">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//Timestamp"/>
			<RegExp>\s+</RegExp>
			<Condition FieldPosition="0" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="1" InValue="{Condition:Timestamp}" ConditionName="Year" Operation="NotEqualTo" Value="" NextOperation="And">(20[2-9][0-9])\/?</Condition>
			<Condition FieldPosition="{Condition:Year}" Operation="GreaterThan" Value="2023"/> <!-- allow 2024 or higher for now -->
			</Expression>
	</Formula>
	
	<!-- investigation 46984 -->
	<Formula Categories="failure" SortMethod="descending" FormulaIDMatch="!IsTenantOrVirtualDevice">
		<Name>Possible Firmware or Hardware Watchdog Restart (watchdog2TimeExpired) ({/Status/IPMISelEvents//Timestamp})!</Name>
		<DisplayMessage>Review DPOSDiagnostics or SysRecord (if available) for more information (INFO level, available at bottom of Analytics Report).  Versions prior to 7.0 this is more likely a firmware watchdog.</DisplayMessage>
			<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//EventReadingTypeCode"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="watchdog2TimeExpired"/>
			</Expression>
			<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//SensorNumber"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="0x0001"/>
			</Expression>
			<Expression LogLevel="Critical">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//Timestamp"/>
			<!-- "Tue Jan  9 00:35:54 2007" or "2016/12/19 14:36:18" -->
			<RegExp>\s+</RegExp>
			<Condition FieldPosition="0" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="1" InValue="{Condition:Timestamp}" ConditionName="Year" Operation="NotEqualTo" Value="" NextOperation="And">(20[2-9][0-9])\/?</Condition>
			<Condition FieldPosition="{Condition:Year}" Operation="GreaterThan" Value="2023"/> <!-- allow 2024 or higher for now -->
			</Expression>
	</Formula>

	<Formula Categories="failure" SortMethod="descending" FormulaIDMatch="!IsTenantOrVirtualDevice">
		<Name>{Condition:SectionName} {/Status/IPMISelEvents//Timestamp} Unexpected Restart/Reset/Reboot ({/Status/IPMISelEvents//SensorName})!</Name>
		<URL description="How to use LLDIAG on the DataPower gateways to gather diagnostic information: ">https://www.ibm.com/support/pages/how-use-lldiag-datapower-gateways-gather-diagnostic-information</URL>
		<URL FormulaIDMatch="MachineType9235" description="9235 may restart due to Baseboard Management Controller (BMC) communications loss: ">https://www.ibm.com/support/pages/node/467907</URL>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//EventReadingTypeCode"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="watchdog2HardReset"/>
			</Expression>
		<Expression LogLevel="Critical">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//Timestamp"/>
			<!-- "Tue Jan  9 00:35:54 2007" -->
			<RegExp>\s+</RegExp>
			<Condition FieldPosition="0" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="1" InValue="{Condition:Timestamp}" ConditionName="Year" Operation="NotEqualTo" Value="" NextOperation="And">(20[2-9][0-9])\/?</Condition>
			<Condition FieldPosition="{Condition:Year}" Operation="GreaterThan" Value="2023"/> <!-- allow 2024 or higher for now -->
		</Expression>
	</Formula>
	
	<!-- track ipmiselevents -->
	<Formula Categories="general;hardware" SortMethod="descending" FormulaIDMatch="!IsTenantOrVirtualDevice">
		<Name>{Condition:SectionName} contains software and hardware events for review</Name>
		<DisplayMessage>&lt;font color='#CC3300'&gt;{/Status/IPMISelEvents//Timestamp}&lt;/font&gt;||&lt;font color='#CC3300'&gt;{Condition:SensorType}&lt;/font&gt;||&lt;font color='#CC3300'&gt;{Condition:EventReadingTypeCode}&lt;/font&gt;||{Condition:SensorName}||{Condition:SensorNumber}||{Condition:EventDirection}||{Condition:ExtraFlags}</DisplayMessage>
		<URL description="IPMISelEvents HW Status (systemFirmwareProgress=reload/reboot)">https://www.ibm.com/docs/en/datapower-gateway/10.6.0?topic=providers-hardware-status</URL>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//Timestamp"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="Timestamp" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//SensorType"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="SensorType" Operation="Append" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//EventReadingTypeCode"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="EventReadingTypeCode" Operation="Append" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//SensorName"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="SensorName" Operation="Append" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//SensorNumber"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="SensorNumber" Operation="Append" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//EventDirection"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="EventDirection" Operation="Append" Value=""/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//Extra"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="ExtraFlags" Operation="Append" Value=""/>
		</Expression>
	</Formula>
	<!-- end of ipmiselevents tracking -->
	
	<!-- Covers correctableEcc and uncorrectableEcc (looks for contains to match both) - memory related issues -->
	<Formula Categories="failure;hardware"  SortMethod="descending" FormulaIDMatch="!IsTenantOrVirtualDevice">
		<Name>IPMISelEvents Reports ECC Memory Issues ({/Status/IPMISelEvents//Timestamp})!</Name>
		<URL description="ECC Memory Issues: ">https://www.ibm.com/support/pages/node/234927</URL>
			<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//EventReadingTypeCode"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="Contains" Value="correctableEcc"/>
			<Condition FieldPosition="0" Operation="Contains" Value="uncorrectableEcc"/>
			</Expression>
			<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//SensorType"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="memory"/>
			</Expression>
			<Expression LogLevel="Critical">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//Timestamp"/>
			<!-- "Tue Jan  9 00:35:54 2007" -->
			<RegExp>\s+</RegExp>
			<Condition FieldPosition="0" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="1" InValue="{Condition:Timestamp}" ConditionName="Year" Operation="NotEqualTo" Value="" NextOperation="And">(20[2-9][0-9])\/?</Condition>
			<Condition FieldPosition="{Condition:Year}" Operation="GreaterThan" Value="2023"/> <!-- allow 2024 or higher for now -->
			</Expression>
	</Formula>
	
	<Formula Categories="failure;hardware"  SortMethod="descending">
		<Name>{Condition:SectionName} {Condition:Timestamp} Reports Potential CPU/Motherboard Issue</Name>
		<DisplayMessage>&lt;font color='#CC3300'&gt;{Condition:Timestamp}&lt;/font&gt;||&lt;font color='#CC3300'&gt;{Condition:SensorType}&lt;/font&gt;||&lt;font color='#CC3300'&gt;{Condition:EventReadingTypeCode}&lt;/font&gt;</DisplayMessage>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//EventReadingTypeCode"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" TableMapPosition="2" ConditionName="EventReadingTypeCode" Operation="EqualsTo" Value="busCorrectableError"/>
		</Expression>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//SensorType"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" TableMapPosition="1" ConditionName="SensorType" Operation="EqualsTo" Value="criticalInterrupt"/>
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="IPMISelEvents" XPath="/Status/IPMISelEvents//Timestamp"/>
			<!-- "Tue Jan  9 00:35:54 2007" -->
			<RegExp>\s+</RegExp>
			<Condition FieldPosition="0" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="1" InValue="{Condition:Timestamp}" ConditionName="Year" Operation="NotEqualTo" Value="" NextOperation="And">(20[2-9][0-9])\/?</Condition>
			<Condition FieldPosition="{Condition:Year}" Operation="GreaterThan" Value="2023"/> <!-- allow 2024 or higher for now -->
		</Expression>
	</Formula>
	<!-- end IPMISelEvents checks -->
	
	<!-- Stylesheet Execution Times -->
	<Formula Categories="memory">
		<Name>{Condition:SectionName} High Stylesheet Execution Times from XMLMgr {/Status/StylesheetMeanExecutionTimeSimpleIndex//XMLManager} ({/Status/StylesheetMeanExecutionTimeSimpleIndex//URL})!</Name>
		<DisplayMessage>Excessive execution time for stylesheet: {/Status/StylesheetMeanExecutionTimeSimpleIndex//URL}, XMLMgr: {/Status/StylesheetMeanExecutionTimeSimpleIndex//XMLManager}, Buckets - 10s: {/Status/StylesheetMeanExecutionTimeSimpleIndex//tenSeconds}, 1m: {/Status/StylesheetMeanExecutionTimeSimpleIndex//oneMinute}, 10m: {/Status/StylesheetMeanExecutionTimeSimpleIndex//tenMinutes}, 1hr: {/Status/StylesheetMeanExecutionTimeSimpleIndex//oneHour}, day: {/Status/StylesheetMeanExecutionTimeSimpleIndex//oneDay}.</DisplayMessage>
		<URL description="WebSphere DataPower SOA Appliances and XSLT, Part 1 of 2 - Tools (Stylesheet Profiling): ">https://www.ibm.com/support/pages/node/324917</URL>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="StylesheetMeanExecutionTimeSimpleIndex" Wildcard="True" XPath="/Status/StylesheetMeanExecutionTimeSimpleIndex//tenSeconds"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="999"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="StylesheetMeanExecutionTimeSimpleIndex" Wildcard="True" XPath="/Status/StylesheetMeanExecutionTimeSimpleIndex//oneMinute"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="999"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="StylesheetMeanExecutionTimeSimpleIndex" Wildcard="True" XPath="/Status/StylesheetMeanExecutionTimeSimpleIndex//tenMinutes"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="999"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="StylesheetMeanExecutionTimeSimpleIndex" Wildcard="True" XPath="/Status/StylesheetMeanExecutionTimeSimpleIndex//oneHour"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="999"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="StylesheetMeanExecutionTimeSimpleIndex" Wildcard="True" XPath="/Status/StylesheetMeanExecutionTimeSimpleIndex//oneDay"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="999"/>
		</Expression>
	</Formula>
	
	<Formula Categories="memory">
		<Name>{Condition:SectionName} Execution Counts from XMLMgr {/Status/StylesheetExecutionsSimpleIndex//XMLManager} ({/Status/StylesheetExecutionsSimpleIndex//URL})</Name>
		<DisplayMessage>Execution Counts for stylesheet: {/Status/StylesheetExecutionsSimpleIndex//URL}, XMLMgr: {/Status/StylesheetExecutionsSimpleIndex//XMLManager}, Buckets - 10s: {/Status/StylesheetExecutionsSimpleIndex//tenSeconds}, 1m: {/Status/StylesheetExecutionsSimpleIndex//oneMinute}, 10m: {/Status/StylesheetExecutionsSimpleIndex//tenMinutes}, 1hr: {/Status/StylesheetExecutionsSimpleIndex//oneHour}, day: {/Status/StylesheetExecutionsSimpleIndex//oneDay}.</DisplayMessage>
		<URL description="WebSphere DataPower SOA Appliances and XSLT, Part 1 of 2 - Tools (Stylesheet Profiling): ">https://www.ibm.com/support/pages/node/324917</URL>
		<Expression LogLevel="Info" NextOperation="Or">
			<Section Name="StylesheetExecutionsSimpleIndex" Wildcard="True" XPath="/Status/StylesheetExecutionsSimpleIndex//tenSeconds"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0" NextOperation="And"/>
			<Condition FieldPosition="0" ConditionName="OneMinuteMinimum" Operation="Multiply" Value="6" NextOperation="And"/>
			<Condition FieldPosition="{/Status/StylesheetExecutionsSimpleIndex/oneMinute}" Operation="GreaterThan" Value="{Condition:OneMinuteMinimum}"/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="Or">
			<Section Name="StylesheetExecutionsSimpleIndex" Wildcard="True" XPath="/Status/StylesheetExecutionsSimpleIndex//oneMinute"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0" NextOperation="And"/>
			<Condition FieldPosition="0" ConditionName="TenMinuteMinimum" Operation="Multiply" Value="10" NextOperation="And"/>
			<Condition FieldPosition="{/Status/StylesheetExecutionsSimpleIndex/tenMinutes}" Operation="GreaterThan" Value="{Condition:TenMinuteMinimum}"/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="Or">
			<Section Name="StylesheetExecutionsSimpleIndex" Wildcard="True" XPath="/Status/StylesheetExecutionsSimpleIndex//tenMinutes"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0" NextOperation="And"/>
			<Condition FieldPosition="0" ConditionName="OneHourMinimum" Operation="Multiply" Value="6" NextOperation="And"/>
			<Condition FieldPosition="{/Status/StylesheetExecutionsSimpleIndex/oneHour}" Operation="GreaterThan" Value="{Condition:OneHourMinimum}"/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="Or">
			<Section Name="StylesheetExecutionsSimpleIndex" Wildcard="True" XPath="/Status/StylesheetExecutionsSimpleIndex//oneHour"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0" NextOperation="And"/>
			<Condition FieldPosition="0" ConditionName="OneDayMinimum" Operation="Multiply" Value="24" NextOperation="And"/>
			<Condition FieldPosition="{/Status/StylesheetExecutionsSimpleIndex/oneDay}" Operation="GreaterThan" Value="{Condition:OneDayMinimum}"/>
		</Expression>
	</Formula>
	
	<!-- End execution stylesheet tests -->
	
	<!-- Log target tests -->	
	<Formula Categories="configuration;failure" FormulaID="LogTargetReload" SortCondition="DaysToCapRnd" SortMethod="ascending">
		<Name>{Condition:SectionName} Log Target &lt;font color='#CC3300'&gt;{Condition:LogTargetName}&lt;/font&gt; contains {/Status/LogTargetStatus//EventsProcessed} log events processed successfully after device uptime of: {Condition:Uptime} ({Condition:ProcessedEventsDivideByHour} events per hour, to cap {Condition:LogTargetCap}).  Identify if log target is a syslog-tcp based log target, if so &lt;font color='#CC3300'&gt;Log target will suffer a known defect approximately in {Condition:DaysToCapRnd} days resulting in an unexpected device reload&lt;/font&gt;.  Reduce logging levels to restrict hitting the 4294967294 processed events cap.</Name>
		<URL description="IT37506 - DATAPOWER MAY RESTART AFTER PROCESSING 4 BILLION LOG TARGET MESSAGES VIA SYSLOG-TCP OR NFS (Fixed in 2018.4.1.18, 10.0.1.5): ">https://www.ibm.com/support/pages/apar/IT37506</URL>
		<Expression LogLevel="Critical" FormulaIDMatch="APARCHECK:IT37506" NextOperation="And">
			<Section Name="DateTimeStatus" SectionName="false" XPath="/Status/DateTimeStatus//uptime2"/>
			<RegExp>([0-9]+)\sdays\s([0-9]{2})\:([0-9]{2})\:[0-9]{2}</RegExp>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="LogTargetCap" Value="4294967294" NextOperation="And"/>
			<Condition FieldPosition="0" ConditionName="Uptime" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" ConditionName="UptimeMinToHours" Operation="DivideBy" Value="60" NextOperation="And"/>
			<Condition FieldPosition="1" ConditionName="UptimeMinDaysToHours" Operation="Multiply" Value="24" NextOperation="And"/>
			<Condition FieldPosition="2" ConditionName="UptimeHoursAddMinHours" Operation="Add" Value="{Condition:UptimeMinToHours}" NextOperation="And"/>
			<Condition FieldPosition="{Condition:UptimeHoursAddMinHours}" ConditionName="TotalUptimeHours" Operation="Add" Value="{Condition:UptimeMinDaysToHours}"/>
		</Expression>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="LogTargetStatus" Wildcard="True" XPath="/Status/LogTargetStatus//EventsProcessed"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="{/Status/LogTargetStatus//EventsProcessed}" Operation="DivideBy" ConditionName="ProcessedEventsDivideByHour" Value="{Condition:TotalUptimeHours}" NextOperation="And"/>
			<Condition FieldPosition="{Condition:ProcessedEventsDivideByHour}" Operation="GreaterThan" Value="0.0" NextOperation="And"/>
			<Condition FieldPosition="{Condition:LogTargetCap}" Operation="DivideBy" ConditionName="HoursToHitCap" Value="{Condition:ProcessedEventsDivideByHour}" NextOperation="And"/>
			<Condition FieldPosition="{Condition:HoursToHitCap}" Operation="NotContain" Value="E" NextOperation="And"/>
			<Condition FieldPosition="{Condition:HoursToHitCap}" Operation="Subtract" ConditionName="HoursToCapMinusUptime" Value="{Condition:TotalUptimeHours}" NextOperation="And"/>
			<Condition FieldPosition="{Condition:HoursToCapMinusUptime}" Operation="DivideBy" ConditionName="DaysToCap" Value="24" NextOperation="And"/>
			<Condition FieldPosition="{Condition:DaysToCap}" Operation="LessThan" Value="366" NextOperation="And"/> <!-- allow up to a year notice -->
			<Condition FieldPosition="{Condition:DaysToCap}" Operation="Round" ConditionName="DaysToCapRnd" Value="0"/>
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="LogTargetStatus" Wildcard="True" XPath="/Status/LogTargetStatus//LogTarget"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="LogTargetName" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration" FormulaID="BadLogTarget">
		<Name>{Condition:SectionName} Log Target has 25% or more dropped events, {/Status/LogTargetStatus//EventsDropped} dropped events from target {/Status/LogTargetStatus//LogTarget}!  There were {/Status/LogTargetStatus//EventsProcessed} log events processed successfully.</Name>
		<Expression LogLevel="Warning" NextOperation="And">
			<Section Name="LogTargetStatus" Wildcard="True" XPath="/Status/LogTargetStatus//EventsDropped"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="{/Status/LogTargetStatus//EventsProcessed}" Operation="Add" ConditionName="ProcessedEvents" Value="1" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="DivideBy" ConditionName="DroppedEvents" Value="{Condition:ProcessedEvents}" NextOperation="And"/>
			<Condition FieldPosition="{Condition:DroppedEvents}" Operation="GreaterThan" Value=".25"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="LogTargetStatus" Wildcard="True" XPath="/Status/LogTargetStatus//LogTarget"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="LogTargetName" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- end log target tests -->
	
	<!-- Find log targets using event-detection -->
	
	<!-- through PMR 29525,442,000 encountered a customer who had high load from event-detection -->
	<Formula Categories="configuration;memory;cpuload" SortCondition="SuppressionPeriod" SortMethod="descending">
		<Name>{Condition:SectionName} Logging Target {Condition:ObjectName} is configured with 'event-detection' on with a suppression period of {Condition:SuppressionPeriod} seconds, longer suppression periods may cause high memory, may also cause high load.  This feature is set in the logging target as the radio button 'Identical Event Detection'.  This feature is deprecated in the product, see technote link for more details.</Name>
		<URL description="Logging Identical Event Suppression Tuning Considerations: ">https://www.ibm.com/support/pages/node/211991</URL>
		<URL description="Event Detection is Deprecated as of 10.0.0.0: ">https://www.ibm.com/support/pages/deprecated-and-removed-features-ibm-datapower-gateway-products</URL>
		<Expression LogLevel="Warning">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And">\b(logging target \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit)\b</Condition>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ConfigInfo" Operation="Contains" Value="event-detection" NextOperation="And">\b(logging target \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit)\b</Condition>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ConfigInfo" Operation="NotContain" Value="no event-detection" NextOperation="And">\b(logging target \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit)\b</Condition>
			<Condition FieldPosition="3" RegGroup="AllResult" ConditionName="SuppressionPeriod" Operation="GreaterThan" Value="0">logging target \"{Condition:ObjectName}\"\W+(\w+\W+)*?(suppression-period ([0-9]+)|exit)</Condition>
		</Expression>
	</Formula>
	
	<!-- end of log target check for event detection -->
	
	<Formula Categories="configuration;memory;cpuload">
		<Name>{Condition:SectionName} Logging Target {Condition:ObjectName} is configured with log target type syslog-ng which is deprecated.  Update log target to use syslog-tcp for better resource usage and stability.</Name>
		<DisplayMessage>{Condition:SectionName}||{Condition:ObjectName}</DisplayMessage>
		<Expression LogLevel="Warning">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="2" TableMapPosition="1" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And">\b(logging target \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit)\b</Condition>
			<Condition FieldPosition="1" TableMapPosition="0" RegGroup="All" ConditionName="ConfigFile" Operation="NotEqualTo" InValue="{Condition:SectionName}" Value="" NextOperation="And">([a-zA-Z-_.0-9]+)-config</Condition>
			<Condition FieldPosition="1" TableMapPosition="-2" RegGroup="All" ConditionName="ConfigInfo" Operation="Contains" Value="type syslog-ng">\b(logging target \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit)\b</Condition>
		</Expression>
	</Formula>
	
	<!-- Beginning of Tibco EMS Status Fault Checks -->
	
	<Formula Categories="configuration">
		<Name>{Condition:SectionName} Tibco EMS Server Reports Receive Faults</Name>
		<DisplayMessage>The Receive Faults field in the TibcoEMS Status Provider {/Status/TibcoEMSStatus//Server}, {/Status/TibcoEMSStatus//ReceivedFaults} faults found.</DisplayMessage>
			<Expression LogLevel="Warning">
			<Section Name="TibcoEMSStatus" Wildcard="True" XPath="/Status/TibcoEMSStatus//ReceivedFaults"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0"/>
			</Expression>
	</Formula>
	<Formula Categories="configuration">
		<Name>{Condition:SectionName} Tibco EMS Server Reports Send Faults ({/Status/TibcoEMSStatus//Server})</Name>
		<DisplayMessage>The Send Faults field in the TibcoEMS Status Provider {/Status/TibcoEMSStatus//Server}, {/Status/TibcoEMSStatus//SentFaults} faults found.</DisplayMessage>
			<Expression LogLevel="Warning">
			<Section Name="TibcoEMSStatus" Wildcard="True" XPath="/Status/TibcoEMSStatus//SentFaults"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0"/>
			</Expression>
	</Formula>
	
	<!-- End of Tibco EMS Status Fault Checks -->
	
	
	<!-- Beginning of FailureNotificationStatus2 Fault Checks -->
	<Formula OmitPrintingMetConditions="true" Categories="failure;memory">
		<Name>{Condition:SectionName} Failure Notification Event - Error Report (Error!) Generated on {/Status/FailureNotificationStatus2//Date} (Reason Code: {/Status/FailureNotificationStatus2//Reason})</Name>
		<DisplayMessage>There is a failure notification entry on {/Status/FailureNotificationStatus2//Date} which indicates an error report was generated due to reason: {/Status/FailureNotificationStatus2//Reason}.  File Location: {/Status/FailureNotificationStatus2//Location}</DisplayMessage>
		<Expression LogLevel="Error" NextOperation="And">
			<Section Name="FirmwareVersion2" SectionName="false" XPath="/Status/FirmwareVersion2//Version"/>
			<Section Name="FirmwareVersion" SectionName="false" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<!-- versions under 5.0 do not properly handle user-requested -->
			<Condition FieldPosition="2" Operation="GreaterThan" Value="4"/>
		</Expression>
		<Expression LogLevel="Error">
			<Section Name="FailureNotificationStatus2" XPath="/Status/FailureNotificationStatus2//Reason"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value="user-requested" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value="on-startup"/>
		</Expression>
		<Expression LogLevel="Error" ExpressionGroup="ResetReleases" NextOperation="And">
			<Section Name="FirmwareVersion3" SectionName="false" XPath="/Status/FirmwareVersion3//Version"/>
			<RegExp>([A-Z]{2,4})[0-9]{0,2}.(((2018|2019|20[2-9][0-9])\.\d+\.\d+)\.(\d+))([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="2018"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="10"/>
		</Expression>
		<Expression LogLevel="Error">
			<Section Name="FailureNotificationStatus2" XPath="/Status/FailureNotificationStatus2//Reason"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value="user-requested" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value="on-startup"/>
		</Expression>
	</Formula>
	
	<!-- report backtrace transaction ids below failure notification so user knows if its a reload or a watchdog -->
	<Formula Categories="failure" TopPositionResult="true" SortCondition="Timestamp" SortMethod="descending" SortOption="EEE MMM dd HH:mm:ss yyyy">
		<Name>[BACKTRACE] Recorded on {Condition:Timestamp}</Name>
		<DisplayMessage>Transaction ID: {Condition:TransID}, Seconds Up: {Condition:SecsUp}, SigNum: {Condition:SigNum}</DisplayMessage>
		<URL description="Backtraces Provide Transaction ID, in case of Watchdog Events, there may be multiple backtraces in a 30 second timeframe, these transaction IDs may not relate to the reload: ">https://www.ibm.com/support/pages/device-reloads-backtrace-header-includes-configuration-object-information</URL>
		<Expression LogLevel="Critical">
			<Section Name="Backtrace" Wildcard="True" NoDecodeCache="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And">0x[0-9a-fA-F]*\: ([a-zA-Z]{3} [a-zA-Z]{3}\s+\d+\s\d{2}:\d{2}:\d{2}\s\d{4})</Condition>
			<Condition FieldPosition="1" RegGroup="All" Conversion="hex2long" ConditionName="TransID" Operation="NotEqualTo" Value="0" NextOperation="And">xactid 0x([a-zA-Z-_.0-9]+)</Condition>
			<Condition FieldPosition="1" RegGroup="All" Conversion="hex2long" ConditionName="SecsUp" Operation="NotEqualTo" Value="" NextOperation="And">SecsUp 0x([a-zA-Z-_.0-9]+),</Condition>
			<Condition FieldPosition="1" RegGroup="All" Conversion="hex2long" ConditionName="SigNum" Operation="NotEqualTo" Value="">signum 0x([a-zA-Z-_.0-9]+),</Condition>
		</Expression>
	</Formula>
	
	<Formula Categories="failure" TopPositionResult="true" SortCondition="Timestamp" SortMethod="descending">
		<Name>[BACKTRACE] Recorded on {Condition:Timestamp}</Name>
		<DisplayMessage>Transaction ID: {Condition:TransID}, Seconds Up: {Condition:SecsUp}, SigNum: {Condition:SigNum}</DisplayMessage>
		<URL description="Backtraces Provide Transaction ID, in case of Watchdog Events, there may be multiple backtraces in a 30 second timeframe, these transaction IDs may not relate to the reload: ">https://www.ibm.com/support/pages/device-reloads-backtrace-header-includes-configuration-object-information</URL>
		<Expression LogLevel="Critical">
			<Section Name="Backtrace" Wildcard="True" NoDecodeCache="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And">Thread 0x[0-9a-fA-F]*\: (\d{4}\-\d{2}\-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z)</Condition>
			<Condition FieldPosition="1" RegGroup="All" Conversion="hex2long" ConditionName="TransID" Operation="NotEqualTo" Value="0" NextOperation="And">xactid 0x([a-zA-Z-_.0-9]+)</Condition>
			<Condition FieldPosition="1" RegGroup="All" Conversion="hex2long" ConditionName="SecsUp" Operation="NotEqualTo" Value="" NextOperation="And">SecsUp 0x([a-zA-Z-_.0-9]+),</Condition>
			<Condition FieldPosition="1" RegGroup="All" Conversion="hex2long" ConditionName="SigNum" Operation="NotEqualTo" Value="">signum 0x([a-zA-Z-_.0-9]+),</Condition>
		</Expression>
	</Formula>
	
	<Formula OmitPrintingMetConditions="true" Categories="failure">
		<Name>{Condition:SectionName} Failure Notification Event - Error Report Generated on {/Status/FailureNotificationStatus2//Date} (Reason Code: {/Status/FailureNotificationStatus2//Reason})</Name>
		<DisplayMessage>There is a failure notification entry on {/Status/FailureNotificationStatus2//Date} which indicates an error report was generated due to reason: {/Status/FailureNotificationStatus2//Reason}.  File Location: {/Status/FailureNotificationStatus2//Location}</DisplayMessage>
		<Expression LogLevel="Warning" NextOperation="And">
			<Section Name="FirmwareVersion2" SectionName="false" XPath="/Status/FirmwareVersion2//Version"/>
			<Section Name="FirmwareVersion" SectionName="false" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="GreaterThan" Value="4"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="FailureNotificationStatus2" XPath="/Status/FailureNotificationStatus2//Reason"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="user-requested"/>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="on-startup"/>
		</Expression>
		<Expression LogLevel="Warning" ExpressionGroup="ResetReleases" NextOperation="And">
			<Section Name="FirmwareVersion3" SectionName="false" XPath="/Status/FirmwareVersion3//Version"/>
			<RegExp>([A-Z]{2,4})[0-9]{0,2}.(((2018|2019|20[2-9][0-9])\.\d+\.\d+)\.(\d+))([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="2018"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="10"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="FailureNotificationStatus2" XPath="/Status/FailureNotificationStatus2//Reason"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="user-requested"/>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="on-startup"/>
		</Expression>
	</Formula>
	
	<Formula OmitPrintingMetConditions="true" Categories="failure">
		<Name>{Condition:SectionName} Failure Notification Event - Error Report (Warning) Generated on {/Status/FailureNotificationStatus2//Date} (Reason Code: {/Status/FailureNotificationStatus2//Reason})</Name>
		<DisplayMessage>There is a failure notification entry on {/Status/FailureNotificationStatus2//Date} - the error report may have been user-requested or it could be related to an unexpected reload (check the URL below for a known issue with FFDC reason code issues).  This issue was resolved in 5.0.0.0.</DisplayMessage>
		<Expression LogLevel="Warning" NextOperation="And">
			<Section Name="FirmwareVersion" SectionName="false" XPath="/Status/FirmwareVersion//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<!-- versions under 5.0 do not properly handle user-requested -->
			<Condition FieldPosition="2" Operation="EqualsTo" Value="4"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="FailureNotificationStatus2" XPath="/Status/FailureNotificationStatus2//Reason"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="user-requested"/>
		</Expression>
	</Formula>
	
	<Formula OmitPrintingMetConditions="true" Categories="failure;configuration">
		<Name>{/Status/FailureNotificationStatus2//Date} Failed to generate error report to location {/Status/FailureNotificationStatus2//Location}.</Name>
		<URL FormulaIDMatch="APARCHECK:IT22300" description="IT22300 (Fixed in 7.1.0.21, 7.2.0.18, 7.5.0.12, 7.5.1.11, 7.5.2.11 and 7.6.0.4): INTENSIVE USE OF LOGGING MAY IMPOSE IMPACT TO OVERALL PERFORMANCE: L2 note, this has been seen in situations where there is available space to error report target, but it fails to generate successfully: ">https://www.ibm.com/support/docview.wss?uid=swg1IT22300</URL>
		<URL description="Configuring Failure Notification: ">https://www.ibm.com/docs/en/datapower-gateway/10.6.0?topic=reports-configuring-failure-notification</URL>
		<Expression LogLevel="Error">
			<Section Name="FailureNotificationStatus2" XPath="/Status/FailureNotificationStatus2//UploadStatus"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="failure"/>
		</Expression>
	</Formula>
	<!-- End of FailureNotificationStatus2 Checks -->
	
	
	<!-- SLMSummary Checks -->
	<!-- slm errors are when a transaction fails multistep (or such as a 500 internal backend) -->
	<Formula Categories="configuration">
		<Name>{Condition:SectionName} SLMSummaryStatus Reports Error Count (Failed Transaction) ({/Status/SLMSummaryStatus//SLMPolicy})</Name>
		<DisplayMessage>The SLM policy {/Status/SLMSummaryStatus//SLMPolicy} (SLMID: {/Status/SLMSummaryStatus//SLMId}) reports {/Status/SLMSummaryStatus//TotalErrors} total errors against {/Status/SLMSummaryStatus//TotalMessages} total successful messages.</DisplayMessage>
		<Expression LogLevel="Warning">
			<Section Name="SLMSummaryStatus" Wildcard="True" XPath="/Status/SLMSummaryStatus//TotalErrors"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>
	
	<!-- latency in this variable occurs when the response time is high, we can get the minimum, average and maximum response times -->
	<Formula Categories="configuration;network" SortCondition="TotalMaximum" SortMethod="descending">
		<Name>{Condition:SectionName} SLMSummaryStatus Reports Latency ({/Status/SLMSummaryStatus//SLMPolicy})</Name>
		<DisplayMessage>The SLM policy {/Status/SLMSummaryStatus//SLMPolicy} (SLMID: {/Status/SLMSummaryStatus//SLMId}) reports &lt;b&gt;{/Status/SLMSummaryStatus//TotalMaximum}ms&lt;/b&gt; maximum response time against &lt;b&gt;{/Status/SLMSummaryStatus//TotalAverage}ms&lt;/b&gt; average response time.</DisplayMessage>
		<Expression LogLevel="Warning">
			<Section Name="SLMSummaryStatus" Wildcard="True" XPath="/Status/SLMSummaryStatus//TotalMaximum"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="TotalMaximum" Operation="GreaterThan" Value="999"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration">
		<Name>{Condition:SectionName} SLMSummaryStatus Reports Throttle Count ({/Status/SLMSummaryStatus//SLMPolicy})</Name>
		<DisplayMessage>The SLM policy {/Status/SLMSummaryStatus//SLMPolicy} (SLMID: {/Status/SLMSummaryStatus//SLMId}) reports {/Status/SLMSummaryStatus//TotalThrottled} total throttled messages against {/Status/SLMSummaryStatus//TotalMessages} total successful messages.</DisplayMessage>
		<Expression LogLevel="Warning">
			<Section Name="SLMSummaryStatus" Wildcard="True" XPath="/Status/SLMSummaryStatus//TotalThrottled"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>
	<!-- End of SLMSummaryStatus Checks -->
	
	<!-- Probe checks -->
	<Formula Categories="failure;general;cpuload"  SortCondition="Timestamp" SortMethod="descending">
		<Name>[Probe] {Condition:Timestamp} Logs report there is a probe running and hitting max concurrency, this means a service with the probe is receiving load, thus the probe should not be enabled, this log message does not describe the service at fault.  Transaction ID: {Condition:TransactionID}.</Name>
		<URL description="DataPower SOA Appliance Probe - Setting the limit for concurrent transactions (also notes debugging only not production): ">https://www.ibm.com/support/pages/node/386195</URL>
		<URL description="Webcast Replay: Tips and Tricks for Use of the DataPower Multistep Probe Debugging Tool: ">https://www.ibm.com/support/pages/node/614155</URL>
		<Expression LogLevel="Critical">
			<Section Name="log" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>Max concurrent transactions exceeded for Probe. Transaction is not captured.</IndexSearch>
			<RegExp>1,([0-9TZ.]{16,20}),([a-zA-Z0-9_-]+),([a-zA-Z0-9.\_-]+),([a-zA-Z0-9.\_-]+),,,([0-9]+),([0-9.]+),([0-9a-fx]+),,,"Max concurrent transactions exceeded for Probe. Transaction is not captured."</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="5" RegGroup="All" ConditionName="TransactionID" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula TopPositionResult="true" Categories="general;failure">
		<Name>{Condition:SectionName} &lt;font color='red'&gt;Device is currently in failsafe mode&lt;/font&gt;!  Mode: {/Status//DomainStatus[Domain = 'default']/FailsafeMode}</Name>
		<URL description="DataPower Failsafe Mode or Unresponsive to Management (WebGUI and SSH): ">https://www.ibm.com/support/pages/node/712113</URL>
		<Expression LogLevel="Critical">
			<Section Name="DomainStatus" XPath="/Status//DomainStatus[Domain = 'default']/FailsafeMode"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="management"/>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="console"/>
		</Expression>
	</Formula> 
	
	<Formula Categories="configuration;cpuload">
		<Name>Probe Enabled in domain {/Status//DomainStatus/Domain} (Warning!).</Name>
		<DisplayMessage>Probe is currently enabled in the domain {/Status//DomainStatus/Domain}.</DisplayMessage>
		<URL description="DataPower SOA Appliance Probe - Setting the limit for concurrent transactions (also notes debugging only not production): ">https://www.ibm.com/support/pages/node/386195</URL>
		<URL description="Webcast Replay: Tips and Tricks for Use of the DataPower Multistep Probe Debugging Tool: ">https://www.ibm.com/support/pages/node/614155</URL>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="DomainStatus" XPath="/Status//DomainStatus/ProbeEnabled"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value="on"/>
		</Expression>
	</Formula> 
	
	
	<Formula CollapseResult="true" Categories="configuration;cpuload" SortCondition="Timestamp" SortMethod="descending">
		<Name>{Condition:Timestamp} Probe was enabled on the service {Condition:ServiceName}, Domain: {Condition:Domain}, Service Type: {Condition:ServiceType}</Name>
		<DisplayMessage>Logs note that the probe was enabled at {Condition:Timestamp} on the service {Condition:ServiceName} in the domain {Condition:Domain}, this service is of the type {Condition:ServiceType}.</DisplayMessage>
		<URL description="DataPower SOA Appliance Probe - Setting the limit for concurrent transactions (also notes debugging only not production): ">https://www.ibm.com/support/pages/node/386195</URL>
		<URL description="Webcast Replay: Tips and Tricks for Use of the DataPower Multistep Probe Debugging Tool: ">https://www.ibm.com/support/pages/node/614155</URL>
		<Expression LogLevel="Warning">
			<Section Name="AuditLog" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>: Multistep Probe enabled</IndexSearch>
			<RegExp>\b([0-9TZ.]{16,20}) [a-zA-Z0-9_\-\[\] ]* ([a-zA-Z]*)\(([a-zA-Z0-9.\- ]*)\): Multistep Probe enabled\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="Domain" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ServiceType" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" Categories="configuration;cpuload" SortCondition="Timestamp" SortMethod="descending">
		<Name>{Condition:Timestamp} Probe was enabled on the service {Condition:ServiceName}, Domain: {Condition:Domain}, Service Type: {Condition:ServiceType}</Name>
		<DisplayMessage>Logs note that the probe was enabled at {Condition:Timestamp} on the service {Condition:ServiceName} in the domain {Condition:Domain}, this service is of the type {Condition:ServiceType}.</DisplayMessage>
		<URL description="DataPower SOA Appliance Probe - Setting the limit for concurrent transactions (also notes debugging only not production): ">https://www.ibm.com/support/pages/node/386195</URL>
		<URL description="Webcast Replay: Tips and Tricks for Use of the DataPower Multistep Probe Debugging Tool: ">https://www.ibm.com/support/pages/node/614155</URL>
		<Expression LogLevel="Warning">
			<Section Name="AuditLog" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch> - Multistep Probe enabled</IndexSearch>
			<RegExp>\b([0-9TZ.]{16,20}) [a-zA-Z0-9_.\-\[\] ]* \([a-zA-Z0-9]*:([a-zA-Z0-9\-.]*):\*:\*\): ([a-zA-Z0-9\-.]*) \'([a-zA-Z0-9\-.]*)\' - Multistep Probe enabled\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="Domain" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ServiceType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="ServiceName" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" Categories="configuration;cpuload" SortCondition="Timestamp" SortMethod="descending">
		<Name>{Condition:SectionName} {Condition:Timestamp} Probe was enabled on the service {Condition:ServiceName}, Service Type: {Condition:ServiceType}, transaction id {Condition:TransactionID}</Name>
		<DisplayMessage>Logs note that the probe was enabled during a transaction {Condition:Timestamp} on the service {Condition:ServiceName}, this service is of the type {Condition:ServiceType} and had a transaction id of {Condition:TransactionID}.</DisplayMessage>
		<URL description="DataPower SOA Appliance Probe - Setting the limit for concurrent transactions (also notes debugging only not production): ">https://www.ibm.com/support/pages/node/386195</URL>
		<URL description="Webcast Replay: Tips and Tricks for Use of the DataPower Multistep Probe Debugging Tool: ">https://www.ibm.com/support/pages/node/614155</URL>
		<Expression LogLevel="Warning">
			<Section Name="-log" Wildcard="True" XPath="/Root/text()" ReadNextSection="True"/>
			<Section Name="DefaultLogBeforeReload" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".log" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>: Multistep Probe enabled</IndexSearch>
			<RegExp>\b([0-9TZ.]{16,20}) [a-zA-Z0-9_.\-\[\] ]* ([a-zA-Z]*)\(([a-zA-Z0-9.\-_ ]*)\): tid\(([0-9]*)\)[a-zA-Z0-9_.\-\[\]. ]*: Multistep Probe enabled\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ServiceType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ServiceName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="TransactionID" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" Categories="configuration;cpuload" SortCondition="Timestamp" SortMethod="descending">
		<Name>{Condition:SectionName} {Condition:Timestamp} Probe was enabled on the service {Condition:ServiceName}, Service Type: {Condition:ServiceType}, transaction id {Condition:TransactionID}</Name>
		<DisplayMessage>Logs note that the probe was enabled during a transaction {Condition:Timestamp} on the service {Condition:ServiceName}, this service is of the type {Condition:ServiceType} and had a transaction id of {Condition:TransactionID}.</DisplayMessage>
		<URL description="DataPower SOA Appliance Probe - Setting the limit for concurrent transactions (also notes debugging only not production): ">https://www.ibm.com/support/pages/node/386195</URL>
		<URL description="Webcast Replay: Tips and Tricks for Use of the DataPower Multistep Probe Debugging Tool: ">https://www.ibm.com/support/pages/node/614155</URL>
		<Expression LogLevel="Warning">
			<Section Name="-log" Wildcard="True" XPath="/Root/text()" ReadNextSection="True"/>
			<Section Name="DefaultLogBeforeReload" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".log" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>[request]: Multistep Probe enabled</IndexSearch>
			<RegExp>\b([0-9TZ.]{16,20}) [a-zA-Z0-9_.\-\[\] ]* ([a-zA-Z]*)\(([a-zA-Z0-9.\- ]*)\): tid\(([0-9]+)\)\[request\]: Multistep Probe enabled\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ServiceType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ServiceName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="TransactionID" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- end probe checks -->

	<!-- port conflict checks-->
	<Formula Categories="configuration" SortCondition="Timestamp" SortMethod="descending">
		<Name>&lt;font color='red'&gt;{Condition:SectionName}&lt;/font&gt; {Condition:Timestamp} Service &lt;font color='red'&gt;{Condition:ServiceName}&lt;/font&gt;, Service Type: {Condition:ServiceType}: conflicting with registration of IP:port &lt;font color='red'&gt;{Condition:IPHostConflict}&lt;/font&gt;, it is owned by &lt;font color='red'&gt;{Condition:OwnedByServiceName}&lt;/font&gt; in domain &lt;font color='red'&gt;{Condition:OwnedByDomain}&lt;/font&gt;.</Name>
		<Expression LogLevel="Error">
			<Section Name="-log" Wildcard="True" XPath="/Root/text()" ReadNextSection="True"/>
			<Section Name="DefaultLogBeforeReload" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".log" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>: Request to activate gateway on</IndexSearch>
			<RegExp>\b([0-9TZ.]{16,20}) \[[0-9a-ex]+\]\[[a-zA-Z0-9_.-]+\]\[[a-zA-Z0-9_.-]+\] ([a-zA-Z0-9_.-]+)\(([a-zA-Z0-9_.-]+)\): tid\([0-9]+\): Request to activate gateway on ([a-zA-Z0-9_.:]+) failed. The conflicting registration is owned by ([a-zA-Z0-9_.-]+) in domain ([a-zA-Z0-9_.-]+)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ServiceType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ServiceName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="IPHostConflict" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="5" RegGroup="All" ConditionName="OwnedByServiceName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="6" RegGroup="All" ConditionName="OwnedByDomain" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration" SortCondition="Timestamp" SortMethod="descending">
		<Name>&lt;font color='red'&gt;{Condition:CurrentDomain}&lt;/font&gt; {Condition:Timestamp} Service &lt;font color='red'&gt;{Condition:ServiceName}&lt;/font&gt;, Service Type: {Condition:ServiceType}: conflicting with registration of IP:port &lt;font color='red'&gt;{Condition:IPHostConflict}&lt;/font&gt;, it is owned by &lt;font color='red'&gt;{Condition:OwnedByServiceName}&lt;/font&gt; in domain &lt;font color='red'&gt;{Condition:OwnedByDomain}&lt;/font&gt;.</Name>
		<Expression LogLevel="Error">
			<Section Name="default-log" Wildcard="True" XPath="/Root/text()" ReadNextSection="True"/>
			<Section Name="DefaultLogBeforeReload" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".log" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>: Request to activate gateway on</IndexSearch>
			<RegExp>\b([0-9TZ.]{16,20}) \[([a-zA-Z0-9_.-]+)\]\[[0-9a-ex]+\]\[[a-zA-Z0-9_.-]+\]\[[a-zA-Z0-9_.-]+\] ([a-zA-Z0-9_.-]+)\(([a-zA-Z0-9_.-]+)\): tid\([0-9]+\): Request to activate gateway on ([a-zA-Z0-9_.:]+) failed. The conflicting registration is owned by ([a-zA-Z0-9_.-]+) in domain ([a-zA-Z0-9_.-]+)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="CurrentDomain" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ServiceType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="ServiceName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="5" RegGroup="All" ConditionName="IPHostConflict" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="6" RegGroup="All" ConditionName="OwnedByServiceName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="7" RegGroup="All" ConditionName="OwnedByDomain" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- port conflict checks-->
	
	<Formula Categories="configuration;failure;cpuload;memory" SortCondition="CompileTime" SortMethod="descending">
		<Name>{Condition:SectionName} StylesheetStatusSimpleIndex Reports XML Manager {/Status//StylesheetStatusSimpleIndex/XMLManager/text()} has file {/Status//StylesheetStatusSimpleIndex/URL/text()} compile time {/Status//StylesheetStatusSimpleIndex/CompileSpeed} milliseconds and compiled on {/Status//StylesheetStatusSimpleIndex/LastRefresh}</Name>
		<URL description="WebSphere DataPower SOA Appliance performance tuning: ">https://www.ibm.com/developerworks/library/ws-dpperformance/</URL>
		<Expression LogLevel="Warning">
			<Section Name="StylesheetStatusSimpleIndex" Wildcard="True" XPath="/Status//StylesheetStatusSimpleIndex/CompileSpeed"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="CompileTime" Operation="GreaterThan" Value="999" NextOperation="And"/>
			<Condition FieldPosition="{/Status//StylesheetStatusSimpleIndex/URL}" ConditionName="URL" Operation="NotContain" Value="store:///dp/aaapolicy.xsl"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="StylesheetStatusSimpleIndex" Wildcard="True" XPath="/Status//StylesheetStatusSimpleIndex/CompileSpeed"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="CompileTime" Operation="GreaterThan" Value="5000" NextOperation="And"/>
			<Condition FieldPosition="{/Status//StylesheetStatusSimpleIndex/URL}" ConditionName="URL" Operation="Contains" Value="store:///dp/aaapolicy.xsl"/>
		</Expression>
	</Formula>
	
	<!-- Begin WSRR/WSDL Subscription Checks -->
	<Formula Categories="configuration">
		<Name>{Condition:SectionName} WSRRSubscriptionStatus Reports Subscription {/Status//WSRRSubscriptionStatus/Subscription} is in {/Status//WSRRSubscriptionStatus/Status} State</Name>
		<DisplayMessage>WSRRSubscriptionStatus reports the Subscription {/Status//WSRRSubscriptionStatus/Subscription} is in {/Status//WSRRSubscriptionStatus/Status} state.</DisplayMessage>
			<Expression LogLevel="Warning">
			<Section Name="WSRRSubscriptionStatus" Wildcard="True" XPath="/Status//WSRRSubscriptionStatus/Status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value="Okay"/>
			</Expression>
	</Formula>
	
	<!-- This will handle WSDL's that have a log message available to help the user determine the problem -->
	<Formula Categories="configuration">
		<Name>{Condition:SectionName} WSWSDLStatusSimpleIndex Reports WSDL {/Status//WSWSDLStatusSimpleIndex/WSDLSourceLocation} in the WSP {/Status//WSWSDLStatusSimpleIndex/WSGateway} is in {/Status//WSWSDLStatusSimpleIndex/Status} State</Name>
		<DisplayMessage>WSWSDLStatusSimpleIndex Reason Message: {/Status//WSWSDLStatusSimpleIndex/Log}</DisplayMessage>
			<Expression LogLevel="Warning" NextOperation="And">
			<Section Name="WSWSDLStatusSimpleIndex" Wildcard="True" XPath="/Status//WSWSDLStatusSimpleIndex/Status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value="Okay"/>
			</Expression>
			<Expression LogLevel="Warning">
			<Section Name="WSWSDLStatusSimpleIndex" Wildcard="True" XPath="/Status//WSWSDLStatusSimpleIndex/Log"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value=""/>
			</Expression>
	</Formula>
	
	<!-- This will handle WSDL's that have no log message recorded -->
	<Formula Categories="configuration">
		<Name>{Condition:SectionName} WSWSDLStatusSimpleIndex Reports WSDL {/Status//WSWSDLStatusSimpleIndex/WSDLSourceLocation} in the WSP {/Status//WSWSDLStatusSimpleIndex/WSGateway} is in {/Status//WSWSDLStatusSimpleIndex/Status} State</Name>
		<DisplayMessage>WSWSDLStatusSimpleIndex has no reason message recorded.</DisplayMessage>
			<Expression LogLevel="Warning" NextOperation="And">
			<Section Name="WSWSDLStatusSimpleIndex" Wildcard="True" XPath="/Status//WSWSDLStatusSimpleIndex/Status"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value="Okay"/>
			</Expression>
			<Expression LogLevel="Warning">
			<Section Name="WSWSDLStatusSimpleIndex" Wildcard="True" XPath="/Status//WSWSDLStatusSimpleIndex/Log"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" Value=""/>
			</Expression>
	</Formula>
	<!-- End WSRR/WSDL Subscription Checks -->
	
	<Formula CollapseResult="true" Categories="configuration;cpuload" FormulaID="BadDocumentCache">
		<Name>&lt;font color='#CC3300'&gt;{Condition:SectionName}&lt;/font&gt; There is a document cache, &lt;font color='#CC3300'&gt;{Condition:ObjectName}&lt;/font&gt; configured allowing &lt;font color='#CC3300'&gt;{Condition:BytesPerDocument} bytes&lt;/font&gt; per document.  Caches set to 0 bytes will not cache, others may get full before document count is reached.</Name>
		<DisplayMessage>Max Document Count: &lt;b&gt;{Condition:MaxDocsCount}&lt;/b&gt;, Max Cache Size (Bytes): &lt;b&gt;{Condition:MaxSizeBytes}&lt;/b&gt;</DisplayMessage>
		<URL description="IBM Knowledge Center - Defining document cache policies: ">https://www.ibm.com/docs/en/datapower-gateway/10.6.0?topic=manager-defining-document-cache-policies</URL>
		<Expression LogLevel="Warning">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>documentcache \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(maxdocs \"([0-9]+)\"|exit)</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="MaxDocsCount" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="MaxSizeBytes" Operation="GreaterThan" Value="0" NextOperation="And">documentcache \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(size \"([0-9]+)\"|exit)</Condition>
			<Condition FieldPosition="{Condition:MaxSizeBytes}" RegGroup="All" ConditionName="BytesPerDocument" Operation="DivideBy" Value="{Condition:MaxDocsCount}" NextOperation="And"/>
			<Condition FieldPosition="{Condition:BytesPerDocument}" RegGroup="All" Operation="LessThan" Value="1000"/>
		</Expression>
	</Formula>
	
	<!-- MQ configuration search for cache-timeout (when not 0) less than heartbeat (also when not 0) -->	
	<Formula Categories="configuration;cpuload" FormulaID="MQHeartbeatCacheTimeout">
		<Name>&lt;font color='#CC3300'&gt;{Condition:SectionName}&lt;/font&gt; There is an MQ-QM Object &lt;font color='#CC3300'&gt;{Condition:ObjectName}&lt;/font&gt; configured with a cache-timeout {Condition:CacheTimeout} less than the heartbeat {Condition:Heartbeat}.  May cause MQ 2009/2059 connection issues with MQ: "Cache-Timeout: Specify a value that is greater than the negotiated heartbeat interval but less than the keep alive interval."</Name>
		<URL description="Best practices for integrating IBM WebSphere DataPower SOA Appliances with WebSphere MQ: ">https://www.ibm.com/support/pages/best-practices-integrating-ibm-websphere-datapower-soa-appliances-websphere-mq</URL>
		<Expression LogLevel="Critical">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And">idg-mq-qm \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(cache-timeout ([1-9]+)|exit)</Condition>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="CacheTimeout" Operation="GreaterThan" Value="0" NextOperation="And">idg-mq-qm \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(cache-timeout ([0-9]+)|exit)</Condition>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="Heartbeat" Operation="GreaterThan" Value="0" NextOperation="And">idg-mq-qm \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(heartbeat ([0-9]+)|exit)</Condition>
			<Condition FieldPosition="0" InValue="{Condition:CacheTimeout}" Operation="LessThan" Value="{Condition:Heartbeat}"/>
		</Expression>
	</Formula>
	
	<!-- MQ configuration search for cache-timeout, v2018 defaults to non-0 value, but upgrades can integrate old values and cache-timeout of 0 is still supported -->
	<Formula Categories="configuration;cpuload" FormulaID="MQCacheTimeout">
		<Name>&lt;font color='#CC3300'&gt;{Condition:SectionName}&lt;/font&gt; There is an MQ-QM Object &lt;font color='#CC3300'&gt;{Condition:ObjectName}&lt;/font&gt; configured without a cache-timeout</Name>
		<URL description="WebSphere DataPower SOA Appliance MQ Queue Manager Object's connections are not closed as expected (cache-timeout default value is unlimited and connections may not be closed even if terminated on the MQ end): ">https://www.ibm.com/support/pages/node/623131</URL>
		<Expression LogLevel="Critical">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>(idg-)?mq-qm \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(cache-timeout ([1-9]+)|exit)</RegExp>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="CacheTimeout" Operation="EqualsTo" Value="exit"/> <!-- if default of 0 -->
		</Expression>
	</Formula>
	<!-- End of MQ configuration search -->
	
	<!-- MQ Config search for retry interval of 0 -->
	<Formula Categories="configuration;cpuload" FormulaID="MQLongRetryNotSet">
		<Name>&lt;font color='#CC3300'&gt;{Condition:SectionName}&lt;/font&gt; There is an MQ-QM Object &lt;font color='#CC3300'&gt;{Condition:ObjectName}&lt;/font&gt; configured with the default retry attempts of 0.</Name>
		<DisplayMessage>{Condition:ObjectName} is configured without a retry attempt value, the default value is 0 and negates long retry intervals.</DisplayMessage>
		<URL description="WebSphere DataPower spikes with high CPU when WebSphere MQ connection is unavailable: ">https://www.ibm.com/support/pages/node/407279</URL>
		<Expression LogLevel="Critical" FormulaIDMatch="V760FirmwareCheckOrLower">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>(idg-)?mq-qm \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(retry-attempts ([1-9]+)|exit)</RegExp>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="ConfigInfo" Operation="EqualsTo" Value="exit"/>
		</Expression>
		<!-- v2018 supports retry-attempts of 0, but the default is 6, versus prior to v2018, the default was 0. -->
		<Expression LogLevel="Critical" FormulaIDMatch="V2018FirmwareCheckOrGreater">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>(idg-)?mq-qm \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(retry-attempts 0|exit)</RegExp>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="ConfigInfo" Operation="NotEqualTo" Value="exit"/>
		</Expression>
	</Formula>
	
	<!-- end MQ Config search for retry interval -->
	
	<!-- Backtrace search for objects related to reloads -->
	<Formula Categories="failure" TopPositionResult="true">
		<Name>Backtrace on {Condition:Timestamp} Contained Configuration Object Information: Component={Condition:Component}, Domain={Condition:Domain}, Config={Condition:Config}</Name>
		<DisplayMessage>Component={Condition:Component}, Domain={Condition:Domain}, Config={Condition:Config} should be reviewed further as it could be related to a reload of the appliance.</DisplayMessage>
		<URL description="Backtrace generated during reload notes domain and configuration object: ">https://www.ibm.com/support/pages/node/498213</URL>
		<Expression LogLevel="Critical">
			<Section Name="Backtrace" Wildcard="True" NoDecodeCache="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And">(Mon|Tue|Wed|Thu|Fri|Sat|Sun)(\s)([a-zA-Z].*)(\s+(.+))</Condition>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Component" Operation="NotEqualTo" Value="" NextOperation="And">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="Domain" Operation="NotEqualTo" Value="" NextOperation="And">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="Config" Operation="NotEqualTo" Value="">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
		</Expression>
	</Formula>
	
	<!-- 6.0 backtrace search -->
	<Formula Categories="failure" TopPositionResult="true">
		<Name>Backtrace on {Condition:Timestamp} Contained Configuration Object Information: Component={Condition:Component}, Domain={Condition:Domain}, Config={Condition:Config}</Name>
		<DisplayMessage>Component={Condition:Component}, Domain={Condition:Domain}, Config={Condition:Config} should be reviewed further as it could be related to a reload of the appliance.</DisplayMessage>
		<URL description="Backtrace generated during reload notes domain and configuration object: ">https://www.ibm.com/support/pages/node/498213</URL>
		<Expression LogLevel="Critical">
			<Section Name="Backtrace" Wildcard="True" NoDecodeCache="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And">Thread 0x[0-9a-fA-F]*\: (\d{4}\-\d{2}\-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z)</Condition>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Component" Operation="NotEqualTo" Value="" NextOperation="And">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="Domain" Operation="NotEqualTo" Value="" NextOperation="And">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="Config" Operation="NotEqualTo" Value="">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;failure" TopPositionResult="true">
		<Name>{Condition:SectionName} {Condition:StartTime} Config Sequence Status reports {Condition:SequenceName} contains {Condition:ErrorCount} errors and {Condition:WarningCount} warnings.  Check {Condition:ResultLogName} in domain {Condition:DomainName} File Management for more.</Name>
		<Expression LogLevel="Critical">
			<Section Name="ConfigSequenceStatus" XPath="/Status/ConfigSequenceStatus/ErrorCount"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="2" Operation="GreaterThan" ConditionName="ErrorCount" Value="0" NextOperation="And"/>
			<Condition FieldPosition="1" InValue="{Condition:SectionName}" ConditionName="DomainName" Operation="NotEqualTo" Value="" NextOperation="And">([a-zA-Z-_.0-9]+)-ConfigSequenceStatus</Condition>	
			<Condition FieldPosition="{/Status/ConfigSequenceStatus/WarningCount}" ConditionName="WarningCount" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="{/Status/ConfigSequenceStatus/SequenceName}" ConditionName="SequenceName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/ConfigSequenceStatus/StartTime}" ConditionName="StartTime" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/ConfigSequenceStatus/ConfigFileName}" ConditionName="ConfigFileName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/ConfigSequenceStatus/ResultLogName}" ConditionName="ResultLogName" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="ConfigSequenceStatus" XPath="/Status/ConfigSequenceStatus/WarningCount"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="2" ConditionName="WarningCount" Operation="GreaterThan" Value="0" NextOperation="And"/>
			<Condition FieldPosition="1" InValue="{Condition:SectionName}" ConditionName="DomainName" Operation="NotEqualTo" Value="" NextOperation="And">([a-zA-Z-_.0-9]+)-ConfigSequenceStatus</Condition>	
			<Condition FieldPosition="{/Status/ConfigSequenceStatus/ErrorCount}" ConditionName="ErrorCount" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="{/Status/ConfigSequenceStatus/SequenceName}" ConditionName="SequenceName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/ConfigSequenceStatus/StartTime}" ConditionName="StartTime" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/ConfigSequenceStatus/ConfigFileName}" ConditionName="ConfigFileName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/ConfigSequenceStatus/ResultLogName}" ConditionName="ResultLogName" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>

	
	<Formula Categories="failure;configuration;cpuload;memory">
		<Name>{Condition:SectionName} on {Condition:Timestamp} Contained Action: {Condition:Data}.  This could relate to calling dp:get-status being called via XSLT, XML-Mgmt or some other management method. Lack of providing a status provider, eg. var://service/system/status pulls 180+ status providers, versus var://service/system/status/SomeStatusProvider pulls just that specific status provider.  Polling all status providers on a transaction basis can cause high load, memory and potentially reloads.</Name>
		<URL description="KnowledgeCenter var://service/system/status variable syntax: ">https://www.ibm.com/docs/en/datapower-gateway/10.6.0?topic=variables-varservicesystemstatus</URL>
		<Expression LogLevel="Critical">
			<Section Name="Backtrace" Wildcard="True" NoDecodeCache="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And">Thread 0x[0-9a-fA-F]*\: (\d{4}\-\d{2}\-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z)</Condition>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Data" Operation="NotEqualTo" Value="">\b(Action=[0-9]+\,\sActionName=system\-policy\-domain-supported\-status\-rule_[0-9]+)\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
		</Expression>
	</Formula>
	<!-- End of backtrace search -->
	
	<!-- search for use of shutdown reboot -->
	<Formula Categories="general" SortCondition="Timestamp" SortMethod="descending">
		<Name>{Condition:Timestamp} Customer rebooted, halted or issued a secure-restore with the command: {Condition:Command}</Name>
		<DisplayMessage>{Condition:SectionName} {Condition:Timestamp}||{Condition:LogMsg}</DisplayMessage>
		<Expression LogLevel="Warning">
			<Section Name="AuditLog" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\b([0-9TZ.]{16,20}).*(shutdown (-f){0,}\s?(reload|reboot|halt)\s?\d{0,5}|Attempting \(secure-restore .*)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" TableMapPosition="-2" RegGroup="All" ConditionName="Command" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" RegGroup="All" ConditionName="LogMsg" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- End of shutdown reboot search -->
	
	<!-- search for use of restart domain -->
	<Formula Categories="general" SortCondition="Timestamp" SortMethod="descending">
		<Name>{Condition:SectionName} {Condition:Timestamp} Restart domain issued inside domain {Condition:Domain}, if default domain, command may include domain name.</Name>
		<DisplayMessage>Customer restarted a domain with the command: "{Condition:Command}", this was issued inside domain {Condition:Domain} at {Condition:Timestamp}.</DisplayMessage>
		<Expression LogLevel="Warning">
			<Section Name="AuditLog" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>restart domain</IndexSearch>
			<RegExp>\b([0-9TZ.]{16,20}).* \([a-zA-Z-_.0-9]+:([a-zA-Z-_.0-9]+):[a-zA-Z-_.0-9]+:[a-zA-Z-_.0-9]+\):.* (restart domain.*)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="Domain" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="Command" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="general">
		<Name>{Condition:SectionName} Customer restarted a domain at {Condition:Timestamp} with command: {Condition:Domain}</Name>
		<DisplayMessage>Domain restarted at {Condition:Timestamp} domain name: {Condition:Domain}</DisplayMessage>
		<Expression LogLevel="Warning">
			<Section Name="CLILog" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>restart domain</IndexSearch>
			<RegExp>1,([0-9TZ.]{16,20}),([a-zA-Z0-9-._]+),.*: (restart domain [a-zA-Z0-9-._"]+)</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="Domain" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- End of restart domain search -->
	
	<Formula Categories="general">
		<Name>{Condition:SectionName} User {Condition:User} at {Condition:ClientIP} deleted a domain at {Condition:Timestamp} inside domain {Condition:DomainRanIn} using the command: {Condition:Command}</Name>
		<Expression LogLevel="Warning">
			<Section Name="CLILog" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>no domain</IndexSearch>
			<RegExp>1,([0-9TZ.]{16,20}),([a-zA-Z0-9-._]+),cli,debug,,,0,,,[a-zA-Z0-9]+,,,"\(([a-zA-Z0-9-._]+):([a-zA-Z0-9-._]+):([a-zA-Z0-9-._]+):([a-zA-Z0-9-._]+)\): (no domain [a-zA-Z0-9-._"]+)</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="DomainRanIn" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="User" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="6" RegGroup="All" ConditionName="ClientIP" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="7" RegGroup="All" ConditionName="Command" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<!-- Interface search for preempt on -->
		<Formula Categories="configuration;network">
		<Name>Interface {Condition:ObjectName} is configured with 'preempt on' in standby control, this is not recommended.</Name>
		<DisplayMessage>Interface {Condition:ObjectName} is configured with preempt on in standby control, this is not recommended, review Step #5 in Troubleshooting: Standby Control.</DisplayMessage>
		<URL description="Troubleshooting: Standby Control not working correctly on DataPower Appliance: ">https://www.ibm.com/support/pages/node/399779</URL>
		<Expression LogLevel="Critical" FormulaIDMatch="V720FirmwareCheckOrGreater">
			<Section Name="default-config" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\b(ethernet|interface) \"([a-zA-Z-_.0-9]+)"\W+(\w+\W+)*?([no ]{0,3}standby-preempt|exit)\b</RegExp>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="ConfigInfo" Operation="EqualsTo" Value="standby-preempt"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;network">
		<Name>Interface {Condition:ObjectName} is configured with 'preempt on' in standby control, this is not recommended.</Name>
		<DisplayMessage>Interface {Condition:ObjectName} is configured with preempt on in standby control, this is not recommended, review Step #5 in Troubleshooting: Standby Control.</DisplayMessage>
		<URL description="Troubleshooting: Standby Control not working correctly on DataPower Appliance: ">https://www.ibm.com/support/pages/node/399779</URL>
		<Expression LogLevel="Critical" FormulaIDMatch="V710FirmwareCheckOrLower">
			<Section Name="default-config" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And">\b(interface \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit)\b</Condition>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ConfigInfo" Operation="Contains" Value="preempt on">\b(interface \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit)\b</Condition>
		</Expression>
	</Formula>
	
	<!-- end Interface Config search for retry interval -->
	
	
	<!-- Search for modified xml managers bytes scanned -->
	<Formula CollapseResult="true" Categories="configuration;memory" SortCondition="BytesScanned">
		<Name>{Condition:SectionName} Contains a modified bytes-scanned of {Condition:BytesScanned} bytes, xml manager {Condition:XMLManager} allowing larger documents.</Name>
		<DisplayMessage>XML Manager {Condition:XMLManager} has a custom bytes-scanned value of {Condition:BytesScanned} bytes.  This means that the service can accept larger messages, this is noted in customer situations where memory may be high that services tied to this XML Manager may be a contributor.</DisplayMessage>
		<Expression LogLevel="Warning">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<!-- FieldPositions, 0=XMLMgr Config, 1=XML Manager name (without quotes), 2=N/A, 3=bytes-scanned #num#, 4=#num# of bytes scanned
						0=xmlmgr "default" ... exit, 1=default,2=N/A,3=bytes-scanned 4194304, 4=4194304 -->
			<RegExp>\bxmlmgr \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?(bytes-scanned ([0-9]+)|exit)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="XMLManager" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<!-- the default value of the XML Manager bytes-scanned is 4194304, if it is greater than it is likely a modified object -->
			<Condition FieldPosition="4" RegGroup="All" ConditionName="BytesScanned" Operation="GreaterThan" Value="4194304" NextOperation="And"/>
			<!-- the XML Manager for stream based services has a default Bytes-Scanned of 268435456, so lets just omit those since they will always exist -->
			<Condition FieldPosition="4" RegGroup="All" Operation="NotEqualTo" Value="268435456"/>
		</Expression>
	</Formula>
	<!-- End of search xml managers -->
	
	<Formula CollapseResult="true" FormulaID="APARCHECK:IT25130">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.0" NextOperation="And"/>
				<!-- fixed in 7.5.0.16 -->
				<Condition FieldPosition="3" Operation="LessThan" Value="16"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.1" NextOperation="And"/>
				<!-- fixed in 7.5.1.15 -->
				<Condition FieldPosition="3" Operation="LessThan" Value="15"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.2" NextOperation="And"/>
				<!-- fixed in 7.5.2.15 -->
				<Condition FieldPosition="3" Operation="LessThan" Value="15"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.6.0" NextOperation="And"/>
				<!-- fixed in 7.6.0.8 -->
				<Condition FieldPosition="3" Operation="LessThan" Value="8"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.7.0"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.7.1" NextOperation="And"/>
				<!-- fixed in 7.7.1.1 -->
				<Condition FieldPosition="3" Operation="LessThan" Value="2"/>
			</Expression>
	</Formula>
	
	<Formula Categories="configuration;network;memory;cpuload;failure">
		<Name>DataPower DNS Round Robin Algorithm does not honor TCP based responses.</Name>
		<DisplayMessage>Round Robin Algorithm will not honor TCP based responses, use First-Alive as a workaround or upgrade to fixpacks in URL.</DisplayMessage>
		<URL description="IT25130 (Fixed in 7.5.0.16, 7.5.1.15, 7.5.2.15, 7.6.0.8 and 7.7.1.2): DATAPOWER DNS ROUND ROBIN ALGORITHM DOES NOT HONOR TCP BASED DNSRESPONSE: ">https://www.ibm.com/support/docview.wss?uid=swg1IT25130</URL>
		<Expression LogLevel="Error" FormulaIDMatch="APARCHECK:IT25130">
			<Section Name="default-config" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\bdns\W+(\w+\W+)*?(load-balance ([a-zA-Z\-]+)|exit)\b</RegExp>
			<Condition FieldPosition="3" RegGroup="All" Operation="EqualsTo" Value="round-robin"/>
			<!-- round robin is default so it could be empty, first-alive would be set otherwise -->
			<Condition FieldPosition="2" RegGroup="All" Operation="EqualsTo" Value="exit"/>
		</Expression>
	</Formula>
	<!-- End of search dns -->
		
		
	<!-- Bad physical memory track -->
	<Formula Categories="hardware">
		<Name>Customer has an issue with their physical memory module, error: {/Hardware/diagmemorydisabled}</Name>
		<DisplayMessage>This typically indicates the device has bad physical memory, the device can be rebooted to see if this message goes away, otherwise the device must be replaced.</DisplayMessage>
		<Expression LogLevel="Critical">
			<Section Name="Hardware" XPath="/Hardware/diagmemorydisabled"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" Value=""/>
			</Expression>
	</Formula>
	<!-- End bad physical memory -->
	
	<!-- Search memory section for nuclear event -->
	<Formula Categories="failure">
		<Name>{Condition:SectionName} notes that the device went nuclear and memory was collected {Condition:MemTimesCollected} times, starting {Condition:ZuluDate}{Condition:ZuluTime}.  Local time recorded as {Condition:LocalTime} (local time can be different than zulu indicating another throttle event more recently).</Name>
		<DisplayMessage>This indicates the device likely throttled due to low memory starting at {Condition:ZuluDate}{Condition:ZuluTime} (indicates first throttle).  There is a local time of {Condition:LocalTime} which may represent a more recent throttle event.</DisplayMessage>
		<Expression LogLevel="Error">
			<Section Name="Memory" XPath="/Root/text()"/>
			<!-- FieldPositions, 0=Memory collected line, 1=DateTime, 2=Day, 3=Amount of times mem collected, 4=Zulu date,5=Zulu time -->
			<RegExp>\b((Mon|Tue|Wed|Thu|Fri|Sat|Sun) [a-zA-Z0-9 :]+): Memory collected (\d+) times, starting (\d{8}T)(\d{6}Z)\b</RegExp>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="MemTimesCollected" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="ZuluDate" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="5" RegGroup="All" ConditionName="ZuluTime" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="LocalTime" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- End of nuclear memory search -->
	
	
	<Formula CollapseResult="true" FormulaID="APARCHECK:IT30563">
		<Expression LogLevel="Info">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
			<RegExp>([A-Z]{2,4})[0-9]{0,2}.(((2018|2019|20[2-9][0-9])\.(\d+)\.(\d+))\.(\d+))([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="2018" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="EqualsTo" Value="4" NextOperation="And"/>
			<Condition FieldPosition="6" Operation="EqualsTo" Value="1" NextOperation="And"/>
			<Condition FieldPosition="7" Operation="LessThan" Value="10"/>
		</Expression>
	</Formula>
	
	<!-- domain mem status -->
	<Formula OmitPrintingMetConditions="true" Categories="memory" SortCondition="MemUsage" SortMethod="Descending">
		<Name>Domain {/Status/DomainsMemoryStatus//Domain} reports memory usage.  DocCacheSize: {/Status/DomainsMemoryStatus//DocumentCaches} KB, StylesheetCacheSize: {/Status/DomainsMemoryStatus//StylesheetCaches} KB</Name>
		<DisplayMessage>Kilobyte buckets (ex. 500 = 500Kb, 1000 = 1Mb), Buckets - Current: {/Status/DomainsMemoryStatus//ServicesCurrent}, 1m: {/Status/DomainsMemoryStatus//ServicesOneMinute}, 5m: {/Status/DomainsMemoryStatus//ServicesFiveMinutes}, 10m: {/Status/DomainsMemoryStatus//ServicesTenMinutes}, 1hr: {/Status/DomainsMemoryStatus//ServicesOneHour}, 12hr: {/Status/DomainsMemoryStatus//ServicesTwelveHours}, day: {/Status/DomainsMemoryStatus//ServicesOneDay}, lifetime: {/Status/DomainsMemoryStatus//ServicesLifetime}.</DisplayMessage>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="DomainsMemoryStatus" Wildcard="True" XPath="/Status/DomainsMemoryStatus//ServicesCurrent"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="DomainsMemoryStatus" Wildcard="True" XPath="/Status/DomainsMemoryStatus//ServicesOneMinute"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="DomainsMemoryStatus" Wildcard="True" XPath="/Status/DomainsMemoryStatus//ServicesFiveMinutes"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="DomainsMemoryStatus" Wildcard="True" XPath="/Status/DomainsMemoryStatus//ServicesTenMinutes"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="DomainsMemoryStatus" Wildcard="True" XPath="/Status/DomainsMemoryStatus//ServicesOneHour"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="DomainsMemoryStatus" Wildcard="True" XPath="/Status/DomainsMemoryStatus//ServicesTwelveHours"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="DomainsMemoryStatus" Wildcard="True" XPath="/Status/DomainsMemoryStatus//ServicesOneDay"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="DomainsMemoryStatus" Wildcard="True" XPath="/Status/DomainsMemoryStatus//ServicesLifetime"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
	</Formula>
	
	
	<!-- 7.2+ -->
	<Formula OmitPrintingMetConditions="true" Categories="memory" SortCondition="MemUsage" SortMethod="Descending">
		<Name>Domain {/Status/DomainsMemoryStatus2//Domain} reports memory usage.  DocCacheSize: {/Status/DomainsMemoryStatus2//DocumentCaches} KB, StylesheetCacheSize: {/Status/DomainsMemoryStatus2//StylesheetCaches} KB</Name>
		<DisplayMessage>Kilobyte buckets (ex. 500 = 500Kb, 1000 = 1Mb), Buckets - Current: {/Status/DomainsMemoryStatus2//ServicesCurrent}, 1m: {/Status/DomainsMemoryStatus2//ServicesOneMinute}, 5m: {/Status/DomainsMemoryStatus2//ServicesFiveMinutes}, 10m: {/Status/DomainsMemoryStatus2//ServicesTenMinutes}, 1hr: {/Status/DomainsMemoryStatus2//ServicesOneHour}, 12hr: {/Status/DomainsMemoryStatus2//ServicesTwelveHours}, day: {/Status/DomainsMemoryStatus2//ServicesOneDay}, lifetime: {/Status/DomainsMemoryStatus2//ServicesLifetime}.</DisplayMessage>
		<URL FormulaIDMatch="APARCHECK:IT30563" description="IT30563 (Fixed in 2018.4.1.10): MEMORY USAGE INACCURATE FOR API DOMAIN FROM THE GUI VIEW: ">https://www.ibm.com/support/pages/node/6103606</URL>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="DomainsMemoryStatus2" Wildcard="True" XPath="/Status/DomainsMemoryStatus2//ServicesCurrent"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="DomainsMemoryStatus2" Wildcard="True" XPath="/Status/DomainsMemoryStatus2//ServicesOneMinute"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="DomainsMemoryStatus2" Wildcard="True" XPath="/Status/DomainsMemoryStatus2//ServicesFiveMinutes"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="DomainsMemoryStatus2" Wildcard="True" XPath="/Status/DomainsMemoryStatus2//ServicesTenMinutes"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="DomainsMemoryStatus2" Wildcard="True" XPath="/Status/DomainsMemoryStatus2//ServicesOneHour"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="DomainsMemoryStatus2" Wildcard="True" XPath="/Status/DomainsMemoryStatus2//ServicesTwelveHours"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="DomainsMemoryStatus2" Wildcard="True" XPath="/Status/DomainsMemoryStatus2//ServicesOneDay"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="DomainsMemoryStatus2" Wildcard="True" XPath="/Status/DomainsMemoryStatus2//ServicesLifetime"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
	</Formula>
	<!-- end of domain mem status -->
	
	<!-- Check services for memory usage higher than 100MB -->
	<Formula OmitPrintingMetConditions="true" Categories="memory" SortCondition="MemUsage" SortMethod="Descending">
		<Name>{Condition:SectionName} High Memory usage in service {/Status/ServicesMemoryStatus//serviceName}, type of service: ({/Status/ServicesMemoryStatus//serviceClass})</Name>
		<DisplayMessage>Should a device be encountering high memory usage, these are the services using high memory, {/Status/ServicesMemoryStatus//serviceName} service kilobyte buckets (ex. 500 = 500Kb, 1000 = 1Mb), Buckets - Current: {/Status/ServicesMemoryStatus//current}, 1m: {/Status/ServicesMemoryStatus//oneMinute}, 5m: {/Status/ServicesMemoryStatus//fiveMinutes}, 10m: {/Status/ServicesMemoryStatus//tenMinutes}, 1hr: {/Status/ServicesMemoryStatus//oneHour}, 12hr: {/Status/ServicesMemoryStatus//twelveHours}, day: {/Status/ServicesMemoryStatus//oneDay}, lifetime: {/Status/ServicesMemoryStatus//lifetime}.</DisplayMessage>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryStatus" Wildcard="True" XPath="/Status/ServicesMemoryStatus//current"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryStatus" Wildcard="True" XPath="/Status/ServicesMemoryStatus//oneMinute"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryStatus" Wildcard="True" XPath="/Status/ServicesMemoryStatus//fiveMinutes"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryStatus" Wildcard="True" XPath="/Status/ServicesMemoryStatus//tenMinutes"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryStatus" Wildcard="True" XPath="/Status/ServicesMemoryStatus//oneHour"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryStatus" Wildcard="True" XPath="/Status/ServicesMemoryStatus//twelveHours"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryStatus" Wildcard="True" XPath="/Status/ServicesMemoryStatus//oneDay"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryStatus" Wildcard="True" XPath="/Status/ServicesMemoryStatus//lifetime"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
	</Formula>
	
	<!-- 7.2+ -->
	<Formula OmitPrintingMetConditions="true" Categories="memory" SortCondition="MemUsage" SortMethod="Descending">
		<Name>{Condition:SectionName} High Memory usage in service {/Status/ServicesMemoryStatus2//serviceName}, type of service: ({/Status/ServicesMemoryStatus2//serviceClass})</Name>
		<DisplayMessage>Should a device be encountering high memory usage, these are the services using high memory, {/Status/ServicesMemoryStatus2//serviceName} service megabyte buckets (ex. 100 = 100MB, 1000 = 1GB), Buckets - Current: {/Status/ServicesMemoryStatus2//current}, 1m: {/Status/ServicesMemoryStatus2//oneMinute}, 5m: {/Status/ServicesMemoryStatus2//fiveMinutes}, 10m: {/Status/ServicesMemoryStatus2//tenMinutes}, 1hr: {/Status/ServicesMemoryStatus2//oneHour}, 12hr: {/Status/ServicesMemoryStatus2//twelveHours}, day: {/Status/ServicesMemoryStatus2//oneDay}, lifetime: {/Status/ServicesMemoryStatus2//lifetime}.</DisplayMessage>
		<URL FormulaIDMatch="APARCHECK:IT30563" description="IT30563 (Fixed in 2018.4.1.10): MEMORY USAGE INACCURATE FOR API DOMAIN FROM THE GUI VIEW: ">https://www.ibm.com/support/pages/node/6103606</URL>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryStatus2" Wildcard="True" XPath="/Status/ServicesMemoryStatus2//current"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryStatus2" Wildcard="True" XPath="/Status/ServicesMemoryStatus2//oneMinute"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryStatus2" Wildcard="True" XPath="/Status/ServicesMemoryStatus2//fiveMinutes"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryStatus2" Wildcard="True" XPath="/Status/ServicesMemoryStatus2//tenMinutes"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryStatus2" Wildcard="True" XPath="/Status/ServicesMemoryStatus2//oneHour"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryStatus2" Wildcard="True" XPath="/Status/ServicesMemoryStatus2//twelveHours"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryStatus2" Wildcard="True" XPath="/Status/ServicesMemoryStatus2//oneDay"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryStatus2" Wildcard="True" XPath="/Status/ServicesMemoryStatus2//lifetime"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100"/>
		</Expression>
	</Formula>
	<!-- end services memory usage check -->
	
		<Formula OmitPrintingMetConditions="true" Categories="memory" SortCondition="MemUsage" SortMethod="Descending">
		<Name>{Condition:SectionName} Cached Memory Status on Failure - High Memory usage in service {/Status/ServicesMemoryStatus//serviceName}, type of service: ({/Status/ServicesMemoryStatus//serviceClass})</Name>
		<DisplayMessage>Should a device be encountering high memory usage, these are the services using high memory, {/Status/ServicesMemoryStatus//serviceName} service kilobyte buckets (ex. 500 = 500Kb, 1000 = 1Mb), Buckets - Current: {/Status/ServicesMemoryStatus//current}, 1m: {/Status/ServicesMemoryStatus//oneMinute}, 5m: {/Status/ServicesMemoryStatus//fiveMinutes}, 10m: {/Status/ServicesMemoryStatus//tenMinutes}, 1hr: {/Status/ServicesMemoryStatus//oneHour}, 12hr: {/Status/ServicesMemoryStatus//twelveHours}, day: {/Status/ServicesMemoryStatus//oneDay}, lifetime: {/Status/ServicesMemoryStatus//lifetime}.</DisplayMessage>
		<URL FormulaIDMatch="APARCHECK:IT30563" description="IT30563 (Fixed in 2018.4.1.10): MEMORY USAGE INACCURATE FOR API DOMAIN FROM THE GUI VIEW: ">https://www.ibm.com/support/pages/node/6103606</URL>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryOnFailure" Wildcard="True" XPath="/Status/ServicesMemoryStatus//current"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryOnFailure" Wildcard="True" XPath="/Status/ServicesMemoryStatus//oneMinute"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryOnFailure" Wildcard="True" XPath="/Status/ServicesMemoryStatus//fiveMinutes"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryOnFailure" Wildcard="True" XPath="/Status/ServicesMemoryStatus//tenMinutes"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryOnFailure" Wildcard="True" XPath="/Status/ServicesMemoryStatus//oneHour"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryOnFailure" Wildcard="True" XPath="/Status/ServicesMemoryStatus//twelveHours"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryOnFailure" Wildcard="True" XPath="/Status/ServicesMemoryStatus//oneDay"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="Or">
			<Section Name="ServicesMemoryOnFailure" Wildcard="True" XPath="/Status/ServicesMemoryStatus//lifetime"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MemUsage" Operation="GreaterThan" Value="100000"/>
		</Expression>
	</Formula>
	
	<!-- find backside connection failures -->
	<Formula Categories="network;memory" SortCondition="Timestamp" SortMethod="Descending">
		<Name>{Condition:Timestamp} NFS mount failed on {Condition:ObjectName} (nfs-static-mount), Domain: {Condition:DomainName}.</Name>
		<URL description="Tuning the NFS mount on the DataPower and B2B: ">https://www.ibm.com/support/pages/node/205309</URL>
		<Expression LogLevel="Warning">
			<Section Name="-log" Wildcard="True" XPath="/Root/text()" ReadNextSection="True"/>
			<Section Name="DefaultLogBeforeReload" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".log" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>: NFS mount of</IndexSearch>
			<RegExp>\b([0-9TZ.]{16,20}) \[([a-zA-Z._\-0-9]+)\]\[0x80e002d7\]\[network-file\]\[error\] nfs-static-mount\(([a-zA-Z._\-0-9]+)\): NFS mount of ([a-zA-Z0-9-_.:?=;/\ ]*) failed\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="DomainName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="URL" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="network;memory" SortCondition="Timestamp" SortMethod="Descending">
		<Name>{Condition:SectionName} {Condition:Timestamp} Backside connection failed on {Condition:ServiceName}, Service Type: {Condition:ServiceType}, transaction id {Condition:TransactionID}.  This type of backend failure is usually due to a service timeout being triggered, the backend may be held up (header is empty, eg. no response from backend, was only able to establish the TCP connection, but no further, no http headers).</Name>
		<DisplayMessage>{Condition:Timestamp} [{Condition:SectionName}]||{Condition:ServiceName}||{Condition:ServiceType}||{Condition:TransactionID}||{Condition:URL} </DisplayMessage>
		<Expression LogLevel="Warning">
			<Section Name="-log" Wildcard="True" XPath="/Root/text()" ReadNextSection="True"/>
			<Section Name="DefaultLogBeforeReload" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".log" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>failed to parse due to: Failed to establish a backside connection</IndexSearch>
			<RegExp>\b([0-9TZ.]{16,20}) ([a-zA-Z0-9.\-_\[\] ]+) ([a-zA-Z-_]*)\(([a-zA-Z0-9.\-_]*)\): tid\(([0-9]*)\)(\[[0-9.]+\])(( gtid\(([0-9a-f]*)\))?): Backside header \('N\/A'\) failed to parse due to: Failed to establish a backside connection\, URL: ([a-zA-Z0-9-_.:?=;\/\ ]{1,200})\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="ServiceName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ServiceType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="5" RegGroup="All" ConditionName="TransactionID" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="10" RegGroup="All" ConditionName="URL" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="network;memory" SortCondition="Timestamp" SortMethod="Descending">
		<Name>{Condition:SectionName} {Condition:Timestamp} Backside connection failed on {Condition:ServiceName}, Service Type: {Condition:ServiceType}, transaction id {Condition:TransactionID}.  This type of backend failure is usually related to DNS failure, look for other DNS failure entries in the logs against the same hostname.</Name>
		<DisplayMessage>{Condition:Timestamp} [{Condition:SectionName}]||{Condition:ServiceName}||{Condition:ServiceType}||{Condition:TransactionID}||{Condition:URL}</DisplayMessage>
		<Expression LogLevel="Warning">
			<Section Name="-log" Wildcard="True" XPath="/Root/text()" ReadNextSection="True"/>
			<Section Name="DefaultLogBeforeReload" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".log" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>Failed to establish a connection to the server</IndexSearch>
			<RegExp>\b([0-9TZ.]{16,20}) ([a-zA-Z0-9.-_\[\] ]*) ([a-zA-Z-_]*)\(([a-zA-Z0-9.\-_]*)\): tid\(([0-9]*)\)[a-zA-Z0-9_.\-\[\]. ]*: Failed to establish a connection to the server\, URL: ([a-zA-Z0-9-_.:?=;/\ ]*)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ServiceType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="ServiceName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="5" RegGroup="All" ConditionName="TransactionID" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="6" RegGroup="All" ConditionName="URL" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="network;memory" SortCondition="Timestamp" SortMethod="Descending">
		<Name>{Condition:SectionName} {Condition:Timestamp} Backside connection failed on {Condition:ServiceName}, Service Type: {Condition:ServiceType}, transaction id {Condition:TransactionID}.  This type of backend failure is usually related to resolved hostnames, but unable to establish a TCP connection (timed out).</Name>
		<DisplayMessage>{Condition:Timestamp} {Condition:SectionName}||{Condition:ServiceName}||{Condition:ServiceType}||{Condition:TransactionID}||{Condition:URL}</DisplayMessage>
		<Expression LogLevel="Warning">
			<Section Name="-log" Wildcard="True" XPath="/Root/text()" ReadNextSection="True"/>
			<Section Name="DefaultLogBeforeReload" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".log" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>Valid backside connection could not be established: Failed to establish a backside connection</IndexSearch>
			<RegExp>\b([0-9TZ.]{16,20}) ([a-zA-Z0-9.-_\[\] ]*) ([a-zA-Z-_]*)\(([a-zA-Z0-9.\-_]*)\): tid\(([0-9]*)\)[a-zA-Z0-9_.\-\[\]. ]*: Valid backside connection could not be established: Failed to establish a backside connection\, url: ([a-zA-Z0-9-_.:?=;/\ ]*)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ServiceType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="ServiceName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="5" RegGroup="All" ConditionName="TransactionID" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="6" RegGroup="All" ConditionName="URL" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
		
	<Formula Categories="network;memory" SortCondition="Timestamp" SortMethod="Descending">
		<Name>{Condition:SectionName} {Condition:Timestamp} Connection failed on object {Condition:ObjectName}, Service Type: {Condition:Type}, Connection Error: {Condition:ErrorCode}, transaction id {Condition:TransactionID}</Name>
		<DisplayMessage>{Condition:Timestamp} [{Condition:SectionName}]||{Condition:ObjectName}||{Condition:Type}||{Condition:TransactionID}||{Condition:ErrorCode}||{Condition:URL}</DisplayMessage>
		<Expression LogLevel="Warning">
			<Section Name="-log" Wildcard="True" XPath="/Root/text()" ReadNextSection="True"/>
			<Section Name="DefaultLogBeforeReload" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".log" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>: Connection error</IndexSearch>
			<RegExp>\b([0-9TZ.]{16,20}) ([a-zA-Z0-9.-_\[\]]*) ([a-zA-Z ]*)\(([a-zA-Z0-9.\-_]*)\): tid\(([0-9]*)\)[a-zA-Z0-9_.\-\[\]. ]*: Connection error\(([0-9]+)\) at '([a-zA-Z0-9-_.:/\ ]*)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="Type" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="5" RegGroup="All" ConditionName="TransactionID" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="6" RegGroup="All" ConditionName="ErrorCode" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="7" RegGroup="All" ConditionName="URL" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>

	<!-- end backside connection failures -->
	
	<!-- dns failures -->
	<Formula Categories="network;memory" SortCondition="Timestamp" SortMethod="Descending">
		<Name>{Condition:SectionName} {Condition:Timestamp} DNS resolution failed on hostname: {Condition:URL} in service {Condition:ServiceName}, Service Type: {Condition:ServiceType}, transaction id {Condition:TransactionID}.</Name>
		<DisplayMessage>{Condition:Timestamp} [{Condition:SectionName}]||{Condition:ServiceName}||{Condition:ServiceType}||{Condition:TransactionID}||{Condition:URL}.</DisplayMessage>
		<Expression LogLevel="Warning">
			<Section Name="-log" Wildcard="True" XPath="/Root/text()" ReadNextSection="True"/>
			<Section Name="DefaultLogBeforeReload" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".log" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>: DNS Callback cannot resolve host</IndexSearch>
			<RegExp>\b([0-9TZ.]{16,20}) ([a-zA-Z0-9.-_\[\] ]*) ([a-zA-Z-_]*)\(([a-zA-Z0-9.\-_]*)\): tid\(([0-9]*)\)[a-zA-Z0-9_.\-\[\]. ]*: DNS Callback cannot resolve host '([a-zA-Z0-9-_.:/\ ]*)': returning error\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="ServiceName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ServiceType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="5" RegGroup="All" ConditionName="TransactionID" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="6" RegGroup="All" ConditionName="URL" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- end of dns failures -->
	
	<!-- latency line search -->
	<Formula Categories="network;memory" Popup="latency.analytics.html" SortCondition="TimeMS" SortMethod="descending">
		<Name>{Condition:SectionName} Latency Line Reported with at least a {Condition:TimeMS} millisecond delay</Name>
		<DisplayMessage>Latency in transaction, Service name: {Condition:ServiceName}, transaction id: {Condition:TransactionID} backend URL destination was {Condition:URL}.  See details for read out of transaction latency -- {Condition:LatencyLine}</DisplayMessage>
		<Expression LogLevel="Warning">
			<Section Name="-log" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".log" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>: Latency</IndexSearch>
			<RegExp>\b([0-9TZ.]{16,20}) [a-zA-Z0-9_.\-\[\] ]* ([a-zA-Z]*)\(([a-zA-Z0-9.\-_]*)\): tid\(([0-9]*)\)[a-zA-Z0-9_.\-\[\].]*: Latency:.*\s+([1-9]\d{3,8})\s+.*\[([a-zA-Z0-9=:?/\-_.&amp;]*)\b</RegExp>
			<!-- LatencyLine condition is fed for purposes of latency.analytics.html as a argument passed -->
			<Condition FieldPosition="0" RegGroup="All" ConditionName="LatencyLine" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="5" RegGroup="All" ConditionName="TimeMS" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ServiceName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="TransactionID" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="6" RegGroup="All" ConditionName="URL" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- end of latency line search -->
	
	<Formula Categories="memory;cpuload">
		<Name>{Condition:SectionName} Growth in ActiveUsers due to ITCAM/XML-MGMT Usage, counted {Condition:UserCount} 'system' connections.</Name>
		<DisplayMessage>Workarounds.  A) Change web-mgmt idle-timeout to be shorter (60 seconds), this will clean-up entries faster.  B) Disable ITCAM/Xml-Mgmt monitor or xml-mgmt interface.</DisplayMessage>
		<Expression LogLevel="Critical">
			<Section Name="ActiveUsers" Wildcard="True" XPath="count(/Status/ActiveUsers//connection[text()='system' or text()='saml-artifact'])"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="UserCount" Operation="GreaterThan" Value="20"/>
		</Expression>
	</Formula>
		
	<!-- tracking bug 43693 -->
	<Formula Categories="configuration;memory">
		<Name>QPool section reports a count {Condition:AAACount} aaapolicy.xsl entries.</Name>
		<DisplayMessage>If the customer is having memory issues, review the QPool for a large count of aaapolicy.xsl entries.  If this accompanies high memory, the customer may be encountering an RBM LDAP memory leak and need to move to fixpacks (or later) 5.0.0.18, 6.0.0.10, 6.0.1.6 and 7.0.0.3.</DisplayMessage>
		<Expression LogLevel="Error" NextOperation="And">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="3"/>
		</Expression>
		<Expression LogLevel="Error" NextOperation="And">
			<Section Name="QPool" XPath="/Root/text()"/>
			<RegExp>(\d+): 0x\d+ "(https://|http://|sftp://|ftp://).*"</RegExp>
			<Condition FieldPosition="1" RegGroup="Count" ConditionName="LDAPCount" Operation="LessThan" Value="100"/>
		</Expression>
		<Expression LogLevel="Error">
			<Section Name="QPool" XPath="/Root/text()"/>
			<RegExp>(\d+): 0x\d+ "store:///dp/aaapolicy.xsl"</RegExp>
			<Condition FieldPosition="1" RegGroup="Count" ConditionName="AAACount" Operation="GreaterThan" Value="1000"/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" FormulaID="APARCHECK:IT25995">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.7.0"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.7.1" NextOperation="And"/>
				<!-- was fixed in  7.7.1.3, so 7.7.1.0 - 7.7.1.2 will match here -->
				<Condition FieldPosition="3" Operation="LessThan" Value="3"/>
			</Expression>
	</Formula>
	
	<Formula Categories="configuration;memory">
		<Name>QPool section reports a count {Condition:AAACount} aaapolicy.xsl entries.</Name>
		<DisplayMessage>Customer has a large count of AAAPolicy.xsl entries, these exist as a reference to a AAA document cache entry inside an XML-Manager (need to use document-status for further analysis).  These entries can cause a high memory overhead, if most of entries are expired in document-cache for aaa: consider reducing the max document count allowed in cache (default is 5000 in an XML Manager document cache).</DisplayMessage>
		<URL FormulaIDMatch="APARCHECK:IT25995" description="APAR IT25995 (Fixed in 7.7.1.3): SLOW MEMORY GROWTH SEEN WHEN USING AAA OR WTX PROCESSING: ">https://www.ibm.com/support/docview.wss?uid=swg1IT25995</URL>
		<Expression LogLevel="Critical" FormulaIDMatch="APARCHECK:IT25995">
			<Section Name="QPool" XPath="/Root/text()"/>
			<RegExp>(\d+): 0x\d+ (name\()?"store:\/\/\/dp\/aaapolicy.xsl"(\))?</RegExp>
			<Condition FieldPosition="1" RegGroup="Count" ConditionName="AAACount" Operation="GreaterThan" Value="1000"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="QPool" XPath="/Root/text()"/>
			<RegExp>(\d+): 0x\d+ (name\()?"store:\/\/\/dp\/aaapolicy.xsl"(\))?</RegExp>
			<Condition FieldPosition="1" RegGroup="Count" ConditionName="AAACount" Operation="GreaterThan" Value="1000"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;memory">
		<Name>{Condition:SectionName} AAA Entries {Condition:AAACount}.</Name>
		<Expression LogLevel="Info">
			<Section Name="DocumentStatusSimpleIndex" Wildcard="True" XPath="count(/Status/DocumentStatusSimpleIndex//URL[starts-with(text(),'aaa://')])"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="AAACount" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>
	
	<!-- nfs static mount should use soft mount as it is recommended practice -->
	<Formula Categories="configuration">
		<Name>{Condition:SectionName} There is an NFS static mount {Condition:ObjectName} configured as a hard mount instead of a soft mount.</Name>
		<DisplayMessage>{Condition:ObjectName} is configured with a hard mount instead of soft mount, the default value is hard-mount, but sometimes this can have unexpected behavior and it is recommended to use soft-mount for NFS.  See technote below for more information.</DisplayMessage>
		<URL description="Tuning the NFS mount on the DataPower and B2B: ">https://www.ibm.com/support/pages/node/205309</URL>
		<URL FormulaIDMatch="V700FirmwareCheckOrGreater" description="NFS log target behaviour changed with DataPower release 7.0: ">https://www.ibm.com/support/pages/node/542659</URL>
		<Expression LogLevel="Warning">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\b(nfs-static-mount \"([a-zA-Z-_.0-9]+).*\"\W+(\w+\W+)*?exit)\b</RegExp>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ConfigInfo" Operation="NotContain" Value="mount-type soft"/>
		</Expression>
	</Formula>
	<!-- end of soft-mount check -->
	
	<!-- interface NetworkInfo check for NO-CARRIER -->
	<Formula CollapseResult="true" Categories="network">
		<Name>(NetworkInfo) Interface {Condition:InterfaceName} is UP, but reporting NO-CARRIER</Name>
		<DisplayMessage>Routing is likely missing from the interface {Condition:InterfaceName}.  Network and port test required for interface. Interface information: {Condition:InterfaceStatus}.</DisplayMessage>
		<Expression LogLevel="Warning" NextOperation="And">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//MachineType"/>
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//MachineType"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MachineType" Operation="NotEqualTo" Value="4195"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="NetworkInfo" XPath="/Root/text()"/>
			<RegExp>\b[0-9]+: ([a-zA-Z0-9_]+): &lt;(([a-zA-Z0-9-_ ]+),([a-zA-Z0-9-_ ]+),([a-zA-Z0-9-_ ]+),([a-zA-Z0-9-_ ]+)).*&gt;.*\b</RegExp>
			<!-- try and find the 'UP' state of the interface -->
			<Condition FieldPosition="2" RegGroup="All" ConditionName="InterfaceState" Operation="Contains" Value=",UP" NextOperation="And"/>
			<!-- grab the interface name -->
			<Condition FieldPosition="1" RegGroup="All" ConditionName="InterfaceName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<!-- pull the interface status together -->
			<Condition FieldPosition="2" RegGroup="All" ConditionName="InterfaceStatus" Operation="Contains" Value="NO-CARRIER"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="And" ExpressionGroup="InternalState">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//MachineType"/>
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//MachineType"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MachineType" Operation="NotEqualTo" Value="4195"/>
		</Expression>
		<Expression LogLevel="Warning" ExpressionGroup="InternalState">
			<Section Name="InternalState" XPath="/Root/text()"/>
			<RegExp>\b[0-9]+: ([a-zA-Z0-9_]+): &lt;(([a-zA-Z0-9-_ ]+),([a-zA-Z0-9-_ ]+),([a-zA-Z0-9-_ ]+),([a-zA-Z0-9-_ ]+)).*&gt;.*\b</RegExp>
			<!-- try and find the 'UP' state of the interface -->
			<Condition FieldPosition="2" RegGroup="All" ConditionName="InterfaceState" Operation="Contains" Value=",UP" NextOperation="And"/>
			<!-- grab the interface name -->
			<Condition FieldPosition="1" RegGroup="All" ConditionName="InterfaceName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<!-- pull the interface status together -->
			<Condition FieldPosition="2" RegGroup="All" ConditionName="InterfaceStatus" Operation="Contains" Value="NO-CARRIER"/>
		</Expression>
	</Formula>
	<!-- end of interface NetworkInfo check for NO-CARRIER -->
	
	<!-- test IPMI lan channel based on bug 43635 -->
	<Formula Categories="configuration;network">
		<Name>IPMI-Lan-Channel IP Conflict, {Condition:IPMIAddress} is being used in the ipmi-lan-channel and also interface {Condition:InterfaceName}</Name>
		<DisplayMessage>The IPMI-Lan-Channel IP address must be distinct from all IP addresses on the appliance and from all IP address on the connected subnet (broadcast domain).</DisplayMessage>
		<URL description="IPMI LAN Channel commands: ">https://www.ibm.com/docs/en/datapower-gateway/10.6.0?topic=access-defining-ipmi-lan-channel</URL>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="default-config" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\bipmi-lan-channel \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?(ip address ([a-zA-Z0-9._\/-]+)|exit)\b</RegExp>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="IPMIAddress" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Critical">
			<Section Name="default-config" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\binterface \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?(ip address ([a-zA-Z0-9._\/-]+)|exit)\b</RegExp>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="IPAddress" Operation="EqualsTo" Value="{Condition:IPMIAddress}" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="InterfaceName" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- end of testing ipmi channel -->
	
	<!-- mpgw/wsgw check for APAR IT29236 persistent connections in conjunction with transaction-timeout may fail -->
	<Formula Categories="configuration;network">
		<Name>{Condition:SectionName} {Condition:ObjectType} {Condition:ObjectName} has a transaction-timeout of {Condition:TransactionTimeout}. APAR IT29236 will impact the service.</Name>
		<URL description="IT29236 (7.6.0.16 and 2018.4.1.7): DATAPOWER MIGHT ERRONEOUSLY CANCEL TRANSACTION IF TRANSACTION TIMEOUT IS SET IN CONJUNCTION WITH PERSISTENT CONNECTIONS: ">https://www.ibm.com/support/docview.wss?uid=swg1IT29236</URL>
			<Expression FormulaIDMatch="APARCHECK:IT29214,IT29236" LogLevel="Critical">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\b(wsgw|mpgw) \"([a-zA-Z-_0-9.]+)\"\W+(\w+\W+)*?((transaction-timeout ([0-9]+)\s+|exit))\b</RegExp>
			<Condition FieldPosition="0" RegGroup="All" Operation="NotContain" Value="no persistent-connections" NextOperation="And"/>
			<Condition FieldPosition="0" RegGroup="All" Operation="NotContain" Value="persistent-connections off" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ObjectType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="6" RegGroup="All" ConditionName="TransactionTimeout" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>
	<!-- end IT29236 check -->
	
	<Formula Categories="configuration;network">
		<Name>{Condition:SectionName} MPGW {Condition:ObjectName} Front End Timeout</Name>
		<DisplayMessage>Has a front-end timeout greater than 120 seconds, front-end timeout is {Condition:FrontTimeout}.</DisplayMessage>
		<URL description="Connection Timeouts: ">https://publib.boulder.ibm.com/infocenter/ieduasst/v1r1m0/topic/com.ibm.iea.wdatapower/wdatapower/1.0/xa35/DP_373_Timeouts.pdf?dmuid=20090730163013045496</URL>
		<Expression LogLevel="Info">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\bmpgw \"([a-zA-Z-_0-9.]+)\"\W+(\w+\W+)*?(front-timeout ([0-9]+)|exit)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="FrontTimeout" Operation="GreaterThan" Value="120"/>
		</Expression>
	</Formula>
	<Formula Categories="configuration;network">
		<Name>{Condition:SectionName} MPGW {Condition:ObjectName} Back End Timeout</Name>
		<DisplayMessage>Has a back-end timeout greater than 120 seconds, back-end timeout is {Condition:BackTimeout}.</DisplayMessage>
		<URL description="Connection Timeouts: ">https://publib.boulder.ibm.com/infocenter/ieduasst/v1r1m0/topic/com.ibm.iea.wdatapower/wdatapower/1.0/xa35/DP_373_Timeouts.pdf?dmuid=20090730163013045496</URL>
		<Expression LogLevel="Info">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\bmpgw \"([a-zA-Z-_0-9.]+)\"\W+(\w+\W+)*?(back-timeout ([0-9]+)|exit)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="BackTimeout" Operation="GreaterThan" Value="120"/>
		</Expression>
	</Formula>
	
	<!-- sharing conversation MQ tracking -->
	<Formula Categories="configuration;failure;network;cpuload">
		<Name>{Condition:SectionName} There is an MQ-QM Object {Condition:ObjectName} configured with sharing-conversation.</Name>
		<URL description="When to enable Conversation Sharing in DataPower MQ Queue Manager (mq-qm) object: ">https://www.ibm.com/support/pages/node/231033</URL>
		<URL description="IT09316 (Fixed in 7.5.0.0): UNEXPECTED 2009 MQ ERRORS WITH MQ WHEN USING MQ-SHARING: ">https://www.ibm.com/support/docview.wss?uid=swg1IT09316</URL>
		<URL description="IT10128 (Fixed in 6.0.0.16, 6.0.1.12, 7.0.0.9, 7.1.0.6, 7.2.0.0): HIGH TRAFFIC WITH MQ SHARING-CONVERSATION ENABLED MAY CAUSE RELOAD: ">https://www.ibm.com/support/docview.wss?uid=swg1IT10128</URL>
		<URL description="IT08838 (Fixed in 6.0.0.16, 6.0.1.12, 7.0.0.9, 7.1.0.6, 7.2.0.0): UNEXPECTED RESTART WHEN USING MQ-SHARING CONVERSATION WITH OLD MQv7 SERVER: ">https://www.ibm.com/support/docview.wss?uid=swg1IT08838</URL>
		<URL description="IT05998 (Fixed in 6.0.0.12, 6.0.1.8, 7.0.0.5, 7.1.0.3): DATAPOWER APPLIANCE MIGHT NOT RESPOND UNDER HIGH LOAD WITH MQ QUEUE MANAGER OBJECT CONFIGURED TO USE SHARED CONVERSATIONS: ">https://www.ibm.com/support/docview.wss?uid=swg1IT05998</URL>
		<URL description="IT02476 (Fixed in 5.0.0.16, 6.0.0.8, 6.0.1.4, and 7.0.0.2): WITH SHARING CONVERSATION ENABLED, MQ-QM OBJECTS RUN INTO PENDING STATE AND HIGH CPU IS OBSERVED WHEN THERE IS MQ ERROR: ">https://www.ibm.com/support/docview.wss?uid=swg1IT02476</URL>
		<Expression LogLevel="Error"  FormulaIDMatch="V700FirmwareCheck">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\b(mq-qm \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit)\b</RegExp>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ConfigInfo" Operation="Contains" Value="sharing-conversations"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;failure;network;cpuload">
		<Name>{Condition:SectionName} There is an MQ-QM Object {Condition:ObjectName} configured with sharing-conversation.</Name>
		<URL description="When to enable Conversation Sharing in DataPower MQ Queue Manager (mq-qm) object: ">https://www.ibm.com/support/pages/node/231033</URL>
		<URL description="IT09316 (Fixed in 7.5.0.0): UNEXPECTED 2009 MQ ERRORS WITH MQ WHEN USING MQ-SHARING: ">https://www.ibm.com/support/docview.wss?uid=swg1IT09316</URL>
		<URL description="IT10498 (Fixed in 7.1.0.7): UNEXPECTED RESTART MIGHT OCCUR DURING MQ TRAFFIC WITH MQ SHARING CONVERSATION: ">https://www.ibm.com/support/docview.wss?uid=swg1IT10498</URL>
		<URL description="IT10128 (Fixed in 6.0.0.16, 6.0.1.12, 7.0.0.9, 7.1.0.6, 7.2.0.0): HIGH TRAFFIC WITH MQ SHARING-CONVERSATION ENABLED MAY CAUSE RELOAD: ">https://www.ibm.com/support/docview.wss?uid=swg1IT10128</URL>
		<URL description="IT08838 (Fixed in 6.0.0.16, 6.0.1.12, 7.0.0.9, 7.1.0.6, 7.2.0.0): UNEXPECTED RESTART WHEN USING MQ-SHARING CONVERSATION WITH OLD MQv7 SERVER: ">https://www.ibm.com/support/docview.wss?uid=swg1IT08838</URL>
		<URL description="IT05998 (Fixed in 6.0.0.12, 6.0.1.8, 7.0.0.5, 7.1.0.3): DATAPOWER APPLIANCE MIGHT NOT RESPOND UNDER HIGH LOAD WITH MQ QUEUE MANAGER OBJECT CONFIGURED TO USE SHARED CONVERSATIONS: ">https://www.ibm.com/support/docview.wss?uid=swg1IT05998</URL>
		<Expression LogLevel="Error"  FormulaIDMatch="V710FirmwareCheck">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\bmq-qm \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(sharing-conversations ([0-9]+)|exit)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="SharingCount" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>

	<Formula Categories="configuration;failure;network;cpuload">
		<Name>{Condition:SectionName} There is an MQ-QM Object {Condition:ObjectName} configured with sharing-conversation: {Condition:SharingCount}.</Name>
		<URL description="When to enable Conversation Sharing in DataPower MQ Queue Manager (mq-qm) object: ">https://www.ibm.com/support/pages/node/231033</URL>
		<URL description="IT09316 (Fixed in 7.5.0.0): DATAPOWER MQ-QM OBJECT CLOSES CONNECTION UNEXPECTEDLY RESULTING MQ REASON CODE 2009 WHEN SHARING CONVERSATIONS VALUE IS > 1: ">https://www.ibm.com/support/docview.wss?uid=swg1IT09316</URL>
		<URL description="IT10128 (Fixed in 6.0.0.16, 6.0.1.12, 7.0.0.9, 7.1.0.6, 7.2.0.0): HIGH TRAFFIC WITH MQ SHARING-CONVERSATION ENABLED MAY CAUSE RELOAD: ">https://www.ibm.com/support/docview.wss?uid=swg1IT10128</URL>
		<URL description="IT08838 (Fixed in 6.0.0.16, 6.0.1.12, 7.0.0.9, 7.1.0.6, 7.2.0.0): UNEXPECTED RESTART WHEN USING MQ-SHARING CONVERSATION WITH OLD MQv7 SERVER: ">https://www.ibm.com/support/docview.wss?uid=swg1IT08838</URL>
		<Expression LogLevel="Error" FormulaIDMatch="V720FirmwareCheckOrLower">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\bmq-qm \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(sharing-conversations ([0-9]+)|exit)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="SharingCount" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>	
	
	<Formula Categories="configuration;failure;network;cpuload">
		<Name>{Condition:SectionName} There is an MQ-QM Object {Condition:ObjectName} configured with sharing-conversation: {Condition:SharingCount}.</Name>
		<URL description="When to enable Conversation Sharing in DataPower MQ Queue Manager (mq-qm) object: ">https://www.ibm.com/support/pages/node/231033</URL>
		<Expression LogLevel="Critical" FormulaIDMatch="V750FirmwareCheckOrGreater">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\bmq-qm \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(sharing-conversations ([0-9]+)|exit)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="SharingCount" Operation="GreaterThan" Value="9"/>
		</Expression>
		<Expression LogLevel="Warning" FormulaIDMatch="V750FirmwareCheckOrGreater">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\bmq-qm \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(sharing-conversations ([0-9]+)|exit)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="SharingCount" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>	
	<!-- end of MQ sharing conversation -->
	
	
	<!-- APAR IT11147 tracking (MQ-QM with SSL may have connection errors like 2538) -->
	<Formula CollapseResult="true" FormulaID="APAR-IT10598-OR-IT11147-Fixpacks">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="10"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="7"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="2" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="2"/>
			</Expression>
	</Formula>
	
	<Formula Categories="configuration;failure;network;cpuload">
		<Name>{Condition:SectionName} There is an MQ-QM Object &lt;font color='#CC3300'&gt;{Condition:ObjectName}&lt;/font&gt; configured with SSL Profile &lt;font color='#CC3300'&gt;{Condition:SSLProfile}&lt;/font&gt;, current firmware may be affected by APAR in related URL listing.</Name>
		<URL description="IT11147 (Fixed in 6.0.0.17, 6.0.1.13, 7.0.0.10, 7.1.0.7 and 7.2.0.2): DATAPOWER MQ-QM FAILS TO CONNECT WITH AN MQ REASON CODE OF 2538 WHEN SSL IS USED: ">https://www.ibm.com/support/docview.wss?uid=swg1IT11147</URL>
		<Expression LogLevel="Error" FormulaIDMatch="APAR-IT10598-OR-IT11147-Fixpacks">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\bmq-qm \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(ssl ([a-zA-Z-_.0-9]+)|exit)\b</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="SSLProfile" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- end of APAR IT11147 tracking (MQ-QM with SSL may have connection errors like 2538) -->
	
	<!-- SFTP poller APAR tracking -->
	
	<!-- WSRR APAR IT10165 can cause random reloading during wsrr-subscription pull -->
		<Formula CollapseResult="true" FormulaID="WSRRAPARCheck">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="9"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="6"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="2" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="2"/>
			</Expression>
		</Formula>
		
	<Formula Categories="failure">
		<Name>Backtrace on {Condition:Timestamp} Contained Component: {Condition:Data}.  Review WSRR Related APAR's.</Name>
		<URL description="IT10165: APPLIANCE MAY RESTART IF XML MANAGEMENT INTERFACE IS LISTENING ON A HOST-ALIAS, ::, OR 0.0.0.0 AND WSRR SUBSCRIPTION IS USED: ">https://www.ibm.com/support/docview.wss?uid=swg1IT10165</URL>
		<Expression LogLevel="Critical" FormulaIDMatch="WSRRAPARCheck">
			<Section Name="Backtrace" Wildcard="True" NoDecodeCache="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And">Thread 0x[0-9a-fA-F]*\: (\d{4}\-\d{2}\-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z)</Condition>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Data" Operation="NotEqualTo" Value="">\b(Component=wsrr-subscription.*)\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
		</Expression>
	</Formula>
	<!-- end APAR IT10165 check -->
	
	<Formula Categories="configuration;failure">
		<Name>DataPower Error Report may be corrupted or DPMon data missing if internal-state is on within Failure Notification Settings.  Review URL for instructions about best practices on error report settings.</Name>
		<URL description="DataPower Best Practices: Most Detailed Error-Report configured through Failure Notification and Throttle Settings: ">https://www.ibm.com/support/pages/best-practices-failure-notification-settings-datapower</URL>
		<Expression LogLevel="Error" FormulaIDMatch="V750FirmwareCheckOrGreater">
			<Section Name="default-config" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\nfailure-notification\W+(\w+\W+)*?(no internal-state|exit)</RegExp>
			<Condition FieldPosition="2" RegGroup="All" Operation="NotEqualTo" Value="no internal-state"/>
		</Expression>
	</Formula>
	
	<Formula Categories="failure">
		<Name>Backtrace on {Condition:Timestamp} Contained Component: {Condition:Data}.  Review Failure Notification for Internal-State setting, if 'on' try having it turned 'off'.  Reboot is required to fix failure-notification as down.</Name>
		<Expression LogLevel="Critical">
			<Section Name="Backtrace" Wildcard="True" NoDecodeCache="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And">Thread 0x[0-9a-fA-F]*\: (\d{4}\-\d{2}\-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z)</Condition>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Data" Operation="NotEqualTo" Value="">\b(Component=ErrorReport, Domain=default, Config=ErrorReport)\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
		</Expression>
	</Formula>
	
	<Formula Categories="failure">
		<Name>Backtrace on {Condition:Timestamp} Contained source-sftp-poller component in Domain={Condition:Domain}, Config={Condition:Config}.  Possible APAR's listed, may need investigation by IBM support.</Name>
		<URL description="IT09825 (7.0.0.9, 7.1.0.6 and 7.2.0.1): MANY CONCURRENT SFTP POLLER CONNECTIONS MIGHT RESULT IN AN UNEXPECTED IMMEDIATE RESTART: ">https://www.ibm.com/support/docview.wss?uid=swg1IT09825</URL>
		<URL description="IT06471: DATAPOWER APPLIANCE USING A SFTP POLLER MIGHT EXPERIENCE AN IMMEDIATE RESTART (Fixed in 7.0.0.7): ">https://www.ibm.com/support/docview.wss?uid=swg1IT06471</URL>
		<Expression LogLevel="Error" FormulaIDMatch="V700FirmwareCheck">
			<Section Name="Backtrace" Wildcard="True" NoDecodeCache="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And">Thread 0x[0-9a-fA-F]*\: (\d{4}\-\d{2}\-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z)</Condition>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="Domain" Operation="NotEqualTo" Value="" NextOperation="And">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="Config" Operation="NotEqualTo" Value="" NextOperation="And">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Component" Operation="EqualsTo" Value="source-sftp-poller">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
		</Expression>
	</Formula>
	
	<Formula Categories="failure">
		<Name>Backtrace on {Condition:Timestamp} Contained source-sftp-poller component in Domain={Condition:Domain}, Config={Condition:Config}.  Possible APAR's listed, may need investigation by IBM support.</Name>
		<URL description="IT09825 (Fixed in 7.1.0.6 and 7.2.0.1): MANY CONCURRENT SFTP POLLER CONNECTIONS MIGHT RESULT IN AN UNEXPECTED IMMEDIATE RESTART: ">https://www.ibm.com/support/docview.wss?uid=swg1IT09825</URL>
		<URL description="IT06471: DATAPOWER APPLIANCE USING A SFTP POLLER MIGHT EXPERIENCE AN IMMEDIATE RESTART (Fixed in 7.1.0.5): ">https://www.ibm.com/support/docview.wss?uid=swg1IT06471</URL>
		<Expression LogLevel="Error" FormulaIDMatch="V710FirmwareCheck">
			<Section Name="Backtrace" Wildcard="True" NoDecodeCache="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And">Thread 0x[0-9a-fA-F]*\: (\d{4}\-\d{2}\-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z)</Condition>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="Domain" Operation="NotEqualTo" Value="" NextOperation="And">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="Config" Operation="NotEqualTo" Value="" NextOperation="And">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Component" Operation="EqualsTo" Value="source-sftp-poller">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
		</Expression>
	</Formula>
	
	<Formula Categories="failure">
		<Name>Backtrace on {Condition:Timestamp} Contained source-sftp-poller component in Domain={Condition:Domain}, Config={Condition:Config}.  Possible APAR's listed, may need investigation by IBM support.</Name>
		<URL description="IT09825 (Fixed in 7.2.0.1): MANY CONCURRENT SFTP POLLER CONNECTIONS MIGHT RESULT IN AN UNEXPECTED IMMEDIATE RESTART: ">https://www.ibm.com/support/docview.wss?uid=swg1IT09825</URL>
		<Expression LogLevel="Error" FormulaIDMatch="V720FirmwareCheck">
			<Section Name="Backtrace" Wildcard="True" NoDecodeCache="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And">Thread 0x[0-9a-fA-F]*\: (\d{4}\-\d{2}\-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z)</Condition>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="Domain" Operation="NotEqualTo" Value="" NextOperation="And">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="Config" Operation="NotEqualTo" Value="" NextOperation="And">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Component" Operation="EqualsTo" Value="source-sftp-poller">\bComponent[=]([a-zA-Z-_.0-9]+).*, Domain=([a-zA-Z-_\.0-9]+).*, Config=([a-zA-Z-_.0-9]+).*\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
		</Expression>
	</Formula>
	<!-- end of SFTP poller APAR tracking -->
	
	<!-- begin of CVE-2015-0235 and CVE-2014-6040 tracking -->
	<Formula Categories="configuration">
		<Name>(CVE-2015-0235 and CVE-2014-6040) IT06941: SECURITY ISSUES IN SOME GNU C LIBRARY (GLIBC) FUNCTIONS</Name>
		<URL description="IT06941: SECURITY ISSUES IN SOME GNU C LIBRARY (GLIBC) FUNCTIONS: ">https://www.ibm.com/support/docview.wss?uid=swg1IT06941</URL>
		<Expression LogLevel="Critical">
				<Section Name="FirmwareVersion" SectionName="false" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="5"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration">
		<Name>(CVE-2015-0235 and CVE-2014-6040) IT06941: SECURITY ISSUES IN SOME GNU C LIBRARY (GLIBC) FUNCTIONS</Name>
		<URL description="IT06941: SECURITY ISSUES IN SOME GNU C LIBRARY (GLIBC) FUNCTIONS: ">https://www.ibm.com/support/docview.wss?uid=swg1IT06941</URL>
		<Expression LogLevel="Critical">
				<Section Name="FirmwareVersion" SectionName="false" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="3"/>
		</Expression>
	</Formula>
	<!-- end of CVE-2015-0235 and CVE-2014-6040 tracking -->
	
	
	
	<Formula Categories="configuration;memory;failure">
		<Name>{Condition:SectionName} {Condition:Timestamp} issues communicating to LDAP MSGID mismatch against server {Condition:ServerName}.</Name>
		<Expression LogLevel="Error">
			<Section Name="DiagnosticLog" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>Searching LDAP server</IndexSearch>
			<RegExp>1,([0-9TZ.]{16,20}),([a-zA-Z0-9-_]+),.*,"Searching LDAP server ([a-zA-Z0-9.\-_]+) for .* failed: MSGID mismatch.*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ServerName" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;failure">
		<Name>{Condition:SectionName} {Condition:Timestamp} LDAP server {Condition:ServerName} throwing unknown reply tag 115 error.</Name>
		<DisplayMessage>{Condition:LineInfo}</DisplayMessage>
		<URL description="IBM WebSphere DataPower SOA Appliance: Searching LDAP server results in message..: ">https://www.ibm.com/support/pages/node/126941</URL>
		<Expression LogLevel="Warning">
			<Section Name="DiagnosticLog" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>Searching LDAP server</IndexSearch>
			<RegExp>1,([0-9TZ.]{16,20}),([a-zA-Z0-9-_]+),.*,"Searching LDAP server ([a-zA-Z0-9.\-_]+) for .* failed: Unknown reply tag 115</RegExp>
			<Condition FieldPosition="0" RegGroup="All" ConditionName="LineInfo" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ServerName" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;failure">
		<Name>Unable to bind to LDAP server.</Name>
		<DisplayMessage>{Condition:Timestamp}||{Condition:ServerName}||{Condition:LineInfo}</DisplayMessage>
		<URL description="IBM Support: Troubleshooting intermittent network errors on DataPower: ">https://www.ibm.com/support/pages/troubleshooting-intermittent-network-errors-datapower</URL>
		<Expression LogLevel="Warning">
			<Section Name="DiagnosticLog" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>Cannot bind; see LDAP Server log for details</IndexSearch>
			<RegExp>1,([0-9TZ.]{16,20}),([a-zA-Z0-9-_]+),.*,"Error querying server ([a-zA-Z0-9.\-_]+)\: Cannot bind; see LDAP Server log for details</RegExp>
			<Condition FieldPosition="0" RegGroup="All" TableMapPosition="2" ConditionName="LineInfo" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" TableMapPosition="0" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" TableMapPosition="1" ConditionName="ServerName" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<!-- ethernet interface restriction APAR IT05767 7.0.0.5, 7.1.0.3-->
	<Formula Categories="configuration;memory;failure">
		<Name>{Condition:SectionName} {Condition:Timestamp} Interface {Condition:InterfaceName} is reporting as invalid; this interface will not come up until configuration is resolved.</Name>
		<URL description="IT05767 (Fixed in 7.0.0.5 and 7.1.0.3): RESTORE THE ABILITY TO USE ADDITIONAL VNICS DEFINED IN THE VMWARE HYPERVISOR: ">https://www.ibm.com/support/docview.wss?uid=swg1IT05767</URL>
		<Expression LogLevel="Critical">
			<Section Name="DiagnosticLog" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>Invalid Ethernet interface name </IndexSearch>
			<RegExp>1,([0-9TZ.]{16,20}),[a-zA-Z0-9-_]+,.*,"Invalid Ethernet interface name '([a-zA-Z0-9.\-_]+)'.*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="InterfaceName" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- not going to bother checking the version of firmware, this still might be useful even if the APAR doesn't apply so L2 is aware there is a bad config -->
	<!-- end of ethernet interface tracking -->
	
	<!-- tracking of ephemeral port range -->
		<Formula Categories="configuration">
		<Name>{Condition:SectionName} Customer has a service running on {Condition:PortNumber} - this is inside the ephemeral range of {Condition:MinEphemeralPort} - {Condition:MaxEphemeralPort}.</Name>
		<URL description="WebSphere DataPower - Best practice for specifying port values: ">https://www.ibm.com/support/pages/node/404593</URL>
		<Expression LogLevel="Warning">
			<Section Name="DiagnosticLog" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch> is within the ephemeral range </IndexSearch>
			<RegExp>1,([0-9TZ.]{16,20}),([a-zA-Z0-9-_]+),.*,"Requested port \(([0-9]+)\) is within the ephemeral range \(([0-9]+) - ([0-9]+)\)"</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="PortNumber" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="MinEphemeralPort" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="5" RegGroup="All" ConditionName="MaxEphemeralPort" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- end of ephemeral port range check -->
	
	
	<Formula Categories="general">
		<Name>{Condition:SectionName} {Condition:Timestamp} Customer enabled debug inside action {Condition:ActionName}.  It is not recommended to have enabled in production.</Name>
		<Expression LogLevel="Warning">
			<Section Name="CLILog" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>1,([0-9TZ.]{16,20}),([a-zA-Z0-9-._]+),.*: (action [a-zA-Z0-9-._"]+)\"\W+(\w+\W+)*?1,([0-9TZ.]{16,20}),([a-zA-Z0-9-._]+),.*: (cancel|exit|debug|debug on)</RegExp>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ActionName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="5" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="7" RegGroup="All" Operation="NotEqualTo" Value="cancel" NextOperation="And"/>
			<Condition FieldPosition="7" RegGroup="All" Operation="NotEqualTo" Value="exit"/>
		</Expression>
	</Formula>
	
	<!-- GatewayScript APAR IT14083 -->
	<Formula Categories="configuration;failure">
		<Name>{Condition:SectionName} Action &lt;font color='#cc0000'&gt;{Condition:ActionName}&lt;/font&gt; is configured to OUTPUT: &lt;font color='#cc0000'&gt;{Condition:OutputName}&lt;/font&gt;.  &lt;u&gt;&lt;font color='#000000'&gt;OUTPUT should never be set to 'INPUT'&lt;/font&gt;&lt;/u&gt;.</Name>
		<Expression LogLevel="Warning">
			<Section Name="config" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>output "INPUT"</IndexSearch>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ActionName" Operation="NotEqualTo" Value="" NextOperation="And">action \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(output \"([a-zA-Z-_.0-9]+)\"|exit)</Condition>
			<!-- DP internally instantiates some actions in which INPUT <- action -> INPUT is used as it is a restricted design for these actions, but custom user actions should not follow this bad practice -->
			<!-- apic v5 and beyond continues to implement this in very special cases, dp-policy is now a -policy check to blanket match customer implementations -->
			<Condition FieldPosition="1" RegGroup="All" Operation="NotContain" Value="-policy" NextOperation="And">action \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(output \"([a-zA-Z-_.0-9]+)\"|exit)</Condition>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="OutputName" Operation="EqualsTo" Value="INPUT">action \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(output \"([a-zA-Z-_.0-9]+)\"|exit)</Condition>
		</Expression>
	</Formula>
	
	<!-- Find strip-attachments actions -->
	
		<!-- firmware check of 7.0.0.2 for strip attachment formula -->
		<Formula CollapseResult="true" FormulaID="7002FirmwareCheck">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="2"/>
			</Expression>
		</Formula>
		
		<Formula Categories="configuration;failure">
			<Name>{Condition:SectionName} There is an Strip Attachments Action {Condition:ObjectName} configured.</Name>
			<URL description="IT03488 (Fixed in 7.0.0.2): STRIP-ATTACHMENTS ACTION MIGHT CAUSE A RESTART UNDER CERTAIN CIRCUMSTANCES: ">https://www.ibm.com/support/docview.wss?uid=swg1IT03488</URL>
			<Expression LogLevel="Warning" FormulaIDMatch="7002FirmwareCheck">
				<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
				<RegExp>*</RegExp>
				<Condition FieldPosition="2" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And">\b(action \"([a-zA-Z-_.0-9]+).*\"\W+(\w+\W+)*?exit)\b</Condition>
				<Condition FieldPosition="1" RegGroup="All" ConditionName="ConfigInfo" Operation="Contains" Value="type strip-attachments">\b(action \"([a-zA-Z-_.0-9]+).*\"\W+(\w+\W+)*?exit)\b</Condition>
			</Expression>
		</Formula>
		<!-- end 7.0.0.2 strip attachment check -->	
	
	<!-- tracking of front side handler use of compression for APAR IT04947 -->
	<Formula CollapseResult="true" FormulaID="7005FirmwareCheck">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="5"/>
			</Expression>
		</Formula>
		
		<Formula Categories="configuration;cpuload;network">
		<Name>{Condition:SectionName} There is a {Condition:ComponentType} Object {Condition:ObjectName} configured with compression on.</Name>
		<URL description="IT04947 (Fixed in 7.0.0.5): READING OF CHUNKED ENCODING WITH HTTP BODY COMPRESSION MAY CAUSE UNEXPECTED BEHAVIOR UNABLE TO PROCESS REQUEST OR RESPONSE: ">https://www.ibm.com/support/docview.wss?uid=swg1IT04947</URL>
			<Expression LogLevel="Warning" FormulaIDMatch="7005FirmwareCheck">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\b((wsgw|mpgw|source-http[s]?) \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit)\b</RegExp>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ComponentType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ConfigInfo" Operation="Contains" Value="compression" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ConfigInfo" Operation="NotContain" Value="no compression"/>
		</Expression>
	</Formula>
	
	
		<Formula CollapseResult="true" FormulaID="7103FirmwareCheck">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="3"/>
			</Expression>
		</Formula>
		
	<Formula Categories="configuration;cpuload;network">
		<Name>{Condition:SectionName} There is a {Condition:ComponentType} Object {Condition:ObjectName} configured with compression on.</Name>
		<URL description="IT04947 (Fixed in 7.1.0.3): READING OF CHUNKED ENCODING WITH HTTP BODY COMPRESSION MAY CAUSE UNEXPECTED BEHAVIOR UNABLE TO PROCESS REQUEST OR RESPONSE: ">https://www.ibm.com/support/docview.wss?uid=swg1IT04947</URL>
			<Expression LogLevel="Warning" FormulaIDMatch="7103FirmwareCheck">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\b((wsgw|mpgw|source-http[s]?) \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit)\b</RegExp>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ComponentType" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ConfigInfo" Operation="Contains" Value="compression" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ConfigInfo" Operation="NotContain" Value="no compression"/>
		</Expression>
	</Formula>
	<!-- end of APAR IT04947 tracking -->
		
	<Formula Categories="configuration;memory">
		<Name>{Condition:SectionName} There is a TAM object {Condition:ObjectName} configured with tracing enabled, this may cause low temporary space!</Name>
		<DisplayMessage>TAM File is &lt;b&gt;{Condition:TamFileEnabled}&lt;/b&gt; using file &lt;b&gt;{Condition:TamFileName}&lt;/b&gt; max byte size &lt;b&gt;{Condition:TamFileSize}&lt;/b&gt;.&lt;br&gt;LDAP File is &lt;b&gt;{Condition:LdapFileEnabled}&lt;/b&gt; using file &lt;b&gt;{Condition:LdapFileName}&lt;/b&gt; max byte size &lt;b&gt;{Condition:LdapFileSize}&lt;/b&gt;.&lt;br&gt;GSKit File is &lt;b&gt;{Condition:GSKitEnabled}&lt;/b&gt; using file &lt;b&gt;{Condition:GSKitFileName}&lt;/b&gt;, gskit does not have a file size limit.</DisplayMessage>
		<URL description="Knowledge Center tam-ras-trace debugging tool: ">https://www.ibm.com/docs/en/datapower-gateway/10.6.0?topic=commands-tam-ras-trace</URL>
		<Expression LogLevel="Error">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>((tam \"([a-zA-Z-_.0-9]{0,40})\"|tam-ras-trace \"on\" \"([a-zA-Z-_.0-9]{0,40})\" \"([0-9]{0,20})\" \"([a-zA-Z-_.0-9]{0,40})\" \"([a-zA-Z-_.*:0-9]{0,40})\" \"(on|off)\" \"([a-zA-Z-_.0-9]{0,40})\" \"([0-9]{0,20})\" \"([0-9]{0,20})\" \"(on|off)\" \"([a-zA-Z-_.0-9]{0,40})\" \"(on|off)\")|exit)</RegExp>
			<Condition FieldPosition="3" RegGroup="Ordered" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="Ordered" ConditionName="TamFileName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="5" RegGroup="Ordered" ConditionName="TamFileSize" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="8" RegGroup="Ordered" ConditionName="TamFileEnabled" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="9" RegGroup="Ordered" ConditionName="LdapFileName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="10" RegGroup="Ordered" ConditionName="LdapFileSize" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="12" RegGroup="Ordered" ConditionName="LdapFileEnabled" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="13" RegGroup="Ordered" ConditionName="GSKitFileName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="14" RegGroup="Ordered" ConditionName="GSKitEnabled" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>

	<Formula Categories="configuration;memory">
		<Name>{Condition:SectionName} There is an XML Manager {Condition:ObjectName} configured with a scheduled-rule.</Name>
		<DisplayMessage>Rule {Condition:ConfigInfo} is ran every {Condition:TimeSeconds} seconds.</DisplayMessage>
		<URL description="If the system is suffering hangs, slowness in the webgui or transactions, identify if scheduled rules use XML-Mgmt or Rest-Mgmt, excessive traffic to these interfaces can slow the system: ">https://www.ibm.com/support/pages/node/6570351</URL>
		<Expression LogLevel="Info">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>((xml-manager \"([a-zA-Z-_.0-9]{0,40})\"|schedule-rule \"([a-zA-Z-_.0-9]{0,40})\"\s\"([0-9]{0,10})\")|exit)</RegExp>
			<Condition FieldPosition="3" RegGroup="Ordered" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="Ordered" ConditionName="ConfigInfo" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="5" RegGroup="Ordered" ConditionName="TimeSeconds" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<!-- track APAR IT06691 on 7.1.0.0 - 7.1.0.3 -->
	<Formula CollapseResult="true" FormulaID="NonXB7104FirmwareCheck">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="1" Operation="NotContain" Value="XB" NextOperation="And"/>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="4"/>
			</Expression>
	</Formula>

	<Formula Categories="configuration;failure">
		<Name>{Condition:SectionName} There is a logging target {Condition:ObjectName} configured for SMTP, this will throw invalid URL unless upgraded to 7.1.0.4.</Name>
		<URL description="APAR IT06691 (Fixed v7.1.0.4): ">https://www.ibm.com/support/docview.wss?uid=swg1IT06691</URL>
		<Expression LogLevel="Error" FormulaIDMatch="NonXB7104FirmwareCheck">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>((logging target \"([a-zA-Z-_.0-9]{0,40})\"|type (smtp))|exit)</RegExp>
			<Condition FieldPosition="3" RegGroup="Ordered" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="Ordered" ConditionName="SMTPCheck" Operation="EqualsTo" Value="smtp"/>
		</Expression>
	</Formula>
	<!-- end of IT06691 tracking -->
	
	<!-- tcp table handlers -->
	<Formula Categories="memory;cpuload;network" CollapseResult="true" CondenseCondition="CombinedIPPort" SortCondition="CondenseCondition" SortMethod="descending">
		<Name>{Condition:SectionName} (Backside) Local IP/Port(Ephemeral/Listener): &lt;font color='#CC0066'&gt;{Condition:localIP}:{Condition:localPort}&lt;/font&gt; - Remote IP/Port: &lt;font color='#CC0066'&gt;{Condition:RemoteIPAndPort}&lt;/font&gt;</Name>
		<Expression LogLevel="Info">
			<Section Name="TCPTable" Wildcard="True" XPath="/Status/TCPTable[state/text()!='listen' and serviceClass/text() = 'MQGW' and localIP/text() != '127.0.0.1']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="{/Status/TCPTable/serviceClass[../state/text()!='listen' and ../serviceClass/text() = 'MQGW' and ../localIP/text() != '127.0.0.1']}" ConditionName="ServiceClass" Operation="EqualsTo" Value="MQGW" NextOperation="And"/>
			<Condition FieldPosition="{/Status/TCPTable/localIP[../state/text()!='listen' and ../serviceClass/text() = 'MQGW' and ../localIP/text() != '127.0.0.1']}" ConditionName="localIP" Operation="NotEqualTo" Value="127.0.0.1" NextOperation="And"/>
			<Condition FieldPosition="{/Status/TCPTable/localPort[../state/text()!='listen' and ../serviceClass/text() = 'MQGW' and ../localIP/text() != '127.0.0.1']}" ConditionName="localPort" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/TCPTable/remoteIP[../state/text()!='listen' and ../serviceClass/text() = 'MQGW' and ../localIP/text() != '127.0.0.1']}" ConditionName="remoteIP" Operation="Append" Value=":" NextOperation="And"/>
			<Condition FieldPosition="{Condition:remoteIP}" ConditionName="RemoteIPAndPort" Operation="Append" Value="{/Status/TCPTable//remotePort[../state/text()!='listen' and ../serviceClass/text() = 'MQGW' and ../localIP/text() != '127.0.0.1']}" NextOperation="And"/>
			<Condition FieldPosition="{Condition:localIP}" ConditionName="LocalIPAndSpace" Operation="Append" Value=" , " NextOperation="And"/>
			<Condition FieldPosition="{Condition:LocalIPAndSpace}" ConditionName="CombinedIPPort" Operation="Append" Value="{Condition:RemoteIPAndPort}"/>
		</Expression>
	</Formula>
	
	<Formula Categories="memory;cpuload;network" CollapseResult="true" CondenseCondition="LocalIPAndPort" SortCondition="CondenseCondition" SortMethod="descending">
		<Name>{Condition:SectionName} (Front-Side) Domain: {Condition:serviceDomain}, Service Name: {Condition:serviceName} Local IP/Port: &lt;font color='#CC0066'&gt;{Condition:LocalIPAndPort}&lt;/font&gt;</Name>
		<Expression LogLevel="Info">
			<Section Name="TCPTable" Wildcard="True" XPath="/Status/TCPTable[state/text()!='listen' and serviceClass/text() != 'MQGW']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="{/Status/TCPTable/serviceClass[../state/text()!='listen' and ../serviceClass/text() != 'MQGW']}" ConditionName="ServiceClass" Operation="NotEqualTo" Value="MQGW" NextOperation="And"/>
			<Condition FieldPosition="{/Status/TCPTable/serviceDomain[../state/text()!='listen' and ../serviceClass/text() != 'MQGW']}" ConditionName="serviceDomain" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/TCPTable/serviceName[../state/text()!='listen' and ../serviceClass/text() != 'MQGW']}" ConditionName="serviceName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/TCPTable/localIP[../state/text()!='listen' and ../serviceClass/text() != 'MQGW']}" ConditionName="localIP" Operation="Append" Value=":" NextOperation="And"/>
			<Condition FieldPosition="{Condition:localIP}" ConditionName="LocalIPAndPort" Operation="Append" Value="{/Status/TCPTable/localPort[../state/text()!='listen' and ../serviceClass/text() != 'MQGW']}"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="TCPTable" Wildcard="True" XPath="/Status/TCPTable[state/text()='listen' and serviceClass/text() != 'None' and serviceClass/text() != 'MQGW']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="{/Status/TCPTable/serviceClass[../state/text()='listen' and ../serviceClass/text() != 'None' and ../serviceClass/text() != 'MQGW']}" ConditionName="ServiceClass" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/TCPTable/serviceDomain[../state/text()='listen' and ../serviceClass/text() != 'None' and ../serviceClass/text() != 'MQGW']}" ConditionName="serviceDomain" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/TCPTable/serviceName[../state/text()='listen' and ../serviceClass/text() != 'None' and ../serviceClass/text() != 'MQGW']}" ConditionName="serviceName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/TCPTable/localIP[../state/text()='listen' and ../serviceClass/text() != 'None' and ../serviceClass/text() != 'MQGW']}" ConditionName="localIP" Operation="Append" Value=":" NextOperation="And"/>
			<Condition FieldPosition="{Condition:localIP}" ConditionName="LocalIPAndPort" Operation="Append" Value="{/Status/TCPTable/localPort[../state/text()='listen' and ../serviceClass/text() != 'None' and ../serviceClass/text() != 'MQGW']}"/>
		</Expression>
	</Formula>
	
	<Formula Categories="memory;cpuload;network" CollapseResult="true" CondenseCondition="LocalIPAndPort" SortCondition="CondenseCondition" SortMethod="descending">
		<Name>{Condition:SectionName} (Loopback) Local IP/Port: &lt;font color='#CC0066'&gt;{Condition:LocalIPAndPort}&lt;/font&gt; RemotePort (Ephemeral/Listener): {Condition:remotePort}</Name>
		<Expression LogLevel="Info">
			<Section Name="TCPTable" Wildcard="True" XPath="/Status/TCPTable[state/text()!='listen' and localIP/text() = '127.0.0.1' and serviceClass/text() = 'MQGW']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="{/Status/TCPTable/localIP[../state/text()!='listen' and ../localIP/text() = '127.0.0.1' and ../serviceClass/text() = 'MQGW']}" ConditionName="localIP" Operation="EqualsTo" Value="127.0.0.1" NextOperation="And"/>
			<Condition FieldPosition="{/Status/TCPTable/remotePort[../state/text()!='listen' and ../localIP/text() = '127.0.0.1' and ../serviceClass/text() = 'MQGW']}" ConditionName="remotePort" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{Condition:localIP}" ConditionName="localIPAppended" Operation="Append" Value=":" NextOperation="And"/>
			<Condition FieldPosition="{Condition:localIPAppended}" ConditionName="LocalIPAndPort" Operation="Append" Value="{/Status/TCPTable/localPort[../state/text()!='listen' and ../localIP/text() = '127.0.0.1' and ../serviceClass/text() = 'MQGW']}"/>
		</Expression>
	</Formula>
	
	<!-- MQ appliance driven tcp tables -->
	<Formula Categories="memory;cpuload;network" CollapseResult="true" CondenseCondition="LocalIPAndPort" SortCondition="CondenseCondition" SortMethod="descending">
		<Name>{Condition:SectionName} (MQ Listeners) Local IP/Port: &lt;font color='#CC0066'&gt;{Condition:LocalIPAndPort}&lt;/font&gt;</Name>
		<Expression LogLevel="Info">
			<Section Name="TCPTable" Wildcard="True" XPath="/Status/TCPTable[state/text()='listen' and serviceClass/text() = 'None']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="{/Status/TCPTable/serviceClass[../state/text()='listen' and ../serviceClass/text() = 'None']}" ConditionName="ServiceClass" Operation="NotEqualTo" Value="MQGW" NextOperation="And"/>
			<!-- MQ appliance seems to not have serviceName or domain on the majority of its connections -->
			<Condition FieldPosition="{/Status/TCPTable/serviceDomain[../state/text()='listen' and ../serviceClass/text() = 'None']}" ConditionName="serviceDomain" Operation="EqualsTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/TCPTable/serviceName[../state/text()='listen' and ../serviceClass/text() = 'None']}" ConditionName="serviceName" Operation="EqualsTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/TCPTable/localIP[../state/text()='listen' and ../serviceClass/text() = 'None']}" ConditionName="localIP" Operation="Append" Value=":" NextOperation="And"/>
			<Condition FieldPosition="{Condition:localIP}" ConditionName="LocalIPAndPort" Operation="Append" Value="{/Status/TCPTable/localPort[../state/text()='listen' and ../serviceClass/text() = 'None']}"/>
		</Expression>
	</Formula>
	
	<Formula Categories="memory;cpuload;network" CollapseResult="true" CondenseCondition="LocalIPAndPort" SortCondition="CondenseCondition" SortMethod="descending">
		<Name>{Condition:SectionName} (Service Traffic) Local IP/Port: &lt;font color='#CC0066'&gt;{Condition:LocalIPAndPort}&lt;/font&gt;</Name>
		<Expression LogLevel="Info">
			<Section Name="TCPTable" Wildcard="True" XPath="/Status/TCPTable[state/text()!='listen' and serviceClass/text() = 'None']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="{/Status/TCPTable/serviceClass[../state/text()!='listen' and ../serviceClass/text() = 'None']}" ConditionName="ServiceClass" Operation="NotEqualTo" Value="MQGW" NextOperation="And"/>
			<!-- MQ appliance seems to not have serviceName or domain on the majority of its connections -->
			<Condition FieldPosition="{/Status/TCPTable/serviceDomain[../state/text()!='listen' and ../serviceClass/text() = 'None']}" ConditionName="serviceDomain" Operation="EqualsTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/TCPTable/serviceName[../state/text()!='listen' and ../serviceClass/text() = 'None']}" ConditionName="serviceName" Operation="EqualsTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/TCPTable/localIP[../state/text()!='listen' and ../serviceClass/text() = 'None']}" ConditionName="localIP" Operation="Append" Value=":" NextOperation="And"/>
			<Condition FieldPosition="{Condition:localIP}" ConditionName="LocalIPAndPort" Operation="Append" Value="{/Status/TCPTable/localPort[../state/text()!='listen' and ../serviceClass/text() = 'None']}"/>
		</Expression>
	</Formula>
	<!-- MQ appliance driven tcp tables end -->
	
	<!-- end tcp table handling -->
	
	<Formula Categories="configuration;memory;failure;cpuload" CollapseResult="true">
		<Name>[Sidecar Data] {Condition:SectionName}: {Condition:FileDescriptor} Sidecar: {Condition:SidecarName}</Name>
		<Expression LogLevel="Info">
			<Section Name="&lt;FileDescriptors@datapower.ibm.com&gt;" XPath="/Root/text()"/>
			<RegExp>([0-9]+)\s+[a-z]{1}\s+-\s+-\s+ramdisk2/sidecar-([a-zA-Z_.0-9\-]+)</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="FileDescriptor" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="SidecarName" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<!-- todo: After April we need to set fixpack checks -->
	<Formula Categories="configuration;memory;failure;cpuload">
		<Name>{Condition:SectionName} - reports a count of {Condition:DisableEntries} disable cache or flush entries.  If this count is high and customer experiences instability, watchdog or latency type issues review urlrefresh objects in this domain for duplicate attributes such as disable cache and flush.</Name>
		<URL description="IT03762: URLREFRESH CONFIGURATION PROPERTIES CONTAINS DUPLICATE ENTRIES (6.0.0.13, 6.0.1.9, 7.0.0.6, 7.1.0.5): ">https://www.ibm.com/support/docview.wss?uid=swg1IT03762</URL>
		<Expression LogLevel="Error">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>(disable cache|disable flush).*</RegExp>
			<Condition FieldPosition="1" RegGroup="Count" ConditionName="DisableEntries" Operation="GreaterThan" Value="1000"/>
		</Expression>
	</Formula>
	
	

	<Formula CollapseResult="true" FormulaID="APAR-IT11825-IT11824-Fixpacks">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="11"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="8"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="2" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="2"/>
			</Expression>
	</Formula>
	
	<Formula Categories="configuration;cpuload">
		<Name>{Condition:SectionName} Domain {/Status//DomainStatus/Domain} is currently running the command {Condition:CurrentCommand}, review WebGUI Domain Status or CLI show domains to see if secure-backup command persists. If command persists, reload or reboot may be required to resolve.</Name>
		<URL FormulaIDMatch="APAR-IT11825-IT11824-Fixpacks" description="IT11825: USING SECURE BACKUP CAN LEAD TO UNEXPECTED BEHAVIOR INCLUDING HUNG TRANSACTIONS AND RESTARTS (6.0.0.18, 6.0.1.14, 7.0.0.11, 7.1.0.8 and 7.2.0.2): ">https://www.ibm.com/support/docview.wss?uid=swg1IT11825</URL>
		<URL FormulaIDMatch="APAR-IT11825-IT11824-Fixpacks" description="IT11824: IN RARE CASES, USING SECURE BACKUP CAN LEAD TO UNEXPECTED BEHAVIOR INCLUDING RESTARTS OR HUNG TRANSACTIONS. (6.0.0.18, 6.0.1.14, 7.0.0.11, 7.1.0.8 and 7.2.0.2): ">https://www.ibm.com/support/docview.wss?uid=swg1IT11824</URL>
		<URL FormulaIDMatch="APAR-IT10598-OR-IT11147-Fixpacks" description="IT10598: SECURE-BACKUP MAY CAUSE DEVICE TO HANG UNEXPECTEDLY (6.0.0.17, 6.0.1.13, 7.0.0.10, 7.1.0.7, 7.2.0.2): ">https://www.ibm.com/support/docview.wss?uid=swg1IT10598</URL>
		<URL description="Best Practices on secure-backup and restore: ">https://www.ibm.com/developerworks/websphere/library/techarticles/1009_furbee/1009_furbee.html</URL>
		<URL description="Backing up, exporting and importing the configuration of an IBM WebSphere DataPower SOA Appliance or Virtual Edition: ">https://www.ibm.com/support/pages/node/135091</URL>
		<Expression LogLevel="Critical">
			<Section Name="DomainStatus" XPath="/Status//DomainStatus/CurrentCommand"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="CurrentCommand" Operation="EqualsTo" Value="secure-backup"/>
		</Expression>
	</Formula> 
	
	<Formula Categories="configuration;cpuload">
		<Name>Domain {/Status//DomainStatus/Domain} is currently running the command {Condition:CurrentCommand} (Warning!).</Name>
		<Expression LogLevel="Warning">
			<Section Name="DomainStatus" XPath="/Status//DomainStatus/CurrentCommand"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="CurrentCommand" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" ConditionName="CurrentCommand" Operation="NotEqualTo" Value="secure-backup"/>
		</Expression>
	</Formula> 
	
	<Formula Categories="configuration;network">
		<Name>Domain {/Status//DomainStatus/Domain} is currently in state {Condition:QuiesceState} (Warning!).</Name>
		<URL description="IBM Knowledge Center Quiescence Overview: ">https://www.ibm.com/docs/en/datapower-gateway/10.6.0?topic=itself-quiescence</URL>
		<Expression LogLevel="Warning">
			<Section Name="DomainStatus" XPath="/Status//DomainStatus/QuiesceState"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="QuiesceState" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula> 
	
		<!-- track APAR IT09552 on fixpacks below 6.0.0.16, 6.0.1.12, 7.0.0.9, 7.1.0.6 and 7.2.0.2 -->
	<Formula CollapseResult="true" FormulaID="APAR-IT09552-7.0LaterVersionChecks">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="9"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="6"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="2" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="2"/>
			</Expression>
	</Formula>

	<Formula Categories="configuration;memory" FormulaID="APAR-IT09552">
		<Name>{Condition:SectionName} There is a logging target {Condition:ObjectName} configured for SFTP, temporary space may be exhausted when remote endpoint is unavailable.</Name>
		<URL FormulaIDMatch="APAR-IT09552-7.0LaterVersionChecks" description="IT09552: ARCHIVE MODE LOG TARGET MAY CONSUME TEMPORARY SPACE IF REMOTE SERVER IS DOWN (Fixed in 7.0.0.9, 7.1.0.6 and 7.2.0.2): ">https://www.ibm.com/support/docview.wss?uid=swg1IT09552</URL>
		<Expression LogLevel="Critical" FormulaIDMatch="APAR-IT09552-7.0LaterVersionChecks">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>logging target \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(archive-mode ([a-zA-Z]+)|exit)</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" Operation="EqualsTo" Value="upload" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" Operation="EqualsTo" Value="sftp">logging target \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(upload-method ([a-zA-Z]+)|exit)</Condition>
		</Expression>
	</Formula>
	<!-- end of IT09552 tracking -->
		
	<!-- Import Package / Execute AND Auto Execute Search -->
	<Formula Categories="configuration">
		<Name>{Condition:SectionName} Found {Condition:ObjectName} package is NOT configured with auto-execute OFF</Name>
		<DisplayMessage>{Condition:ObjectName} is NOT configured with auto-execute OFF, this causes the configuration not to be saved to the persisted (startup) configuration.</DisplayMessage>
		<Expression LogLevel="Critical">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\b(import-package \"([a-zA-Z-_0-9]+).*"\W+(\w+\W+)*?exit)\b</RegExp>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ConfigInfo" Operation="NotContain" Value="no auto-execute"/>
		</Expression>
	</Formula>
	<!-- End of Import Package / Execute AND Auto Execute Search -->
	
	<!-- tracking mq-qm-group causing source-mq/fte not to come up correctly APAR IT15701 -->
	<Formula Categories="configuration;failure">
		<Name>&lt;font color='#CC3300'&gt;{Condition:SectionName}&lt;/font&gt; There is an Source-MQ Object &lt;font color='#CC3300'&gt;{Condition:SourceMQName}&lt;/font&gt; configured with QM Group &lt;font color='#CC3300'&gt;{Condition:QueueManagerName}&lt;/font&gt; and &lt;font color='#CC3300'&gt;{Condition:PrimaryQueue}&lt;/font&gt; as a primary queue.  Source-MQ or MQFTE objects may fail to configure correctly, invalid property 'Queue Manager', Review APAR IT15701.</Name>
		<URL description="IT15701 (Fixed in 7.5.0.3 and 7.5.1.2): MQ &amp; MQFTE FRONT SIDE HANDLER IS REMOVED FROM THE CONFIGURATION WHEN USING A QUEUE MANAGER GROUP IN THE QUEUE MANAGER FIELD: ">https://www.ibm.com/support/docview.wss?uid=swg1IT15701</URL>
		<Expression LogLevel="Critical" FormulaIDMatch="APARCHECK:IT15995,IT15701">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="SourceMQName" Operation="NotEqualTo" Value="" NextOperation="And">source-mq[fte]{0,3} \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(queue-manager ([a-zA-Z-_.0-9]+)|exit)</Condition>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="QueueManagerName" Operation="NotEqualTo" Value="" NextOperation="And">source-mq[fte]{0,3} \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(queue-manager ([a-zA-Z-_.0-9]+)|exit)</Condition>
			<Condition FieldPosition="4" RegGroup="AllResult" ConditionName="PrimaryQueue" Operation="NotEqualTo" Value="">mq-qm-group \"({Condition:QueueManagerName})\"\W+(\w+\W+)*?(primary ([a-zA-Z-_.0-9]+)|exit)</Condition>
		</Expression>
	</Formula>
	<!-- end APAR IT15701 check -->
	
	<!-- new test MQ formula for AllResult RegGroup ( mq-qm backout settings required for units-of-work ) -->
	<Formula Categories="configuration;cpuload;memory" FormulaID="MQBadPracticeBackoutSettingsPrimary">
		<Name>&lt;font color='#CC3300'&gt;{Condition:SectionName}&lt;/font&gt; There is an Source-MQ Object &lt;font color='#CC3300'&gt;{Condition:SourceMQName}&lt;/font&gt; configured with QM Group &lt;font color='#CC3300'&gt;{Condition:QueueManagerName}&lt;/font&gt; and &lt;font color='#CC3300'&gt;{Condition:PrimaryQueue}&lt;/font&gt; as the primary queue.</Name>
		<DisplayMessage>When using units-of-work on the MQ-QM, the best practice is for the MQ-QM to have automatic-backout on and the source-mq or source-mqfte object to have retrieve-backout-settings off.  Having retrieve-backout-settings 'on' may cause higher resource consumption (memory/cpu/load).</DisplayMessage>
		<URL description="Best practices for integrating IBM WebSphere DataPower SOA Appliances with WebSphere MQ(automatic backout ON with units-of-work is best practice): ">https://www.ibm.com/developerworks/websphere/library/techarticles/1410_sahoo/1410_sahoo.html</URL>
		<URL description="Backout Settings Required with units-of-work: ">https://www.ibm.com/docs/en/datapower-gateway/10.6.0?topic=mq-units-work</URL>
		<Expression LogLevel="Warning">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="SourceMQName" Operation="NotEqualTo" Value="" NextOperation="And">source-mq[fte]{0,3} \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(queue-manager ([a-zA-Z-_.0-9]+)|exit)</Condition>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="QueueManagerName" Operation="NotEqualTo" Value="" NextOperation="And">source-mq[fte]{0,3} \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(queue-manager ([a-zA-Z-_.0-9]+)|exit)</Condition>
			<!-- fixed to pull only source-mq with retrieve-backout-settings on -->
			<Condition FieldPosition="3" RegGroup="All" Operation="EqualsTo" Value="retrieve-backout-settings" NextOperation="And">source-mq[fte]{0,3} \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?((?&lt;!no )retrieve-backout-settings|exit)</Condition>
			<Condition FieldPosition="4" RegGroup="AllResult" ConditionName="PrimaryQueue" Operation="NotEqualTo" Value="" NextOperation="And">mq-qm-group \"({Condition:QueueManagerName})\"\W+(\w+\W+)*?(primary ([a-zA-Z-_.0-9]+)|exit)</Condition>
			<Condition FieldPosition="3" RegGroup="AllResult" Operation="EqualsTo" Value="exit" NextOperation="And">mq-qm \"({Condition:PrimaryQueue})\"\W+(\w+\W+)*?((?&lt;!no )automatic-backout|exit)</Condition>
			<Condition FieldPosition="3" RegGroup="AllResult" Operation="NotEqualTo" Value="exit">mq-qm \"({Condition:PrimaryQueue})\"\W+(\w+\W+)*?(units-of-work [1-9]+|exit)</Condition>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;cpuload;memory" FormulaID="MQBadPracticeBackoutSettingsBackup">
		<Name>&lt;font color='#CC3300'&gt;{Condition:SectionName}&lt;/font&gt; There is an Source-MQ Object &lt;font color='#CC3300'&gt;{Condition:SourceMQName}&lt;/font&gt; configured with QM Group &lt;font color='#CC3300'&gt;{Condition:QueueManagerName}&lt;/font&gt; and &lt;font color='#CC3300'&gt;{Condition:BackupQueue}&lt;/font&gt; as the backup queue.</Name>
		<DisplayMessage>When using units-of-work on the MQ-QM, the best practice is for the MQ-QM to have automatic-backout on and the source-mq or source-mqfte object to have retrieve-backout-settings off.  Having retrieve-backout-settings 'on' may cause higher resource consumption (memory/cpu/load).</DisplayMessage>
		<URL description="Best practices for integrating IBM WebSphere DataPower SOA Appliances with WebSphere MQ(automatic backout ON with units-of-work is best practice): ">https://www.ibm.com/developerworks/websphere/library/techarticles/1410_sahoo/1410_sahoo.html</URL>
		<URL description="Backout Settings Required with units-of-work: ">https://www.ibm.com/docs/en/datapower-gateway/10.6.0?topic=mq-units-work</URL>
		<Expression LogLevel="Warning">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="SourceMQName" Operation="NotEqualTo" Value="" NextOperation="And">source-mq[fte]{0,3} \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(queue-manager ([a-zA-Z-_.0-9]+)|exit)</Condition>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="QueueManagerName" Operation="NotEqualTo" Value="" NextOperation="And">source-mq[fte]{0,3} \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(queue-manager ([a-zA-Z-_.0-9]+)|exit)</Condition>
			<!-- fixed to pull only source-mq with retrieve-backout-settings on -->
			<Condition FieldPosition="3" RegGroup="All" Operation="EqualsTo" Value="retrieve-backout-settings" NextOperation="And">source-mq[fte]{0,3} \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?((?&lt;!no )retrieve-backout-settings|exit)</Condition>
			<Condition FieldPosition="4" RegGroup="AllResult" ConditionName="BackupQueue" Operation="NotEqualTo" Value="" NextOperation="And">mq-qm-group \"({Condition:QueueManagerName})\"\W+(\w+\W+)*?(backup ([a-zA-Z-_.0-9]+)|exit)</Condition>
			<Condition FieldPosition="3" RegGroup="AllResult" Operation="EqualsTo" Value="exit" NextOperation="And">mq-qm \"({Condition:BackupQueue})\"\W+(\w+\W+)*?((?&lt;!no )automatic-backout|exit)</Condition>
			<Condition FieldPosition="3" RegGroup="AllResult" Operation="NotEqualTo" Value="exit">mq-qm \"({Condition:BackupQueue})\"\W+(\w+\W+)*?(units-of-work [1-9]+|exit)</Condition>
		</Expression>
	</Formula>

	<Formula Categories="configuration;cpuload;memory" FormulaID="MQBadPracticeBackoutSettingsNoMQGroup">
		<Name>&lt;font color='#CC3300'&gt;{Condition:SectionName}&lt;/font&gt; There is an Source-MQ Object &lt;font color='#CC3300'&gt;{Condition:SourceMQName}&lt;/font&gt; configured with the queue manager &lt;font color='#CC3300'&gt;{Condition:QueueManagerName}&lt;/font&gt;.</Name>
		<DisplayMessage>When using units-of-work on the MQ-QM, the best practice is for the MQ-QM to have automatic-backout on and the source-mq or source-mqfte object to have retrieve-backout-settings off.  Having retrieve-backout-settings 'on' may cause higher resource consumption (memory/cpu/load).</DisplayMessage>
		<URL description="Best practices for integrating IBM WebSphere DataPower SOA Appliances with WebSphere MQ(automatic backout ON with units-of-work is best practice): ">https://www.ibm.com/developerworks/websphere/library/techarticles/1410_sahoo/1410_sahoo.html</URL>
		<URL description="Backout Settings Required with units-of-work: ">https://www.ibm.com/docs/en/datapower-gateway/10.6.0?topic=mq-units-work</URL>
		<Expression LogLevel="Warning">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="SourceMQName" Operation="NotEqualTo" Value="" NextOperation="And">source-mq[fte]{0,3} \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(queue-manager ([a-zA-Z-_.0-9]+)|exit)</Condition>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="QueueManagerName" Operation="NotEqualTo" Value="" NextOperation="And">source-mq[fte]{0,3} \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(queue-manager ([a-zA-Z-_.0-9]+)|exit)</Condition>
			<!-- fixed to pull only source-mq with retrieve-backout-settings on -->
			<Condition FieldPosition="3" RegGroup="All" Operation="EqualsTo" Value="retrieve-backout-settings" NextOperation="And">source-mq[fte]{0,3} \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?((?&lt;!no )retrieve-backout-settings|exit)</Condition>
			<Condition FieldPosition="3" RegGroup="AllResult" Operation="EqualsTo" Value="exit" NextOperation="And">mq-qm \"({Condition:QueueManagerName})\"\W+(\w+\W+)*?((?&lt;!no )automatic-backout|exit)</Condition>
			<Condition FieldPosition="3" RegGroup="AllResult" Operation="NotEqualTo" Value="exit">mq-qm \"({Condition:QueueManagerName})\"\W+(\w+\W+)*?(units-of-work [1-9]+|exit)</Condition>
		</Expression>
	</Formula>
	<!-- end of mq-qm backout settings required for units-of-work -->
	
	
	<!-- tracking of IT39342 -->
	<Formula CollapseResult="true" FormulaID="APARCHECK:IT39342">
		<Expression LogLevel="Info">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
			<RegExp>([A-Z]{2,4})[0-9]{0,2}.(((10|2018|2019|20[2-9][0-9])\.(\d+)\.(\d+))\.(\d+))([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="2018" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="EqualsTo" Value="4" NextOperation="And"/>
			<Condition FieldPosition="6" Operation="EqualsTo" Value="1" NextOperation="And"/>
			<Condition FieldPosition="7" Operation="LessThan" Value="19"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
			<RegExp>([A-Z]{2,4})[0-9]{0,2}.(((10|2018|2019|20[2-9][0-9])\.(\d+)\.(\d+))\.(\d+))([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="10" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="6" Operation="EqualsTo" Value="1" NextOperation="And"/>
			<Condition FieldPosition="7" Operation="LessThan" Value="6"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;failure;memory">
		<Name>&lt;font color='#CC3300'&gt;{Condition:SectionName}&lt;/font&gt; There is an Source-MQ FTE Object &lt;font color='#CC3300'&gt;{Condition:SourceMQName}&lt;/font&gt;, configured with QM Group &lt;font color='#CC3300'&gt;{Condition:QueueManagerName}&lt;/font&gt;.  This may be susceptible to a memory leak/growth issue that can cause low memory throttle or unexpected reloads (with out of memory tracing).</Name>
		<URL description="IT39342 (Fixed in 2018.4.1.19, 10.0.1.6): DATAPOWER MAY GROW IN MEMORY WHEN MQFTE URL OPENER OR SOURCE-MQFTE FAILS TO PUT MESSAGES: ">https://www.ibm.com/support/pages/apar/IT39342</URL>
		<Expression LogLevel="Critical" FormulaIDMatch="APARCHECK:IT39342">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="SourceMQName" Operation="NotEqualTo" Value="" NextOperation="And">source-mqfte \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(queue-manager ([a-zA-Z-_.0-9]+)|exit)</Condition>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="QueueManagerName" Operation="NotEqualTo" Value="">source-mqfte \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(queue-manager ([a-zA-Z-_.0-9]+)|exit)</Condition>
		</Expression>
	</Formula>
	
	<!-- tracking of IT25471 -->
	<Formula CollapseResult="true" FormulaID="APARCHECK:IT25471">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.0" NextOperation="And"/>
				<!-- fixed in 7.5.0.18 -->
				<Condition FieldPosition="3" Operation="LessThan" Value="18"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.1" NextOperation="And"/>
				<!-- fixed in 7.5.1.17 -->
				<Condition FieldPosition="3" Operation="LessThan" Value="17"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.2" NextOperation="And"/>
				<!-- fixed in 7.5.2.17 -->
				<Condition FieldPosition="3" Operation="LessThan" Value="17"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.6.0" NextOperation="And"/>
				<!-- fixed in 7.6.0.10 -->
				<Condition FieldPosition="3" Operation="LessThan" Value="10"/>
			</Expression>
			<!-- never fixed in 7.7.0.x or 7.7.1.x -->
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.7.0"/>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.7.1"/>
			</Expression>
	</Formula>
	
	<Formula Categories="configuration;failure" FormulaID="MQUnitsOfWorkAPARIT25471PrimaryGroup">
		<Name>&lt;font color='#CC3300'&gt;{Condition:SectionName}&lt;/font&gt; There is an Source-MQ FTE Object &lt;font color='#CC3300'&gt;{Condition:SourceMQName}&lt;/font&gt; utilizing units-of-work, configured with QM Group &lt;font color='#CC3300'&gt;{Condition:QueueManagerName}&lt;/font&gt; and &lt;font color='#CC3300'&gt;{Condition:GroupQMName}&lt;/font&gt; as the primary queue.</Name>
		<URL description="IT25471 (Fixed in 7.5.0.18, 7.5.1.17, 7.5.2.17, 7.6.0.10): DEVICE MAY RELOAD UNEXPECTEDLY DUE TO MQ ROLLBACK WHEN UNITS OF WORK IS GREATER THAN 0: ">https://www.ibm.com/support/docview.wss?uid=swg1IT25471</URL>
		<Expression LogLevel="Critical" FormulaIDMatch="APARCHECK:IT25471">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="SourceMQName" Operation="NotEqualTo" Value="" NextOperation="And">source-mqfte \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(queue-manager ([a-zA-Z-_.0-9]+)|exit)</Condition>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="QueueManagerName" Operation="NotEqualTo" Value="" NextOperation="And">source-mqfte \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(queue-manager ([a-zA-Z-_.0-9]+)|exit)</Condition>
			<Condition FieldPosition="4" RegGroup="AllResult" ConditionName="GroupQMName" Operation="NotEqualTo" Value="" NextOperation="And">mq-qm-group \"({Condition:QueueManagerName})\"\W+(\w+\W+)*?(primary ([a-zA-Z-_.0-9]+)|exit)</Condition>
			<Condition FieldPosition="3" RegGroup="AllResult" Operation="NotEqualTo" Value="exit">mq-qm \"({Condition:GroupQMName})\"\W+(\w+\W+)*?(units-of-work [1-9]+|exit)</Condition>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;failure" FormulaID="MQUnitsOfWorkAPARIT25471BackupGroup">
		<Name>&lt;font color='#CC3300'&gt;{Condition:SectionName}&lt;/font&gt; There is an Source-MQ FTE Object &lt;font color='#CC3300'&gt;{Condition:SourceMQName}&lt;/font&gt; utilizing units-of-work, configured with QM Group &lt;font color='#CC3300'&gt;{Condition:QueueManagerName}&lt;/font&gt; and &lt;font color='#CC3300'&gt;{Condition:GroupQMName}&lt;/font&gt; as the backup queue.</Name>
		<URL description="IT25471 (Fixed in 7.5.0.18, 7.5.1.17, 7.5.2.17, 7.6.0.10): DEVICE MAY RELOAD UNEXPECTEDLY DUE TO MQ ROLLBACK WHEN UNITS OF WORK IS GREATER THAN 0: ">https://www.ibm.com/support/docview.wss?uid=swg1IT25471</URL>
		<Expression LogLevel="Critical" FormulaIDMatch="APARCHECK:IT25471">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="SourceMQName" Operation="NotEqualTo" Value="" NextOperation="And">source-mqfte \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(queue-manager ([a-zA-Z-_.0-9]+)|exit)</Condition>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="QueueManagerName" Operation="NotEqualTo" Value="" NextOperation="And">source-mqfte \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(queue-manager ([a-zA-Z-_.0-9]+)|exit)</Condition>
			<Condition FieldPosition="4" RegGroup="AllResult" ConditionName="GroupQMName" Operation="NotEqualTo" Value="" NextOperation="And">mq-qm-group \"({Condition:QueueManagerName})\"\W+(\w+\W+)*?(backup ([a-zA-Z-_.0-9]+)|exit)</Condition>
			<Condition FieldPosition="3" RegGroup="AllResult" Operation="NotEqualTo" Value="exit">mq-qm \"({Condition:GroupQMName})\"\W+(\w+\W+)*?(units-of-work [1-9]+|exit)</Condition>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;failure" FormulaID="MQUnitsOfWorkAPARIT25471NoGroup">
		<Name>&lt;font color='#CC3300'&gt;{Condition:SectionName}&lt;/font&gt; There is an Source-MQ FTE Object &lt;font color='#CC3300'&gt;{Condition:SourceMQName}&lt;/font&gt; utilizing units-of-work, configured with the queue manager &lt;font color='#CC3300'&gt;{Condition:QueueManagerName}&lt;/font&gt;.</Name>
		<URL description="IT25471 (Fixed in 7.5.0.18, 7.5.1.17, 7.5.2.17, 7.6.0.10): DEVICE MAY RELOAD UNEXPECTEDLY DUE TO MQ ROLLBACK WHEN UNITS OF WORK IS GREATER THAN 0: ">https://www.ibm.com/support/docview.wss?uid=swg1IT25471</URL>
		<Expression LogLevel="Critical" FormulaIDMatch="APARCHECK:IT25471">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="SourceMQName" Operation="NotEqualTo" Value="" NextOperation="And">source-mqfte \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(queue-manager ([a-zA-Z-_.0-9]+)|exit)</Condition>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="QueueManagerName" Operation="NotEqualTo" Value="" NextOperation="And">source-mqfte \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(queue-manager ([a-zA-Z-_.0-9]+)|exit)</Condition>
			<Condition FieldPosition="3" RegGroup="AllResult" Operation="NotEqualTo" Value="exit">mq-qm \"({Condition:QueueManagerName})\"\W+(\w+\W+)*?(units-of-work [1-9]+|exit)</Condition>
		</Expression>
	</Formula>
	<!-- end of tracking APAR IT25471 -->

	<Formula CollapseResult="true" FormulaID="APARIT09304FWCheck">
		<Expression LogLevel="Warning">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="9"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="1" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="6"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="2" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="2"/>
		</Expression>
	</Formula>
	
	<Formula Categories="failure;general;cpuload">
		<Name>APAR IT09304 may cause instability at the current firmware level including unexpected reloads (can also occur if VIRTUAL with CPU HOTPLUG ENABLED) - {Condition:CPUs} CPUs.</Name>
		<DisplayMessage>Disabling CPU hotplug in the VM config and rebooting the DP VMs workaround: Power VM's off, In vSphere Client: click the VM, Summary tab - Edit Settings - Options tab - Disable Memory/CPU Hotplug</DisplayMessage>
		<URL description="IT09304: APPLIANCES WITH 40 CPUS AND MORE MAY UNEXPECTEDLY RESTART: ">https://www.ibm.com/support/docview.wss?uid=swg1IT09304</URL>
		<Expression LogLevel="Critical" FormulaIDMatch="APARIT09304FWCheck">
			<Section Name="Hypervisor" Wildcard="True" XPath="/Status//*[starts-with(local-name(),'Hypervisor')]/VirtualCPUs"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="CPUs" Operation="GreaterThan" Value="39"/>
		</Expression>
		<!-- check for virtual devices if the amount of CPUs is not greater than 39 as this issue can occur on VM due to hotplug despite cpu count -->
		<Expression LogLevel="Critical" FormulaIDMatch="APARIT09304FWCheck" NextOperation="And">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//MachineType"/>
			<Section Name="FirmwareVersion" XPath="/Status/FirmwareVersion//MachineType"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MachineType" Operation="EqualsTo" Value="5725"/>
		</Expression>
		<!-- since the previous 'GreaterThan' 39 CPU's check did not match we still need to assign the CPUs condition -->
		<Expression LogLevel="Critical">
			<Section Name="Hypervisor" Wildcard="True" XPath="/Status//*[starts-with(local-name(),'Hypervisor')]/VirtualCPUs"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="CPUs" Operation="GreaterThan" Value="0"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;cpuload" FormulaID="SQLSourceDebug">
		<Name>&lt;font color='#CC3300'&gt;{Condition:SectionName}&lt;/font&gt; There is an SQL-Source &lt;font color='#CC3300'&gt;{Condition:SQLName}&lt;/font&gt; configured with a sql-config-param 'TraceFile', this may create files that consume the filesystem, review SQL-Debug files (.cli).</Name>
		<DisplayMessage>Trace file configured to {Condition:FileDirectory}.</DisplayMessage>
		<URL description="query-timeout in sql-source: ">https://www.ibm.com/docs/en/datapower-gateway/10.6.0?topic=commands-query-timeout</URL>
		<URL description="MustGather: Collecting data when experiencing ODBC issues on IBM WebSphere DataPower SOA Appliances: ">https://www.ibm.com/support/pages/node/144889</URL>
		<Expression LogLevel="Critical">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>sql-source \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(sql-config-param \"TraceFile\" \"([a-zA-Z-_.0-9:/]+)\"|exit)</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="SQLName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="FileDirectory" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;cpuload">
		<Name>&lt;font color='#CC3300'&gt;{Condition:SectionName}&lt;/font&gt; There is an SQL-Source &lt;font color='#CC3300'&gt;{Condition:SQLName}&lt;/font&gt; configured with a query-timeout=&lt;font color='#006666'&gt;{Condition:QueryTimeout} second(s)&lt;/font&gt; shorter or equal to the connect-timeout=&lt;font color='#006666'&gt;{Condition:ConnectTimeout} second(s)&lt;/font&gt;.</Name>
		<DisplayMessage>Depending on connection delay, queries may fail due to shorter query timeout (query timeout should be greater than connection timeout)</DisplayMessage>
		<URL description="query-timeout in sql-source: ">https://www.ibm.com/docs/en/datapower-gateway/10.6.0?topic=commands-query-timeout</URL>
		<URL description="MustGather: Collecting data when experiencing ODBC issues on IBM WebSphere DataPower SOA Appliances: ">https://www.ibm.com/support/pages/node/144889</URL>
		<Expression LogLevel="Critical">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="SQLName" Operation="NotEqualTo" Value="" NextOperation="And">sql-source \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(query-timeout ([0-9]+)|exit)</Condition>
			<Condition FieldPosition="3" RegGroup="All" Operation="NotEqualTo" Value="exit" NextOperation="And">sql-source \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(query-timeout ([0-9]+)|exit)</Condition>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="QueryTimeout" Operation="NotEqualTo" Value="0" NextOperation="And">sql-source \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(query-timeout ([0-9]+)|exit)</Condition>
			<Condition FieldPosition="3" RegGroup="All" Operation="NotEqualTo" Value="exit" NextOperation="And">sql-source \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(connect-timeout ([0-9]+)|exit)</Condition>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="ConnectTimeout" Operation="NotEqualTo" Value="" NextOperation="And">sql-source \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(connect-timeout ([0-9]+)|exit)</Condition>
			<Condition FieldPosition="{Condition:QueryTimeout}" RegGroup="All" Operation="Subtract" ConditionName="ResultValue" Value="{Condition:ConnectTimeout}" NextOperation="And">sql-source \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(connect-timeout ([0-9]+)|exit)</Condition>
			<Condition FieldPosition="{Condition:ResultValue}" RegGroup="All" Operation="LessThan" Value="1">sql-source \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(connect-timeout ([0-9]+)|exit)</Condition>
		</Expression>
	</Formula>
	
	<Formula Categories="memory" SortCondition="Size" SortMethod="Descending" SumCondition="Size">
		<Name>{Condition:SectionName} Possible SQL-Debug File {Condition:FileName} size {Condition:Size} bytes.</Name>
		<Expression LogLevel="Critical" FormulaIDMatch="SQLSourceDebug" NextOperation="And">
			<Section Name="FlashFiles" XPath="/flash/file[contains(text(),'.cli') or contains(text(),'.trace')]"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="FileName" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Critical" FormulaIDMatch="SQLSourceDebug">
			<Section Name="FlashFiles" XPath="/flash/file[contains(text(),'.cli') or contains(text(),'.trace')]/@size"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="Size" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;failure">
		<Name>{Condition:ResultGWSText}</Name>
		<URL description="Experiencing High Compilation Times for GatewayScripts on the IBM DataPower Gateway Docker Edition: ">https://www.ibm.com/support/pages/node/6091012</URL>
		<Expression LogLevel="Critical">
			<Section Name="FlashFiles" XPath="/flash/file[text() = 'etc/gatewayscript_action_disabled']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="FileName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="ResultGWSText" Value="GatewayScript has been disabled with 'diag; set-gatewayscript [enabled|disabled]', GatewayScript (.js) will not run with this feature disabled."/>
		</Expression>
		<Expression LogLevel="Critical" ExpressionGroup="GWSCacheReset">
			<Section Name="FlashFiles" XPath="/flash/file[text() = 'root/secure/gatewayscript_cache_disabled']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="FileName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="-1" Operation="Append" ConditionName="ResultGWSText" Value="GatewayScript Cache has been disabled with 'diag; set-gatewayscript-cache [enabled|disabled]', GatewayScript (.js) will be required to compile on each transactional run."/>
		</Expression>
	</Formula>
		
	<Formula Categories="configuration;failure">
		<Name>{Condition:SectionName} &lt;font color='#006666'&gt;{Condition:ObjectName}&lt;/font&gt; : Class &lt;font color='#006666'&gt;{Condition:ObjectClass}&lt;/font&gt; is currently down.</Name>
		<DisplayMessage>{Condition:SectionName} {Condition:ObjectName}||{Condition:ObjectClass}||{Condition:ErrorCode}</DisplayMessage>
		<Expression LogLevel="Warning" NextOperation="And">
			<Section Name="ObjectStatus" Wildcard="True" XPath="/Status/ObjectStatus/OpState[text() = 'down']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" TableMapPosition="-2" ConditionName="OpState" Operation="EqualsTo" Value="down"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="And">
			<Section Name="ObjectStatus" Wildcard="True" XPath="/Status/ObjectStatus/AdminState[../OpState/text() = 'down']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" TableMapPosition="-2" ConditionName="AdminState" Operation="EqualsTo" Value="enabled"/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="And">
			<Section Name="ObjectStatus" Wildcard="True" XPath="/Status/ObjectStatus/Name[../OpState/text() = 'down']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" TableMapPosition="0" ConditionName="ObjectName" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="And">
			<Section Name="ObjectStatus" Wildcard="True" XPath="/Status/ObjectStatus/Class[../OpState/text() = 'down']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" TableMapPosition="1" ConditionName="ObjectClass" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="ObjectStatus" Wildcard="True" XPath="/Status/ObjectStatus/ErrorCode[../OpState/text() = 'down']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" TableMapPosition="2" ConditionName="ErrorCode" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	
	<!-- Crypto runtime issue -->
	<Formula Categories="failure;general;cpuload"  SortCondition="Timestamp" SortMethod="descending">
		<Name>{Condition:Timestamp} : The Crypto Engine threw an error.</Name>
		<DisplayMessage>{Condition:Reason}.  This may have disrupted some cryptography or signing functionality.</DisplayMessage>
		<URL description="Review co; crypto-fallback output in CLI, fallback=true means we stopped using crypto hardware and using software: ">TBD</URL>
		<Expression LogLevel="Critical">
			<Section Name="default-log" Wildcard="True" XPath="/Root/text()" ReadNextSection="True"/>
			<Section Name="DefaultLogBeforeReload" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".log" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>Runtime error detected in crypto engine</IndexSearch>
			<RegExp>([0-9TZ.]{16,20}) \[0x8060016b\]\[crypto\]\[critic\] : tid\(([0-9]*)\): (Runtime error detected in crypto engine \(code: [0-9]+, count: [0-9]+\))</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="Reason" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula CollapseResult="true" FormulaID="APARCHECK:IT14456,IT15693,IT14708,IT14996">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="14"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="11"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="2" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="8"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="5" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="2"/>
			</Expression>
	</Formula>
	
	<Formula Categories="configuration;failure;cpuload">
		<Name>{Condition:SectionName} sql-runtime-settings has enable-sharing ENABLED, this may cause HIGH CPU usage.  Review APAR details for APAR IT14456.</Name>
		<URL FormulaIDMatch="APARCHECK:IT14456,IT15693,IT14708,IT14996" description="APAR IT14456 (Fixed in 7.0.0.14, 7.1.0.11, 7.2.0.8, 7.5.0.2): IT MAY CAUSE HIGH CPU USAGE WHEN ENABLE-SHARING IS ENABLED IN SQL DATA SOURCE RUNTIME SETTINGS: ">https://www.ibm.com/support/docview.wss?uid=swg1IT14456</URL>
		<URL description="SQL Data Source Runtime Settings commands (enable-sharing): ">https://www.ibm.com/docs/en/datapower-gateway/10.6.0?topic=c-sql-runtime-settings-commands</URL>
		<Expression LogLevel="Warning" FormulaIDMatch="APARCHECK:IT14456,IT15693,IT14708,IT14996">
			<Section Name="default-config" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="SharingEnabled" Operation="EqualsTo" Value="exit">\bsql-runtime-settings\W+(\w+\W+)*?(no enable-sharing|exit)\b</Condition>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;failure;memory">
		<Name>{Condition:SectionName} sql-runtime-settings has enable-sharing DISABLED, this may cause HIGH MEMORY usage.  &lt;font color='#006666'&gt;Each sql-source will individually allocate {Condition:MemorySizeMB}MB&lt;/font&gt;.  Best practice is to have enable-sharing enabled and increase the memory profile size.</Name>
		<URL description="SQL Data Source Runtime Settings commands (enable-sharing): ">https://www.ibm.com/docs/en/datapower-gateway/10.6.0?topic=c-sql-runtime-settings-commands</URL>
		<Expression LogLevel="Warning" NextOperation="And">
			<Section Name="default-config" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="SharingEnabled" Operation="EqualsTo" Value="no enable-sharing">\bsql-runtime-settings\W+(\w+\W+)*?(no enable-sharing|exit)\b</Condition>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="default-config" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="MemorySizeMB" Operation="NotEqualTo" Value="">\bsql-runtime-settings\W+(\w+\W+)*?(profiles \"default\" \"([0-9]+)|exit)\b</Condition>
			<!-- if we cannot pull memory by profile, pull it by the max-memory attribute -->
			<Condition FieldPosition="3" RegGroup="All" ConditionName="MemorySizeMB" Operation="NotEqualTo" Value="">\bsql-runtime-settings\W+(\w+\W+)*?(max-memory ([0-9]+)|exit)\b</Condition>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;memory" SortCondition="MemSizeRound" SortMethod="Descending">
		<Name>{Condition:SectionName} StylesheetStatusSimpleIndex XML Manager &lt;font color='{Condition:ResultColor}'&gt;{Condition:ActualXMLManager}&lt;/font&gt; Reports &lt;font color='{Condition:ResultColor}'&gt;{Condition:MemSizeRound}GB&lt;/font&gt; in usage (2GB limit).</Name>
		<Expression LogLevel="Critical" FormulaIDMatch="V2018Firmware" NextOperation="And">	
			<Section Name="DocumentCachingSummary" SectionName="false" Wildcard="True" XPath="/Status//*[starts-with(local-name(),'DocumentCachingSummary')]/DocCount"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" InValue="{Condition:SectionName}" ConditionName="DomainName" Operation="NotEqualTo" Value="" NextOperation="And">([a-zA-Z-_.0-9]+)-DocumentCachingSummary</Condition>
			<Condition FieldPosition="0" InValue="{/Status//*[starts-with(local-name(),'DocumentCachingSummary')]/XMLManager}" ConditionName="XMLManager" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Critical" FormulaIDMatch="V2018Firmware" RequiredFile="{Condition:DomainName}-StylesheetStatusSimpleIndex">
			<Section Name="StylesheetStatusSimpleIndex" Wildcard="True" XPath="/Status//*[starts-with(local-name(),'StylesheetStatusSimpleIndex')]/MemSize"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" InValue="{/Status/*[starts-with(local-name(),'StylesheetStatusSimpleIndex')]//XMLManager}" ConditionName="ActualXMLManager" Operation="EqualsTo" Value="{Condition:XMLManager}" NextOperation="And"/>
			<Condition FieldPosition="0" RegGroup="Sum" ConditionName="MemSize" Operation="DivideBy" Value="1048576" NextOperation="And"/>
			<Condition FieldPosition="0" InValue="{Condition:MemSize}" ConditionName="MemSizeRound" Operation="Round" Value="2" NextOperation="And"/>
			<Condition FieldPosition="0" InValue="{Condition:MemSizeRound}" ConditionName="Result" Operation="GreaterThan" Value="1.9" NextOperation="And"/>
			<Condition FieldPosition="-1" ConditionName="ResultColor" Operation="Append" Value="red"/>
		</Expression>
		<Expression LogLevel="Info" FormulaIDMatch="V2018Firmware" NextOperation="And" ExpressionGroup="NormalState">	
			<Section Name="DocumentCachingSummary" SectionName="false" Wildcard="True" XPath="/Status//*[starts-with(local-name(),'DocumentCachingSummary')]/DocCount"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" InValue="{Condition:SectionName}" ConditionName="DomainName" Operation="NotEqualTo" Value="" NextOperation="And">([a-zA-Z-_.0-9]+)-DocumentCachingSummary</Condition>
			<Condition FieldPosition="0" InValue="{/Status//*[starts-with(local-name(),'DocumentCachingSummary')]/XMLManager}" ConditionName="XMLManager" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" FormulaIDMatch="V2018Firmware" RequiredFile="{Condition:DomainName}-StylesheetStatusSimpleIndex" ExpressionGroup="NormalState">
			<Section Name="StylesheetStatusSimpleIndex" Wildcard="True" XPath="/Status//*[starts-with(local-name(),'StylesheetStatusSimpleIndex')]/MemSize"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" InValue="{/Status/*[starts-with(local-name(),'StylesheetStatusSimpleIndex')]//XMLManager}" ConditionName="ActualXMLManager" Operation="EqualsTo" Value="{Condition:XMLManager}" NextOperation="And"/>
			<Condition FieldPosition="0" RegGroup="Sum" ConditionName="MemSize" Operation="DivideBy" Value="1048576" NextOperation="And"/>
			<Condition FieldPosition="0" InValue="{Condition:MemSize}" ConditionName="MemSizeRound" Operation="Round" Value="2" NextOperation="And"/>
			<Condition FieldPosition="0" InValue="{Condition:MemSizeRound}" ConditionName="Result" Operation="LessThan" Value="1.91" NextOperation="And"/>
			<Condition FieldPosition="-1" ConditionName="ResultColor" Operation="Append" Value="green"/>
		</Expression>
	</Formula>
	
	<Formula Categories="cpuload" SortCondition="FilesOpen" SortMethod="Descending">
		<Name>{Condition:SectionName} NFS Mount {Condition:MountName} in state {Condition:MountState} has {Condition:FilesOpen} files open, mount state is {Condition:MountState}.  A total of {Condition:FilesWritten} files written and {Condition:FilesRead} files read.</Name>
		<URL FormulaIDMatch="APARCHECK:IT15997" description="IT15997: WHILE UPDATING NFS MOUNT STATE AN UNEXPECTED APPLIANCE RESTART MAY OCCUR (Fixed in 7.0.0.16, 7.1.0.13, 7.2.0.10, 7.5.0.4 and 7.5.1.3): ">https://www.ibm.com/support/docview.wss?uid=swg1IT15997</URL>
		<URL FormulaIDMatch="APARCHECK:IT15457,IT16042,IT16229,IT15445,IT16715" description="IT15457: DIFFICULTY IN COMMUNICATING WITH NFS SERVER MAY CAUSE HIGHER SUSTAINED CPU USAGE (Fixed in 7.0.0.15, 7.1.0.12, 7.2.0.9, 7.5.0.3 and 7.5.1.2): ">https://www.ibm.com/support/docview.wss?uid=swg1IT15457</URL>
		<URL FormulaIDMatch="APARCHECK:IT15457,IT16042,IT16229,IT15445,IT16715" description="IT16042: DISABLING AN NFS STATIC MOUNT MAY LEAD TO AN UNEXPECTED APPLIANCE RESTART (Fixed in 7.0.0.15, 7.1.0.12, 7.2.0.9, 7.5.0.3 and 7.5.1.2): ">https://www.ibm.com/support/docview.wss?uid=swg1IT16042</URL>
		<URL FormulaIDMatch="APARCHECK:IT15457,IT16042,IT16229,IT15445,IT16715" description="IT16229: NFS MOUNTS MAY NOT ENTER AN 'UP' STATE CORRECTLY (Fixed in 7.0.0.15, 7.1.0.12, 7.2.0.9, 7.5.0.3 and 7.5.1.2): ">https://www.ibm.com/support/docview.wss?uid=swg1IT16229</URL>
		<URL FormulaIDMatch="APARCHECK:IT15457,IT16042,IT16229,IT15445,IT16715" description="IT15445: DELETING OR RESTARTING A DOMAIN WITH AN NFS STATIC MOUNT MIGHT UNEXPECTEDLY RESTART THE APPLIANCE (Fixed in 7.0.0.15, 7.1.0.12, 7.2.0.9, 7.5.0.3 and 7.5.1.2): ">https://www.ibm.com/support/docview.wss?uid=swg1IT15445</URL>
		<URL FormulaIDMatch="APARCHECK:IT15099" description="IT15099: NFS MOUNT MAY NOT COME UP CORRECTLY DURING DOMAIN RESTART OR UPON INITIAL DEPLOYMENT (Fixed in 7.0.0.14, 7.1.0.11, 7.2.0.8, 7.5.0.2 and 7.5.1.2): ">https://www.ibm.com/support/docview.wss?uid=swg1IT15099</URL>
		<URL FormulaIDMatch="APARCHECK:IT14456,IT15693,IT14708,IT14996" description="IT14996: RESTARTING/DISABLING/ENABLING A DOMAIN CONTAINING NFS STATIC MOUNTS MIGHT TAKE A LONG TIME TO COMPLETE IN CERTAIN SITUATIONS (Fixed in 7.0.0.14, 7.1.0.11, 7.2.0.8, 7.5.0.2, 7.5.1.0): ">https://www.ibm.com/support/docview.wss?uid=swg1IT14996</URL>
		<URL FormulaIDMatch="APARCHECK:IT15340" description="IT15340: A RELOAD MAY OCCUR DURING RAPID AND REPEATED MOUNTING AND UNMOUNTING OF AN NFS MOUNT (Fixed in 7.0.0.14, 7.1.0.11): ">https://www.ibm.com/support/docview.wss?uid=swg1IT15340</URL>
		<URL FormulaIDMatch="APARCHECK:IT12165,IT14136" description="IT12165: NFS OBJECTS MAY NOT CLEAN UP CORRECTLY AND USE ADDITIONAL RESOURCES (Fixed in 7.0.0.13, 7.1.0.10, 7.2.0.6 and 7.5.0.0): ">https://www.ibm.com/support/docview.wss?uid=swg1IT12165</URL>
		<URL FormulaIDMatch="APARCHECK:IT12165,IT14136" description="IT14136: USING NFS-POLLERS MIGHT LEAD TO UNEXPECTED MEMORY GROWTH (Fixed in 7.0.0.13, 7.1.0.10, 7.2.0.6 and 7.5.0.0): ">https://www.ibm.com/support/docview.wss?uid=swg1IT14136</URL>
		<URL FormulaIDMatch="APARCHECK:IT10924" description="IT10924: ON DOMAIN DELETE WITH A NFS STATIC MOUNT AN APPLIANCE RESTART MAY OCCUR (Fixed in 6.0.1.13, 7.0.0.10, 7.1.0.7 and 7.2.0.1): ">https://www.ibm.com/support/docview.wss?uid=swg1IT14136</URL>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="NFSMountStatus" Wildcard="True" XPath="/Status/NFSMountStatus/Name"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MountName" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="NFSMountStatus" Wildcard="True" XPath="/Status/NFSMountStatus/FilesOpen"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="FilesOpen" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="NFSMountStatus" Wildcard="True" XPath="/Status/NFSMountStatus/FilesWritten"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="FilesWritten" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="NFSMountStatus" Wildcard="True" XPath="/Status/NFSMountStatus/FilesRead"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="FilesRead" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="NFSMountStatus" Wildcard="True" XPath="/Status/NFSMountStatus/State"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="MountState" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>

	<!-- New CVE's (late 2015 into May 2016) -->
	<Formula Categories="configuration">
		<Name>IT14230: A VULNERABILITY IN THE SSL COMPONENT OF IBM DATAPOWER GATEWAYS. (CVE-2016-0701 &amp; CVE-2015-3197)</Name>
		<DisplayMessage>SSL vulnerabilities disclosed on January 28th, 2016 include CVE-2015-3197.  IBM DataPower Gateways releases 7.x are affected by this CVE.&lt;br&gt;&lt;br&gt; SSL could allow a remote attacker to conduct man-in-the-middle attacks, caused by an error related to the negotiation of disabled SSLv2 ciphers by malicious SSL/TLS clients. (CVE-2015-3197).</DisplayMessage>
		<URL description="IT14230 (Fixed in 7.0.0.13, 7.1.0.10 and 7.2.0.6, 7.5.0.x planned): A VULNERABILITY IN THE SSL COMPONENT OF IBM DATAPOWER GATEWAYS. (CVE-2016-0701 &amp; CVE-2015-3197): ">https://www.ibm.com/support/docview.wss?uid=swg1IT14230</URL>
		<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" SectionName="false" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="13"/>
		</Expression>
		<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" SectionName="false" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="10"/>
		</Expression>
		<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" SectionName="false" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="2" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="6"/>
		</Expression>
		<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" SectionName="false" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="5" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="2"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration">
		<Name>IT14231: A VULNERABILITY IN THE SSL COMPONENT OF IBM DATAPOWER GATEWAYS. (CVE-2015-3195 &amp; CVE-2015-1794) - Only fixed in v7.0 or later.</Name>
		<DisplayMessage>SSL could allow a remote attacker to obtain sensitive information, caused by a memory leak (CVE-2015-3195). SSL is vulnerable to a denial of service, caused by a client cipher suite error (CVE-2015-1794).</DisplayMessage>
		<URL description="IT14231 (Fixed in 7.0.0.13, 7.1.0.10, does not apply to 7.2 or later): A VULNERABILITY IN THE SSL COMPONENT OF IBM DATAPOWER GATEWAYS. (CVE-2015-3195 &amp; CVE-2015-1794): ">https://www.ibm.com/support/docview.wss?uid=swg1IT14231</URL>
		<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" SectionName="false" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="13"/>
		</Expression>
		<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" SectionName="false" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="10"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration">
		<Name>IT13989: GNU C LIBRARY (GLIBC) VULNERABILITY AFFECTS IBM DATAPOWER GATEWAYS (CVE-2015-7547)</Name>
		<DisplayMessage>GNU C Library (glibc) is vulnerable to a stack-based buffer overflow in the getaddrinfo() function. A remote attacker could overflow a buffer and execute arbitrary code on the system or cause the application to crash.</DisplayMessage>
		<URL description="IT13989 (Fixed in 6.0.0.19, 6.0.1.15, 7.1.0.9, 7.2.0.4): GNU C LIBRARY (GLIBC) VULNERABILITY AFFECTS IBM DATAPOWER GATEWAYS (CVE-2015-7547): ">https://www.ibm.com/support/docview.wss?uid=swg1IT13989</URL>
		<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" SectionName="false" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="12"/>
		</Expression>
		<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" SectionName="false" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="9"/>
		</Expression>
		<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" SectionName="false" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="2" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="4"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration">
		<Name>IT13742: SLOTH: VULNERABILITIES IN TLS HANDSHAKE DUE TO USE OF MD5 SIGNATURES (CVE-2015-7575)</Name>
		<DisplayMessage>The TLS protocol could allow weaker than expected security caused by a collision attack when using the MD5 hash function for signing a ServerKeyExchange message during a TLS handshake.  An attacker could exploit this vulnerability using man-in-the-middle techniques to impersonate a TLS server and obtain credentials.</DisplayMessage>
		<URL description="IT13742 (Fixed in 6.0.0.18, 6.0.1.14, 7.0.0.11, 7.1.0.8): SLOTH: VULNERABILITIES IN TLS HANDSHAKE DUE TO USE OF MD5 SIGNATURES(CVE-2015-7575): ">https://www.ibm.com/support/docview.wss?uid=swg1IT13742</URL>
		<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" SectionName="false" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="11"/>
		</Expression>
		<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" SectionName="false" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="EqualsTo" Value="1" NextOperation="And"/>
				<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
				<Condition FieldPosition="5" Operation="LessThan" Value="8"/>
		</Expression>
	</Formula>
	<!-- end of late 2015 to May 2016 CVE's -->
	
	<Formula Categories="memory;cpuload;failure">
		<Name>{Condition:SectionName} {Condition:StartTime} (FrontFileDes: {Condition:FrontFileDes}, BackFileDes: {Condition:BackFileDes}) Potential Failed Transaction in Domain &lt;font color='#ff7733'&gt;{Condition:Domain}&lt;/font&gt; contains service &lt;font color='#006666'&gt;{Condition:Name} ({Condition:Class})&lt;/font&gt; TransxID: &lt;font color='#006666'&gt;{Condition:TransactionID}&lt;/font&gt;, FrontURL: &lt;font color='#ff7733'&gt;{Condition:FrontURL}&lt;/font&gt;.</Name>
		<URL description="IT20998 (Fixed in 7.1.0.18, 7.2.0.15, 7.5.0.9, 7.5.1.8, 7.5.2.8 and 7.6.0.0): TRANSACTIONS TO A NON-RESPONSIVE BACKEND MIGHT NEVER TIME OUT: ">https://www.ibm.com/support/docview.wss?uid=swg1IT20998</URL>		
		<Expression LogLevel="Warning" FormulaIDMatch="APARCHECK:IT20998">
			<Section Name="GatewayTransactions" XPath="/Status//GatewayTransactions/FrontRemoteAddressType"/>
			<RegExp>*</RegExp>
			<!-- if the front remote address type is set to undefined, something is likely wrong -->
			<Condition FieldPosition="0" Operation="EqualsTo" Value="undefined" NextOperation="And"/>
			<Condition FieldPosition="{/Status//GatewayTransactions/Domain}" Operation="NotEqualTo" ConditionName="Domain" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status//GatewayTransactions/Name}" Operation="NotEqualTo" ConditionName="Name" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status//GatewayTransactions/Class}" Operation="NotEqualTo" ConditionName="Class" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status//GatewayTransactions/TransactionID}" Operation="NotEqualTo" ConditionName="TransactionID" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status//GatewayTransactions/FrontURL}" Operation="NotEqualTo" ConditionName="FrontURL" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status//GatewayTransactions/FrontFileDes}" Operation="NotEqualTo" ConditionName="FrontFileDes" Value="-1" NextOperation="And"/>
			<Condition FieldPosition="{/Status//GatewayTransactions/BackFileDes}" Operation="NotEqualTo" ConditionName="BackFileDes" Value="-1" NextOperation="And"/>
			<Condition FieldPosition="{/Status//GatewayTransactions/StartTime}" Operation="NotEqualTo" ConditionName="StartTime" Value=""/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="GatewayTransactions" XPath="/Status//GatewayTransactions/FrontRemoteAddressType"/>
			<RegExp>*</RegExp>
			<!-- if the front remote address type is set to undefined, something is likely wrong -->
			<Condition FieldPosition="0" Operation="EqualsTo" Value="undefined" NextOperation="And"/>
			<Condition FieldPosition="{/Status//GatewayTransactions/Domain}" Operation="EqualsTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status//GatewayTransactions/Name}" Operation="EqualsTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status//GatewayTransactions/Class}" Operation="EqualsTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status//GatewayTransactions/Domain}" ConditionName="Domain" Operation="Append" Value="Unknown" NextOperation="And"/>
			<Condition FieldPosition="{/Status//GatewayTransactions/Name}" ConditionName="Name" Operation="Append" Value="Unknown" NextOperation="And"/>
			<Condition FieldPosition="{/Status//GatewayTransactions/Class}" ConditionName="Class" Operation="Append" Value="Unknown" NextOperation="And"/>
			<Condition FieldPosition="{/Status//GatewayTransactions/TransactionID}" Operation="NotEqualTo" ConditionName="TransactionID" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status//GatewayTransactions/FrontOriginalURL}" Operation="NotEqualTo" ConditionName="FrontURL" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status//GatewayTransactions/FrontFileDes}" Operation="NotEqualTo" ConditionName="FrontFileDes" Value="-1" NextOperation="And"/>
			<Condition FieldPosition="{/Status//GatewayTransactions/BackFileDes}" Operation="NotEqualTo" ConditionName="BackFileDes" Value="-1" NextOperation="And"/>
			<Condition FieldPosition="{/Status//GatewayTransactions/StartTime}" Operation="NotEqualTo" ConditionName="StartTime" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="network" SortCondition="Domain" SortMethod="descending">
		<Name>{Condition:SectionName} contains transactional data from services on the DataPower device</Name>
		<DisplayMessage>{Condition:StartTime}||&lt;font color='#ff7733'&gt;{Condition:Domain}&lt;/font&gt;||&lt;font color='#006666'&gt;{Condition:Name}||({Condition:Class})&lt;/font&gt;||&lt;font color='#006666'&gt;{Condition:TransactionID}&lt;/font&gt;||&lt;font color='#ff7733'&gt;{Condition:FrontURL}&lt;/font&gt;||&lt;font color='#ff7733'&gt;{Condition:BackURL}&lt;/font&gt;||{Condition:FrontFileDes}||{Condition:BackFileDes}</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="GatewayTransactions" XPath="/Status//GatewayTransactions/FrontRemoteAddressType"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="{/Status//GatewayTransactions/StartTime}" Operation="NotEqualTo" ConditionName="StartTime" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status//GatewayTransactions/Domain}" ConditionName="Domain" Operation="Append" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status//GatewayTransactions/Name}" ConditionName="Name" Operation="Append" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status//GatewayTransactions/Class}" ConditionName="Class" Operation="Append" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status//GatewayTransactions/TransactionID}" Operation="NotEqualTo" ConditionName="TransactionID" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status//GatewayTransactions/FrontURL}" Operation="Append" ConditionName="FrontURL" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status//GatewayTransactions/BackURL}" Operation="Append" ConditionName="BackURL" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status//GatewayTransactions/FrontFileDes}" Operation="NotEqualTo" ConditionName="FrontFileDes" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status//GatewayTransactions/BackFileDes}" Operation="NotEqualTo" ConditionName="BackFileDes" Value=""/>
		</Expression>
	</Formula>

	<Formula Categories="configuration;memory" CollapseResult="true" CondenseCondition="QPoolEntry" SortCondition="CondenseCondition" SortMethod="descending">
		<Name>{Condition:SectionName} QRef Section contains {Condition:QPoolEntry}</Name>
		<Expression LogLevel="Info">
			<Section Name="QPool" XPath="/Root/text()"/>
			<RegExp>\d+: 0x\d+ "([a-zA-Z0-9-_.:?=*;/\ ]*)"</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="QPoolEntry" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>

	<Formula Categories="configuration;memory" CollapseResult="true" CondenseCondition="QPoolEntry" SortCondition="CondenseCondition" SortMethod="descending">
		<Name>{Condition:SectionName} QRef DP v7.5+ Section contains {Condition:QPoolEntry}</Name>
		<Expression LogLevel="Info" FormulaIDMatch="V750FirmwareCheckOrGreater">
			<Section Name="QPool" XPath="/Root/text()"/>
			<RegExp>\d+: 0x\d+ ((domain|name)\(([a-zA-Z0-9-_.:?=*;/\()" ]*))</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="QPoolEntry" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<!-- APAR IT15006 Check for LBG half health check setting -->
	<Formula CollapseResult="true" FormulaID="APARIT15006Check">
		<Expression LogLevel="Warning">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="2" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="8"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
			<RegExp>([A-Z]{2,3})[0-9]{0,2}.(\d+)\.(\d+)\.(\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="2" Operation="EqualsTo" Value="7" NextOperation="And"/>
			<Condition FieldPosition="3" Operation="EqualsTo" Value="5" NextOperation="And"/>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="LessThan" Value="2"/>
		</Expression>
	</Formula>
	
	<Formula Categories="failure;general">
		<Name>{Condition:SectionName} Load Balancer Group &lt;font color='#006666'&gt;{Condition:LBG}&lt;/font&gt; using tcp half health check, advise upgrading past APAR IT15006 or workaround with tcp full health check.</Name>
		<URL description="APAR IT15006 (Fixed in 7.2.0.8, 7.5.0.2 and 7.5.1.0): USING TCP PARTIAL HEALTH CHECKS CAN LEAD TO UNEXPECTED BEHAVIOR: ">https://www.ibm.com/support/docview.wss?uid=swg1IT15006</URL>
		<Expression LogLevel="Critical" FormulaIDMatch="APARIT15006Check">
			<Section Name="-config" Wildcard="True" XPath="/Root/text()" ReadNextSection="True"/>
			<Section Name=".config" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>tcp-conn-type Partial</IndexSearch>
			<RegExp>loadbalancer-group \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(type TCPConnection|exit)</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="LBG" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="LBGType" Operation="NotEqualTo" Value="exit" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="LBGTypeSetting" Operation="NotEqualTo" Value="exit">loadbalancer-group \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(tcp-conn-type Partial|exit)</Condition>
		</Expression>
	</Formula>
	<!-- end APAR IT15006 check -->
	
	<Formula Categories="memory" FormulaID="LowB2BPersistenceStorage">
		<Name>{Condition:SectionName} &lt;font color='#ff7733'&gt;{Condition:Purpose} is low&lt;/font&gt; on volume &lt;font color='#006666'&gt;{/Status/RaidPartitionStatus//VolumeName}&lt;/font&gt; partition idx &lt;font color='#006666'&gt;{/Status/RaidPartitionStatus//PartitionIndex}&lt;/font&gt;, &lt;font color='#ff7733'&gt;{/Status/RaidPartitionStatus//FreeSpace}KB&lt;/font&gt; of &lt;font color='#ff7733'&gt;{Condition:TotalSize}KB&lt;/font&gt; left free.</Name>
		<URL description="Best practice for DataPower B2B persistent storage: ">https://www.ibm.com/support/pages/node/557583</URL>
		<URL description="How to resolve and avoid the B2B Persistence down problem due to running out of space: ">https://www.ibm.com/support/docview.wss?uid=swg21639436</URL>
		<URL description="Configuring Virtual Appliance DP (Advise minimum of 16GB for raid, HALF is allowed to b2bPersistence): ">https://www.ibm.com/docs/en/datapower-gateway/10.6.0?topic=vmware-deploying-ova-hypervisor</URL>
		<Expression LogLevel="Critical">
			<Section Name="RaidPartitionStatus" XPath="/Status/RaidPartitionStatus//FreeSpace"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="{/Status/RaidPartitionStatus//Purpose}" Operation="NotEqualTo" ConditionName="Purpose" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/RaidPartitionStatus//TotalSize}" Operation="NotEqualTo" ConditionName="TotalSize" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="DivideBy" ConditionName="PercentageFree" Value="{Condition:TotalSize}" NextOperation="And"/>
			<Condition FieldPosition="{Condition:PercentageFree}" Operation="LessThan" Value=".26"/> <!-- check for less than 26% -->
		</Expression>
		<Expression LogLevel="Error">
			<Section Name="RaidPartitionStatus" XPath="/Status/RaidPartitionStatus//FreeSpace"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="{/Status/RaidPartitionStatus//Purpose}" Operation="NotEqualTo" ConditionName="Purpose" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/RaidPartitionStatus//TotalSize}" Operation="NotEqualTo" ConditionName="TotalSize" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" Operation="DivideBy" ConditionName="PercentageFree" Value="{Condition:TotalSize}" NextOperation="And"/>
			<Condition FieldPosition="{Condition:PercentageFree}" Operation="LessThan" Value=".51"/> <!-- check for less than 51% -->
		</Expression>
	</Formula>

	<!-- tracking APAR IT15693 resource exhaustion due to source-mqfte -->
	<Formula Categories="failure">
		<Name>Backtrace on {Condition:Timestamp} Contained Component: {Condition:Data}.  Review Source-MQFTE Related APAR's.</Name>
		<URL FormulaIDMatch="APARCHECK:IT15457,IT16042,IT16229,IT15445,IT16715" description="IT16715: SERVICE UTILIZING MQ BACKOUT MAY CAUSE AN UNEXPECTED APPLIANCE RESTART IF BACKOUT ATTEMPT OCCURS (Fixed in 7.0.0.15, 7.1.0.12, 7.2.0.9, 7.5.0.3 and 7.5.1.2): ">https://www.ibm.com/support/docview.wss?uid=swg1IT15693</URL>
		<URL FormulaIDMatch="APARCHECK:IT14456,IT15693,IT14708,IT14996" description="IT15693: WHILE USING MQ FTE FRONT SIDE HANDLER APPLIANCE MAY UNEXPECTEDLY RELOAD (Fixed in 7.0.0.14, 7.1.0.11, 7.2.0.8, 7.5.0.2): ">https://www.ibm.com/support/docview.wss?uid=swg1IT15693</URL>
		<!-- won't show these results unless the firmware level is below the newest APAR -->
		<Expression LogLevel="Critical" FormulaIDMatch="APARCHECK:IT15457,IT16042,IT16229,IT15445,IT16715">
			<Section Name="Backtrace" Wildcard="True" NoDecodeCache="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value="" NextOperation="And">Thread 0x[0-9a-fA-F]*\: (\d{4}\-\d{2}\-\d{2}T\d{2}:\d{2}:\d{2}\.\d+Z)</Condition>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Data" Operation="NotEqualTo" Value="">\b(Component=source-mqfte.*)\W+(\w+\W+)*?Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+|Thread 0x[0-9a-f]+: Frame: 0x[0-9a-f]+\b</Condition>
		</Expression>
	</Formula>
	<!-- end tracking APAR IT15693 resource exhaustion due to source-mqfte -->
		
	<Formula Categories="configuration;cpu;memory;failure">
		<Name>{Condition:SectionName} {Condition:Timestamp} - SSL shutdown error no read/write info.</Name>
		<URL description="IT14708: WHEN PROCESSING EMPTY BODIED RESPONSES ON SSL ENABLED XML FIREWALL APPLIANCE MAY EXPERIENCE CONNECTION FAILURES (Fixed in 7.0.0.14, 7.1.0.11, 7.2.0.8, 7.5.0.2): ">https://www.ibm.com/support/docview.wss?uid=swg1IT14708</URL>
		<Expression LogLevel="Warning" FormulaIDMatch="APARCHECK:IT14456,IT15693,IT14708,IT14996">
			<Section Name="DiagnosticLog" Wildcard="True" XPath="/Root/text()"/>
			<IndexSearch>shutdown error, no read/write info</IndexSearch>
			<RegExp>1,([0-9TZ.]{16,20}),[a-zA-Z-_.0-9]+,ssl,error,,,[0-9]+,[0-9]+,[0-9.]+,0x806000c6,,,\"shutdown error, no read/write info\"</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="Timestamp" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	
	<Formula Categories="configuration;failure;memory">
		<Name>{Condition:SectionName} WSGW &lt;font color='#006666'&gt;{Condition:WSGWName}&lt;/font&gt; has a front side handler &lt;font color='#006666'&gt;{Condition:FrontSideHandler}&lt;/font&gt; that has GET enabled, features enabled: &lt;font color='#006666'&gt;{Condition:Features}&lt;/font&gt;.  &lt;font color='red'&gt;Review APAR description (known issue for memory leak)&lt;/font&gt;.</Name>
		<URL description="IT17895: THE DEVICE MAY SHOW MEMORY GROWTH DUE TO DELAY IN RELEASING MEMORY FROM THE BACKEND URL ASSOCIATED WITH THE WS-PROXY SERVICE (Fixed in 7.0.0.16, 7.1.0.13, 7.2.0.10, 7.5.0.4, 7.5.1.3, 7.5.2.1): ">https://www.ibm.com/support/docview.wss?uid=swg1IT17895</URL>
		<Expression LogLevel="Warning" FormulaIDMatch="APARCHECK:IT17895">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="WSGWName" Operation="NotEqualTo" Value="" NextOperation="And">wsgw \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(endpoint-rewrite-policy ([a-zA-Z-_.0-9]+)|exit)</Condition>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="EndPointRewritePolicy" Operation="NotEqualTo" Value="" NextOperation="And">wsgw \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(endpoint-rewrite-policy ([a-zA-Z-_.0-9]+)|exit)</Condition>
			<Condition FieldPosition="3" RegGroup="AllResult" ConditionName="FrontSideHandler" Operation="NotEqualTo" Value="" NextOperation="And">wsm-endpointrewrite \"{Condition:EndPointRewritePolicy}\"\W+(\w+\W+)*?(listener-rule \"[a-zA-Z0-9-_.:?=;\/\ ^{}$]+\" \"[a-zA-Z0-9.]+" \"[0-9.]+\" \"[0-9]+\" \"[a-zA-Z0-9-_.:?=;\/\ ^{}$]+\" \"([a-zA-Z-_.0-9]+)\"|exit)</Condition>
			<Condition FieldPosition="3" RegGroup="AllResult" ConditionName="Features" Operation="Contains" Value="GET">source-http[s]{0,1} \"{Condition:FrontSideHandler}\"\W+(\w+\W+)*?(allowed-features \"([a-zA-Z0-9.\-\+]+)\"|exit)</Condition>
		</Expression>
	</Formula>
	
	<!-- sftp poller reload due to persistent connections use tracking -->
	<Formula Categories="configuration;failure">
		<Name>&lt;font color='#CC3300'&gt;{Condition:SectionName}&lt;/font&gt; There is an SFTP Poller &lt;font color='#CC3300'&gt;{Condition:SFTPPollerName}&lt;/font&gt; that is configured to use persistent-connections.  SSHClientProfile &lt;font color='#CC3300'&gt;{Condition:SSHClientProfile}&lt;/font&gt; defines the persistent-connections on or off. </Name>
		<URL description="IT17833 (Fixed in 7.0.0.17, 7.1.0.14, 7.2.0.11, 7.5.0.5, 7.5.1.4, 7.5.2.2): REUSE OF SSH PERSISTENT CONNECTIONS WHEN TIMEOUT OCCURS MAY CAUSE UNEXPECTED RELOAD: ">https://www.ibm.com/support/docview.wss?uid=swg1IT17833</URL>
		<Expression FormulaIDMatch="APARCHECK:IT17833" LogLevel="Critical">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="SFTPPollerName" Operation="NotEqualTo" Value="" NextOperation="And">source-sftp-poller \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(ssh-client-connection ([a-zA-Z-_.0-9]+)|exit)</Condition>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="SSHClientProfile" Operation="NotEqualTo" Value="" NextOperation="And">source-sftp-poller \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(ssh-client-connection ([a-zA-Z-_.0-9]+)|exit)</Condition>
			<Condition FieldPosition="3" RegGroup="AllResult" ConditionName="PersistentConnections" Operation="NotEqualTo" Value="off">sshclientprofile \"({Condition:SSHClientProfile})\"\W+(\w+\W+)*?(persistent-connections off|exit)</Condition>
		</Expression>
	</Formula>
	<!-- end of sftp poller apar tracking -->
	
	<Formula Categories="configuration;network">
		<Name>{Condition:SectionName} [Network Settings] Ephemeral Port Range is set to &lt;font color='#006666'&gt;{Condition:EphemeralPortRange}&lt;/font&gt;, default is 10000, setting higher may reduce available ports and cause system port exhaustion.</Name>
		<URL description="WebSphere DataPower - Best practice for specifying port values: ">https://www.ibm.com/support/pages/node/404593</URL>
		<URL description="Configuring appliance-wide network settings: ">https://www.ibm.com/docs/en/datapower-gateway/10.6.0?topic=itself-configuring-datapower-network-settings</URL>
		<Expression LogLevel="Warning">
			<Section Name="default-config" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\bnetwork\W+(\w+\W+)*?(ephemeral-port-range ([0-9]+)|exit)\b</RegExp>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="EphemeralPortRange" Operation="NotEqualTo" Value="10000" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" Operation="NotEqualTo" Value="exit" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="All" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="memory;failure" SortCondition="Size" SortMethod="Descending" SumCondition="Size">
		<Name>{Condition:SectionName} File {Condition:FileName} can completely consume encrypted space, size {Condition:Size} bytes.</Name>
		<URL description="IT19465: USING SFTP ON A LOGTARGET COULD LEAD TO A DISK SPACE PROBLEM (Fixed in 7.5.2.4): ">https://www.ibm.com/support/docview.wss?uid=swg1IT19465</URL>
		<Expression LogLevel="Critical" FormulaIDMatch="APARCHECK:IT19465" NextOperation="And">
			<Section Name="FlashFiles" XPath="/flash/file[text() = 'sshprocess.stderr']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="FileName" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Critical" FormulaIDMatch="APARCHECK:IT19465">
			<Section Name="FlashFiles" XPath="/flash/file[text() = 'sshprocess.stderr']/@size"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="Size" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;failure">
		<Name>{Condition:SectionName} - Has a monitor-count &lt;font color='#CC3300'&gt;{Condition:MonitorCountName}&lt;/font&gt; that contains a filter &lt;font color='#CC3300'&gt;{Condition:FilterName}&lt;/font&gt; which has an interval period of &lt;font color='#CC3300'&gt;{Condition:IntervalPeriod}&lt;/font&gt;, Burst Limit: &lt;font color='#CC3300'&gt;{Condition:BurstLimit}&lt;/font&gt;, IntervalPeriod * Burst Limit exceeds 32-bit integer: &lt;font color='#CC3300'&gt;{Condition:ResultBucket}&lt;/font&gt;.  Filter action may trigger unexpectedly before burst limit or rate limit is reached.</Name>
		<URL description="APAR IT22213 (Fix in 7.1.0.21, 7.2.0.18, 7.5.0.12, 7.5.1.11, 7.5.2.11 and 7.6.0.4): MONITOR COUNTS WITH A LARGE INTERVAL AND BURST LIMIT MAY EXCEED 32-BIT LIMITATION AND PREMATURELY TAKE ACTION ON TRAFFIC: ">https://www.ibm.com/support/docview.wss?uid=swg1IT22213</URL>
		<Expression LogLevel="Critical" FormulaIDMatch="APARCHECK:IT22213">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>(monitor-count \"([a-zA-Z-_.0-9]+)\"|filter \"([a-zA-Z-_.0-9]+)\"\s+\"([0-9]+)\"\s+\"[0-9]+\"\s+\"([0-9]+)\"\s+\"([a-zA-Z-_.0-9]+)\"|exit)</RegExp>
			<Condition FieldPosition="2" RegGroup="Ordered" ConditionName="MonitorCountName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="3" RegGroup="Ordered" ConditionName="FilterName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" RegGroup="Ordered" ConditionName="IntervalPeriod" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="5" RegGroup="Ordered" ConditionName="BurstLimit" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{Condition:IntervalPeriod}" RegGroup="AllResult" ConditionName="ResultBucket" Operation="Multiply" Value="{Condition:BurstLimit}" NextOperation="And"/>
			<Condition FieldPosition="{Condition:ResultBucket}" RegGroup="AllResult" Operation="GreaterThan" Value="4.2E9"/>
		</Expression>
	</Formula>
	
	<!-- product insights enabled can cause higher cpu -->
	<Formula Categories="configuration;failure;network;cpuload">
		<Name>{Condition:SectionName} Product Insights is enabled in the default domain, may cause higher than expected CPU..</Name>
		<Expression LogLevel="Warning" FormulaIDMatch="V760FirmwareCheckOrGreater" NextOperation="And">
			<Section Name="default-config" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\bproduct-insights\W+(\w+\W+)*?(admin-state (enabled|disabled)|exit)\b</RegExp>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="EnabledOrNot" Operation="EqualsTo" Value="enabled"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="default-config" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\bproduct-insights\W+(\w+\W+)*?(host \"([a-zA-Z0-9.]+)|exit)\b</RegExp>
			<!-- if it is the host example.ibm.com -->
			<Condition FieldPosition="3" RegGroup="All" ConditionName="DefaultHost" Operation="NotEqualTo" Value="example.ibm.com"/>
			<!-- if no host provided, uses default which is example.ibm.com -->
			<Condition FieldPosition="2" RegGroup="All" Operation="NotEqualTo" Value="exit"/>
		</Expression>
		<Expression LogLevel="Error" FormulaIDMatch="V760FirmwareCheckOrGreater" ExpressionGroup="DefaultProductInsightConfig" NextOperation="And">
			<Section Name="default-config" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\bproduct-insights\W+(\w+\W+)*?(admin-state (enabled|disabled)|exit)\b</RegExp>
			<Condition FieldPosition="3" RegGroup="All" ConditionName="EnabledOrNot" Operation="EqualsTo" Value="enabled"/>
		</Expression>
		<Expression LogLevel="Error" ExpressionGroup="DefaultProductInsightConfig">
			<Section Name="default-config" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\bproduct-insights\W+(\w+\W+)*?(host \"([a-zA-Z0-9.]+)|exit)\b</RegExp>
			<!-- if it is the host example.ibm.com -->
			<Condition FieldPosition="3" RegGroup="All" ConditionName="DefaultHost" Operation="EqualsTo" Value="example.ibm.com"/>
			<!-- if no host provided, uses default which is example.ibm.com -->
			<Condition FieldPosition="2" RegGroup="All" Operation="EqualsTo" Value="exit"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;failure;cpuload;memory">
		<Name>{Condition:SectionName} XML Manager &lt;font color='#FF0000'&gt;{Condition:XMLManager}&lt;/font&gt; is at full capacity for stylesheet cache.  There are &lt;font color='#006666'&gt;{Condition:ReadyCount}&lt;/font&gt; files compiled, &lt;font color='#006666'&gt;{/Status/StylesheetCachingSummary//PendingCount}&lt;/font&gt; are pending, &lt;font color='#006666'&gt;{Condition:BadCount}&lt;/font&gt; are bad attempts to compile. Total: &lt;font color='#FF0000'&gt;{Condition:TotalStylesheetsAttempted}&lt;/font&gt; (attempted) / &lt;font color='#FF0000'&gt;{Condition:CacheSize}&lt;/font&gt; (allowed).</Name>>
		<Expression LogLevel="Critical">
			<Section Name="StylesheetCachingSummary" Wildcard="True" XPath="/Status/StylesheetCachingSummary//XMLManager"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" ConditionName="XMLManager" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/StylesheetCachingSummary//ReadyCount}" Operation="NotEqualTo" ConditionName="ReadyCount" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/StylesheetCachingSummary//BadCount}" Operation="NotEqualTo" ConditionName="BadCount" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/StylesheetCachingSummary//CacheSize}" Operation="NotEqualTo" ConditionName="CacheSize" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/StylesheetCachingSummary//PendingCount}" Operation="Add" ConditionName="PendingReadyCount" Value="{Condition:ReadyCount}" NextOperation="And"/>
			<Condition FieldPosition="{Condition:BadCount}" Operation="Add" ConditionName="TotalStylesheetsAttempted" Value="{Condition:PendingReadyCount}" NextOperation="And"/>
			<Condition FieldPosition="{Condition:TotalStylesheetsAttempted}" Operation="Add" ConditionName="TotalStylesheetsCompare" Value="1" NextOperation="And"/> <!-- +1 to make it 'greater than or equal to' on next argument -->
			<Condition FieldPosition="{Condition:TotalStylesheetsCompare}" Operation="GreaterThan" Value="{Condition:CacheSize}"/>
		</Expression>
	</Formula>
	
	
	<!-- duplicate config param checks -->
	<Formula CollapseResult="true" FormulaID="APARCHECK:IT30935">
		<Expression LogLevel="Info">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
			<RegExp>([A-Z]{2,4})[0-9]{0,2}.(((2018|2019|20[2-9][0-9])\.(\d+)\.(\d+))\.(\d+))([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="2018" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="EqualsTo" Value="4" NextOperation="And"/>
			<Condition FieldPosition="6" Operation="EqualsTo" Value="1" NextOperation="And"/>
			<Condition FieldPosition="7" Operation="LessThan" Value="10"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;memory;failure;cpuload">
		<Name>{Condition:SectionName} - AAAPolicy Object &lt;font color='#006666'&gt;{Condition:ObjectName}&lt;/font&gt; has &lt;font color='red'&gt;{Condition:ConfigObjectResult}&lt;/font&gt; saml-attributes.  There may be duplicate entries that are building up in the configuration object that should be removed.  Duplicate parameters can attribute to higher cpu, memory and latency due to additional time spent on transactions.</Name>
		<URL description="APAR IT30935 (Fixed in: 2018.4.1.10): Indexed properties related to URLRewrite Rule, SAML Attribute, Stylepolicy to avoid duplicate entries: ">https://www.ibm.com/support/docview.wss?uid=swg1IT30935</URL>
		<Expression LogLevel="Warning" FormulaIDMatch="APARCHECK:IT30935">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\baaapolicy \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit\b</RegExp>
			<Condition FieldPosition="0" RegGroup="All" ConditionName="ConfigObject" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{Condition:ConfigObject}" RegGroup="Count" ConditionName="ConfigObjectResult" Operation="GreaterThan" Value="100">(saml-attribute).*</Condition>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;memory;failure;cpuload">
		<Name>{Condition:SectionName} - URLRewrite Object &lt;font color='#006666'&gt;{Condition:ObjectName}&lt;/font&gt; has &lt;font color='red'&gt;{Condition:ConfigObjectResult}&lt;/font&gt; absolute-rewrite.  There may be duplicate entries that are building up in the configuration object that should be removed.  Duplicate parameters can attribute to higher cpu, memory and latency due to additional time spent on transactions.</Name>
		<URL description="APAR IT30935 (Fixed in: 2018.4.1.10): Indexed properties related to URLRewrite Rule, SAML Attribute, Stylepolicy to avoid duplicate entries: ">https://www.ibm.com/support/docview.wss?uid=swg1IT30935</URL>
		<Expression LogLevel="Warning" FormulaIDMatch="APARCHECK:IT30935">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\burlrewrite \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit\b</RegExp>
			<Condition FieldPosition="0" RegGroup="All" ConditionName="ConfigObject" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{Condition:ConfigObject}" RegGroup="Count" ConditionName="ConfigObjectResult" Operation="GreaterThan" Value="100">(absolute-rewrite)\s</Condition>
		</Expression>
	</Formula>

	<Formula Categories="configuration;memory;failure;cpuload">
		<Name>{Condition:SectionName} - StylePolicy Object &lt;font color='#006666'&gt;{Condition:ObjectName}&lt;/font&gt; has &lt;font color='red'&gt;{Condition:ConfigObjectResult}&lt;/font&gt; match actions.  There may be duplicate entries that are building up in the configuration object that should be removed.  Duplicate parameters can attribute to longer import/export/view/comparison configuration times.</Name>
		<URL description="APAR IT30935 (Fixed in: 2018.4.1.10): Indexed properties related to URLRewrite Rule, SAML Attribute, Stylepolicy to avoid duplicate entries: ">https://www.ibm.com/support/docview.wss?uid=swg1IT30935</URL>
		<Expression LogLevel="Warning" FormulaIDMatch="APARCHECK:IT30935">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\bstylepolicy \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit\b</RegExp>
			<Condition FieldPosition="0" RegGroup="All" ConditionName="ConfigObject" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{Condition:ConfigObject}" RegGroup="Count" ConditionName="ConfigObjectResult" Operation="GreaterThan" Value="100">match\s+\"[a-zA-Z-_.0-9]+\"\s+\"[a-zA-Z-_.0-9]+\"</Condition>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;memory;failure;cpuload">
		<Name>{Condition:SectionName} - User-Agent Object &lt;font color='#006666'&gt;{Condition:ObjectName}&lt;/font&gt; has &lt;font color='red'&gt;{Condition:ConfigObjectResult}&lt;/font&gt; basicauth entries.  There may be duplicate entries that are building up in the configuration object that should be removed.  Duplicate parameters can attribute to longer import/export/view/comparison configuration times.</Name>
		<Expression LogLevel="Warning">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\buser-agent \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit\b</RegExp>
			<Condition FieldPosition="0" RegGroup="All" ConditionName="ConfigObject" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{Condition:ConfigObject}" RegGroup="Count" ConditionName="ConfigObjectResult" Operation="GreaterThan" Value="100">\s{0,}basicauth \"[a-zA-Z0-9-_.:?=;\/*+ ]*\" \"[a-zA-Z0-9-_.:?=;\/*+ ]*\" \"[a-zA-Z0-9-_.:?=;\/*+ ]*\"</Condition>
		</Expression>
	</Formula>
	<!-- end duplicate config param checks -->
	

	<!-- tracking of APAR IT23520 where wsm-agent has capture-mode set to all-messages -->
	<Formula Categories="configuration;memory;failure">
		<Name>&lt;font color='#CC3300'&gt;{Condition:SectionName}&lt;/font&gt; WSM-Agent is configured with 'capture-mode all-messages'.  Records could be getting lost without APAR fix, this can cause API Connect Analytics to not display.  Advise using 'capture-mode faults' as a workaround, update using CLI or OLD WebGUI, &lt;font color='red'&gt;WARNING: DO NOT use BluePrint console to make these change as it will clear push-subscribers field if used (API Management domains always use this hidden property)&lt;/font&gt;.</Name>
		<URL description="IT23520 (Fixed in 7.5.2.13 and 7.6.0.6): WSM-AGENT MIGHT REPORT AN INCORRECT VALUE FOR MEMORY USED CAUSING RECORDS TO BE LOST: ">https://www.ibm.com/support/docview.wss?uid=swg1IT23520</URL>
		<Expression LogLevel="Error" FormulaIDMatch="APARCHECK:IT23520">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>wsm-agent\W+(\w+\W+)*?(capture-mode all-messages|exit)</RegExp>
			<Condition FieldPosition="2" RegGroup="All" Operation="EqualsTo" Value="capture-mode all-messages"/>
		</Expression>
	</Formula>
	
	<!-- tracking WSM agent causing memory to grow due to lack of APAR fix IT21626 -->
	<Formula Categories="failure;general;memory">
		<Name>{Condition:SectionName} Memory may grow due to WSM-Agent Records Lost, currently {Condition:RecordsLost} records have been lost.</Name>
		<URL description="IT21626: IBM API CONNECT PERFORMANCE / DATAPOWER MEMORY GROWTH (Fixed in 7.1.0.20, 7.2.0.17, 7.5.0.11, 7.5.1.10, 7.5.2.10 and 7.6.0.3): ">https://www.ibm.com/support/docview.wss?uid=swg1IT21626</URL>
		<Expression LogLevel="Error" FormulaIDMatch="APARCHECK:IT21626">
			<Section Name="WSMAgentStatus" Wildcard="True" XPath="/Status/WSMAgentStatus/RecordsLost"/>
			<RegExp>*</RegExp>
			<!-- set a base line of 10k, but situations have shown 100k+ typically noticeable -->
			<Condition FieldPosition="0" ConditionName="RecordsLost" Operation="GreaterThan" Value="10000"/>
		</Expression>
	</Formula>
	
	<Formula Categories="general;configuration;sidebarresult">
		<Name>{Condition:SectionName} State: {Condition:ResultString}&lt;/font&gt; Mode: {/Status/QuotaEnforcementStatus/Mode}, Role: {Condition:Role}, Connected Slaves: {Condition:ConnectedSlaves}, Master Host is {Condition:Master}, QES Size: {Condition:Size}.</Name>
		<URL description="Best practices for configuring a reliable and scalable peer group for quota enforcement: ">https://www.ibm.com/support/docview.wss?uid=swg21981525</URL>
		<Expression LogLevel="Info">
			<Section Name="QuotaEnforcementStatus" XPath="/Status/QuotaEnforcementStatus/State"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="EqualsTo" ConditionName="State" Value="up" NextOperation="And"/>
			<!-- set field position to something less than 0 to not append an existing value -->
			<Condition FieldPosition="-1" ConditionName="ColorString" Operation="Append" Value="&lt;font color='green'&gt;" NextOperation="And"/>
			<Condition FieldPosition="{Condition:ColorString}" ConditionName="ResultString" Operation="Append" Value="{Condition:State}" NextOperation="And"/>
			<Condition FieldPosition="{/Status/QuotaEnforcementStatus/Mode}" ConditionName="Mode" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/QuotaEnforcementStatus/Role}" ConditionName="Role" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/QuotaEnforcementStatus/ConnectedSlaves}" ConditionName="ConnectedSlaves" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/QuotaEnforcementStatus/Master}" ConditionName="Master" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/QuotaEnforcementStatus/Size}" ConditionName="Size" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="QuotaEnforcementStatus" XPath="/Status/QuotaEnforcementStatus/State"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" Operation="NotEqualTo" ConditionName="State" Value="up" NextOperation="And"/>
			<!-- set field position to something less than 0 to not append an existing value -->
			<Condition FieldPosition="-1" ConditionName="ColorString" Operation="Append" Value="&lt;font color='red'&gt;" NextOperation="And"/>
			<Condition FieldPosition="{Condition:ColorString}" ConditionName="ResultString" Operation="Append" Value="{Condition:State}" NextOperation="And"/>
			<Condition FieldPosition="{/Status/QuotaEnforcementStatus/Mode}" ConditionName="Mode" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/QuotaEnforcementStatus/Role}" ConditionName="Role" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/QuotaEnforcementStatus/ConnectedSlaves}" ConditionName="ConnectedSlaves" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/QuotaEnforcementStatus/Master}" ConditionName="Master" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/QuotaEnforcementStatus/Size}" ConditionName="Size" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;memory;cpuload;network">
		<Name>{Condition:SectionName} with xml manager: {Condition:XMLManager}, DocCount/Total: &lt;font color='orange'&gt;{Condition:DocCount}/{Condition:CacheTotal}&lt;/font&gt;.  Cache Size Current/Max (KiB): {Condition:CacheCurrentSizeKiB} / {Condition:CacheTotalSizeKiB}.  Non-Expired Documents: {Condition:EnumerationCount}.</Name>
		<DisplayMessage>This cache is nearing or reached capacity of unique entries, however this cache may have expired entries which can be replaced, check the other status provider, DocumentStatusSimpleIndex (Document Status) for more information.</DisplayMessage>
		<URL description="Defining the capacity and concurrent write behavior for the document cache: ">https://www.ibm.com/docs/en/datapower-gateway/10.6.0?topic=manager-defining-document-cache-policies</URL>
		<Expression LogLevel="Warning" NextOperation="And">	
			<Section Name="DocumentCachingSummary" SectionName="false" Wildcard="True" XPath="/Status//*[starts-with(local-name(),'DocumentCachingSummary')]/DocCount"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" InValue="{Condition:SectionName}" ConditionName="DomainName" Operation="NotEqualTo" Value="" NextOperation="And">([a-zA-Z-_.0-9]+)-DocumentCachingSummary</Condition>
			<Condition FieldPosition="0" InValue="{/Status//*[starts-with(local-name(),'DocumentCachingSummary')]/XMLManager}" ConditionName="XMLManager" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" ConditionName="DocCount" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" InValue="{/Status//*[starts-with(local-name(),'DocumentCachingSummary')]/CacheCount}" ConditionName="CacheTotal" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" InValue="{Condition:DocCount}" Operation="DivideBy" ConditionName="PercentageUsed" Value="{Condition:CacheTotal}" NextOperation="And"/>
			<Condition FieldPosition="{Condition:PercentageUsed}" Operation="Round" ConditionName="PercentageUsedRounded" Value="2" NextOperation="And"/>
			<!-- set slightly below the 'good' formula so we don't miss out on anything thats 80% -->
			<Condition FieldPosition="0" InValue="{Condition:PercentageUsedRounded}" Operation="GreaterThan" Value=".7999" NextOperation="And"/>
			<Condition FieldPosition="0" InValue="{/Status//*[starts-with(local-name(),'DocumentCachingSummary')]/KiByteCount}" ConditionName="CacheCurrentSizeKiB" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" InValue="{/Status//*[starts-with(local-name(),'DocumentCachingSummary')]/CacheSizeKiB}" ConditionName="CacheTotalSizeKiB" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Warning" RequiredFile="{Condition:DomainName}-DocumentStatusSimpleIndex">	
			<Section Name="DocumentStatusSimpleIndex" Wildcard="True" XPath="/Status//*[starts-with(local-name(),'DocumentStatusSimpleIndex')]/Expiry"/>
			<RegExp>*</RegExp>
			<Condition RegGroup="Enumeration" FieldPosition="0" InValue="{/Status//*[starts-with(local-name(),'DocumentStatusSimpleIndex')]/XMLManager}" ConditionName="ActualXMLManager" Operation="EqualsTo" Value="{Condition:XMLManager}" NextOperation="And"/>
			<Condition RegGroup="Enumeration" FieldPosition="0" ConditionName="Expired" Operation="NotEqualTo" Value="expired"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;memory;cpuload;network">
		<Name>{Condition:SectionName} with xml manager: {Condition:XMLManager}, DocCount/Total: &lt;font color='green'&gt;{Condition:DocCount}/{Condition:CacheTotal}&lt;/font&gt;. Cache Size Current/Max (KiB): {Condition:CacheCurrentSizeKiB} / {Condition:CacheTotalSizeKiB}</Name>
		<URL description="Defining the capacity and concurrent write behavior for the document cache: ">https://www.ibm.com/docs/en/datapower-gateway/10.6.0?topic=manager-defining-document-cache-policies</URL>
		<Expression LogLevel="Info">
			<Section Name="DocumentCachingSummary" Wildcard="True" XPath="/Status//*[starts-with(local-name(),'DocumentCachingSummary')]/DocCount"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" InValue="{/Status//*[starts-with(local-name(),'DocumentCachingSummary')]/XMLManager}" ConditionName="XMLManager" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" ConditionName="DocCount" Operation="NotEqualTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="0" InValue="{/Status//*[starts-with(local-name(),'DocumentCachingSummary')]/CacheCount}" ConditionName="CacheTotal" Operation="NotEqualTo" Value="{Condition:DocCount}" NextOperation="And"/>
			<Condition FieldPosition="0" InValue="{Condition:DocCount}" Operation="DivideBy" ConditionName="PercentageUsed" Value="{Condition:CacheTotal}" NextOperation="And"/>
			<Condition FieldPosition="{Condition:PercentageUsed}" Operation="Round" ConditionName="PercentageUsedRounded" Value="2" NextOperation="And"/>
			<!-- set slightly above formula above to not miss out on any results -->
			<Condition FieldPosition="0" InValue="{Condition:PercentageUsedRounded}" Operation="LessThan" Value=".80" NextOperation="And"/>
			<Condition FieldPosition="0" InValue="{/Status//*[starts-with(local-name(),'DocumentCachingSummary')]/KiByteCount}" ConditionName="CacheCurrentSizeKiB" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" InValue="{/Status//*[starts-with(local-name(),'DocumentCachingSummary')]/CacheSizeKiB}" ConditionName="CacheTotalSizeKiB" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;failure">
		<Name>{Condition:SectionName} - Domain Availability is enabled in the domain, this will cause objects in the domain to quiesce on startup.  May also cause SSH/Telnet to be unresponsive past initial connection (cannot get to login prompt).  Disable and reload/reboot the DataPower Gateway.</Name>
		<URL FormulaIDMatch="APARCHECK:IT30192" description="IT30192 (Fixed in 2018.4.1.8): DATAPOWER MIGHT EXPERIENCE CPU SPIKE AFTER DOMAIN IS QUIESCED: ">https://www.ibm.com/support/pages/apar/IT30192</URL>
		<URL FormulaIDMatch="APARCHECK:IT33621" description="IT33621 (Fixed in 2018.4.1.13): BADLY CONFIGURED SERVICES CAUSES HANG ON SSH OR WEBGUI: ">https://www.ibm.com/support/pages/apar/IT33621</URL>
		<URL description="Open for E-Business for DataPower: ">ftp://ftp.software.ibm.com/software/iea/content/com.ibm.iea.wdatapower/wdatapower/1.0/xi50/60DataPower_OpenBusiness.pdf</URL>
		<!-- won't display since the quiesce fixes in late v2018 should resolve -->
		<Expression LogLevel="Error" FormulaIDMatch="APARCHECK:IT33621">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\bdomain-availability\W+(\w+\W+)*?(admin-state ([a-zA-Z\-]+)|exit)\b</RegExp>
			<Condition FieldPosition="2" RegGroup="All" ConditionName="ConfigObject" Operation="Contains" Value="admin-state enabled"/>
		</Expression>
	</Formula>
	
	<!-- secure gateway client updates in later 7.5.2/7.6 fixpacks -->
	<Formula CollapseResult="true" FormulaID="APAR-IT14230">
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.5.2" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="14"/>
			</Expression>
			<Expression LogLevel="Warning">
				<Section Name="FirmwareVersion2" XPath="/Status/FirmwareVersion2//Version"/>
				<RegExp>(XI|XG|XA|XS|XB|IDG)[0-9]{0,2}.(\d+\.\d+\.\d+)\.(\d+)([a-zA-Z0-9]*)</RegExp>
				<Condition FieldPosition="2" Operation="EqualsTo" Value="7.6.0" NextOperation="And"/>
				<Condition FieldPosition="3" Operation="LessThan" Value="7"/>
			</Expression>
	</Formula>
	
	<Formula Categories="configuration;cpuload">
		<Name>&lt;font color='#CC3300'&gt;{Condition:SectionName}&lt;/font&gt; There is a Secure Gateway Client Object &lt;font color='#CC3300'&gt;{Condition:ObjectName}&lt;/font&gt; configured using an outdated client.  Connectivity problems may occur at current level.</Name>
		<URL description="IT14230 (Fixed in 7.5.2.14 and 7.6.0.7): UPGRADE EMBEDDED SECURE GATEWAY CLIENT TO VERSION 1.8.0: ">https://www.ibm.com/support/docview.wss?uid=swg1IT24225</URL>
		<Expression LogLevel="Critical" FormulaIDMatch="APAR-IT14230">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\nsgclient \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?exit</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ObjectName" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	<!-- end of secure gateway client updates -->

	<Formula Categories="general;configuration;sidebarresult" FormulaID="FoundRuntimeCPUMatch">
		<Name>{Condition:SectionName} Runtime Count: {Condition:ResultString}&lt;/font&gt;.  Max GatewayScript Runtimes Allowed (Limited to vCPU count): {Condition:VirtualCPUs}.</Name>
		<URL description="Configuring GatewayScript settings: ">https://www.ibm.com/docs/en/datapower-gateway/10.6.0?topic=gatewayscript-configuring-settings</URL>
		<Expression LogLevel="Info" NextOperation="And">
			<Section Name="VirtualPlatform" Wildcard="True" XPath="/Status//*[starts-with(local-name(),'VirtualPlatform')]/VirtualCPUs"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="VirtualCPUs" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" ConditionName="VirtualCPUsTmp" Operation="Multiply" Value=".9" NextOperation="And"/>
			<Condition FieldPosition="0" InValue="{Condition:VirtualCPUsTmp}" ConditionName="VirtualCPUsFraction" Operation="Add" Value=".001"/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="GatewayScriptStatus" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="RuntimeCount" Operation="NotEqualTo" Value="" NextOperation="And">CurrentRuntimes: ([0-9]+)</Condition>
			<Condition FieldPosition="0" InValue="{Condition:RuntimeCount}" Operation="GreaterThan" Value="{Condition:VirtualCPUsFraction}" NextOperation="And"/>
			<Condition FieldPosition="-2" ConditionName="ColorString" Operation="Append" Value="&lt;font color='orange'&gt;" NextOperation="And"/>
			<Condition FieldPosition="{Condition:ColorString}" ConditionName="ResultString" Operation="Append" Value="{Condition:RuntimeCount}"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="GatewayScriptStatus" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="{Condition:VirtualCPUs}" Operation="NotContain" Value="(null)" NextOperation="And"/>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="RuntimeCount" Operation="NotEqualTo" Value="" NextOperation="And">CurrentRuntimes: ([0-9]+)</Condition>
			<Condition FieldPosition="{Condition:RuntimeCount}" Operation="LessThan" Value="{Condition:VirtualCPUsFraction}" NextOperation="And"/>
			<Condition FieldPosition="-1" ConditionName="ColorString" Operation="Append" Value="&lt;font color='green'&gt;" NextOperation="And"/>
			<Condition FieldPosition="{Condition:ColorString}" ConditionName="ResultString" Operation="Append" Value="{Condition:RuntimeCount}"/>
		</Expression>
	</Formula>
	
	<Formula Categories="general;configuration;sidebarresult">
		<Name>{Condition:SectionName} Runtime Count: {Condition:ResultString}&lt;/font&gt;.  Max GatewayScript Runtimes Allowed (Limited to vCPU count): Could not retrieve VirtualPlatform Status Provider to establish vCPU count.</Name>
		<URL description="Configuring GatewayScript settings: ">https://www.ibm.com/docs/en/datapower-gateway/10.6.0?topic=gatewayscript-configuring-settings</URL>
		<Expression LogLevel="Info" FormulaIDMatch="!FoundRuntimeCPUMatch">
			<Section Name="GatewayScriptStatus" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="RuntimeCount" Operation="NotEqualTo" Value="" NextOperation="And">CurrentRuntimes: ([0-9]+)</Condition>
			<Condition FieldPosition="-1" ConditionName="ColorString" Operation="Append" Value="&lt;font color='black'&gt;" NextOperation="And"/>
			<Condition FieldPosition="{Condition:ColorString}" ConditionName="ResultString" Operation="Append" Value="{Condition:RuntimeCount}"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration">
		<Name>{Condition:SectionName} &lt;font color='#006666'&gt;{Condition:ObjectName}&lt;/font&gt; : Class &lt;font color='#006666'&gt;{Condition:ObjectClass}&lt;/font&gt; is in the default domain, it is not a good practice to have custom services in the default domain.</Name>
		<DisplayMessage>&lt;font color='#006666'&gt;{Condition:ObjectName}&lt;/font&gt;||&lt;font color='#006666'&gt;{Condition:ObjectClass}&lt;/font&gt;||&lt;font color='#006666'&gt;{Condition:OpState}&lt;/font&gt;</DisplayMessage>
		<Expression LogLevel="Warning" NextOperation="And">
			<Section Name="&lt;ObjectStatus@datapower.ibm.com&gt;" XPath="/Status/ObjectStatus/Name[../Class/text()='MultiProtocolGateway' or ../Class/text()='WSGateway' or ../Class/text()='XMLFirewallService' or ../Class/text()='WebAppFW']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="ObjectName" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Warning" NextOperation="And">
			<Section Name="&lt;ObjectStatus@datapower.ibm.com&gt;" XPath="/Status/ObjectStatus/Class[../Class/text()='MultiProtocolGateway' or ../Class/text()='WSGateway' or ../Class/text()='XMLFirewallService' or ../Class/text()='WebAppFW']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="ObjectClass" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Warning">
			<Section Name="&lt;ObjectStatus@datapower.ibm.com&gt;" XPath="/Status/ObjectStatus/OpState[../Class/text()='MultiProtocolGateway' or ../Class/text()='WSGateway' or ../Class/text()='XMLFirewallService' or ../Class/text()='WebAppFW']"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" ConditionName="OpState" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;failure;network" SortCondition="DomainName">
		<Name>Two Gateway Peering Objects conflict on local port in different domains, change the local port and/or IP to not conflict with other gateway-peering objects.</Name>
		<DisplayMessage>&lt;font color='#CC3300'&gt;{Condition:SectionName}&lt;/font&gt;||"Object Name" (Domain Name): &lt;font color='#CC3300'&gt;"{Condition:GWPeerName}" ({Condition:DomainName}) / "{Condition:GWPeerName2}" ({Condition:DomainName2})&lt;/font&gt;||&lt;font color='#CC3300'&gt;{Condition:LocalIPPort} / {Condition:LocalIPPort2}&lt;/font&gt;</DisplayMessage>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<!-- <Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/> -->
			<RegExp>\bgateway-peering \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?(local-address ([a-zA-Z0-9-_.:/\ ]*)|exit)\b</RegExp>
			<Condition FieldPosition="1" TableMapPosition="0" RegGroup="All" InValue="{Condition:SectionName}" ConditionName="DomainName" Operation="NotEqualTo" Value="" NextOperation="And">([a-zA-Z-_.0-9]+)-config</Condition>
			<Condition FieldPosition="1" TableMapPosition="1" RegGroup="All" ConditionName="GWPeerName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" TableMapPosition="-2" RegGroup="All" ConditionName="LocalAddress" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" TableMapPosition="-2" RegGroup="All" ConditionName="LocalPort" Operation="NotEqualTo" Value="" NextOperation="And">\bgateway-peering \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?(local-port ([0-9]+)|exit)\b</Condition>
			<Condition FieldPosition="0" TableMapPosition="-2" RegGroup="All" ConditionName="Config" Operation="NotContain" Value="admin-state disabled" NextOperation="And">\bgateway-peering \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit\b</Condition>
			<Condition FieldPosition="-2" TableMapPosition="2" InValue="{Condition:LocalAddress}:" RegGroup="AllResult" ConditionName="LocalIPPort" Operation="Append" Value="{Condition:LocalPort}"/>
		</Expression>
		<Expression LogLevel="Critical" RequiredFile="-config">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<!-- <Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/> -->
			<RegExp>\bgateway-peering \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?(local-address ([a-zA-Z0-9-_.:/\ ]*)|exit)\b</RegExp>
			<Condition FieldPosition="1" TableMapPosition="-2" RegGroup="AllResult" InValue="{Condition:SectionName}" ConditionName="DomainName2" Operation="NotEqualTo" Value="{Condition:DomainName}" NextOperation="And">([a-zA-Z-_.0-9]+)-config</Condition>
			<Condition FieldPosition="1" TableMapPosition="-2" RegGroup="AllResult" ConditionName="GWPeerName2" Operation="NotEqualTo" Value="" NextOperation="And">\bgateway-peering \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?(local-address ([a-zA-Z0-9-_.:/\ ]*)|exit)\b</Condition>
			<Condition FieldPosition="4" TableMapPosition="-2" RegGroup="AllResult" ConditionName="LocalAddress2" Operation="NotEqualTo" Value="" NextOperation="And">\bgateway-peering \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?(local-address ([a-zA-Z0-9-_.:/\ ]*)|exit)\b</Condition>
			<Condition FieldPosition="4" TableMapPosition="-2" RegGroup="AllResult" ConditionName="LocalPort2" Operation="NotEqualTo" Value="" NextOperation="And">\bgateway-peering \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?(local-port ([0-9]+)|exit)\b</Condition>
			<Condition FieldPosition="0" TableMapPosition="-2" RegGroup="AllResult" ConditionName="Config2" Operation="NotContain" Value="admin-state disabled" NextOperation="And">\bgateway-peering \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit\b</Condition>
			<Condition FieldPosition="-2" TableMapPosition="-2" InValue="{Condition:LocalAddress2}:" RegGroup="AllResult" ConditionName="LocalIPPort2" Operation="Append" Value="{Condition:LocalPort2}" NextOperation="And"/>
			<Condition FieldPosition="-2" TableMapPosition="-2" InValue="{Condition:LocalIPPort2}" RegGroup="AllResult" Operation="EqualsTo" Value="{Condition:LocalIPPort}"/>
		</Expression>
	</Formula>

	<Formula Categories="configuration;failure;network">
		<Name>Two Gateway Peering Objects conflict on local port in the same domain, change the local port and/or IP to not conflict with other gateway-peering objects.</Name>
		<DisplayMessage>&lt;font color='#CC3300'&gt;{Condition:SectionName}&lt;/font&gt;||&lt;font color='#CC3300'&gt;"{Condition:GWPeerName}" / "{Condition:GWPeerName2}" &lt;/font&gt;||&lt;font color='#CC3300'&gt;{Condition:LocalIPPort} / {Condition:LocalIPPort2}&lt;/font&gt;</DisplayMessage>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<!-- <Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/> -->
			<RegExp>\bgateway-peering \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?(local-address ([a-zA-Z0-9-_.:/\ ]*)|exit)\b</RegExp>
			<Condition FieldPosition="1" TableMapPosition="0" RegGroup="All" InValue="{Condition:SectionName}" ConditionName="DomainName" Operation="NotEqualTo" Value="" NextOperation="And">([a-zA-Z-_.0-9]+)-config</Condition>
			<Condition FieldPosition="1" TableMapPosition="1" RegGroup="All" ConditionName="GWPeerName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" TableMapPosition="-2" RegGroup="All" ConditionName="LocalAddress" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" TableMapPosition="-2" RegGroup="All" ConditionName="LocalPort" Operation="NotEqualTo" Value="" NextOperation="And">\bgateway-peering \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?(local-port ([0-9]+)|exit)\b</Condition>
			<Condition FieldPosition="0" TableMapPosition="-2" RegGroup="All" ConditionName="Config" Operation="NotContain" Value="admin-state disabled" NextOperation="And">\bgateway-peering \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit\b</Condition>
			<Condition FieldPosition="-2" TableMapPosition="2" InValue="{Condition:LocalAddress}:" RegGroup="AllResult" ConditionName="LocalIPPort" Operation="Append" Value="{Condition:LocalPort}"/>
		</Expression>
		<Expression LogLevel="Critical" RequiredFile="{Condition:DomainName}-config">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<!-- <Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/> -->
			<RegExp>\bgateway-peering \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?(local-address ([a-zA-Z0-9-_.:/\ ]*)|exit)\b</RegExp>
			<Condition FieldPosition="1" TableMapPosition="-2" RegGroup="AllResult" ConditionName="GWPeerName2" Operation="NotEqualTo" Value="" NextOperation="And">\bgateway-peering \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?(local-address ([a-zA-Z0-9-_.:/\ ]*)|exit)\b</Condition>
			<Condition FieldPosition="4" TableMapPosition="-2" RegGroup="AllResult" ConditionName="LocalAddress2" Operation="NotEqualTo" Value="" NextOperation="And">\bgateway-peering \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?(local-address ([a-zA-Z0-9-_.:/\ ]*)|exit)\b</Condition>
			<Condition FieldPosition="4" TableMapPosition="-2" RegGroup="AllResult" ConditionName="LocalPort2" Operation="NotEqualTo" Value="" NextOperation="And">\bgateway-peering \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?(local-port ([0-9]+)|exit)\b</Condition>
			<Condition FieldPosition="0" TableMapPosition="-2" RegGroup="AllResult" ConditionName="Config2" Operation="NotContain" Value="admin-state disabled" NextOperation="And">\bgateway-peering \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit\b</Condition>
			<Condition FieldPosition="-2" TableMapPosition="-2" InValue="{Condition:LocalAddress2}:" RegGroup="AllResult" ConditionName="LocalIPPort2" Operation="Append" Value="{Condition:LocalPort2}" NextOperation="And"/>
			<Condition FieldPosition="-2" TableMapPosition="-2" InValue="{Condition:LocalIPPort2}" RegGroup="AllResult" Operation="EqualsTo" Value="{Condition:LocalIPPort}" NextOperation="And"/>
			<Condition FieldPosition="-2" TableMapPosition="-2" InValue="{Condition:GWPeerName}" RegGroup="AllResult" ConditionName="ResultTest" Operation="NotEqualTo" Value="{Condition:GWPeerName2}"/>
		</Expression>
	</Formula>
	
	
	<Formula Categories="configuration;failure;network">
		<Name>Two Gateway Peering Objects conflict on monitor port in different domains, change the monitor port and/or IP to not conflict with other gateway-peering objects.</Name>
		<DisplayMessage>&lt;font color='#CC3300'&gt;{Condition:SectionName}&lt;/font&gt;||"Object Name" (Domain Name): &lt;font color='#CC3300'&gt;"{Condition:GWPeerName}" ({Condition:DomainName}) / "{Condition:GWPeerName2}" ({Condition:DomainName2})&lt;/font&gt;||&lt;font color='#CC3300'&gt;{Condition:LocalIPPort} / {Condition:LocalIPPort2}&lt;/font&gt;</DisplayMessage>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<!-- <Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/> -->
			<RegExp>\bgateway-peering \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?(local-address ([a-zA-Z0-9-_.:/\ ]*)|exit)\b</RegExp>
			<Condition FieldPosition="1" TableMapPosition="0" RegGroup="All" InValue="{Condition:SectionName}" ConditionName="DomainName" Operation="NotEqualTo" Value="" NextOperation="And">([a-zA-Z-_.0-9]+)-config</Condition>
			<Condition FieldPosition="1" TableMapPosition="1" RegGroup="All" ConditionName="GWPeerName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" TableMapPosition="-2" RegGroup="All" ConditionName="LocalAddress" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" TableMapPosition="-2" RegGroup="All" ConditionName="LocalPort" Operation="NotEqualTo" Value="" NextOperation="And">\bgateway-peering \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?(monitor-port ([0-9]+)|exit)\b</Condition>
			<Condition FieldPosition="0" TableMapPosition="-2" RegGroup="All" ConditionName="Config" Operation="NotContain" Value="admin-state disabled" NextOperation="And">\bgateway-peering \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit\b</Condition>
			<Condition FieldPosition="-2" TableMapPosition="2" InValue="{Condition:LocalAddress}:" RegGroup="AllResult" ConditionName="LocalIPPort" Operation="Append" Value="{Condition:LocalPort}"/>
		</Expression>
		<Expression LogLevel="Critical" RequiredFile="-config">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<!-- <Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/> -->
			<RegExp>\bgateway-peering \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?(local-address ([a-zA-Z0-9-_.:/\ ]*)|exit)\b</RegExp>
			<Condition FieldPosition="1" TableMapPosition="-2" RegGroup="AllResult" InValue="{Condition:SectionName}" ConditionName="DomainName2" Operation="NotEqualTo" Value="{Condition:DomainName}" NextOperation="And">([a-zA-Z-_.0-9]+)-config</Condition>
			<Condition FieldPosition="1" TableMapPosition="-2" RegGroup="AllResult" ConditionName="GWPeerName2" Operation="NotEqualTo" Value="" NextOperation="And">\bgateway-peering \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?(local-address ([a-zA-Z0-9-_.:/\ ]*)|exit)\b</Condition>
			<Condition FieldPosition="4" TableMapPosition="-2" RegGroup="AllResult" ConditionName="LocalAddress2" Operation="NotEqualTo" Value="" NextOperation="And">\bgateway-peering \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?(local-address ([a-zA-Z0-9-_.:/\ ]*)|exit)\b</Condition>
			<Condition FieldPosition="4" TableMapPosition="-2" RegGroup="AllResult" ConditionName="LocalPort2" Operation="NotEqualTo" Value="" NextOperation="And">\bgateway-peering \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?(monitor-port ([0-9]+)|exit)\b</Condition>
			<Condition FieldPosition="0" TableMapPosition="-2" RegGroup="AllResult" ConditionName="Config2" Operation="NotContain" Value="admin-state disabled" NextOperation="And">\bgateway-peering \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit\b</Condition>
			<Condition FieldPosition="-2" TableMapPosition="-2" InValue="{Condition:LocalAddress2}:" RegGroup="AllResult" ConditionName="LocalIPPort2" Operation="Append" Value="{Condition:LocalPort2}" NextOperation="And"/>
			<Condition FieldPosition="-2" TableMapPosition="-2" InValue="{Condition:LocalIPPort2}" RegGroup="AllResult" Operation="EqualsTo" Value="{Condition:LocalIPPort}"/>
		</Expression>
	</Formula>

	<Formula Categories="configuration;failure;network">
		<Name>Two Gateway Peering Objects conflict on monitor port in the same domain, change the monitor port and/or IP to not conflict with other gateway-peering objects.</Name>
		<DisplayMessage>&lt;font color='#CC3300'&gt;{Condition:SectionName}&lt;/font&gt;||&lt;font color='#CC3300'&gt;"{Condition:GWPeerName}" / "{Condition:GWPeerName2}" &lt;/font&gt;||&lt;font color='#CC3300'&gt;{Condition:LocalIPPort} / {Condition:LocalIPPort2}&lt;/font&gt;</DisplayMessage>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<!-- <Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/> -->
			<RegExp>\bgateway-peering \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?(local-address ([a-zA-Z0-9-_.:/\ ]*)|exit)\b</RegExp>
			<Condition FieldPosition="1" TableMapPosition="0" RegGroup="All" InValue="{Condition:SectionName}" ConditionName="DomainName" Operation="NotEqualTo" Value="" NextOperation="And">([a-zA-Z-_.0-9]+)-config</Condition>
			<Condition FieldPosition="1" TableMapPosition="1" RegGroup="All" ConditionName="GWPeerName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" TableMapPosition="-2" RegGroup="All" ConditionName="LocalAddress" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="4" TableMapPosition="-2" RegGroup="All" ConditionName="LocalPort" Operation="NotEqualTo" Value="" NextOperation="And">\bgateway-peering \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?(monitor-port ([0-9]+)|exit)\b</Condition>
			<Condition FieldPosition="0" TableMapPosition="-2" RegGroup="All" ConditionName="Config" Operation="NotContain" Value="admin-state disabled" NextOperation="And">\bgateway-peering \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit\b</Condition>
			<Condition FieldPosition="-2" TableMapPosition="2" InValue="{Condition:LocalAddress}:" RegGroup="AllResult" ConditionName="LocalIPPort" Operation="Append" Value="{Condition:LocalPort}"/>
		</Expression>
		<Expression LogLevel="Critical" RequiredFile="{Condition:DomainName}-config">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<!-- <Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/> -->
			<RegExp>\bgateway-peering \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?(local-address ([a-zA-Z0-9-_.:/\ ]*)|exit)\b</RegExp>
			<Condition FieldPosition="1" TableMapPosition="-2" RegGroup="AllResult" ConditionName="GWPeerName2" Operation="NotEqualTo" Value="" NextOperation="And">\bgateway-peering \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?(local-address ([a-zA-Z0-9-_.:/\ ]*)|exit)\b</Condition>
			<Condition FieldPosition="4" TableMapPosition="-2" RegGroup="AllResult" ConditionName="LocalAddress2" Operation="NotEqualTo" Value="" NextOperation="And">\bgateway-peering \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?(local-address ([a-zA-Z0-9-_.:/\ ]*)|exit)\b</Condition>
			<Condition FieldPosition="4" TableMapPosition="-2" RegGroup="AllResult" ConditionName="LocalPort2" Operation="NotEqualTo" Value="" NextOperation="And">\bgateway-peering \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?(monitor-port ([0-9]+)|exit)\b</Condition>
			<Condition FieldPosition="0" TableMapPosition="-2" RegGroup="AllResult" ConditionName="Config2" Operation="NotContain" Value="admin-state disabled" NextOperation="And">\bgateway-peering \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?exit\b</Condition>
			<Condition FieldPosition="-2" TableMapPosition="-2" InValue="{Condition:LocalAddress2}:" RegGroup="AllResult" ConditionName="LocalIPPort2" Operation="Append" Value="{Condition:LocalPort2}" NextOperation="And"/>
			<Condition FieldPosition="-2" TableMapPosition="-2" InValue="{Condition:LocalIPPort2}" RegGroup="AllResult" Operation="EqualsTo" Value="{Condition:LocalIPPort}" NextOperation="And"/>
			<Condition FieldPosition="-2" TableMapPosition="-2" InValue="{Condition:GWPeerName}" RegGroup="AllResult" ConditionName="ResultTest" Operation="NotEqualTo" Value="{Condition:GWPeerName2}"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;failure;network">
		<Name>Gateway Peering Object has too long of a domain name and/or object name, this will cause the redis client to fail startup if the length is 108 or more.  Reduce domain and/or object name to have filename below 108 byte length limit.</Name>
		<DisplayMessage>&lt;font color='#CC3300'&gt;{Condition:SectionName}&lt;/font&gt;||&lt;font color='#CC3300'&gt;{Condition:GWPeerName}&lt;/font&gt;||&lt;font color='#CC3300'&gt;{Condition:FileName}&lt;/font&gt;||&lt;font color='#CC3300'&gt;{Condition:FileLength}&lt;/font&gt;</DisplayMessage>
		<Expression LogLevel="Critical">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<!-- <Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/> -->
			<RegExp>\bgateway-peering \"([a-zA-Z-_.0-9]+).*"\W+(\w+\W+)*?(persistence (memory|local|raid)|exit)\b</RegExp>
			<Condition FieldPosition="1" TableMapPosition="0" RegGroup="All" InValue="{Condition:SectionName}" ConditionName="DomainName" Operation="NotEqualTo" Value="" NextOperation="And">([a-zA-Z-_.0-9]+)-config</Condition>
			<Condition FieldPosition="1" TableMapPosition="1" RegGroup="All" ConditionName="GWPeerName" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="-2" TableMapPosition="2" InValue="/drouter/ramdisk2/gateway-peering/config/{Condition:DomainName}/{Condition:GWPeerName}/sentinel.sock" RegGroup="AllResult" ConditionName="FileName" Operation="Append" Value="" NextOperation="And"/>
			<Condition FieldPosition="-2" TableMapPosition="3" InValue="{Condition:FileName}" RegGroup="AllResult" ConditionName="FileLength" Operation="Length" Value="" NextOperation="And"/>
			<Condition FieldPosition="-2" TableMapPosition="-2" InValue="{Condition:FileLength}" RegGroup="AllResult" ConditionName="PersistenceType" Operation="GreaterThan" Value="107"/>
		</Expression>
	</Formula>

	<Formula Categories="configuration;failure;network">
		<Name>WSM Agent Memory is reaching close to maximum allowed by configuration, this may cause records to be dropped and lost, API Connect Analytics will stop working, consider increasing configuration max-memory or reset WSM Agent object to reset memory usage.</Name>
		<DisplayMessage>{Condition:SectionName}||{Condition:MemSize}KB||{Condition:ConfigMemoryMax}KB</DisplayMessage>
		<Expression LogLevel="Critical" NextOperation="And">
			<Section Name="&lt;([a-zA-Z-_.0-9]+)-config@datapower.ibm.com&gt;" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>\bwsm-agent\W+(\w+\W+)*?(max-memory ([0-9]+)|exit)\b</RegExp>
			<Condition FieldPosition="1" TableMapPosition="0" InValue="{Condition:SectionName}" ConditionName="DomainName" Operation="NotEqualTo" Value="" NextOperation="And">([a-zA-Z-_.0-9]+)-config</Condition>
			<Condition FieldPosition="3" TableMapPosition="2" RegGroup="All" ConditionName="ConfigMemoryMax" Operation="NotEqualTo" Value=""/>
		</Expression>
		<Expression LogLevel="Critical" RequiredFile="{Condition:DomainName}-WSMAgentStatus">
			<Section Name="WSMAgentStatus" Wildcard="True" XPath="/Status//*[starts-with(local-name(),'WSMAgentStatus')]/MemoryUsedKB"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" TableMapPosition="1" ConditionName="MemSize" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="0" TableMapPosition="-2" InValue="{Condition:MemSize}" Operation="DivideBy" ConditionName="PercentageUsed" Value="{Condition:ConfigMemoryMax}" NextOperation="And"/>
			<Condition TableMapPosition="-2" FieldPosition="{Condition:PercentageUsed}" Operation="GreaterThan" Value=".899"/> <!-- check for more than 89% -->
		</Expression>
	</Formula>

	<Formula CollapseResult="true" FormulaID="APARCHECK:IT21079">
		<Expression LogLevel="Info">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
			<RegExp>([A-Z]{2,4})[0-9]{0,2}.(((10|2018|2019|20[2-9][0-9])\.(\d+)\.(\d+))\.(\d+))([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="2018" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="EqualsTo" Value="4" NextOperation="And"/>
			<Condition FieldPosition="6" Operation="EqualsTo" Value="1" NextOperation="And"/>
			<Condition FieldPosition="7" Operation="LessThan" Value="17"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
			<RegExp>([A-Z]{2,4})[0-9]{0,2}.(((10|2018|2019|20[2-9][0-9])\.(\d+)\.(\d+))\.(\d+))([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="10" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="6" Operation="EqualsTo" Value="1" NextOperation="And"/>
			<Condition FieldPosition="7" Operation="LessThan" Value="4"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
			<RegExp>([A-Z]{2,4})[0-9]{0,2}.(((10|2018|2019|20[2-9][0-9])\.(\d+)\.(\d+))\.(\d+))([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="10" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="6" Operation="EqualsTo" Value="2" NextOperation="And"/>
			<Condition FieldPosition="7" Operation="LessThan" Value="1"/>
		</Expression>
		<Expression LogLevel="Info">
			<Section Name="FirmwareVersion3" XPath="/Status/FirmwareVersion3//Version"/>
			<RegExp>([A-Z]{2,4})[0-9]{0,2}.(((10|2018|2019|20[2-9][0-9])\.(\d+)\.(\d+))\.(\d+))([a-zA-Z0-9]*)</RegExp>
			<Condition FieldPosition="4" Operation="EqualsTo" Value="10" NextOperation="And"/>
			<Condition FieldPosition="5" Operation="EqualsTo" Value="0" NextOperation="And"/>
			<Condition FieldPosition="6" Operation="EqualsTo" Value="0"/>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;memory;failure">
		<Name>{Condition:SectionName} Action &lt;font color='#cc0000'&gt;{Condition:ActionName}&lt;/font&gt; is configured to INPUT &lt;font color='#cc0000'&gt;{Condition:InputName}&lt;/font&gt; -- due to known defect (memory leak), recommended to use &lt;font color='#cc0000'&gt;PIPE&lt;/font&gt; or upgrade.</Name>
		<URL description="IT21079 (Fixed in 10.0.1.4, 2018.4.1.17): XQUERY ACTION WITH JSON INPUT LANGUAGE MIGHT CAUSE UNRELEASED MEMORY GROWTH: ">https://www.ibm.com/support/pages/apar/IT21079</URL>
		<Expression FormulaIDMatch="APARCHECK:IT21079" LogLevel="Critical">
			<Section Name="config" Wildcard="True" XPath="/Root/text()"/>
			<Section Name=".cfg" Wildcard="True" XPath="/Root/text()"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="1" RegGroup="All" ConditionName="ActionName" Operation="NotEqualTo" Value="" NextOperation="And">action \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(input \"([a-zA-Z-_.0-9]+)\"|exit)</Condition>
			<Condition FieldPosition="4" RegGroup="All" Operation="EqualsTo" Value="xformng" NextOperation="And">action \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(type \"?([a-zA-Z-_.0-9]+)\"?|exit)</Condition>
			<Condition FieldPosition="4" RegGroup="All" Operation="EqualsTo" Value="json" NextOperation="And">action \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(input-language \"?([a-zA-Z-_.0-9]+)\"?|exit)</Condition>
			<Condition FieldPosition="4" RegGroup="All" ConditionName="InputName" Operation="NotEqualTo" Value="PIPE">action \"([a-zA-Z-_.0-9]+)\"\W+(\w+\W+)*?(input \"([a-zA-Z-_.0-9]+)\"|exit)</Condition>
		</Expression>
	</Formula>
	
	<Formula Categories="configuration;failure;network">
		<DisplayMessage>{Condition:SectionName}||{Condition:Address}||{Condition:Name}||{Condition:LinkStatus}||{Condition:Primary}||{Condition:PendingUpdates}||{Condition:ReplicationOffset}</DisplayMessage>
		<Expression LogLevel="Info">
			<Section Name="GatewayPeeringStatus" Wildcard="True" XPath="/Status/GatewayPeeringStatus//Address"/>
			<RegExp>*</RegExp>
			<Condition FieldPosition="0" TableMapPosition="1" ConditionName="Address" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/GatewayPeeringStatus//Name}" TableMapPosition="2" ConditionName="Name" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/GatewayPeeringStatus//LinkStatus}" TableMapPosition="3" ConditionName="LinkStatus" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/GatewayPeeringStatus//Primary}" TableMapPosition="4" ConditionName="Primary" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/GatewayPeeringStatus//PendingUpdates}" TableMapPosition="5" ConditionName="PendingUpdates" Operation="NotEqualTo" Value="" NextOperation="And"/>
			<Condition FieldPosition="{/Status/GatewayPeeringStatus//ReplicationOffset}" TableMapPosition="6" ConditionName="ReplicationOffset" Operation="NotEqualTo" Value=""/>
		</Expression>
	</Formula>
	
</Analytics>